var IDEASCRIPTDIR="script/",IDEAIMGSCRIPTDIR=IDEASCRIPTDIR+"img/",IDEAJQUERYIMAGESDIR=IDEASCRIPTDIR+"images/",IDEAMEDIAPLAYERSWF=IDEASCRIPTDIR+"mediaplayer.swf",IDEAEMPTYGIF=IDEAIMGSCRIPTDIR+"empty.gif",IDEASLIDERDEFICON=IDEAIMGSCRIPTDIR+"slider_icon.gif",IDEAMOUSEICON=IDEAIMGSCRIPTDIR+"mouse.gif",IDEAMOUSELCLICKICON=IDEAIMGSCRIPTDIR+"lclick.gif",IDEAMOUSERCLICKICON=IDEAIMGSCRIPTDIR+"rclick.gif",IDEAENDSCREENIMAGE=IDEAIMGSCRIPTDIR+"end452.png",IDEAFOLDERICON=IDEAIMGSCRIPTDIR+"folder.gif",IDEAFOLDEROPENICON=IDEAIMGSCRIPTDIR+"folderopen.gif",IDEAPAGEICON=IDEAIMGSCRIPTDIR+"page.gif",IDEABASEICON=IDEAIMGSCRIPTDIR+"base.gif",IDEALINEICON=IDEAIMGSCRIPTDIR+"line.gif",IDEAJOINICON=IDEAIMGSCRIPTDIR+"join.gif",IDEAJOINBOTTOMICON=IDEAIMGSCRIPTDIR+"joinbottom.gif",IDEAPLUSICON=IDEAIMGSCRIPTDIR+"plus.gif",IDEAPLUSBOTTOMICON=IDEAIMGSCRIPTDIR+"plusbottom.gif",IDEAMINUSICON=IDEAIMGSCRIPTDIR+"minus.gif",IDEAMINUSBOTTOMICON=IDEAIMGSCRIPTDIR+"minusbottom.gif",IDEANOLINESPLUSICON=IDEAIMGSCRIPTDIR+"nolines_plus.gif",IDEANOLINESMINUSICON=IDEAIMGSCRIPTDIR+"nolines_minus.gif",IDEASYSTEMLIBRARYURL=IDEASCRIPTDIR+"etc/sys.xml",IDEAJQUERYDOCUMENTNEWICON=IDEAJQUERYIMAGESDIR+"document-new.png",IDEAJQUERYDOCUMENTOPENFOLDERICON=IDEAJQUERYIMAGESDIR+"document-open-folder.png",IDEAWASSCRIPTDIR=IDEASCRIPTDIR+"ideawas/",IDEAWASGRIDIMAGSDIR=IDEAWASSCRIPTDIR+"grid/imgs/",IDEAWASMEDIABROWSERURL="mediabrowser/filebrowser.php",IDEAWASMEDIABROWSERGETFILENAMES="mediabrowser/getfilenames.php",IDEAWASMEDIABROWSERDELETEFILE="mediabrowser/deletefile.php",IDEAWASHTMLEDITORURL="htmledit/editor.php",MOBILECONSTANTS={WEBKIT:"webkit",IPHONE:"iphone",IPOD:"ipod",IPAD:"ipad",ANDROID:"android",ANDROIDMOBILE:"mobile",GOOGLETV:"googletv"},FALSE=0,False=0,TRUE=1,True=1,NEIN=0,JA=1,FALSCH=0,WAHR=1,AUTORENSYSTEMMODE=!!window.AUTORENSYSTEMIDEAMODE,WM_USER=1024,WindowsRuntime=0,ALNONE=0,ALTOP=1,ALBOTTOM=2,ALLEFT=3,ALRIGHT=4,ALCLIENT=5,TALEFTJUSTIFY=0,TARIGHTJUSTIFY=1,TACENTER=2,BVNONE=0,BVLOWERED=1,BVRAISED=2,BVSPACE=3,bEditModeResponsive=!1,bsNone=0,bsSingle=1,BKCUSTOM=0,BKOK=1,BKCANCEL=2,BKHELP=3,BKYES=4,BKNO=5,BKCLOSE=6,BKABORT=7,BKRETRY=8,BKIGNORE=9,BKALL=10,SBHORIZONTAL=0,SBVERTICAL=1,BLGLYPHLEFT=0,BLGLYPHRIGHT=1,BLGLYPHTOP=2,BLGLYPHBOTTOM=3,TLTOP=0,TLCENTER=1,TLBOTTOM=2,SSNONE=0,SSHORIZONTAL=1,SSVERTICAL=2,SSBOTH=3,BSBOX=0,BSFRAME=1,BSTOPLINE=2,BSBOTTOMLINE=3,BSLEFTLINE=4,BSRIGHTLINE=5,BSSPACER=6,CBUNCHECKED=0,CBCHECKED=1,CBGRAYED=2,BSLOWERED=0,BSRAISED=1,CSDROPDOWN=0,CSSIMPLE=1,CSDROPDOWNLIST=2,CSOWNERDRAWFIXED=3,CSOWNERDRAWVARIABLE=4,pmRuntime=0,pmEdit=1,pmPreview=3,lmById=1,lmByName=2,lmBySubClass=3,lmByNameExclude=4,lmBySubClassExclude=5,lmByNameList=6,ltFirst=0,ltAny=1,gvnCaption=1,gvnPageName=2,gvnCompName=3,gvnAttrName=4,gvnObjName=5,gvnMailSubj=6,gvnMailBody=7,gvnPrjName=8,gvnPrjTitle=9,gvnUserName=10,gvnCatName=11,gvnMediaNiceName=12,gvnMediaCopyRight=13,whtPixel=0,whtRel2FontSize=1,whtPercent=2,whtAuto=3,whtMinAsParent=4,lttPixel=0,lttRel2FontSize=1,lttPercent=2,lttLeftAligned=3,lttTopAligned=3,lttCentered=4,lttRightAligned=5,lttBottomAligned=5,lttRelative=6;smAnySize=0,smProportional=1,smOrgImageSize=2,smp4To3=0,smp16To9=1,smpAnySize=2,rmHorizontal=1,rmVertical=2;var ntJavaScript="JavaScript",ntTStdHTML5VideoPlayer="TStdHTML5VideoPlayer",ntTHTML5VideoPlayer="THTML5VideoPlayer",ntTStdsortableList="TStdsortableList",ntFont="Font",COLOR_SCROLLBAR=0,COLOR_BACKGROUND=1,COLOR_ACTIVECAPTION=2,COLOR_INACTIVECAPTION=3,COLOR_MENU=4,COLOR_WINDOW=5,COLOR_WINDOWFRAME=6,COLOR_MENUTEXT=7,COLOR_WINDOWTEXT=8,COLOR_CAPTIONTEXT=9,COLOR_ACTIVEBORDER=10,COLOR_INACTIVEBORDER=11,COLOR_APPWORKSPACE=12,COLOR_HIGHLIGHT=13,COLOR_HIGHLIGHTTEXT=14,COLOR_BTNFACE=15,COLOR_BTNSHADOW=16,COLOR_GRAYTEXT=17,COLOR_BTNTEXT=18,COLOR_INACTIVECAPTIONTEXT=19,COLOR_BTNHIGHLIGHT=20,COLOR_3DDKSHADOW=21,COLOR_3DLIGHT=22,COLOR_INFOTEXT=23,COLOR_INFOBK=24,COLOR_HOTLIGHT=26,COLOR_GRADIENTACTIVECAPTION=27,COLOR_GRADIENTINACTIVECAPTION=28,COLOR_MENUHILIGHT=29,COLOR_MENUBAR=30,COLOR_ENDCOLORS=COLOR_MENUBAR,COLOR_DESKTOP=COLOR_BACKGROUND,COLOR_3DFACE=COLOR_BTNFACE,COLOR_3DSHADOW=COLOR_BTNSHADOW,COLOR_3DHIGHLIGHT=COLOR_BTNHIGHLIGHT,COLOR_3DHILIGHT=COLOR_BTNHIGHLIGHT,COLOR_BTNHILIGHT=COLOR_BTNHIGHLIGHT,CLSYSTEMCOLOR=4278190080,CLSCROLLBAR=CLSYSTEMCOLOR|COLOR_SCROLLBAR,CLBACKGROUND=CLSYSTEMCOLOR|COLOR_BACKGROUND,CLACTIVECAPTION=CLSYSTEMCOLOR|COLOR_ACTIVECAPTION,CLINACTIVECAPTION=CLSYSTEMCOLOR|COLOR_INACTIVECAPTION,CLMENU=CLSYSTEMCOLOR|COLOR_MENU,CLWINDOW=CLSYSTEMCOLOR|COLOR_WINDOW,CLWINDOWFRAME=CLSYSTEMCOLOR|COLOR_WINDOWFRAME,CLMENUTEXT=CLSYSTEMCOLOR|COLOR_MENUTEXT,CLWINDOWTEXT=CLSYSTEMCOLOR|COLOR_WINDOWTEXT,CLCAPTIONTEXT=CLSYSTEMCOLOR|COLOR_CAPTIONTEXT,CLACTIVEBORDER=CLSYSTEMCOLOR|COLOR_ACTIVEBORDER,CLINACTIVEBORDER=CLSYSTEMCOLOR|COLOR_INACTIVEBORDER,CLAPPWORKSPACE=CLSYSTEMCOLOR|COLOR_APPWORKSPACE,CLHIGHLIGHT=CLSYSTEMCOLOR|COLOR_HIGHLIGHT,CLHIGHLIGHTTEXT=CLSYSTEMCOLOR|COLOR_HIGHLIGHTTEXT,CLBTNFACE=CLSYSTEMCOLOR|COLOR_BTNFACE,CLBTNSHADOW=CLSYSTEMCOLOR|COLOR_BTNSHADOW,CLGRAYTEXT=CLSYSTEMCOLOR|COLOR_GRAYTEXT,CLBTNTEXT=CLSYSTEMCOLOR|COLOR_BTNTEXT,CLINACTIVECAPTIONTEXT=CLSYSTEMCOLOR|COLOR_INACTIVECAPTIONTEXT,CLBTNHIGHLIGHT=CLSYSTEMCOLOR|COLOR_BTNHIGHLIGHT,CL3DDKSHADOW=CLSYSTEMCOLOR|COLOR_3DDKSHADOW,CL3DLIGHT=CLSYSTEMCOLOR|COLOR_3DLIGHT,CLINFOTEXT=CLSYSTEMCOLOR|COLOR_INFOTEXT,CLINFOBK=CLSYSTEMCOLOR|COLOR_INFOBK,CLHOTLIGHT=CLSYSTEMCOLOR|COLOR_HOTLIGHT,CLGRADIENTACTIVECAPTION=CLSYSTEMCOLOR|COLOR_GRADIENTACTIVECAPTION,CLGRADIENTINACTIVECAPTION=CLSYSTEMCOLOR|COLOR_GRADIENTINACTIVECAPTION,CLMENUHIGHLIGHT=CLSYSTEMCOLOR|COLOR_MENUHILIGHT,CLMENUBAR=CLSYSTEMCOLOR|COLOR_MENUBAR,CLBLACK=0,CLMAROON=128,CLGREEN=32768,CLOLIVE=32896,CLNAVY=8388608,CLPURPLE=8388736,CLTEAL=8421376,CLGRAY=8421504,CLSILVER=12632256,CLRED=255,CLLIME=65280,CLYELLOW=65535,CLBLUE=16711680,CLFUCHSIA=16711935,CLAQUA=16776960,CLLTGRAY=12632256,CLDKGRAY=8421504,CLWHITE=16777215,CLMONEYGREEN=12639424,CLSKYBLUE=15780518,CLCREAM=15793151,CLMEDGRAY=10789024,CLNONE=536870911,CLDEFAULT=536870912,FSNORMAL=0,FSBOLD=1,FSITALIC=2,FSUNDERLINE=4,FSSTRIKEOUT=16,CRDEFAULT="0",CRNONE="-1",CRARROW="-2",CRCROSS="-3",CRIBEAM="-4",CRSIZENESW="-6",CRSIZENS="-7",CRSIZENWSE="-8",CRSIZEWE="-9",CRUPARROW="-10",CRHOURGLASS="-11",CRDRAG="-12",CRNODROP="-13",CRHSPLIT="-14",CRVSPLIT="-15",CRMULTIDRAG="-16",CRSQLWAIT="-17",CRNO="-18",CRAPPSTART="-19",CRHELP="-20",CRHANDPOINT="-21",CRSIZE="-22",CRSIZEALL="-22",CR_UNDEFINED="1111",DMTILE="0",DMCENTER="1",DMSTRECH="2";nmAbsolute="1",nmRelative="2",nmAuto="",nmIgnore="0";var mrNone=0,mrOK=1,mrCancel=2,mrClose=3,mrRetry=4,mrIgnore=5,mrYes=6,mrNo=7,mrAll=8,VK_LBUTTON=1,VK_RBUTTON=2,VK_CANCEL=3,VK_MBUTTON=4,VK_BACK=8,VK_TAB=9,VK_CLEAR=12,VK_RETURN=13,VK_SHIFT=16,VK_CONTROL=17,VK_MENU=18,VK_PAUSE=19,VK_CAPITAL=20,VK_ESCAPE=27,VK_SPACE=32,VK_PRIOR=33,VK_NEXT=34,VK_END=35,VK_HOME=36,VK_LEFT=37,VK_UP=38,VK_RIGHT=39,VK_DOWN=40,VK_SELECT=41,VK_EXECUTE=43,VK_SNAPSHOT=44,VK_INSERT=45,VK_DELETE=46,VK_HELP=47,VK_0=48,VK_1=49,VK_2=50,VK_3=51,VK_4=52,VK_5=53,VK_6=54,VK_7=55,VK_8=56,VK_9=57,VK_A=65,VK_B=66,VK_C=67,VK_D=68,VK_E=69,VK_F=70,VK_G=71,VK_H=72,VK_I=73,VK_J=74,VK_K=75,VK_L=76,VK_M=77,VK_N=78,VK_O=79,VK_P=80,VK_Q=81,VK_R=82,VK_S=83,VK_T=84,VK_U=85,VK_V=86,VK_W=87,VK_X=88,VK_Y=89,VK_Z=90,VK_LWIN=91,VK_RWIN=92,VK_APPS=93,VK_NUMPAD0=96,VK_NUMPAD1=97,VK_NUMPAD2=98,VK_NUMPAD3=99,VK_NUMPAD4=100,VK_NUMPAD5=101,VK_NUMPAD6=102,VK_NUMPAD7=103,VK_NUMPAD8=104,VK_NUMPAD9=105,VK_MULTIPLY=106,VK_ADD=107,VK_SEPARATOR=108,VK_SUBTRACT=109,VK_DECIMAL=110,VK_DEVIDE=111,VK_F1=112,VK_F2=113,VK_F3=114,VK_F4=115,VK_F5=116,VK_F6=117,VK_F7=118,VK_F8=119,VK_F9=120,VK_F10=121,VK_F11=122,VK_F12=123,VK_F13=124,VK_F14=125,VK_F15=126,VK_F16=127,VK_F17=128,VK_F18=129,VK_F19=130,VK_F20=131,VK_F21=132,VK_F22=133,VK_F23=134,VK_F24=135,VK_NUMLOCK=144,VK_SCROLL=145,SSSHIFT=1,SSALT=2,SSCTRL=4,SSSHIFTALT=3,SSSHIFTCTRL=5,SSCTRLALT=6,SSSHIFTCTRLALT=7,SSLMBTN=8,SSRMBTN=16,SSMMBTN=32,CSE_AUDIOFINISHED=1,CSE_VIDEOFINISHED=2,CSE_FLYFINISHED=3,scLF=String.fromCharCode(10),scCR=String.fromCharCode(13),scSQ=String.fromCharCode(39),scDQ=String.fromCharCode(34),scSl=String.fromCharCode(47),scBSl=String.fromCharCode(92),scXMLLF="&#x0A;",hcBR="<br>",scNBS="&nbsp;",cTStdOrganization="TStdOrganization",cTStdHTML5VideoPlayer="TStdHTML5VideoPlayer",cTStdPage="TStdPage",cTIdeaPage="TIdeaPage",cIdeaClass="IdeaClass",cScriptData="ScriptData",cScriptParam="ScriptParam",PredefinedStringColors=["CLBLACK","CLMAROON","CLGREEN","CLOLIVE","CLNAVY","CLPURPLE","CLTEAL","CLGRAY","CLSILVER","CLRED","CLLIME","CLYELLOW","CLBLUE","CLFUCHSIA","CLAQUA","CLLTGRAY","CLDKGRAY","CLWHITE","CLMONEYGREEN","CLSKYBLUE","CLCREAM","CLMEDGRAY","CLNONE","CLDEFAULT","CLSYSTEMCOLOR","CLSCROLLBAR","CLBACKGROUND","CLACTIVECAPTION","CLINACTIVECAPTION","CLMENU","CLWINDOW","CLWINDOWFRAME","CLMENUTEXT","CLWINDOWTEXT","CLCAPTIONTEXT","CLACTIVEBORDER","CLINACTIVEBORDER","CLAPPWORKSPACE","CLAPPWORKSPACE","CLHIGHLIGHT","CLHIGHLIGHTTEXT","CLBTNFACE","CLBTNSHADOW","CLGRAYTEXT","CLBTNTEXT","CLINACTIVECAPTIONTEXT","CLBTNHIGHLIGHT","CL3DDKSHADOW","CL3DLIGHT","CLINFOTEXT","CLINFOBK","CLHOTLIGHT","CLGRADIENTACTIVECAPTION","CLGRADIENTINACTIVECAPTION","CLMENUHIGHLIGHT","CLMENUBAR"],PredefinedIntColors=[CLBLACK,CLMAROON,CLGREEN,CLOLIVE,CLNAVY,CLPURPLE,CLTEAL,CLGRAY,CLSILVER,CLRED,CLLIME,CLYELLOW,CLBLUE,CLFUCHSIA,CLAQUA,CLLTGRAY,CLDKGRAY,CLWHITE,CLMONEYGREEN,CLSKYBLUE,CLCREAM,CLMEDGRAY,CLNONE,CLDEFAULT,CLSYSTEMCOLOR,CLSCROLLBAR,CLBACKGROUND,CLACTIVECAPTION,CLINACTIVECAPTION,CLMENU,CLWINDOW,CLWINDOWFRAME,CLMENUTEXT,CLWINDOWTEXT,CLCAPTIONTEXT,CLACTIVEBORDER,CLINACTIVEBORDER,CLAPPWORKSPACE,CLAPPWORKSPACE,CLHIGHLIGHT,CLHIGHLIGHTTEXT,CLBTNFACE,CLBTNSHADOW,CLGRAYTEXT,CLBTNTEXT,CLINACTIVECAPTIONTEXT,CLBTNHIGHLIGHT,CL3DDKSHADOW,CL3DLIGHT,CLINFOTEXT,CLINFOBK,CLHOTLIGHT,CLGRADIENTACTIVECAPTION,CLGRADIENTINACTIVECAPTION,CLMENUHIGHLIGHT,CLMENUBAR],dvmDesktop=0,dvmTabletHor=1,dvmTabletVert=2,dvmPhoneHor=4,dvmPhoneVert=8,dvmCustom1=16,dvmCustom2=32,stPixel=0,stRel2FontSize=1,stPercentage=2,stAuto=3,cBoxFlow=0,cBoxAlignH=1,cBoxAlignV=2,flxStd=0,flxRow=1,flxRowWrap=2,flxCol=3,flxAlignLeft=0,flxAlignTop=0,flxAlignCenter=1,flxAlignRight=2,flxAlignBottom=2,flxAlignCenterSpaceAround=3,flxAlignCenterSpaceBetween=4,ttTestMin=100,ttTestMaster=100,ttDragDrop=133,ttDragDropMulti=134,ttCorrectOrder=138,ttDecisions=144,ttGapTextDragDrop=153,ttEnterFreeText=158,ttEditTable=172,ttTestMax=199,ttTestStart=201,ttTestEnd=202,ttTestEval=204,ttTestExcList=205,ttMasterTemplate=1,ttInfoMin=300,ttInfoMax=399,ttCFWMin=401,ttCFWMax=450,ttCFWMaster=401,ttCFWS=402,ttCFWTablet=403,ttCFWPhone=404,ttPopup=451,ttSystem=501,ttSmartTemplates=502,gCoverID="coverTrandivel";function convertColor(t){var e=-1;if(null!=t){if(!new String(t).match(/[0-9]/))for(var n=0;n<PredefinedStringColors.length;n++)t.toUpperCase()==PredefinedStringColors[n]&&(e=PredefinedIntColors[n]);-1==e&&(e=t)}else e=0;return"rgb("+(255&e)+","+((65280&e)>>8)+","+((16711680&e)>>16)+")"}function convertColorToHEX(t){var e=-1;if(!new String(t).match(/[0-9]/))for(var n=0;n<PredefinedStringColors.length;n++)if(t.toUpperCase()==PredefinedStringColors[n]){e=PredefinedIntColors[n];break}-1==e&&(e=t);var i=255&e;1==(i=i.toString(16).toUpperCase()).length&&(i="0"+i);var r=(65280&e)>>8;1==(r=r.toString(16).toUpperCase()).length&&(r="0"+r);var o=(16711680&e)>>16;1==(o=o.toString(16).toUpperCase()).length&&(o="0"+o);var a="0x";return a=a+i+r+o}function convertHexRGBToIntColor(t){coValue=t,t.length>1&&("0x"==t.substr(0,2)||"0X"==t.substr(0,2))&&(t=t.substr(2)),t.length>0&&"#"==t.substr(0,1)&&(t=t.substr(1));var e="00",n="00",i="00";return t.length>5&&(i=(255&parseInt("0x"+t.substr(4,2),16))<<16),t.length>3&&(n=(255&parseInt("0x"+t.substr(2,2),16))<<8),t.length>1&&(e=255&parseInt("0x"+t.substr(0,2),16)),e|n|i}function convertCursor(t){var e;switch(String(t)){case CRDEFAULT:e="default";break;case CRNONE:e="auto";break;case CRARROW:e="default";break;case CRCROSS:e="crosshair";break;case CRIBEAM:e="text";break;case CRSIZENESW:e="sw-resize";break;case CRSIZENS:e="n-resize";break;case CRSIZENWSE:e="se-resize";break;case CRSIZEWE:e="w-resize";break;case CRUPARROW:e="default";break;case CRHOURGLASS:e="wait";break;case CRDRAG:e="move";break;case CRNODROP:case CRHSPLIT:case CRVSPLIT:case CRMULTIDRAG:e="auto";break;case CRSQLWAIT:e="wait";break;case CRNO:e="auto";break;case CRAPPSTART:e="wait";break;case CRHELP:e="help";break;case CRHANDPOINT:e="pointer";break;case CRSIZEALL:e="size";break;default:e="default"}return e}function ConvertKeyValue(t){var e;switch(t){case KeyEvent.VK_INSERT:e=VK_INSERT;break;case KeyEvent.VK_DELETE:e=VK_DELETE;break;case KeyEvent.VK_ENTER:e=VK_RETURN;break;default:e=t}return e}window.Modernizr=function(t,e,n){function i(t){d.cssText=t}function r(t,e){return typeof t===e}var o,a,s={},l=(e.documentElement,e.createElement("modernizr")),d=l.style,h={},u=[],c=u.slice,p=function(){var t={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return function(i,o){o=o||e.createElement(t[i]||"div");var a=(i="on"+i)in o;return a||(o.setAttribute||(o=e.createElement("div")),o.setAttribute&&o.removeAttribute&&(o.setAttribute(i,""),a=r(o[i],"function"),r(o[i],"undefined")||(o[i]=n),o.removeAttribute(i))),o=null,a}}(),m={}.hasOwnProperty;for(var g in a=r(m,"undefined")||r(m.call,"undefined")?function(t,e){return e in t&&r(t.constructor.prototype[e],"undefined")}:function(t,e){return m.call(t,e)},Function.prototype.bind||(Function.prototype.bind=function(t){var e=this;if("function"!=typeof e)throw new TypeError;var n=c.call(arguments,1),i=function(){if(this instanceof i){var r=function(){};r.prototype=e.prototype;var o=new r,a=e.apply(o,n.concat(c.call(arguments)));return Object(a)===a?a:o}return e.apply(t,n.concat(c.call(arguments)))};return i}),h.draganddrop=function(){var t=e.createElement("div");return"draggable"in t||"ondragstart"in t&&"ondrop"in t},h)a(h,g)&&(s[o=g.toLowerCase()]=h[g](),u.push((s[o]?"":"no-")+o));return i(""),l=null,s._version="2.5.3",s.hasEvent=p,s}(0,this.document);var EC=new Object;EC.SERVICE_UNVAILABLE=503,EC.LOAD_PAGE_ERROR=600;var runtimeversion="1.00 WAS",runtimedate="15.01.09 13:34",projectPath="",externalStartPage="",tts_key="",languageXML="",amStandard=0,amPreview=1,amDesign=2,iamAnyPreview=1,iamAnyEditor=2,iamRuntime=0,iamPagePreview=17,iamProjectPreview=20,isExitAU=0,mos=!1,TCP_Aufruf=0,wait_DD_sema=0,handleExecLocal=!1,lttobject=null,systemLibary=null,systemLibaryEx=null,GlobalAttrList=[],uncoveredSystemObjects={},GlobalScriptArray=[],PageCache=[],callbackloadPage=null,callbackloadMethod=null,AuthorMode=amStandard,videoplayer10="StrobeMediaPlayback10.swf",videoplayer11="StrobeMediaPlayback.swf",_HTMLText2Edit="",_ScriptData2Edit="",internalProduct=0,PageLibrary=null,GlossarXML=null,doDebug=0,thePageName,globalTipComp=null,maxZ=9999,AppParams=[],allPageIndex={result:""},allPageName={result:-1},tabletPageIndex={result:""},tabletPageName={result:-1},phonePageIndex={result:""},phonePageName={result:-1},desktopPageIndex={result:""},desktopPageName={result:-1},GlobalProtocolSetting1=null,GlobalProtocolSetting2=null,CallbackAutoGlossar=null,AICCMode=null,XAPIMode=null,callbackContainerPage=null,callbackContainerComp=null,_listmovebefore=!1,_listtouchstart=!0,CloseProgramCallbackPage=null,CloseProgramCallbackFuncname=null,mouseIsDown=!1,noTouchEvent=!1,noMouseEvent=!1,mouseUpHandled=!1,mouseDnHandled=!1;function _setcallbackAutoGlossar(t,e,n){""==e&&(e=null),CallbackAutoGlossar={page:t,obj:e,func:n}}function dbg_alert(t){1==doDebug&&alert(t)}function $(t){return"string"==typeof t?document.getElementById(t):t}function addEvent(t,e,n,i){i||(i={passive:!1}),(t=$(t)).addEventListener?t.addEventListener(e,n,i):t.attachEvent&&(t["e"+e+n]=n,t[e+n]=function(){t["e"+e+n](window.event)},t.attachEvent("on"+e,t[e+n])),t=null}function removeEvent(t,e,n){null!=(t=$(t))&&t.removeEventListener?t.removeEventListener(e,n,!1):null!=t&&t.detachEvent&&t[e+n]&&(t.detachEvent("on"+e,t[e+n]),t[e+n]=null),t=null}function getTreeObject(t){return isString(t)&&(t=AnyToObject(t)),t}function StringBuffer(){this.buffer=[]}function concatStr(){for(var t=new StringBuffer,e=0;e<arguments.length;e++)t.append(arguments[e]);return t.toString()}function prepearForReplace(t){if(""==t)return t;t=t.split("");for(var e=["\\","*",".","?","+","-","|","^","$","{","}","[","]","(",")"],n=[],i=0;i<t.length;i++){for(var r=t[i],o=0;o<e.length;o++)e[o]==r&&(i>0&&"\\"==t[i-1]||(r=r.replace(new RegExp("\\"+e[o],"g"),"\\"+e[o])));n.push(r)}return n.join("")}function replace(t,e,n,i){if(null==t||""==e||""==t||e==n)return t;if(t=AnyToStr(t),!i&&(i=!1,-1==t.indexOf(e)))return t;e=prepearForReplace(e);var r="";return i?r="ig":r+="g",t=t.replace(new RegExp(e,r),n)}function replaceIgnoreCase(t,e,n){return replace(t,e,n,!0)}function expandmetavar(t,e){pages[e];var n=""!==t?replace(expandMetaVarImp(t,e),"\\","/"):"";return-1==(n=replaceIgnoreCase(n=replaceIgnoreCase(n,".bmp",".png"),".wmf",".png")).indexOf(projectPath)&&(n=projectPath+toLowerCaseFileName(n)),n}function expandmetavarEx(t,e){var n=""!==t?replace(expandMetaVarImpEx(t,e),"\\","/"):"";return-1==(n=replaceIgnoreCase(n=replaceIgnoreCase(n,".bmp",".png"),".wmf",".png")).indexOf(projectPath)&&(n=projectPath+toLowerCaseFileName(n)),n}function toLowerCaseFileName(t){if("1"==LowerCaseFileName){var e=t.substring(t.lastIndexOf("/")+1,t.length);return e=replace(t,e,e.toLowerCase())}return t}function expandMetaVarImp(t,e){if(!t||""==t)return"";var n=t.indexOf("$(");if(-1==n||n==t.length-1)return t;var i,r,o=n>0?t.substring(0,n+2):"",a=t.indexOf(")$");if(a>0){i=t.substring(n+2,a);try{r=expandMetaVarImp(t.substring(a+2),e)}catch(t){r=""}}else i=t.substring(n+2),r="";return expandMetaVarImp(o+resolveMetaVar(i,""!=AnyToObject(e).varfileinternal?varfiles[AnyToObject(e).varfileinternal]:"")+r,e)}function expandMetaVarImpEx(t,e){if(!t||""==t)return"";var n=t.indexOf("$(");if(-1==n||n==t.length-1)return t;var i,r,o=n>0?t.substring(0,n+2):"",a=t.indexOf(")$");if(a>0){i=t.substring(n+2,a);try{r=expandMetaVarImpEx(t.substring(a+2),e)}catch(t){r=""}}else i=t.substring(n+2),r="";return expandMetaVarImpEx(o+resolveMetaVar(i,varfiles[e])+r,e)}String.prototype.equalsIgnoreCase||(String.prototype.equalsIgnoreCase=function(t){return this.toLowerCase()==(t=t.toLowerCase())}),String.prototyompareTo||(String.prototype.compareTo=function(t){return this<t?-1:this>t?1:0}),Array.prototype.put=function(t,e){void 0!==t&&void 0!==e&&(this[this.length]=new KeyValue(t,e))},Array.prototype.get=function(t){for(var e=0;e<this.length;e++)if(this[e].key==t)return this[e].value;return""},Array.prototype.push||(Array.prototype.push=function(){for(var t=0;t<arguments.length;t++)this[this.length]=arguments[t];return this.length}),Array.prototype.pop||(Array.prototype.pop=function(){var t=this[this.length-1];return this.length=Math.max(this.length-1,0),t}),String.prototype.startsWith||(String.prototype.startsWith=function(t){return 0===this.indexOf(t)}),String.prototype.endsWith||(String.prototype.endsWith=function(t){return this.match(t+"$")==t}),Array.prototype.insert||(Array.prototype.insert=function(t,e){if(t>-1){var n=this.slice(),r=n.splice(t);return n[i]=e,n.concat(r)}}),Array.prototype.remove||(Array.prototype.remove=function(t){t>-1&&this.splice(t,1)}),String.prototype.trim=function(){var t=this;for(t=t.replace(/^\s\s*/,""),ws=/\s/,i=t.length;ws.test(t.charAt(--i)););return t.slice(0,i+1)},StringBuffer.prototype.append=function(t){return this.buffer.push(t),this},StringBuffer.prototype.toString=function(){return 0==this.buffer.length?"":this.buffer.join("")},jQuery.fn.getIdeaObject=function(t,e){var n=new Array;return this.each(function(){var t=findIdeaObj(this);pages[t.pageName][t.obj];n.push(obj)}),n};var resolvedMetaVars=new Object;function resolveMetaVar(t,e){e||(e=Variablen.vartreenode);var n=e.getAttribute("Name");if(resolvedMetaVars[n]||(resolvedMetaVars[n]=new Object),!resolvedMetaVars[n][t]){var i=getNodeFromProjectSettings("Metavariablen",t,e);if(i instanceof String)return i;resolvedMetaVars[n][t]=i}return resolvedMetaVars[n][t].value}function getNodeFromProjectSettings(t,e,n){var i=findNode(t,n);if(null!==i)for(var r=i.attributes,o=r.length,a=0;a<o;a++)if(r[a].name.toLowerCase()==e.toLowerCase())return r[a];return""}var detectTouchAndMobile=function(){};function Is_IE(){var t=navigator.userAgent.toLowerCase();this.dTM=new detectTouchAndMobile,this.major=parseInt(navigator.appVersion),this.minor=parseFloat(navigator.appVersion),this.nav=-1!=t.indexOf("mozilla")&&-1==t.indexOf("spoofer")&&-1==t.indexOf("compatible"),this.nav2=this.nav&&2==this.major,this.nav3=this.nav&&3==this.major,this.nav4=this.nav&&4==this.major,this.nav4up=this.nav&&this.major>=4,this.navonly=this.nav&&(-1!=t.indexOf(";nav")||-1!=t.indexOf("; nav")),this.nav6=this.nav&&5==this.major,this.nav6up=this.nav&&this.major>=5,this.gecko=-1!=t.indexOf("gecko"),this.ie=-1!=t.indexOf("msie")&&-1==t.indexOf("opera"),this.ie3=this.ie&&this.major<4,this.ie4=this.ie&&4==this.major&&-1!=t.indexOf("msie 4"),this.ie4up=this.ie&&this.major>=4,this.ie5=this.ie&&4==this.major&&-1!=t.indexOf("msie 5.0"),this.ie5_5=this.ie&&4==this.major&&-1!=t.indexOf("msie 5.5"),this.ie5up=this.ie&&!this.ie3&&!this.ie4,this.ie5_5up=this.ie&&!this.ie3&&!this.ie4&&!this.ie5,this.ie6=this.ie&&4==this.major&&-1!=t.indexOf("msie 6."),this.ie6up=this.ie&&!this.ie3&&!this.ie4&&!this.ie5&&!this.ie5_5,this.opera=-1!=t.indexOf("opera"),this.opera2=-1!=t.indexOf("opera 2")||-1!=t.indexOf("opera/2"),this.opera3=-1!=t.indexOf("opera 3")||-1!=t.indexOf("opera/3"),this.opera4=-1!=t.indexOf("opera 4")||-1!=t.indexOf("opera/4"),this.opera5=-1!=t.indexOf("opera 5")||-1!=t.indexOf("opera/5"),this.opera5up=this.opera&&!this.opera2&&!this.opera3&&!this.opera4,this.chrome=navigator.userAgent.toLowerCase().indexOf("chrome")>-1,this.safari=!(!window.devicePixelRatio||window.Opera),this.js=0,this.nav2||this.ie3?this.js=1:this.nav3?this.js=1.1:this.opera5up?this.js=1.3:this.opera?this.js=1.1:this.nav4&&this.minor<=4.05||this.ie4?this.js=1.2:this.nav4&&this.minor>4.05||this.ie5?this.js=1.3:this.nav6||this.gecko?this.js=1.5:this.nav6up?this.js=1.5:this.ie5up?this.js=1.3:this.js=1.5}detectTouchAndMobile.prototype={uagent:"",setVariables:function(t){t.System.Phone(this.detectPhone()),t.System.Tablet(this.detectTablet()),t.System.Desktop(this.detectPhone()||this.detectTablet()?0:1)},init_userAgent:function(){navigator&&navigator.userAgent&&(this.uagent=navigator.userAgent.toLowerCase())},detectPhone:function(){return this.detectiPhoneAndiTouch()||this.detectAndroid()&&!this.detectAndroidPad()?1:0},detectTablet:function(){return this.detectiPad()||this.detectAndroid()&&this.detectAndroidPad()?1:0},detectiPhoneAndiTouch:function(){return this.uagent.search(MOBILECONSTANTS.IPHONE)>-1||this.uagent.search(MOBILECONSTANTS.IPOD)>-1},detectiPad:function(){return this.uagent.search(MOBILECONSTANTS.IPAD)>-1},detectAndroid:function(){return this.uagent.search(MOBILECONSTANTS.ANDROID)>-1},detectAndroidPad:function(){return this.uagent.search(MOBILECONSTANTS.ANDROIDMOBILE)<1||!(this.detectAndroidMajorVersion()>2)&&this.checkWidth()},detectTIE:function(){var t=navigator.msMaxTouchPoints;return window.navigator.msMaxTouchPoints&&t>1},detectiOSDevice:function(){return this.detectiPad()||this.detectiPhoneAndiTouch()},detectHPIScreen:function(){return window.devicePixelRatio>1?1:0},detectAndroidMajorVersion:function(){var t=/android\s([\d\.])/.exec(this.uagent);return null!=t?AnyToInt(t[1]):-1},checkWidth:function(){var t=screen.width;return(600==t||800==t||1024==t)&&window.devicePixelRatio<1}},Is_IE.prototype.IE=function(){return this.ie5_5up},Is_IE.prototype.NN=function(){return this.navup6||this.gecko},Is_IE.Opera=function(){return this.opera5up},Is_IE.prototype.detectOrientation=function(){if(void 0!==window.onorientationchange){if(0==orientation)return"potrait";if(90==orientation)return"landscape";if(-90==orientation)return"landscape";if(180==orientation)return"landscape"}};var IS=new Is_IE;function getObjectByID(t){return $(t)}function getStyleObject(t){var e=getObject(t);return e&&IS.isCSS()?e.style:null}function instanceOf(obj,proto){if(BrowserIs.IE)return eval("obj instanceof proto");for(;null!==obj;){if(obj==proto.prototype)return!0;obj=obj.__proto__}return!1}function GlobalHookClass(t){this.events=new Object,this.addEvent(document,"load",hookcallback),this.addEvent(window,"beforeunload",hookcallback)}function getKeyCode(t){var e;return t.keyCode?e=t.keyCode:t.which&&(e=t.which),e}function hookcallback(t){if(!t)t=window.event;return GlobalHook.handleEvent(t.type,t)}function closeProject(t){if(!t)t=window.event;GlobalHook.handleEvent("unload",t)}IS.dTM.init_userAgent(),GlobalHookClass.prototype={isHook:function(t){return this.handleEvent(t)},registerForEvent:function(t,e,n,i){var r=new Object;r.obj=e,r.page=n,r.handler=i,this.events[t]||(this.events[t]=[]),this.events[t].push(r)},removeEvent:function(t,e,n,i){for(var r=this.events[t].length,o=0;o<r;o++)if(this.events[t][o].handler==i&&this.events[t][o].obj==e&&this.events[t][o].page==n){this.events[t].remove(o);break}},handleEvent:function(t,e){var n=0,i=null;if("beforeunload"==t&&(t="unload"),this.events[t]){for(var r=this.events[t].length,o=0;o<r;o++)switch(i=this.events[t][o],t){case"click":case"dblclick":case"resize":case"touchend":case"pointerup":n=this.invokeEvent(i.page,i.obj,i.handler,e);break;case"keypress":n=this.invokeEvent(i.page,i.obj,i.handler,getKeyCode(e));break;case"keyup":case"keydown":var a=convertKeyEventParams(e);n=this.invokeEvent(i.page,i.obj,i.handler,a.keyValue,a.shiftState);break;case"staterevisit":n=this.invokeEvent(i.page,i.obj,i.handler,e.id);break;default:n=this.invokeEvent(i.page,i.obj,i.handler)}return n}},invokeEvent:function(t,e,n,i,r,o){if(t=pages[t])return null==e||""==e?t[n](i,r,o):t[e][n](i,r,o)},addEvent:function(t,e,n){(t=$(t)).addEventListener?t.addEventListener(e,n,!1):t.attachEvent&&(t["e"+e+n]=n,t[e+n]=function(){t["e"+e+n](window.event)},t.attachEvent("on"+e,t[e+n]))}},dragDrop={keyHTML:'<a href="#" class="keyLink">#</a>',keySpeed:10,initialMouseX:void 0,initialMouseY:void 0,startX:void 0,startY:void 0,dXKeys:void 0,dYKeys:void 0,draggedObject:void 0,draggedIObject:void 0,initElement:function(t){t=$(t),jQuery(document.body).css("touch-action","none").css("ms-touch-action","none"),jQuery("html").css("touch-action","none").css("ms-touch-action","none"),jQuery(t).css("touch-action","none").css("ms-touch-action","none")},startDragMouse:function(t,e){if(void 0!==e){dragDrop.startDrag(e);var n=t||window.event;return dragDrop.preventDefault(n),"pointerdown"==n.type&&e.setPointerCapture?e.setPointerCapture(n.pointerId):n.pointerType&&n.pointerType==n.MSPOINTER_TYPE_TOUCH&&e.msSetPointerCapture&&e.msSetPointerCapture(n.pointerId),dragDrop.initialMouseX=n.clientX,dragDrop.initialMouseY=n.clientY,addEvent(document,"mousemove",dragDrop.dragMouse),jQuery(document).one("mouseup",function(t){dragDrop.releaseElement(t)}),addEvent(document,"touchmove",dragDrop.dragMouse),jQuery(document).one("touchend",function(t){dragDrop.releaseElement(t)}),addEvent(document,"pointermove",dragDrop.dragMouse),jQuery(document).one("pointerup",function(t){dragDrop.releaseElement(t)}),!1}},startDragKeys:function(){return dragDrop.startDrag($(this.relatedElement)),dragDrop.dXKeys=dragDrop.dYKeys=0,this.blur(),!1},startDrag:function(t){dragDrop.draggedObject&&(dragDrop.dx=-1,dragDrop.dy=-1,dragDrop.draggedObject=null,dragDrop.draggedIObject=null),dragDrop.startX=t.offsetLeft,dragDrop.startY=t.offsetTop,dragDrop.draggedObject=t;var e=pages[t.pageName];dragDrop.draggedIObject=e[t.obj],jQuery(t).css("touch-action","none").css("ms-touch-action","none"),t.className+=" dragged",dragDrop.orgCursor=t.style.cursor,t.style.cursor="move",document.onselectstart=function(){return!1},this.ondragstart=function(){return!1},document.addEventListener&&(document.addEventListener("MSHoldVisual",dragDrop.preventDefault,!1),t.addEventListener("MSHoldVisual",dragDrop.preventDefault,!1),t.addEventListener("contextmenu",dragDrop.preventDefault,!1),t.addEventListener("selectstart",dragDrop.preventDefault,!1))},dragMouse:function(t){var e=t||window.event;e.preventDefault&&e.preventDefault();var n=e.clientX,i=e.clientY;isTouchDevice()&&e.touches&&1==e.touches.length&&(ICompsEvent.currentX=e.touches[0].pageX,ICompsEvent.currentY=e.touches[0].pageY);var r=n-dragDrop.initialMouseX,o=i-dragDrop.initialMouseY;if(dragDrop.setPosition(r,o),dragDrop.dx=n,dragDrop.dy=i,isTouchDevice())return!1;var a=pages[dragDrop.draggedObject.pageName][dragDrop.draggedObject.obj];if("function"==typeof a.OnDrag)try{a.OnDrag()}catch(t){}try{e.cancelBubble=!0}catch(t){}return e.stopPropagation&&e.stopPropagation(),e.returnValue=!1,!1},dragKeys:function(t){var e=t||window.event;switch(e.keyCode){case 37:case 63234:dragDrop.dXKeys-=dragDrop.keySpeed;break;case 38:case 63232:dragDrop.dYKeys-=dragDrop.keySpeed;break;case 39:case 63235:dragDrop.dXKeys+=dragDrop.keySpeed;break;case 40:case 63233:dragDrop.dYKeys+=dragDrop.keySpeed;break;case 13:case 27:return dragDrop.releaseElement(),!1;default:return!0}return dragDrop.setPosition(dragDrop.dXKeys,dragDrop.dYKeys),e.preventDefault&&e.preventDefault(),!1},setPosition:function(t,e){t=dragDrop.startX+t,e=dragDrop.startY+e;var n=!0,i=!0,r=null,o=null,a=null,s=null;dragDrop.draggedIObject&&(null!=dragDrop.draggedIObject.DragXmin&&(r=dragDrop.draggedIObject.DragXmin()),null!=dragDrop.draggedIObject.DragXmax&&(a=dragDrop.draggedIObject.DragXmax()),null!=dragDrop.draggedIObject.DragYmin&&(o=dragDrop.draggedIObject.DragYmin()),null!=dragDrop.draggedIObject.DragYmax&&(s=dragDrop.draggedIObject.DragYmax()),null!=dragDrop.draggedIObject.DragXAllowed&&(dragDrop.draggedIObject.DragXAllowed()||(n=!1)),null!=dragDrop.draggedIObject.DragYAllowed&&(dragDrop.draggedIObject.DragYAllowed()||(i=!1))),null!=r&&r<t&&(t=r),null!=o&&o<e&&(e=o),null!=a&&a>t&&(t=a),null!=s&&s>e&&(e=s),dragDrop.draggedIObject&&(n&&(dragDrop.draggedObject.style.left=t+"px"),i&&(dragDrop.draggedObject.style.top=e+"px"))},switchKeyEvents:function(){},releaseElement:function(t){if(mouseIsDown=!1,null!=dragDrop.draggedIObject){var e=dragDrop.dx,n=dragDrop.dy;dragDrop.dx=-1,dragDrop.dy=-1;var i=dragDrop.draggedObject,r=dragDrop.draggedIObject;dragDrop.draggedObject=null,dragDrop.draggedIObject=null,jQuery(document.body).css("touch-action","none").css("ms-touch-action","auto"),jQuery("html").css("touch-action","auto").css("ms-touch-action","auto"),document.removeEventListener&&(document.removeEventListener("MSHoldVisual",dragDrop.preventDefault,!1),i.removeEventListener("MSHoldVisual",dragDrop.preventDefault,!1),i.removeEventListener("contextmenu",dragDrop.preventDefault,!1),i.removeEventListener("selectstart",dragDrop.preventDefault,!1)),removeEvent(document,"mousemove",dragDrop.dragMouse),removeEvent(document,"pointermove",dragDrop.dragMouse),removeEvent(document,"touchmove",dragDrop.dragMouse),event=t.originalEvent;var o=!1;if("pointerup"==t.type&&i.releasePointerCapture?(i.releasePointerCapture(event.pointerId),o=!0):t.pointerType&&t.pointerType==t.MSPOINTER_TYPE_TOUCH&&draggedObjectt.msReleasePointerCapture&&(o=!0,i.msReleasePointerCapture(event.pointerId)),jQuery(i).removeClass("dragged"),jQuery(i).css("touch-action","none").css("ms-touch-action","none"),i.style.cursor=dragDrop.orgCursor,document.onselectstart=null,this.ondragstart=null,r.Draggable&&1==r.Draggable()){pages[i.pageName];if(r.Visible()&&(r.obj.style.visibility="visible"),jQuery("#tempDND").remove(),null==(a=document.elementFromPoint(e,n)))return!0;if(a.pageName||(a=findIdeaObj(a)),"function"==typeof(a=pages[a.pageName][a.obj]).OnDrop)try{a.OnDrop(r)}catch(t){}if("function"==typeof r.OnDropped)try{r.OnDropped(a)}catch(t){}}else{var a,s="CFW_S";if(null!=(a=document.elementFromPoint(e,n))&&(a.pageName||(a=findIdeaObj(a)),null!=a&&(s=a.pageName)),null==(a=pages[s]))return!0;"function"==typeof a.OnPageDrop&&a.OnPageDrop(r)}o&&(t.ms_idea_fix=!0,t.ms_idea_dd_fixobj=r,ICompsEvent.onEvent(t))}},preventDefault:function(t){return t.preventDefault&&t.preventDefault(),!1}};var GlobalHook=new GlobalHookClass;function addResizeMonitor(){window.onresize=onBrowserResize}function onBrowserResize(t){if(null!=Variablen&&null!=Variablen.System&&(Variablen.System.ScreenHeight(getDocumentHeight()),Variablen.System.ScreenWidth(getDocumentWidth())),null!=act_ResizeElement)return!0;hookcallback(t)}function getDocumentHeight(){return getDocumentClientHeight()}function getDocumentWidth(){return getDocumentClientWidth()}var act_ResizeElement=null,path=window.location.href,pos=path.lastIndexOf("/");path=path.substring(0,pos+1);var flashSec="http://www.macromedia.com/support/documentation/de/flashplayer/help/settings_manager04.html",audioSecText="Ihr IDEA Lernprogramm versucht ein Audio abzuspielen,<br/>welches aufgrund der aktuellen Sicherheitseinstellungen Ihres Flash PlugIns geblockt wurde.<br/><br/>Um Audios auch im Offline Modus abspielen zu können, muss der Kursordner:<br/><br/><u>"+unescape(window.location.href.substring(0,window.location.href.lastIndexOf("/")+1))+"</u><br/><br/>oder ein Übergeordnetes Verzeichnis explizit  als vertrauenswürdige Quelle registriert werden.<p/>Klicken Sie dazu auf <a href="+flashSec+'>Adobe Flash Player Einstellungsmanager</a>, wählen dort ""Bearbeiten... ->  Hinzfügen..""<br/>und tragen den freizugebenden Ordner dort ein und starten den Kurs anschließend erneut.<br/><br/>Klicken Sie <a href="javascript:closeAudioProblem();" >Hier</a> um mit dem Lernprogramm ohne Audios fortzufahren<br/><br/><br/>Hinweis:<br/>Diese Restriktion besteht auschließlich im Off-Line-Modus. Für den On-Line Fall sind keine weiteren Einstellungen erforderlich!',isDragging=!1,horizontal_offset="9px",vertical_offset="0",ie=document.all,ns6=document.getElementById&&!document.all,pageorignx=0,pageorigny=0,lasttooltip="",VARFILEEXTENSION="XVF",OLDVARFILEEXTENSION="VAR",NEWVARFILEEXTENSION="_xvf.xml",XTDFILEEXTENSION="xTD",XPGFILEEXTENSION="xPG",TPLFILEEXTENSION="TPL",NEWTPLFILEEXTENSION="_tpl.xml",TVRFILEEXTENSION="TVR",StartXMLName="JavaStart.XML",TA_PROJECTNAME="Project",TA_FILENAME="Filename",TA_TEMPLATENAME="Template",TA_DATAPATH="DataPath",TA_STARTPAGENAME="StartPage",MetavarNodeName="Metavariablen",ProjectSettingsNodeName="ProjectSettings",ProjectName=null,StartDate,projectXML=null,StartPageName=null,marker=null,page=null,Page=null,varfiles=new Object,useFlashAudio=!0,ATTRNAME="ATTRNAME",httpObject=null,compNameClas=[],pageHistory=[],pageNew=null,ftNone=0,ftText=1,ftHtml=2,ftIni=3,ftExe=4,ftAudio=5,ftVideo=6,ftPicture=7,ftRtf=8,ftGIF=9,ftDatabase=10,ftFlash=11,ftXML=12,ftPPt=13,ftPDF=14,ftBackgr=15,Variablen=new Object,variablen=new Object,GlossarObject=new Object;function generateIFormatDate(t){var e=t.getDate(),n=t.getMonth()+1,i=t.getFullYear();return e<10&&(e="0"+e),n<10&&(n="0"+n),e+"."+n+"."+i}function date2String(t,e){var n=t.getMonth(),i=t.getDate(),r=t.getDay(),o=t.getFullYear(),a=new Array("January","February","March","April","May","June","July","August","September","October","November","December"),s=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),l=new Array("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"),d=new Array("Sun","Mon","Tue","Wed","Thu","Fri","Sat"),h=a[n],u=s[n],c=n<9?"0"+(1+n):1+n+"",p=1+n+"",m=l[r],g=d[r],f=i<10?"0"+i:i+"",T=i+"",y=o;for(century=0;o-century>=100;)century+=100;var b=o-century;b<10&&(b="0"+b);var S=new String(e);return S=(S=(S=(S=(S=(S=(S=(S=(S=(S=S.replace(/!mmmm/i,h)).replace(/!mmm/i,u)).replace(/!mm/i,c)).replace(/!m/i,p)).replace(/!dddd/i,m)).replace(/!ddd/i,g)).replace(/!dd/i,f)).replace(/!d/i,T)).replace(/!yyyy/i,y)).replace(/!yy/i,b)}function getPageFromCallstack(t){return t.thePageName?t.thePageName:null!=t.caller&&t.caller!=t?getPageFromCallstack(t.caller):null}function generateIFormatTime(t){var e=t.getHours(),n=t.getMinutes(),i=t.getSeconds();return e<10&&(e="0"+e),n<10&&(n="0"+n),e+":"+n+":"+i}var px="px",$_IMAGE={error:!1,preload:function(){for(tmp=[],x=0;x<arguments.length;)tmp[x]=new Image,tmp[x].onerror=$_IMAGE.onImgError,tmp[x].src=arguments[x],(tmp[x].complete||this.error)&&($_IMAGE.error=!1,x++);return x==arguments.length},get_image_property:function(a){var tmp,t=["fileCreatedDate","fileModifiedDate","mimeType","fileSize","width","height"];for(tmp=new Image,tmp.src=a,obj={},x=0;x<t.length;x++)obj[eval(x)]=tmp[t[x]];return obj},onImgError:function(){$_IMAGE.error=!0}};function mediaPlayerClass(){}mediaPlayerClass.prototype={videoobj:null,isplaying:!1,playVideo:function(t,e){e=AnyToObject(e),this.isVplaying&&this.stopVideo(),this.isVplaying=!0;var n=null,i=window.location.href,r=i.lastIndexOf("/");i=i.substring(0,r+1),(n=document.createElement("div")).id="videoobj";var o=n.style;o.height=e.OffsetHeight()+px,o.width=e.OffsetWidth()+px,o.left=0+px,o.top=0+px,o.overflow="hidden",o.position="absolute",n.innerHTML='<object id="videoobjectplayer" classid="clsid:22D6F312-B0F6-11D0-94AB-0080C74C7E95" width="'+e.OffsetWidth()+px+'" height="'+e.OffsetHeight()+px+'"type="application/x-oleobject" standby="Der Microsoft Windows Media Player wird geladen."><param name="src" value="'+unescape(i+t)+'" /><param name="fileName" value="'+unescape(i+t)+'" /><param name="AnimationatStart" value="0" /><param name="TransparentatStart" value="0" /><param name="AutoStart" value="1" /><param name="ShowControls" value="0" /><param name="ShowPositionControls" value="1" /><param name="stretchToFit" value="1" /><param name="enableContextMenu" value="0" /><param name="windowlessVideo" value="0" /><embed id="Video" type="application/x-mplayer2" width="'+e.OffsetWidth()+px+'" height="'+e.OffsetHeight()+px+'"src="http://www.irgendwo.de/beliebigesVideo.wmv" fileName="'+unescape(i+t)+'" autostart="1" enableContextMenu="0" windowlessVideo="1" stretchToFit="1" showcontrols="0" ShowPositionControls="1" animationatstart="0" transparentatstart="0" class="Bild" /></object>',$(e.obj).appendChild(n),this.videocomp=e.obj,o=null},stopVideo:function(){if(this.isVplaying){this.isVplaying=!1,IS.IE()?$("videoobjectplayer").Stop():$("videoobjectplayer").stop&&$("videoobjectplayer").stop();var t=$("videoobj");setOpacity(0,t);var e=t.style;e.top=-2e3+px,e.left=-2e3+px,e.height="0"+px,e.width="0"+px,e.visible="hidden",e.display="none",e=null}},pauseVideo:function(){this.videoobj.pause()},resumeVideo:function(){this.videoobj.play()}};var mediaPlayer=new mediaPlayerClass;function getDocumentClientWidth(){var t=document.body.clientWidth;return 0==t&&(t=document.documentElement.clientWidth),t=Max(document.body.clientWidth,document.documentElement.clientWidth)}function getDocumentClientHeight(){var t=document.body.clientHeight;return 0==t&&(t=document.documentElement.clientHeight),t=Max(document.body.clientHeight,document.documentElement.clientHeight)}function getDocumentScrollWidth(){return 0==document.body.clientHeight?document.documentElement.scrollWidth:document.body.scrollWidth}function getDocumentScrollHeight(){return 0==document.body.clientHeight?document.documentElement.scrollHeight:document.body.scrollHeight}function createTransCoverPanel(t){if(t||(t=gCoverID),t==gCoverID&&TCP_Aufruf++,null==$(t)){var e=document.createElement("div"),n=e.style;n.visibility="hidden",e.id=t,n.backgroundColor=coverColor,n.position="absolute",n.top=0+px,n.left=0+px;var i=getDocumentClientWidth(),r=getDocumentClientHeight(),o=getDocumentScrollWidth(),a=getDocumentScrollHeight();o>i&&(i=o),a>r&&(r=a),n.width=i+px,n.height=r+px,e.innerHTML='<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0"><tr><td align="center" valign="middle"><h3><img src="'+url_libs+'script/img/pageloader.gif"></img></h3></td></tr></table>',n.zIndex="999999",n.cursor="wait",n.visibility="visible",document.getElementsByTagName("body")[0].appendChild(e),setOpacity(5,e),e=null,n=null}}function removeTransCoverPanel(t){t||(t=gCoverID);var e=null;t==gCoverID?(TCP_Aufruf>0&&TCP_Aufruf--,null!=(e=$(t))&&0==TCP_Aufruf&&removeElement(e)):null!=(e=$(t))&&removeElement(e),e=null}function showAudioProblem(){var t=document.createElement("div");document.body.appendChild(t),t.id="audioErrorMsg",t.style.backgroundColor="#ffffff",t.style.position="absolute",t.style.width="100%",t.style.height="100%",t.style.top=0+px,t.style.left=0+px,setOpacity(9,t),t.innerHTML='<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0"><tr><td align="center" valign="middle"><h3>'+audioSecText+"</h3></td></tr></table>"}function closeAudioProblem(){document.body.removeChild($("audioErrorMsg")),audio.error=!1}function getUniqueID(){var t=1+Math.floor(32767*Math.random()),e=new Date;return e.getSeconds()+""+e.getMinutes()+t+"PopUp"}function createCoverPanel(t,e,n){if((t=$(t)).offsetParent){var i=document.createElement("div");jQuery(i).addClass("iCoverPanel"),i.id=e;var r=i.style,o=t.style;r.position="absolute",r.width=o.width,r.height=o.height,r.top=o.top,r.left=o.left,maxZ++,r.zIndex=maxZ,n&&!n&&(r.cursor="wait"),"transparent"!=o.backgroundColor?r.backgroundColor=o.backgroundColor:r.backgroundColor="#FFFFFF",null!=t.nextSibling?t.offsetParent.insertBefore(i,t.nextSibling):t.offsetParent.appendChild(i),setOpacity(3,i),i=null,r=null,o=null}}function createComponentCover(t,e){if(null==(t=$(t))){var n=pages[getPageFromCallstack(createComponentCover.caller)];t=AnyToObj(t,n).obj}createCoverPanel(t,e,!1)}function removeCoverPanel(t){var e=$(t);null!=e&&removeElement(e),e=null}function toHex(t){var e=t/16,n=e+"";n=n.substring(0,2),e=parseInt(n,10);var i=hex[e+1],r=t-16*e;return n=(n=r+"").substring(0,2),r=parseInt(n,10),i+""+hex[r+1]}function createAudioPlayerMovie(t,e){var n=new SWFObject(url_libs+IDEAMEDIAPLAYERSWF,"AudioPlayerMovieContainermp","1","1","1");e||(e=pages[getPageFromCallstack(createAudioPlayerMovie.caller)]),n.addVariable("file",expandmetavar(t,e.Name())),n.addVariable("autostart","true"),n.addParam("menu","false"),n.addParam("allowscriptaccess","always"),n.addParam("wmode","transparent"),n.write("AudioPlayerMovieContainer")}function convertFontStyle(t){if(!arguments.length)return this.attr_FontStyle;var e=$(this.obj).style;null!=e&&(t=AnyToInt(t),this.attr_FontStyle=t,e.fontWeight=(t&FSBOLD)==FSBOLD?"bold":"normal",e.fontStyle=(t&FSITALIC)==FSITALIC?"italic":"normal",e.textDecoration=(t&FSSTRIKEOUT)==FSSTRIKEOUT?"line-through":"",e.textDecoration=(t&FSUNDERLINE)==FSUNDERLINE?"underline":"",e=null)}function _insertGlossar(t,e){var n=pages[e];if(n){n[t].AutoGlossar();AuthorMode!=amDesign&&(1==n[t].AutoGlossar()&&1==Variablen.GlossarSettings.UseToolTipGlossar()&&n[t].insertGlossar(),n=null)}}function cbIdeaTEAMAutoGlossar(t,e){}function _insertGlossarElem(t,e){if(t&&null!=t&&t.toLowerCase().indexOf(e.toLowerCase())<0)return t;var n="#"+convertColorToHEX(Variablen.GlossarSettings.GlossarFontColor()).substring(2),i="";1==Variablen.GlossarSettings.GlossarUnderline()&&(i="text-decoration:underline;");var r='$1<span style="color:'+n+";"+i+'"  onclick="if(CallbackAutoGlossar!=null)ShowTipEx(\''+e.replace(/'/g,"&quot;")+"');\" onmouseover=\"if(CallbackAutoGlossar==null)ShowTipEx('"+e.replace(/'/g,"&quot;")+"');\" onmouseout='if(CallbackAutoGlossar==null)UnTip();'>$2</span>$3",o="g";o="i"+o;var a=new RegExp('([!\\.\\s\\?;":<,>])('+prepearForReplace(e.toLowerCase())+')([!\\.\\s\\?;":<,>])',o);return t=(t=(t=(t=" "+t+" ").replace(a,r)).substr(1)).substr(0,t.length-1)}function getGlossar(){if(null!=GlossarXML);else{var t=expandmetavarEx("$(SonstigePfad)$glossar.xml","Variablen");loadXML(t+="?rnd="+Time()),GlossarXML=GetXMLDoc()}}function _glossardescription(t){for(var e="",n=t.length,i=0;i<n;i++)t[i].lenght>0?e+=make_description(t[i].ChildNodes):null!=t[i].nodeValue?e+=t[i].nodeValue:Is_IE()?e+=t[i].text+"<br>":e+=t[i].textContent+"<br>";return e}function hideOpacityEffect(t,e){e=AnyToInt(e);var n=(t=AnyToObject(t)).TransparencyCover();jQuery(t.obj).animate({opacity:0},e,function(){t.Visible(0),jQuery(t.obj).css({opacity:n/10}),t.TransparencyCover(n),t.doOnEndEffect(0)})}function showOpacityEffect(t,e){e=AnyToInt(e);var n=(t=AnyToObject(t)).TransparencyCover();jQuery(t.obj).css({opacity:0}),t.Visible(1,!0),jQuery(t.obj).animate({opacity:n/10},e,function(){t.TransparencyCover(n),t.doOnEndEffect(1)})}function flyFromTopEffect(t,e){e=AnyToInt(e),t=AnyToObject(t);pages[t.pageName];var n=0-(t.Height()+t.OffsetTop());jQuery(t.obj).css({marginTop:n+"px"}),t.Visible(1,!0),jQuery(t.obj).animate({marginTop:"0px"},e,function(){t.doOnEndEffect(1)})}function flyFromTopOpacityEffect(t,e){e=AnyToInt(e),t=AnyToObject(t);pages[t.pageName];var n=t.TransparencyCover(),i=0-(t.OffsetHeight()+t.OffsetTop());jQuery(t.obj).css({marginTop:i+"px",opacity:0}),t.Visible(1,!0),jQuery(t.obj).animate({marginTop:"0px",opacity:n/10},e,function(){t.TransparencyCover(n),t.doOnEndEffect(1)})}function flyToTopEffect(t,e){e=AnyToInt(e),t=AnyToObject(t);pages[t.pageName];var n=0-(t.OffsetHeight()+t.OffsetTop());jQuery(t.obj).animate({marginTop:n+"px"},e,function(){t.Visible(0),jQuery(t.obj).css({marginTop:"0px",marginLeft:"0px"}),t.doOnEndEffect(0)})}function flyToTopOpacityEffect(t,e){e=AnyToInt(e),t=AnyToObject(t);pages[t.pageName];var n=0-(t.OffsetHeight()+t.OffsetTop()),i=t.TransparencyCover();jQuery(t.obj).animate({marginTop:n+"px",opacity:0},e,function(){t.Visible(0),jQuery(t.obj).css({marginTop:"0px",marginLeft:"0px",opacity:i/10}),t.TransparencyCover(i),t.doOnEndEffect(0)})}function flyToLeftEffect(t,e){e=AnyToInt(e),t=AnyToObject(t);pages[t.pageName];var n=0-(t.OffsetWidth()+t.OffsetLeft());jQuery(t.obj).animate({marginLeft:n+"px"},e,function(){t.Visible(0),jQuery(t.obj).css({marginTop:"0px",marginLeft:"0px"}),t.doOnEndEffect(0)})}function flyToLeftOpacityEffect(t,e){e=AnyToInt(e),t=AnyToObject(t);pages[t.pageName];var n=0-(t.OffsetWidth()+t.OffsetLeft()),i=t.TransparencyCover();jQuery(t.obj).animate({marginLeft:n+"px",opacity:0},e,function(){t.Visible(0),jQuery(t.obj).css({marginTop:"0px",marginLeft:"0px",opacity:i/10}),t.TransparencyCover(i),t.doOnEndEffect(0)})}function flyFromLeftEffect(t,e){e=AnyToInt(e),t=AnyToObject(t);pages[t.pageName];var n=0-(t.OffsetWidth()+t.OffsetLeft());jQuery(t.obj).css({marginLeft:n+"px"}),t.Visible(1,!0),jQuery(t.obj).animate({marginLeft:"0px"},e,function(){t.doOnEndEffect(1)})}function flyFromLeftOpacityEffect(t,e){e=AnyToInt(e),t=AnyToObject(t);pages[t.pageName];var n=0-(t.OffsetWidth()+t.OffsetLeft()),i=t.TransparencyCover();jQuery(t.obj).css({marginLeft:n+"px",opacity:0}),t.Visible(1,!0),jQuery(t.obj).animate({marginLeft:"0px",opacity:i/10},e,function(){t.TransparencyCover(i),t.doOnEndEffect(1)})}function flyFromBottomEffect(t,e){e=AnyToInt(e),t=AnyToObject(t);var n=pages[t.pageName].OffsetHeight()-t.OffsetTop();jQuery(t.obj).css({marginTop:n+"px"}),t.Visible(1,!0),jQuery(t.obj).animate({marginTop:"0px"},e,function(){t.doOnEndEffect(1)})}function flyFromBottomOpacityEffect(t,e){e=AnyToInt(e),t=AnyToObject(t);var n=pages[t.pageName].OffsetHeight()-t.OffsetTop(),i=t.TransparencyCover();jQuery(t.obj).css({marginTop:n+"px",opacity:0}),t.Visible(1,!0),jQuery(t.obj).animate({marginTop:"0px",opacity:i/10},e,function(){t.TransparencyCover(i),t.doOnEndEffect(1)})}function flyToBottomEffect(t,e){e=AnyToInt(e),t=AnyToObject(t);var n=pages[t.pageName].OffsetHeight()-t.OffsetTop();jQuery(t.obj).animate({marginTop:n+"px"},e,function(){t.Visible(0),jQuery(t.obj).css({marginTop:"0px",marginLeft:"0px"}),t.doOnEndEffect(0)})}function flyToBottomOpacityEffect(t,e){e=AnyToInt(e),t=AnyToObject(t);var n=pages[t.pageName].OffsetHeight()-t.OffsetTop(),i=t.TransparencyCover();jQuery(t.obj).animate({marginTop:n+"px",opacity:0},e,function(){t.Visible(0),jQuery(t.obj).css({marginTop:"0px",marginLeft:"0px",opacity:i/10}),t.TransparencyCover(i),t.doOnEndEffect(0)})}function flyFromRigthEffect(t,e){e=AnyToInt(e),t=AnyToObject(t);var n=pages[t.pageName].OffsetWidth()-t.OffsetLeft();jQuery(t.obj).css({marginLeft:n+"px"}),t.Visible(1,!0),jQuery(t.obj).animate({marginLeft:"0px"},e,function(){t.doOnEndEffect(1)})}function flyFromRigthOpacityEffect(t,e){e=AnyToInt(e),t=AnyToObject(t);var n=pages[t.pageName].OffsetWidth()-t.OffsetLeft(),i=t.TransparencyCover();jQuery(t.obj).css({marginLeft:n+"px",opacity:0}),t.Visible(1,!0),jQuery(t.obj).animate({marginLeft:"0px",opacity:i/10},e,function(){t.TransparencyCover(i),t.doOnEndEffect(1)})}function flyToRigthEffect(t,e){e=AnyToInt(e),t=AnyToObject(t);var n=pages[t.pageName].OffsetWidth()-t.OffsetLeft();jQuery(t.obj).animate({marginLeft:n+"px"},e,function(){t.Visible(0),jQuery(t.obj).css({marginTop:"0px",marginLeft:"0px"}),t.doOnEndEffect(0)})}function flyToRigthOpacityEffect(t,e){e=AnyToInt(e),t=AnyToObject(t);var n=pages[t.pageName].OffsetWidth()-t.OffsetLeft(),i=t.TransparencyCover();jQuery(t.obj).animate({marginLeft:n+"px",opacity:0},e,function(){t.Visible(0),jQuery(t.obj).css({marginTop:"0px",marginLeft:"0px",opacity:i/10}),t.TransparencyCover(i),t.doOnEndEffect(0)})}function flyFromTopLeftEffect(t,e){e=AnyToInt(e),t=AnyToObject(t);pages[t.pageName];var n=0-(t.OffsetHeight()+t.OffsetTop()),i=0-(t.OffsetWidth()+t.OffsetLeft());jQuery(t.obj).css({marginTop:n+"px",marginLeft:i+"px"}),t.Visible(1,!0),jQuery(t.obj).animate({marginTop:"0px",marginLeft:"0px"},e,function(){t.doOnEndEffect(1)})}function flyFromTopLeftOpacityEffect(t,e){e=AnyToInt(e),t=AnyToObject(t);pages[t.pageName];var n=0-(t.OffsetHeight()+t.OffsetTop()),i=0-(t.OffsetWidth()+t.OffsetLeft()),r=t.TransparencyCover();jQuery(t.obj).css({marginTop:n+"px",marginLeft:i+"px",opacity:0}),t.Visible(1,!0),jQuery(t.obj).animate({marginTop:"0px",marginLeft:"0px",opacity:r/10},e,function(){t.TransparencyCover(r),t.doOnEndEffect(1)})}function flyFromTopRightEffect(t,e){e=AnyToInt(e),t=AnyToObject(t);var n=pages[t.pageName],i=0-(t.OffsetHeight()+t.OffsetTop()),r=n.OffsetWidth()-t.OffsetLeft();jQuery(t.obj).css({marginTop:i+"px",marginLeft:r+"px"}),t.Visible(1,!0),jQuery(t.obj).animate({marginTop:"0px",marginLeft:"0px"},e,function(){t.doOnEndEffect(1)})}function flyFromTopRightOpacityEffect(t,e){e=AnyToInt(e),t=AnyToObject(t);var n=pages[t.pageName],i=0-(t.OffsetHeight()+t.OffsetTop()),r=n.OffsetWidth()-t.OffsetLeft(),o=t.TransparencyCover();jQuery(t.obj).css({marginTop:i+"px",marginLeft:r+"px",opacity:0}),t.Visible(1,!0),jQuery(t.obj).animate({marginTop:"0px",marginLeft:"0px",opacity:o/10},e,function(){t.TransparencyCover(o),t.doOnEndEffect(1)})}function flyFromBottomRightEffect(t,e){e=AnyToInt(e),t=AnyToObject(t);var n=pages[t.pageName],i=n.OffsetHeight()-t.OffsetTop(),r=n.OffsetWidth()-t.OffsetLeft();jQuery(t.obj).css({marginTop:i+"px",marginLeft:r+"px"}),t.Visible(1,!0),jQuery(t.obj).animate({marginTop:"0px",marginLeft:"0px"},e,function(){t.doOnEndEffect(1)})}function flyFromBottomRightOpacityEffect(t,e){e=AnyToInt(e),t=AnyToObject(t);var n=pages[t.pageName],i=n.OffsetHeight()-t.OffsetTop(),r=n.OffsetWidth()-t.OffsetLeft(),o=t.TransparencyCover();jQuery(t.obj).css({marginTop:i+"px",marginLeft:r+"px",opacity:0}),t.Visible(1,!0),jQuery(t.obj).animate({marginTop:"0px",marginLeft:"0px",opacity:o/10},e,function(){t.TransparencyCover(o),t.doOnEndEffect(1)})}function flyFromBottomLeftEffect(t,e){e=AnyToInt(e),t=AnyToObject(t);var n=pages[t.pageName].OffsetHeight()-t.OffsetTop(),i=0-(t.OffsetWidth()+t.OffsetLeft());jQuery(t.obj).css({marginTop:n+"px",marginLeft:i+"px"}),t.Visible(1,!0),jQuery(t.obj).animate({marginTop:"0px",marginLeft:"0px"},e,function(){t.doOnEndEffect(1)})}function flyFromBottomLeftOpacityEffect(t,e){e=AnyToInt(e),t=AnyToObject(t);var n=pages[t.pageName].OffsetHeight()-t.OffsetTop(),i=0-(t.OffsetLeft()+t.OffsetWidth()),r=t.TransparencyCover();jQuery(t.obj).css({marginTop:n+"px",marginLeft:i+"px",opacity:0}),t.Visible(1,!0),jQuery(t.obj).animate({marginTop:"0px",marginLeft:"0px",opacity:r/10},e,function(){t.TransparencyCover(r),t.doOnEndEffect(1)})}function flyToTopLeftEffect(t,e){e=AnyToInt(e),t=AnyToObject(t);pages[t.pageName];var n=0-(t.OffsetHeight()+t.OffsetTop()),i=0-(t.OffsetWidth()+t.OffsetLeft());jQuery(t.obj).animate({marginTop:n+"px",marginLeft:i+"px"},e,function(){t.Visible(0),jQuery(t.obj).css({marginTop:"0px",marginLeft:"0px"}),t.doOnEndEffect(0)})}function flyToTopLeftOpacityEffect(t,e){e=AnyToInt(e),t=AnyToObject(t);pages[t.pageName];var n=0-(t.OffsetHeight()+t.OffsetTop()),i=0-(t.OffsetWidth()+t.OffsetLeft()),r=t.TransparencyCover();jQuery(t.obj).animate({marginTop:n+"px",marginLeft:i+"px",opacity:0},e,function(){t.Visible(0),jQuery(t.obj).css({marginTop:"0px",marginLeft:"0px",opacity:r/10}),t.TransparencyCover(r),t.doOnEndEffect(0)})}function flyToTopRightEffect(t,e){e=AnyToInt(e),t=AnyToObject(t);var n=pages[t.pageName],i=0-(t.OffsetHeight()+t.OffsetTop()),r=n.OffsetWidth()-t.OffsetLeft();jQuery(t.obj).animate({marginTop:i+"px",marginLeft:r+"px"},e,function(){t.Visible(0),jQuery(t.obj).css({marginTop:"0px",marginLeft:"0px"}),t.doOnEndEffect(0)})}function flyToTopRightOpacityEffect(t,e){e=AnyToInt(e),t=AnyToObject(t);var n=pages[t.pageName],i=0-(t.OffsetHeight()+t.OffsetTop()),r=n.OffsetWidth()-t.OffsetLeft(),o=t.TransparencyCover();jQuery(t.obj).animate({marginTop:i+"px",marginLeft:r+"px",opacity:0},e,function(){t.Visible(0),jQuery(t.obj).css({marginTop:"0px",marginLeft:"0px",opacity:o/10}),t.TransparencyCover(o),t.doOnEndEffect(0)})}function flyToBottomRightEffect(t,e){e=AnyToInt(e),t=AnyToObject(t);var n=pages[t.pageName],i=n.OffsetHeight()-t.OffsetTop(),r=n.OffsetWidth()-t.OffsetLeft();jQuery(t.obj).animate({marginTop:i+"px",marginLeft:r+"px"},e,function(){t.Visible(0),jQuery(t.obj).css({marginTop:"0px",marginLeft:"0px"}),t.doOnEndEffect(0)})}function flyToBottomRightOpacityEffect(t,e){e=AnyToInt(e),t=AnyToObject(t);var n=pages[t.pageName],i=n.OffsetHeight()-t.OffsetTop(),r=n.OffsetWidth()-t.OffsetLeft(),o=t.TransparencyCover();jQuery(t.obj).animate({marginTop:i+"px",marginLeft:r+"px",opacity:0},e,function(){t.Visible(0),jQuery(t.obj).css({marginTop:"0px",marginLeft:"0px",opacity:o/10}),t.TransparencyCover(o),t.doOnEndEffect(0)})}function flyToBottomLeftEffect(t,e){e=AnyToInt(e),t=AnyToObject(t);var n=pages[t.pageName].OffsetHeight()-t.OffsetTop(),i=0-(t.OffsetWidth()+t.OffsetLeft());jQuery(t.obj).animate({marginTop:n+"px",marginLeft:i+"px"},e,function(){t.Visible(0),jQuery(t.obj).css({marginTop:"0px",marginLeft:"0px"}),t.doOnEndEffect(0)})}function flyToBottomLeftOpacityEffect(t,e){e=AnyToInt(e),t=AnyToObject(t);var n=pages[t.pageName].OffsetHeight()-t.OffsetTop(),i=0-(t.OffsetWidth()+t.OffsetLeft()),r=t.TransparencyCover();jQuery(t.obj).animate({marginTop:n+"px",marginLeft:i+"px",opacity:0},e,function(){t.Visible(0),jQuery(t.obj).css({marginTop:"0px",marginLeft:"0px",opacity:r/10}),t.TransparencyCover(r),t.doOnEndEffect(0)})}function popEffect(t){t=AnyToObject(t);pages[t.pageName];if(null!=t){var e=t.OffsetWidth(),n=t.OffsetHeight(),i=e+5,r=n+5;jQuery(t.obj).animate({width:i+"px",height:r+"px"},500),jQuery(t.obj).animate({width:e+"px",height:n+"px"},500,function(){t.doOnEndEffect(1)})}}function ParseTextIntoList(t,e,n,i){var r,o,a=t,s=[],l=[],d=[],h=!0;if(isVarUndefined(e)&&(e=null),isVarUndefined(n)&&(n=""),n.length>0)for(l=n.split("##"),c=0;c<l.length;c++)(r=l[c].indexOf("#"))>0&&d.push([l[c].substring(0,r),l[c].substring(r+1)]);var u=Variablen.TextExerciseSettings.SkipString().split("/");u.splice(0,1);for(var c=0;c<u.length;c++)t=t.replace(new RegExp("\\"+u[c],"g")," ");if(arguments.length<4||1==AnyToBool(isVarUndefined(i))){i=Variablen.TextExerciseSettings.DelimiterString();i+="«»"}for(c=0;c<i.length;c++)t="."==i.charAt(c)||"?"==i.charAt(c)||"+"==i.charAt(c)||"-"==i.charAt(c)?t.replace(new RegExp("\\"+i.charAt(c),"g")," "+i.charAt(c)+" "):t.replace(new RegExp(i.charAt(c),"g")," "+i.charAt(c)+" ");var p=[];if(0!=(t=(t=t.replace(/  /g," ")).trim(t)).length){for(var m=0,g=1,f="{"==t.charAt(m);g<t.length;){if(" "==t.charAt(g)&&!f)T=(T=t.substr(m,g-m)).trim(T),p.push(T),h=!1,sRest="",(o=a.indexOf(T))>=0&&(sRest=a.substring(0,o),a=a.substring(o+T.length)),p.length>1&&s.push(sRest),m=++g;if(f&&"}"==t.charAt(g))f=!1,T=(T=t.substr(m,g-m+1)).trim(T),p.push(T),h=!1,sRest="",(o=a.indexOf(T))>=0&&(sRest=a.substring(0,o),a=a.substring(o+T.length)),p.length>1&&s.push(sRest),m=++g;for(f||"{"!=t.charAt(g)||(f=!0,m=g),g++;0==h&&d.length>0;)for(c=0;c<d.length;c++){if(p.length>1&&1==p[p.length-2].startsWith(d[c][0])&&1==p[p.length-1].endsWith(d[c][1])){p[p.length-2]=p[p.length-2]+s[s.length-1]+p[p.length-1],p.pop(),d.splice(c,1);break}c+1>=d.length&&(h=!0)}}var T;for(T=(T=t.substr(m,g-m+1)).trim(T),p.push(T),h=!1,sRest="",(o=a.indexOf(T))>=0&&(sRest=a.substring(0,o),a=a.substring(o+T.length)),p.length>1&&s.push(sRest);0==h&&d.length>0;)for(c=0;c<d.length;c++){if(p.length>1&&1==p[p.length-2].startsWith(d[c][0])&&1==p[p.length-1].endsWith(d[c][1])){p[p.length-2]=p[p.length-2]+s[s.length-1]+p[p.length-1],p.pop(),d.splice(c,1);break}c+1>=d.length&&(h=!0)}}if(e&&(null!=e&&(e=AnyToObject(e)),null!=e))for(c=0;c<p.length;c++)e.AddListItem(p[c]);return p}function FindSyncPoints(t,e,n,i,r){for(var o=!1,a=n,s=n,l=n;l<Max(t.length,e.length);l++){for(a=Min(l,t.length-1),s=n;s<=Min(l-1,e.length-2);s++)if(t[a]==e[s]){o=!0;break}if(o)break;s=Min(l,e.length-1);for(a=n;a<=Min(l,t.length-1);a++)if(t[a]==e[s]){o=!0;break}if(o)break}return i[0]=a,r[0]=s,o}function CountDifferences(t,e,n,i,r){for(var o=Min(i,r)-n+Math.abs(i-r),a=r,s=i;s<t.length;s++)r<e.length&&t[s]!=e[a]&&o++,a++;return o+Math.abs(t.length-i-(e.length-r))}function SynchronizeLists(t,e,n,i){isVarUndefined(n)&&(n=""),isVarUndefined(i)&&(i="");var r=[],o=[];function a(t,e,r){for(var o=[],a=[],s=t[r].substr(1,t[r].length-2);""!=s;){-1==(u=s.indexOf("/"))?(o.push(s),s=""):(o.push(s.substr(0,u)),s=s.substr(u+1,s.length-(u+1)))}if(0!=o.length){var l=Number.MAX_VALUE,d=-1;t.splice(r,1);for(var h=0;h<o.length;h++){a=ParseTextIntoList(o[h],null,n,i);for(var u=0;u<a.length;u++)t.splice(r+u,0,a[u]);var c=Number.MAX_VALUE,p=[],m=[];FindSyncPoints(t,e,r,p,m)&&(c=CountDifferences(t,e,r,p[0],m[0]));for(u=0;u<a.length;u++)t.splice(r,1);c<l&&(l=c,d=h)}-1==d&&(d=0),a=ParseTextIntoList(o[d],null,n,i);for(u=0;u<a.length;u++)t.splice(r+u,0,a[u])}}for(var s=0;s<t.length&&s<e.length;){if(t[s]!=e[s]&&t[s].length>2&&"{"==t[s][0]&&a(t,e,s),t[s]!=e[s]&&FindSyncPoints(t,e,s,r,o)){for(var l=0;l<=r[0]-o[0]-1;l++)e.splice(s,0,"");for(l=0;l<=o[0]-r[0]-1;l++)t.splice(s,0,"")}s++}}function CompareLists(t,e,n,i){var r,o=[];SynchronizeLists(t,e);for(var a=t.length;a<e.length;a++)t.push("");for(a=e.length;a<t.length;a++)e.push("");var s=0;for(a=0;a<t.length;a++)o=[],(o=t[a].split("#")).length>=3&&""==o[o.length-1]&&(o.pop(),vL2=o[o.length-1].split("&"),o=o.concat(vL2)),(r=o.indexOf(e[a]))<0?(s++,t[a]=o[0]):t[a]=o[r];if(n){(n=AnyToObject(n)).Items.ClearItems();for(a=0;a<t.length;a++)n.AddListItem(t[a])}if(i){(i=AnyToObject(i)).Items.ClearItems();for(a=0;a<e.length;a++)i.AddListItem(e[a])}return s}function hasWindowXScrollBar(){var t=getDocumentClientWidth(),e=getDocumentScrollWidth();return ret=!1,e-t>0&&(ret=!0),ret}function hasWindowYScrollBar(){var t=getDocumentClientHeight(),e=getDocumentScrollHeight();return ret=!1,e-t>0&&(ret=!0),ret}function clearSelection(){if(document.selection&&document.selection.empty)document.selection.empty();else if(window.getSelection){window.getSelection().removeAllRanges()}}function supports_webm_video(){return!!supports_video()&&document.createElement("video").canPlayType('video/webm; codecs="vp8, vorbis"')}function supports_ogg_theora_video(){return!!supports_video()&&document.createElement("video").canPlayType('video/ogg; codecs="theora, vorbis"')}function supports_h264_baseline_video(){return!!supports_video()&&document.createElement("video").canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"')}function supports_video(){return!!document.createElement("video").canPlayType}function supports_audio(){return!!document.createElement("audio").canPlayType}function supports_mp3(){if(!supports_audio())return!1;var t=document.createElement("audio");return"no"!=t.canPlayType("audio/mpeg")&&""!=t.canPlayType("audio/mpeg")}function getBOC(t,e){var n;return 1==AnyToBool(isVarUndefined(e))&&(e=null),0,null==(n=t.getParentasComp())?0:"chrome"==getBrowserName()&&"static"!=n.obj.style.position?AnyToInt(n.obj.style.borderWidth):0}function findIdeaObj(t){var e=null;if(t);for(;t&&null!=t.nodeName&&"BODY"!=t.nodeName;){if(t.pageName&&t.obj&&pages[t.pageName]&&pages[t.pageName][t.obj]&&pages[t.pageName][t.obj].isEnabled()){e=t;break}if(t.pageName)return e;t=t.parentNode}return e}function extractEventTarget(t){var e=null;if(!t)t=window.event;return t.target?e=t.target:t.srcElement&&(e=t.srcElement),e}function Caption(t){return arguments.length&&t!=this.attr_Caption&&(this.attr_Caption=t,this.obj.innerHTML=t),this.attr_Caption}function complexCaption(t){return arguments.length&&t!=this.attr_Caption&&(this.attr_Caption=t,this.obj.childNodes[1].innerHTML=t),this.attr_Caption}ctcpappear=!1,StateManager.onstaterevisit=function(t){GlobalHook.handleEvent("staterevisit",t)};var ideafuncholder={positionholder:{HeightType:function(t){if(!arguments.length)return this.attr_HeightType;this.attr_HeightType=t,this.Height(this.Height())},TopType:function(t){if(!arguments.length)return this.attr_TopType;this.attr_TopType=t,this._initTopType=!0,this.Top(this.Top())},WidthType:function(t){if(!arguments.length)return this.attr_WidthType;this.attr_WidthType=t,this.Width(this.Width())},LeftType:function(t){if(!arguments.length)return this.attr_LeftType;this.attr_LeftType=t,this._initLeftType=!0,this.Left(this.Left())},Top:function(t){if(!arguments.length||void 0==arguments[0]){if(AnyToInt(this.TopType())>2&&6!=AnyToInt(this.TopType())){var e=this.getSizeObj().offsetTop;return isNaN(e)?0:AnyToInt(this.getSizeObj().offsetTop).toFixed(2)}return parseFloat(this.attr_Top).toFixed(2)}if(this._initTopType)if(AnyToInt(this.TopType())>2&&AnyToInt(this.TopType())<6){this.getSizeObj().style.position="",this.getSizeObj().style.top="";var n=this.getSizeObj().style;switch(AnyToInt(this.TopType())){case 3:n.verticalAlign="top";break;case 4:jQuery().css({"margin-top":"auto","margin-bottom":"auto",position:"absolute",top:"0",bottom:"0"}),n.verticalAlign="middle";break;case 5:n.verticalAlign="bottom"}}else{6!=AnyToInt(this.TopType())?this.getSizeObj().style.position="absolute":this.getSizeObj().style.position="relative",this.getSizeObj().style.verticalAlign="";var i=parseFloat(t).toFixed(2);(i<0||isNaN(i))&&(i=0),this.attr_Top=i;var r="px";switch(AnyToInt(this.TopType())){case 0:r="px";break;case 1:r="em";break;case 2:r="%";break;case 6:r="px"}this.getSizeObj().style.position="absolute",this.getSizeObj().style.top=i+r}else this.attr_Top=parseFloat(t).toFixed(2)},Width:function(t){if(!arguments.length||void 0==arguments[0]){if(3==this.WidthType()){var e=this.getSizeObj().offsetWidth;return isNaN(e)?0:AnyToInt(this.getSizeObj().offsetWidth).toFixed(2)}return parseFloat(this.attr_Width).toFixed(2)}if(3!=this.WidthType()){var n=parseFloat(t).toFixed(2);(n<0||isNaN(n))&&(n=0),this.attr_Width=n;var i="px";switch(AnyToInt(this.WidthType())){case 0:i="px";break;case 1:i="em";break;case 2:i="%"}this.getSizeObj().style.width=n+i}else this.getSizeObj().style.width=""},Left:function(t){if(!arguments.length||void 0==arguments[0]){if(AnyToInt(this.LeftType())>2&&6!=AnyToInt(this.LeftType())){var e=this.getSizeObj().offsetLeft;return isNaN(e)?0:AnyToInt(this.getSizeObj().offsetLeft).toFixed(2)}return parseFloat(this.attr_Left).toFixed(2)}if(this._initLeftType)if(AnyToInt(this.LeftType())>2&&AnyToInt(this.LeftType())<6){this.getSizeObj().style.position="",this.getSizeObj().style.left="";var n=this.getSizeObj().style;switch(AnyToInt(this.LeftType())){case 3:n.display="inline-block",0==AnyToInt(this.attr_marginLeft)&&(n.marginLeft=""),0==AnyToInt(this.attr_marginRight)&&(n.marginRight="");break;case 4:n.display="block",n.left=0,n.right=0,n.marginLeft="auto",n.marginRight="auto";break;case 5:n.display="block",n.marginLeft="auto",0==AnyToInt(this.attr_marginRight)&&(n.marginRight="0px")}}else{this.getSizeObj().style.display="inline-block",6!=AnyToInt(this.LeftType())?this.getSizeObj().style.position="absolute":this.getSizeObj().style.position="relative";var i=parseFloat(t).toFixed(2);(i<0||isNaN(i))&&(height=0),this.attr_Left=i;var r="px";switch(AnyToInt(this.LeftType())){case 0:r="px";break;case 1:r="em";break;case 2:r="%";break;case 6:r="px"}this.getSizeObj().style.left=i+r}else this.attr_Left=parseFloat(t).toFixed(2)},Height:function(t){if(!arguments.length||void 0==arguments[0]){if(3==AnyToInt(this.HeightType())){var e=this.getSizeObj().offsetHeight;return isNaN(e)?0:AnyToInt(this.getSizeObj().offsetHeight).toFixed(2)}return parseFloat(this.attr_Height).toFixed(2)}if(3!=AnyToInt(this.HeightType())){if(4==AnyToInt(this.HeightType()))return jQuery(this.obj).css("position","relative"),jQuery(this.obj).parent().is("body")?jQuery(this.obj).css("min-height",window.innerHeight+"px"):jQuery(this.obj).css("min-height","100%"),void(this.getSizeObj().style.height="");var n=parseFloat(t).toFixed(2);(n<0||isNaN(n))&&(n=0),this.attr_Height=n;var i="px";switch(AnyToInt(this.HeightType())){case 0:i="px";break;case 1:i="em";break;case 2:i="%"}this.getSizeObj().style.height=n+i}else this.getSizeObj().style.height=""}},scriptandattr:{UserDefAttrList:function(t){if(!arguments.length)return this.attr_UserDefAttrList;this.attr_UserDefAttrList=t},addUserDefAttr:function(t,e){void 0===this["attr_"+t]?void 0===this[t+"Set"]?(this["attr_"+t]=e,this[t]=createSetterGetter(t)):(this["attr_"+t]=null,this[t]=createSetterGetterTech(t)):null==this["attr_"+t]&&(void 0===this[t+"Set"]?(this["attr_"+t]=e,this[t]=createSetterGetter(t)):(this["attr_"+t]=null,this[t]=createSetterGetterTech(t)))},delUserDefAttr:function(t){delete this["attr_"+t],delete this[t],this["attr_"+t]=null,this[t]=null},addUserDefScript:function(t,e,n){var i,r;(n=n.replace(/&#x0A;/g,"\n"),i=null!=e&&""!=e?new Function(e,n):new Function(n),"OnClick"==t&&(t="JScr_"+t),i.thePageName=this.pageName,this[t]=i,t.endsWith("Get"))&&(this["attr_"+(r=t.replace("Get",""))]=null,this[r]=createSetterGetterTech(r));t.endsWith("Set")&&(this["attr_"+(r=t.replace("Set",""))]=null,this[r]=createSetterGetterTech(r))},getXMLAttrLength:function(){return this._getNode().attributes.length},getXMLAttrName:function(t){return this._getNode().attributes[t].nodeName},getXMLAttr:function(t){return this._getNode().getAttribute(t)},setXMLAttr:function(t,e){this._getNode().setAttribute(t,e)},deleteXMLAttr:function(t){this._getNode().removeAttribute(t)},getnodeObject:function(){return this.nodeObject},_getNode:function(){return this.stringcontentofsite?this.stringcontentofsite:this.nodeObject},getAllXMLScriptNames:function(){for(var t,e=this._getNode(),n="",i=e.childNodes.length,r=0;r<i;r++)"JavaScript"==e.childNodes[r].getAttribute(cIdeaClass)&&(n+=(t=StrCopy(t=e.childNodes[r].getAttribute("Name"),6,t.length))+",");return n=StrCopy(n,1,n.length-1)},getXMLScript:function(t){for(var e=this._getNode(),n="JScr_"+t,i="",r=e.childNodes.length,o=0;o<r;o++)if(e.childNodes[o].getAttribute("Name")==n){i=e.childNodes[o].getAttribute(cScriptData);break}return i},getXMLScriptParams:function(t){for(var e=this._getNode(),n="JScr_"+t,i="",r=0;r<e.childNodes.length;r++)if(e.childNodes[r].getAttribute("Name")==n){i=e.childNodes[r].getAttribute(cScriptParam);break}return i},setXMLScript:function(t,e){for(var n=this._getNode(),i="JScr_"+t,r=0,o=0;o<n.childNodes.length;o++)if(n.childNodes[o].getAttribute("Name")==i){n.childNodes[o].setAttribute(cScriptData,e),r=1;break}if(0==r){var a=n.ownerDocument.createElement("JavaScript");a.setAttribute(cIdeaClass,"JavaScript"),a.setAttribute("Userdef","0"),a.setAttribute(cScriptParam,""),a.setAttribute("Name",i),a.setAttribute(cScriptData,e),n.appendChild(a)}},setXMLScriptAndParams:function(t,e,n){for(var i=this._getNode(),r="JScr_"+t,o=0,a=i.childNodes.length,s=0;s<a;s++)if(i.childNodes[s].getAttribute("Name")==r){i.childNodes[s].setAttribute(cScriptData,e),i.childNodes[s].setAttribute(cScriptParam,n),o=1;break}if(0==o){var l=i.ownerDocument.createElement("JavaScript");l.setAttribute(cIdeaClass,"JavaScript"),l.setAttribute("Userdef","0"),l.setAttribute(cScriptParam,n),l.setAttribute("Name",r),l.setAttribute(cScriptData,e),i.appendChild(l)}},deleteXMLScript:function(t){for(var e=this._getNode(),n="JScr_"+t,i=e.childNodes.length,r=0;r<i;r++)if(e.childNodes[r].getAttribute("Name")==n){e.removeChild(e.childNodes[r]),1;break}},i_addEvent:function(t,e,n){var i=new Object;i.en=t,this["i_"+t+"_"+this.Name()+"_"+e]=this.i_eventProxy(),i.fn=this["i_"+t+"_"+this.Name()+"_"+e],i.fn_name,this.i_removeEventList.push(i),jQuery(document).bind(t,{obj:this,param1:n,func:e},i.fn)},i_removeEvent:function(t,e){var n,i;if(this["i_"+t+"_"+this.Name()+"_"+e])for(jQuery(document).unbind(t,this["i_"+t+"_"+this.Name()+"_"+e]),i=0;i<this.i_removeEventList.length;i++)if((n=this.i_removeEventList[i]).en==t&&n.fn_name==e){this.i_removeEventList.splice(i,1);break}},i_triggerEvent:function(t,e,n,i,r,o){jQuery(document).trigger(t,[this,e,n,i,r,o])},i_eventProxy:function(){return function(t,e,n,i,r,o,a){var s=void 0===typeof t.data.param1?"":t.data.param1,l=void 0===typeof t.result?"":t.result;if(!pages[t.data.obj.pageName])return!1;try{var d=t.data.obj[t.data.func](e,t.type,l,s,n,i,r,o,a);return 0!=d&&d}catch(t){return!1}}},msdown_callback:function(){return!0},msmove_callback:function(){return!0},msup_callback:function(){return!0},onchange_callback:function(){return!0},onkeyreleased_callback:function(){return!0}},pageeventfunc:{onpgready:function(){if(!this.isInit){if(this.i_triggerEvent("evtPageReady",this.Name()),this.StartDate=new Date,IsInProtocolMode()&&IsProtocolBitSet(2))Protocol("Recordtyp=2,Datum="+generateIFormatDate(this.StartDate)+",Zeit="+generateIFormatTime(this.StartDate)+",,Seitenname="+this.Name()+",,,");if(this.isInInit=!0,4==this.attr_Position){var t,e,n="",i=this.Parent();if(i.lastIndexOf(".")>-1){var r=i.substring(i.lastIndexOf(".")+1,i.length);n=i.substring(0,i.indexOf(".")),i=r}var o=$(n+i);null==o||o==document.body?(t=getDocumentWidth(),e=getDocumentHeight()):(t=(o=pages[o.pageName][o.obj]).Width(),e=o.Height()),t=Math.round((t-Number(this.Width()))/2),e=Math.round((e-Number(this.Height()))/2),t=t<0?0:t,e=e<0?0:e,this.Left(t),this.Top(e)}TStdVisibleComponent.prototype.onpgready.call(this),this.isInit=!0}},onpgshown:function(){if(!this.isShowInit){TStdVisibleComponent.prototype.onpgshown.call(this);for(var t=null,e=0;e<this.regForDelay.length;e++)t="pages['"+this.pageName+"']['"+this.regForDelay[e].Name()+"'].OnExecute();",this.timeOutCalls[this.timeOutCalls.length]=setTimeout(t,this.regForDelay[e].delayTime)}},onpgclose:function(){IsInProtocolMode()&&IsProtocolBitSet(3)&&(this.FinishDate=StartDate,Protocol("Recordtyp=3,Datum="+generateIFormatDate(this.FinishDate)+",Zeit="+generateIFormatTime(this.FinishDate)+","+Math.round((this.FinishDate.getTime()-this.StartDate.getTime())/1e3)+",Seitenname="+ +this.Name()+",,,",this));for(var t=0;t<this.timeOutCalls.length;t++)clearTimeout(this.timeOutCalls[t]),this.timeOutCalls[t]=null;this.timeOutCalls=null;for(t=0;t<this.chgAttrOnTime.length;t++)this.chgAttrOnTime[t].stop(),this.chgAttrOnTime[t]=null;if(TStdVisibleComponent.prototype.onpgclose.call(this),null!=this.scenarios)for(t=0;t<this.scenarios.length;t++)this.scenarios[t]=null;this.scenarios=null,this.allComps=null,window[this._intPageNameAlias]=null,delete this.stringcontentofsite,this.stringcontentofsite=null,this.i_triggerEvent("evtPageClose",this.Name())},addUserEventPattern:function(t,e){null==this.eventRecoder&&(this.eventRecoder=new TEventRecorder(this)),this.eventRecoder.addPattern(t,e)},postProcessEvent:function(t,e,n){if(null!=this.eventRecoder)for(var i,r=null,o=this.scenarios.length,a=this.scenarios,s=0;s<o;s++)if("TScenario"==(r=a[s]).IdeaClass())for(var l=0;l<r.childes.length;l++)if("TPageAction"==(i=r.childes[l]).IdeaClass()){var d=this.eventRecoder.processEvent(t,e,n,i);if(null!=d&&""!=d&&"OnExecute"==d&&i.OnExecute){if(0!=i.OnExecute())break;null!=this.eventRecoder&&this.eventRecoder.clearHistory()}}}},visibleholder:{Visible:function(t,e){if(!arguments.length)return this.attr_Visible;t=AnyToInt(t),this.attr_Visible=t,isVarUndefined(e)&&(e=!1),this.isInit||(t=0),0==AnyToBool(e)&&0==pages[this.pageName].PageMode()&&1==t&&setOpacity(this.TransparencyCover(),this),1==t?(this.obj.style.visibility="visible",0!=pages[this.pageName].PageMode()&&this.TransparencyCover(this.TransparencyCover())):0==pages[this.pageName].PageMode()?this.obj.style.visibility="hidden":this.obj.style.opacity="0.30";var n=null,i=null;try{if(1==t){n=this.childes.length;for(var r=0;r<n;r++)(i=this.childes[r]).Visible&&i.Visible(i.Visible())}else if(0==pages[this.pageName].PageMode()){n=this.childes.length;for(r=0;r<n;r++)i=this.childes[r],0==pages[this.pageName].PageMode()&&(i.obj.style.visibility="hidden"),i.internalVisibleHidden&&i.internalVisibleHidden()}}catch(t){}},internalVisibleHidden:function(t){var e=this.childes.length,n=null;try{for(var i=0;i<e;i++)n=this.childes[i],0==pages[this.pageName].PageMode()&&(n.obj.style.visibility="hidden"),n.internalVisibleHidden&&n.internalVisibleHidden()}catch(t){}},internalVisible:function(){var t=this.childes.length,e=null;try{for(var n=0;n<t;n++)(e=this.childes[n]).obj.style.visibility="visible",e.internalVisible&&e.internalVisible()}catch(t){}}},childfuncholder:{addChild:function(t){this.childes.push(t)},getChildCount:function(t){return null!=this.childes?this.childes.length:0},getChildNameAt:function(t){return null!=this.childes&&t<this.childes.length?this.childes[t].Name():""},removeChild:function(t){if(null!=this.childes)for(var e=this.childes.length,n=0;n<e;n++)if(this.childes[n].Name()==t.Name()){this.childes.remove(n);break}},getAppendObj:function(t){if(!arguments.length)return this.appendObj;this.appendObj=t},appendChild:function(t){this.getAppendObj().appendChild(t)}},internalholder:{__LN:function(t){if(!arguments.length)return this.attr___LN;this.attr___LN=t},__LI:function(t){if(!arguments.length)return this.attr___LI;this.attr___LI=t},__PT:function(t){if(!arguments.length)return this.attr___PT;this.attr___PT=t},_getCSSPosition:function(){var t=-1;switch(jQuery(this.obj).css("position")){case"static":t=0;break;case"relative":t=1;break;case"absolute":t=2;break;default:t=3}return t}}};function extendBaseFunction(t){jQuery.extend(t,ideafuncholder.scriptandattr),jQuery.extend(t,ideafuncholder.childfuncholder),jQuery.extend(t,ideafuncholder.visibleholder),jQuery.extend(t,ideafuncholder.internalholder)}function extendPageBaseFunction(t){jQuery.extend(t,ideafuncholder.pageeventfunc)}function Font(t,e){this.obj=t,this.ideaobj=e,this.attr_FontColor=null,this.attr_FontName=null,this.attr_FontSize=null,this.attr_FontStyle=null}function Items(t){this.obj=t,this.intPageName=""}function NavigationElementItems(t){this.obj=t,this.intPageName="",this.content=null}function handleNaviListClick(t){var e=jQuery(this).parentsUntil(".IdeaComponent").parent(),n=jQuery(this).parent();if(isTouchDevice()&&_listmovebefore[0]!=n[0])return _listmovebefore=!1,!1;var i=e[0].obj,r=e[0].pageName,o=jQuery(pages[r][i].attr_Items.obj);if(n.hasClass("navilistcontent-folder")){if(1==pages[r][i].AutoFullExpand()&&0==pages[r][i].MultiExpand())return;var a=n.children("ul:first");0==pages[r][i].MultiExpand()&&(jQuery(o).find("ul").not(a).not(jQuery(this).parentsUntil(".IdeaComponent","ul")).removeClass("open").addClass("close").hide(),jQuery(o).find("li").not(n).not(jQuery(this).parentsUntil(".IdeaComponent","li")).removeClass("open").addClass("close"));var s=0,l=n.attr("pagename");a.hasClass("open")?(s=0,n.removeClass("open").addClass("close"),a.removeClass("open").addClass("close")):(s=1,n.removeClass("close").addClass("open"),a.removeClass("close").addClass("open")),n.children("ul:first").toggle(),pages[r][i].OnChapterClick&&pages[r][i].OnChapterClick(s,l)}else{var d=jQuery(pages[r][i].attr_Items.obj).find("li").index(n);e.find(".navilistcontent-selectedelement").removeClass("navilistcontent-selectedelement"),pages[r][i].attr_ItemIndex=d,jQuery(this).addClass("navilistcontent-selectedelement"),pages[r][i].OnClick&&pages[r][i].OnClick()}}function ElementList(t){this.obj=t,this.intPageName="",this.content=null}function handleListClick(t){if(_listmovebefore)_listmovebefore=!1;else if(_listtouchstart&&(_listtouchstart=!1,null!=this.parentNode)){var e=this.parentNode.obj,n=this.parentNode.pageName,i=jQuery(pages[n][e].attr_Items.obj).find("li").index(this);jQuery(pages[n][e].attr_Items.obj).find(".selectedelement").removeClass("selectedelement"),pages[n][e].attr_ItemIndex=i,jQuery(this).addClass("selectedelement"),pages[n][e].OnChange&&pages[n][e].OnChange()}}function TStdComponent(t){this.obj=t,this.childes=[],this.attr_Parent=null,this.attr_Font=new Font(t,this),this.Font=this.attr_Font,this.isInit=!1}function TStdVisibleComponent(t){if(!(arguments.length<=0)){this.obj=t,this.appendObj=t;var e=this.obj,n=e.style;this.childes=[],n.overflow="hidden",n.position="absolute",n.padding="0"+px,this.orgValue=n.display,this.attr_Font=new Font(t,this),this.Font=this.attr_Font,this.i_removeEventList=[],IS.IE()&&(addEvent(t,"mouseenter",ICompsEvent.hoverworkin),addEvent(t,"mouseleave",ICompsEvent.hoverworkout)),addEvent(t,"click",ICompsEvent.onEvent),this.obj.className="IdeaComponent",e=null}}function TStdPage(t){arguments.length<=0||(this.supconst(t),this.regForDelay=[],this.chgAttrOnTime=[],this.timeOutCalls=[],this.scenarios=[],this.allComps=[])}function TStdBackground(t){arguments.length<=0||(TStdVisibleComponent.call(this,t),this.attr_Picture=null)}function TStdPresiAssi(t){arguments.length<=0||TStdVisibleComponent.call(this,t)}function TStdImage(t){arguments.length<=0||(TStdVisibleComponent.call(this,t),this.attr_Picture=null,this.attr_FileName=null,this.attr_StrechMode=null,this.defSize=100,pages[t.pageName].PageMode()!=pmEdit?this.obj.style.borderStyle="none":this.obj.className="it_framestyle7a "+this.attr_cssClass)}function TStdPicture(t){arguments.length<=0||(TStdVisibleComponent.call(this,t),this.attr_Picture=null,this.attr_FileName=null,this.attr_StrechMode=null,this.defSize=100,pages[t.pageName].PageMode()!=pmEdit?this.obj.style.borderStyle="none":this.obj.className="it_framestyle7a "+this.attr_cssClass)}function TStdPDFLink(t){arguments.length<=0||TStdImage.call(this,t)}function TStdFlipCard(t){arguments.length<=0||TStdPicture.call(this,t)}function TStdTextOverPic(t){arguments.length<=0||TStdPicture.call(this,t)}function TStdTile(t){arguments.length<=0||TStdTextOverPic.call(this,t)}function TStdZoomImg(t){arguments.length<=0||TStdImage.call(this,t)}function TStdLabel(t){if(!(arguments.length<=0)){var e;if(TStdVisibleComponent.call(this,t),0!=pages[t.pageName].PageMode()&&this.attr_ShowFrame&&0==this.attr_ShowFrame)(e=this.obj.style).borderStyle="dashed",e.borderWidth="1px",e.borderColor=convertColor(13421772);if(1==this.attr_LabelMode)(e=this.obj.style).display="inline-table",(e=this.obj.firstChild.style).display="table-cell",e.height="100%",e.width="100%"}}function TStdTextFlipCard(t){if(!(arguments.length<=0)){TStdVisibleComponent.call(this,t),pages[t.pageName].PageMode()==pmEdit&&0==this.attr_ShowFrame&&(this.obj.className="it_framestyle7a "+this.attr_cssClass);var e=this.obj.style;e.display="table",(e=this.obj.firstChild.style).display="table-cell",e.height="100%",e.width="100%"}}function TStdBMPButton(t){if(!(arguments.length<=0)){TStdVisibleComponent.call(this,t);var e=addEvent;if(e(this.obj,"mouseover",this.changeState),e(this.obj,"mousedown",this.changeState),e(this.obj,"mouseup",this.changeState),e(this.obj,"mouseout",this.changeState),0!=pages[t.pageName].PageMode()){var n=this.obj.style;n.borderStyle="solid",n.borderWidth="2px",n.borderColor=convertColor(35071)}else this.obj.style.borderStyle="none"}}function TStdFlashPlayer(t){arguments.length<=0||(TStdVisibleComponent.call(this,t),this.Transparent(0))}function TStdLangComp(t){arguments.length<=0||TStdVisibleComponent.call(this,t)}function TStdPanel(t){if(!(arguments.length<=0)){TStdVisibleComponent.call(this,t);var e=this.obj.firstChild.style;e.width="100%",e.height="auto"}}function TStdTilePanel(t){if(!(arguments.length<=0)){TStdPanel.call(this,t);var e=this.obj.firstChild.style;e.width="100%",e.height="auto"}}function TStdTimer(t){arguments.length<=0||TStdVisibleComponent.call(this,t)}function TStdFramedLabel(t){if(!(arguments.length<=0)){TStdVisibleComponent.call(this,t),pages[t.pageName].PageMode()==pmEdit&&0==this.attr_ShowFrame&&(this.obj.className="it_framestyle7a "+this.attr_cssClass);var e=this.obj.style;e.display="table",(e=this.obj.firstChild.style).display="table-cell",e.height="100%",e.width="100%"}}function TStdHTMLViewer(t){arguments.length<=0||(TStdVisibleComponent.call(this,t),this.obj.style.overflow="auto",pages[t.pageName].PageMode()!=pmEdit?this.obj.style.borderStyle="none":this.obj.className="it_framestyle7a "+this.attr_cssClass)}function TStdPPTViewer(t){arguments.length<=0||(TStdVisibleComponent.call(this,t),this.obj.style.overflow="auto")}function TStdPDFViewer(t){arguments.length<=0||(TStdVisibleComponent.call(this,t),this.obj.style.overflow="auto")}function TStdCMViewer(t){arguments.length<=0||(TStdVisibleComponent.call(this,t),this.obj.style.overflow="auto")}function Lines(t){arguments.length<=0||(this.obj=t)}function TStdMemo(t){arguments.length<=0||(TStdVisibleComponent.call(this,t),this.attr_Lines=new Lines(this.obj),this.Lines=this.attr_Lines,pages[t.pageName].PageMode()!=pmEdit?this.obj.style.borderStyle="solid":this.obj.className="it_framestyle7a "+this.attr_cssClass)}function TStdButton(t){arguments.length<=0||TStdVisibleComponent.call(this,t)}function TStdBitBtn(t){arguments.length<=0||TStdVisibleComponent.call(this,t)}function TStdjqSlider(t){if(!(arguments.length<=0)){TStdVisibleComponent.call(this,t),this.pageName=this.obj.pageName;var e=this;jQuery(this.obj).slider({orientation:"vertical",min:0,max:100,value:0,slide:function(t,n){e.onChange(n.value)}})}}function TStdShape(t){if(!(arguments.length<=0)){TStdVisibleComponent.call(this,t),this.pageName=this.obj.pageName;this.canvas=new fabric.StaticCanvas(this.obj.firstChild)}}function TStdSpinButton(t){if(!(arguments.length<=0)){TStdVisibleComponent.call(this,t),this.pageName=this.obj.pageName;var e=this;addEvent(this.obj.id+"_on","click",function(t){e.ChangeOn(t)}),addEvent(this.obj.id+"_off","click",function(t){e.ChangeOff(t)})}}function TStdCssButton(t){if(!(arguments.length<=0)){TStdBitBtn.call(this,t),this.pageName=this.obj.pageName,this.cssClass(this.cssClass());var e=this;addEvent(this.obj,"mouseover",function(t){e.changeState(t)}),addEvent(this.obj,"mousedown",function(t){e.changeState(t)}),addEvent(this.obj,"mouseup",function(t){e.changeState(t)}),addEvent(this.obj,"mouseout",function(t){e.changeState(t)})}}function TStdSlider(t){if(!(arguments.length<=0)){TStdVisibleComponent.call(this,t),this.cssClass("Slider"),this._line=document.createElement("div"),_lobj=this._line,_lobj.id=this.obj.id+"lb",_lobj.style.position="absolute",_lobj.className="SliderWay",this.obj.appendChild(_lobj),this._icon=document.createElement("img"),this._icon.style.zIndex="2";var e=this._icon;this.Icon(""),e.style.top="0px",e.style.left="0px",e.style.position="absolute",this.obj.appendChild(this._icon)}}function TStdSpeedButton(t){arguments.length<=0||TStdBitBtn.call(this,t)}function TStdRadioButton(t){arguments.length<=0||TStdVisibleComponent.call(this,t)}function TStdFocusRadioButton(t){arguments.length<=0||TStdVisibleComponent.call(this,t)}function TStdTreeView(t){arguments.length<=0||(TStdVisibleComponent.call(this,t),this.obj.style.overflow="auto",this.tree=new IdeaTree(this.obj.pageName+this.obj.obj,this.obj.pageName))}function TStdCheckBox(t){arguments.length<=0||TStdRadioButton.call(this,t)}function TStdEdit(t){arguments.length<=0||TStdVisibleComponent.call(this,t)}function TStdListBox(t){arguments.length<=0||(TStdVisibleComponent.call(this,t),this.obj.style.overflow="auto",this.attr_Items=new Items(this.obj),this.Items=this.attr_Items,this.Items.setpageName(this.pageName))}function TStdComboBox(t){arguments.length<=0||TStdListBox.call(this,t)}function TStdHotSpot(t){arguments.length<=0||(TStdVisibleComponent.call(this,t),this.Transparent(1))}function TStdTrandivel(t){arguments.length<=0||TStdVisibleComponent.call(this,t)}function TExtTreeView(t){arguments.length<=0||TStdTreeView.call(this,t)}function TStdAudioComponent(t){arguments.length<=0||TStdVisibleComponent.call(this,t)}function TStdTipComponent(t){arguments.length<=0||TStdVisibleComponent.call(this,t)}function TStdSplitContainer(t){if(!(arguments.length<=0)){TStdVisibleComponent.call(this,t);this.obj.style;pages[t.pageName].PageMode()!=pmEdit?this.obj.style.borderStyle="none":this.obj.className="it_framestyle7a "+this.attr_cssClass}}function TStdVideoComponent(t){arguments.length<=0||TStdVisibleComponent.call(this,t)}function TTransRichEdit(t){arguments.length<=0||TStdImage.call(this,t)}function Vector(t){t&&"undefinied"!=t&&0!=t||(t=100),this.data=new Array(t),this.increment=t,this.size=0}function TEventInfoList(){this.objectNames=new Vector(100),this.eventNames=new Vector(100),this.eventParams=new Vector(100)}function TEventRecPattern(t,e,n){if(!(arguments.length<=0)){this.owner=t,this.action=n,TEventInfoList.call(this);var i=e,r=i.indexOf("=");r>0?(this.patternName=i.substring(0,r),i=i.substring(r+1)):this.patternName="",(r=i.indexOf(":"))>0&&(this.comparisonType=AnyToInt(i.substring(r+1)),i=i.substring(0,r));for(var o,a=i.split(","),s=0;s<a.length;s++){a[s];var l=a[s].split("."),d=l[0];this.objectNames.addElement(d);var h=l[1];(r=h.indexOf("("))>0&&(o=h.substring(r+1),h=h.substring(0,r)),this.eventNames.addElement(h),")"==o?this.eventParams.addElement(""):"*)"==o?this.eventParams.addElement("*"):this.eventParams.addElement(o.substring(0,o.indexOf(")"))),this.owner.addToRecordedEvents(h,d)}}}function TEventRecorder(t){arguments.length<=0||(Vector.call(this,10),this.owner=t,this.recordedEvents=new TEventInfoList,this.eventHistory=new TEventInfoList)}function TStdScenario(t){arguments.length<=0||TStdVisibleComponent.call(this,t)}function TStdPageAction(t){arguments.length<=0||TStdVisibleComponent.call(this,t)}function TStdTimeline(t){arguments.length<=0||(TStdVisibleComponent.call(this,t),this.timePoints=[])}function CallTimeLineEvent(t,e,n){var i=AnyToObject(e,t);null!=i&&i.OnTimelineEventExec(i.timePoints[n].event)}function TStdFlashVideoPlayer(t){arguments.length<=0||(TStdVisibleComponent.call(this,t),this.playerName=t.id+"mp")}function FVPbindEvents(t,e,n){var i=$(t=StrCopy(t,1,StrLen(t)-2));return i=AnyToObject(i.obj,i.pageName),"timeupdate"==e?(i.Duration=DIV(n.duration,1),i.TimeLeft=DIV(n.duration,1)-DIV(n.currentTime,1),i.attr_Position=DIV(n.currentTime,1),void i.onCurrentTimeChange(n.duration,n.currentTime)):"durationchanged"!=e?"complete"==e?(i.State(0),i.onStateChange(0),void i.onComplete()):"play"==e?(i.State(1),void i.onStateChange(1)):"pause"==e?(i.State(2),void i.onStateChange(2)):void("volumechange"!=e||i.onVolumeChange(n.mute,DIV(100*n.volume,1))):void(i.Duration=DIV(n.duration,1))}function getUpdate(t,e,n,i){var r=$(i=i.substring(0,i.length-2));r=pages[r.pageName][r.obj],"state"==t&&r.State(e),"volume"==t&&(r.attr_Volume=AnyToInt(e)),"time"==t&&(r.attr_Position=AnyToInt(e),r.attr_Duration=AnyToInt(e+n),r.attr_TimeLeft=AnyToInt(n),r.onpltime(),0==r.attr_TimeLeft&&r.onplend())}function TStdHTML5VideoPlayer(t){arguments.length<=0||(TStdVisibleComponent.call(this,t),jQuery(this.obj.children[0]).bind("ended",this.onComplete),jQuery(this.obj.children[0]).bind("timeupdate",this.onCurrentTimeChange),jQuery(this.obj.children[0]).bind("volumechange",this.onVolumeChange),jQuery(this.obj.children[0]).bind("play",this.statechange1),jQuery(this.obj.children[0]).bind("pause",this.statechange2))}function TStdCustomVideoPlayer(t){if(!(arguments.length<=0)){TStdVisibleComponent.call(this,t);var e=this.obj.children[0],n=this;jQuery(e).bind("ended",this.onComplete),jQuery(e).bind("timeupdate",function(){cvp_timeupdate(e,n)}),jQuery(e).bind("volumechange",this.onVolumeChange),jQuery(e).bind("play",function(){cvp_start(e,n)}),jQuery(e).bind("pause",function(){cvp_pause(e,n)}),jQuery(e).bind("click",function(){cvp_togglePlay(e,n)});var i=cvp_getControl(this.cvp_bigBtn,this);jQuery(i).bind("click",function(){cvp_togglePlay(e,n)});var r=cvp_getControl(this.cvp_playBtn,this);jQuery(r).bind("click",function(){cvp_togglePlay(e,n)});var o=cvp_getControl(this.cvp_progress,this);jQuery(o).mousedown(function(){n.pbMouseDown=!0}),jQuery(o).mouseup(function(){n.pbMouseDown=!1}),jQuery(o).mouseleave(function(){n.pbMouseDown=!1}),jQuery(o).mousemove(function(t){n.pbMouseDown&&cvp_moveprogress(t,e,n)}),jQuery(o).bind("click",function(t){cvp_moveprogress(t,e,n)});var a=cvp_getControl(this.cvp_resizeBtn,this);jQuery(a).bind("click",function(){cvp_toggleFullScreen(n,this)}),jQuery(this.obj).bind("webkitfullscreenchange",function(t){cvp_onFullScreen(t,n)}),jQuery(this.obj).bind("mozfullscreenchange",function(t){cvp_onFullScreen(t,n)}),jQuery(this.obj).bind("fullscreenchange",function(t){cvp_onFullScreen(t,n)}),jQuery(this.obj).bind("MSFullscreenChange",function(t){cvp_onFullScreen(t,n)});var s=cvp_getControl(this.cvp_subTitleBtn,this);jQuery(s).bind("click",function(){cvp_toggleSubTitle(e,n)});var l=cvp_getControl(this.cvp_volumeBtn,this);jQuery(l).bind("click",function(){cvp_toggleVolume(e,n)});var d=cvp_getControl(this.cvp_cover,this);jQuery(d).bind("dblclick",function(){cvp_toggleFullScreen(n,this)}),jQuery(d).bind("click",function(){cvp_togglePlay(e,n)}),jQuery(this.obj).bind("mousemove",function(t){cvp_mouseMove(t,n)}),jQuery(this.obj).bind("mouseleave",function(t){cvp_mouseLeave(t,n)})}}function cvp_togglePlay(t,e){var n=t.paused?"play":"pause";t[n](),cvp_playbuttonstate(t,e),"pause"==n?e.State(2):e.State(1),1==AnyToBool(e.ShowControls())&&cvp_showControls(1,e)}function cvp_moveprogress(t,e,n){cvp_pushprbar(t,e,n)}function cvp_getControl(t,e){if(null==e||null==e.obj)return null;if(t<=e.cvp_controls)return e.obj.children[t];var n=t-4;return e.obj.children[e.cvp_controls].children[n]}function cvp_playbuttonstate(t,e){var n=cvp_getControl(e.cvp_bigBtn,e),i=cvp_getControl(e.cvp_playBtn,e),r=e.pageName+e.Name()+"bigplaybtn";t.paused?n.innerHTML="<i id="+scDQ+r+scDQ+' class="cvp_bigplaybtn_i is_paused">':n.innerHTML="<i id="+scDQ+r+scDQ+'class="cvp_bigplaybtn_i is_playing">',t.paused?i.innerHTML='<i class="cvp_playbtn_i is_paused">':i.innerHTML='<i class="cvp_playbtn_i is_playing">'}function cvp_start(t,e){e.statechange1(),cvp_playbuttonstate(t,e)}function cvp_pause(t,e){e.statechange2(),cvp_playbuttonstate(t,e)}function cvp_timeupdate(t,e){var n=t.currentTime/t.duration*100,i=cvp_getControl(e.cvp_progress,e);null!=i&&(i.children[0].style.flexBasis=n+"%",cvp_getControl(e.cvp_timecount,e).innerHTML=cvp_makeTime(t.currentTime)+" / "+cvp_makeTime(t.duration),e.TimeLeft(t.duration-t.currentTime),e.OnPlayingTime&&e.OnPlayingTime(t.duration,t.currentTime))}function cvp_makeTime(t){if(isNaN(t))return"00:00";var e="",n=t;t>=3600&&(e=Math.floor(t/3600),n=t%3600);var i=Math.floor(n/60);i<10&&(i="0"+i);var r=Math.floor(n%60);return r<10&&(r="0"+r),t="",""!=e&&(t=e+":"),t+=i+":"+r}function cvp_pushprbar(t,e,n){var i=cvp_getControl(n.cvp_progress,n),r=t.offsetX/i.offsetWidth*e.duration;e.currentTime=r}function cvp_toggleFullScreen(t,e){var n=t.obj;document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?(jQuery(n).removeClass("cvp_fullscreen"),document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen(),t.isFullscreen=!1,e.innerHTML='<i class="cvp_fullscreenbtn_i expand"></i>'):(jQuery(n).addClass("cvp_fullscreen"),n.requestFullscreen?n.requestFullscreen():n.mozRequestFullScreen?n.mozRequestFullScreen():n.webkitRequestFullscreen?n.webkitRequestFullscreen():n.msRequestFullscreen&&n.msRequestFullscreen(),t.isFullscreen=!0,e.innerHTML='<i class="cvp_fullscreenbtn_i compress"></i>')}function cvp_onFullScreen(t,e){var n=e.obj;!window.screenTop&&!window.screenY||(jQuery(n).removeClass("cvp_fullscreen"),cvp_getControl(e.cvp_resizeBtn,e).innerHTML='<i class="cvp_fullscreenbtn_i compress"></i>')}function cvp_mouseMove(t,e){0==e._TO?1==e.attr_ShowControls&&0!=AnyToInt(e.State())&&1==jQuery(cvp_getControl(3,e)).hasClass("hideControls")&&cvp_showControls(1,e):(clearTimeout(e._TO),e._TO=setTimeout(function(){cvp_showControls(0,e)},AnyToInt(e.attr_autoHide)))}function cvp_showControls(t,e){var n=cvp_getControl(3,e);0!=e._TO&&(clearTimeout(e._TO),e._TO=0),1==t&&1==jQuery(n).hasClass("hideControls")&&jQuery(n).removeClass("hideControls"),0==t&&0==jQuery(n).hasClass("hideControls")&&jQuery(n).addClass("hideControls"),1==t&&AnyToInt(e.attr_autoHide)>0&&(e._TO=setTimeout(function(){cvp_showControls(0,e)},AnyToInt(e.attr_autoHide)))}function cvp_mouseLeave(t,e){0!=e._TO&&(clearTimeout(e._TO),e._TO=0),cvp_showControls(0,e)}function cvp_toggleVolume(t,e){var n=cvp_getControl(e.cvp_volumeBtn,e),i=t.volume,r='<i class="cvp_volumebtn_i full"></i>';1==i?(i=0,r='<i class="cvp_volumebtn_i mute"></i>'):.5==i?(i=1,r='<i class="cvp_volumebtn_i full"></i>'):(i=.5,r='<i class="cvp_volumebtn_i medium"></i>'),t.volume=i,n.innerHTML=r}function cvp_toggleSubTitle(t,e){0==e.ShowTrackTitles()?e.ShowTrackTitles(!0):e.ShowTrackTitles(!1)}function cvp_initVolume(t,e){var n=cvp_getControl(e.cvp_volumeBtn,e),i=t.volume,r='<i class="cvp_volumebtn_i full"></i>';r=1==i?'<i class="cvp_volumebtn_i full"></i>':0==i?'<i class="cvp_volumebtn_i mute"></i>':'<i class="cvp_volumebtn_i medium"></i>',n.innerHTML=r}function TStdIdeaMouse(t){arguments.length<=0||TStdVisibleComponent.call(this,t)}function TXMLElement(t){arguments.length<=0||(null==t?TStdComponent.call(this,t):TStdVisibleComponent.call(this,t),IS.IE()&&(this.xmlDoc=new ActiveXObject("Microsoft.XMLDOM"),this.xmlDoc.async="false"))}function TSoapElement(t){arguments.length<=0||(TStdComponent.call(this,t),this.SOAPClient=new SOAPClient)}function TExtSoapElement(t){arguments.length<=0||(TStdComponent.call(this,t),this.pl=new SOAPClientParameters,this.SOAPClient=new SOAPClient,this.SOAPClient.parent=this)}function TSoapParameter(t){arguments.length<=0||(TStdComponent.call(this,t),this.pl=new SOAPClientParameters)}function TSoapResponse(t){arguments.length<=0||TStdComponent.call(this,t)}function isVisualChildOf(t){var e=t.relatedTarget?t.relatedTarget:"mouseout"==t.type?t.toElement:t.fromElement,n=extractEventTarget(t);return e&&3==e.nodeType&&(e=e.parentNode),!(void 0==e||e.tagName&&e.tagName.match(/^xul\:/i)||e&&e!=n&&!descendantOf(e,n))}function descendantOf(t,e){if(t.descendantOf)return t.descendantOf(e);if(t=$(t),e=$(e),t.compareDocumentPosition)return 8==(8&t.compareDocumentPosition(e));if(e.contains)return e.contains(t)&&e!==t;for(;t=t.parentNode;)if(t==e)return!0;return!1}function createPage(t,e,n){var i=document.createElement("div");return i.setAttribute("id",t),i.style.visibility="hidden",i.style.position="absolute",i.pageName=t,i.obj=t,new TStdPage(i)}function createBMPButton(t,e,n){var i=document.createElement("div"),r=document.createElement("img");e.obj.appendChild(i),i.appendChild(r),r.style.widht="100%",r.style.heigth="100%";var o=document.createElement("div");o.style.position="absolute",i.appendChild(o);var a=r.style;return a.widht="100%",a.heigth="auto",i.setAttribute("id",n+t),i.pageName=n,i.obj=t,e=null,new TStdBMPButton(i)}function createFocusableBMPButton(t,e,n){var i=document.createElement("a");i.href="#",i.tabIndex=0;var r=document.createElement("img");r.style.border="none",e.obj.appendChild(i),i.appendChild(r),r.style.widht="100%",r.style.heigth="100%";var o=document.createElement("div");i.appendChild(o);var a=r.style;return a.widht="100%",a.heigth="auto",a.textAlign="center",i.setAttribute("id",n+t),i.pageName=n,i.obj=t,e=null,new TStdBMPButton(i)}function createComboBox(t,e,n){var i=document.createElement("select");return e.obj.appendChild(i),i.setAttribute("id",n+t),i.pageName=n,i.obj=t,e=null,new TStdComboBox(i)}function createEdit(t,e,n){var i=document.createElement("input");return e.obj.appendChild(i),i.type="text",i.setAttribute("id",n+t),i.pageName=n,i.obj=t,e=null,new TStdEdit(i)}function createPasswordEdit(t,e,n){var i=document.createElement("input");return i.setAttribute("type","password"),e.obj.appendChild(i),i.setAttribute("id",n+t),i.pageName=n,i.obj=t,e=null,new TStdEdit(i)}function createFramedLabel(t,e,n){var i=document.createElement("div"),r=document.createElement("div");return e.obj.appendChild(i),i.appendChild(r),r.style.height="auto",i.setAttribute("id",n+t),i.pageName=n,i.obj=t,e=null,new TStdFramedLabel(i)}function createHotSpot(t,e,n){var i=document.createElement("div"),r=document.createElement("div");return e.obj.appendChild(i),i.appendChild(r),r.style.height="100%",r.style.width="100%",i.pageName=n,i.setAttribute("id",n+t),i.obj=t,e=null,new TStdHotSpot(i)}function createHTMLViewer(t,e,n){var i=document.createElement("div");return e.obj.appendChild(i),i.setAttribute("id",n+t),i.pageName=n,i.obj=t,e=null,new TStdHTMLViewer(i)}function createPPTViewer(t,e,n){var i=document.createElement("div");return e.obj.appendChild(i),i.setAttribute("id",n+t),i.pageName=n,i.obj=t,e=null,new TStdPPTViewer(i)}function createPDFViewer(t,e,n){var i=document.createElement("div");return e.obj.appendChild(i),i.setAttribute("id",n+t),i.obj=t,i.pageName=n,e=null,new TStdPDFViewer(i)}function createCMViewer(t,e,n){var i=document.createElement("div");return e.obj.appendChild(i),i.setAttribute("id",n+t),i.style.overflow="hidden",i.obj=t,i.pageName=n,e=null,new TStdCMViewer(i)}function createVisibleObject(t,e,n){var i=document.createElement("div");return e.obj.appendChild(i),i.setAttribute("id",n+t),i.pageName=n,i.obj=t,e=null,new TStdVisibleComponent(i)}function createTimeline(t,e,n){var i=document.createElement("div");return e.obj.appendChild(i),i.setAttribute("id",n+t),i.pageName=n,i.obj=t,e=null,new TStdTimeline(i)}function createIdeaMouse(t,e,n){var i=document.createElement("img");return e.obj.appendChild(i),i.setAttribute("id",n+t),i.pageName=n,i.obj=t,e=null,new TStdIdeaMouse(i)}function createAudioComment(t,e,n){var i=document.createElement("div");return e.obj.appendChild(i),i.setAttribute("id",n+t),i.pageName=n,i.obj=t,e=null,new TStdAudioComponent(i)}function createTipComponent(t,e,n){var i=document.createElement("div");return e.obj.appendChild(i),i.setAttribute("id",n+t),i.pageName=n,i.obj=t,e=null,new TStdTipComponent(i)}function createGlobalTipComponent(t){var e=document.createElement("div");e.setAttribute("id",t),e.obj=t,newTipComp=new TStdTipComponent(e),newTipComp.BGColor(Variablen.GlossarSettings.BGColor()),newTipComp.BorderColor(Variablen.GlossarSettings.BorderColor()),newTipComp.BorderWidth(Variablen.GlossarSettings.Borderwidth()),newTipComp.CloseBtn(Variablen.GlossarSettings.CloseBtn()),newTipComp.Duration(Variablen.GlossarSettings.Duration()),newTipComp.Height(Variablen.GlossarSettings.Height()),newTipComp.FontSize(Variablen.GlossarSettings.FontSize()),newTipComp.FontWeight(Variablen.GlossarSettings.FontWeight()),newTipComp.FontColor(Variablen.GlossarSettings.FontColor()),newTipComp.TitleFontSize(Variablen.GlossarSettings.TitleFontSize()),newTipComp.TitleFontColor(Variablen.GlossarSettings.TitleFontColor()),newTipComp.TitleBGColor(Variablen.GlossarSettings.TitleBGColor()),newTipComp.Sticky(Variablen.GlossarSettings.Sticky());var n=convertFontName(Variablen.GlossarSettings.FontFace());return newTipComp.FontFace(n),n=convertFontName(Variablen.GlossarSettings.TitleFontFace()),newTipComp.TitleFontFace(n),newTipComp}function createVideoComment(t,e,n){var i=document.createElement("div");return e.obj.appendChild(i),i.setAttribute("id",n+t),i.pageName=n,i.obj=t,e=null,new TStdVideoComponent(i)}function createPageMsg(t,e,n){var i=document.createElement("label");e.obj.appendChild(i);var r=document.createElement("div");return i.appendChild(r),i.setAttribute("id",n+t),i.pageName=n,i.obj=t,r=null,e=null,new TStdVisibleComponent(i)}function createImage(t,e,n){var i=document.createElement("img");return e.obj.appendChild(i),i.setAttribute("id",n+t),i.pageName=n,i.obj=t,e=null,new TStdImage(i)}function createFocusableImage(t,e,n){var i=document.createElement("a"),r=document.createElement("img");return r.style.border="none",e.obj.appendChild(i),i.appendChild(r),i.href="#",i.tabIndex=0,r.style.width="100%",r.style.height="100%",i.setAttribute("id",n+t),i.pageName=n,i.obj=t,e=null,new TStdImage(i)}function createTTransRichEdit(t,e,n){var i=document.createElement("img");return e.obj.appendChild(i),i.setAttribute("id",n+t),i.pageName=n,e=null,new TTransRichEdit(i)}function createBackground(t,e,n){var i=document.createElement("div");return e.obj.appendChild(i),i.setAttribute("id",n+t),i.pageName=n,i.obj=t,e=null,new TStdBackground(i)}function createLabel(t,e,n){var i=document.createElement("div"),r=document.createElement("div");return e.obj.appendChild(i),i.appendChild(r),i.pageName=n,r.style.height="auto",i.setAttribute("id",n+t),i.obj=t,e=null,new TStdLabel(i)}function createFocusableLabel(t,e,n){var i=document.createElement("a");i.href="#",i.tabIndex=0;var r=document.createElement("div");return e.obj.appendChild(i),i.appendChild(r),i.pageName=n,r.style.height="auto",i.setAttribute("id",n+t),i.obj=t,e=null,new TStdLabel(i)}function createListBox(t,e,n){var i=document.createElement("select");return e.obj.appendChild(i),i.setAttribute("id",n+t),i.setAttribute("size","2"),i.pageName=n,i.obj=t,e=null,new TStdListBox(i)}function createMemo(t,e,n){var i=document.createElement("textarea");return e.obj.appendChild(i),i.setAttribute("id",n+t),i.setAttribute("name",n+t),i.setAttribute("rows","3"),i.setAttribute("cols","30"),i.pageName=n,i.obj=t,e=null,new TStdMemo(i)}function createPanel(t,e,n){var i=document.createElement("div");e.obj.appendChild(i),i.setAttribute("id",n+t);var r=document.createElement("div");return i.appendChild(r),i.pageName=n,i.obj=t,e=null,r=null,new TStdPanel(i)}function createShape(t,e,n){var i=document.createElement("div");e.obj.appendChild(i),i.setAttribute("id",n+t);var r=document.createElement("canvas");return i.appendChild(r),i.pageName=n,i.obj=t,e=null,r=null,new TStdShape(i)}function createPicture(t,e,n){var i=document.createElement("div");e.obj.appendChild(i),i.setAttribute("id",n+t);var r=document.createElement("img");i.appendChild(r);var o=document.createElement("div");return i.appendChild(o),i.pageName=n,i.obj=t,e=null,r=null,o=null,new TStdPicture(i)}function createFlipCard(t,e,n){var i=document.createElement("div");e.obj.appendChild(i),i.setAttribute("id",n+t);var r=document.createElement("img");i.appendChild(r);var o=document.createElement("div");return i.appendChild(o),i.pageName=n,i.obj=t,e=null,r=null,o=null,new TStdFlipCard(i)}function createTextFlipCard(t,e,n){var i=document.createElement("div"),r=document.createElement("div");return e.obj.appendChild(i),i.appendChild(r),r.style.height="auto",i.setAttribute("id",n+t),i.pageName=n,i.obj=t,e=null,new TStdTextFlipCard(i)}function createTextOverPic(t,e,n){var i=document.createElement("div");e.obj.appendChild(i),i.setAttribute("id",n+t);var r=document.createElement("img");i.appendChild(r);var o=document.createElement("div");return i.appendChild(o),i.pageName=n,i.obj=t,e=null,r=null,o=null,new TStdTextOverPic(i)}function createTile(t,e,n){var i=document.createElement("div");e.obj.appendChild(i),i.setAttribute("id",n+t);var r=document.createElement("img");i.appendChild(r);var o=document.createElement("div");return i.appendChild(o),i.pageName=n,i.obj=t,e=null,r=null,o=null,new TStdTile(i)}function createTilePanel(t,e,n){var i=document.createElement("div");e.obj.appendChild(i),i.setAttribute("id",n+t);var r=document.createElement("div");return i.appendChild(r),i.pageName=n,i.obj=t,e=null,r=null,new TStdTilePanel(i)}function createZoomImg(t,e,n){var i=document.createElement("img");return e.obj.appendChild(i),i.setAttribute("id",n+t),i.pageName=n,i.obj=t,e=null,new TStdZoomImg(i)}function createPDFLink(t,e,n){var i=document.createElement("img");return e.obj.appendChild(i),i.setAttribute("id",n+t),i.pageName=n,i.obj=t,e=null,new TStdPDFLink(i)}function createLangComp(t,e,n){var i=document.createElement("div");return e.obj.appendChild(i),i.setAttribute("id",n+t),i.pageName=n,i.obj=t,e=null,new TStdLangComp(i)}function createVector(t,e,n){var i=document.createElement("div");e.obj.appendChild(i),i.setAttribute("id",n+t),i.style.visibility="hidden",i.style.display="none",i.pageName=n,i.obj=t,e=null;var r=new Vector;return r.obj=i,r}function createForm(t,e,n){var i=document.createElement("form");return e.obj.appendChild(i),i.setAttribute("id",n+t),i.pageName=n,i.obj=t,new TStdVisibleComponent(i)}function createTPanel(t,e,n){var i=document.createElement("div");e.obj.appendChild(i),i.setAttribute("id",n+t);var r=document.createElement("div");return i.appendChild(r),i.pageName=n,i.obj=t,e=null,r=null,new TStdTrandivel(i)}function createTimer(t,e,n){var i=document.createElement("div");e.obj.appendChild(i);var r=document.createElement("div");i.appendChild(r);var o=r.style;return o.backgroundColor=convertColor(8404992),o.position="absolute",o.margin="auto",i.style.borderStyle="inset",o.top=0+px,o.left=0+px,i.setAttribute("id",n+t),i.pageName=n,i.obj=t,r=null,e=null,o=null,new TStdTimer(i)}function createButton(t,e,n){var i=document.createElement("button");return e.obj.appendChild(i),i.setAttribute("id",n+t),i.pageName=n,i.obj=t,e=null,new TStdButton(i)}function createTStdCssButton(t,e,n){var i=document.createElement("button");return e.obj.appendChild(i),i.setAttribute("id",n+t),i.pageName=n,i.obj=t,e=null,new TStdCssButton(i)}function createTStdjqSlider(t,e,n){var i=document.createElement("div");return e.obj.appendChild(i),i.setAttribute("id",n+t),i.pageName=n,i.obj=t,e=null,new TStdjqSlider(i)}function createTStdSpinButton(t,e,n){var i=document.createElement("div");e.obj.appendChild(i);var r=n+t;i.setAttribute("class","field switch");var o=document.createElement("label");o.setAttribute("id",r+"_on"),o.setAttribute("class","cb-enable");var a=document.createElement("span");o.appendChild(a);var s=document.createElement("label");s.setAttribute("id",r+"_off"),s.setAttribute("class","cb-disable selected");var l=document.createElement("span");return s.appendChild(l),i.appendChild(o),i.appendChild(s),i.setAttribute("id",r),i.pageName=n,a=null,l=null,o=null,s=null,i.obj=t,e=null,new TStdSpinButton(i)}function createClickPresiAssi(t,e,n){var i=document.createElement("div");e.obj.appendChild(i);var r=document.createElement("img");return r.src=IDEAIMGSCRIPTDIR+"cpa.png",i.appendChild(r),i.setAttribute("id",n+t),i.pageName=n,i.obj=t,r=null,e=null,new TStdPresiAssi(i)}function createAudioTimePresiAssi(t,e,n){var i=document.createElement("div");e.obj.appendChild(i);var r=document.createElement("img");return r.src=IDEAIMGSCRIPTDIR+"atpa.png",i.appendChild(r),i.setAttribute("id",n+t),i.pageName=n,i.obj=t,r=null,e=null,new TStdPresiAssi(i)}function createBitBtn(t,e,n){var i=document.createElement("button");return e.obj.appendChild(i),i.setAttribute("id",n+t),i.pageName=n,i.obj=t,e=null,new TStdBitBtn(i)}function createSpeedButton(t,e,n){var i=document.createElement("button");return e.obj.appendChild(i),i.setAttribute("id",n+t),i.pageName=n,i.obj=t,e=null,new TStdSpeedButton(i)}function createRadioButton(t,e,n){var i=document.createElement("div");i.style.padding=0+px,e.obj.appendChild(i);var r=document.createElement("input");r.type="radio",r.setAttribute("id","idearb_"+n+t),r.setAttribute("value","idearb_"+n+t),r.setAttribute("name","radio"),r.style.margin=0,r.style.padding=0,i.appendChild(r);var o=document.createElement("span");return i.appendChild(o),o.setAttribute("id","text_"+n+t),o.style.verticalAlign="middle",i.firstChild.style.verticalAlign="middle",o.style.marginLeft=3+px,i.setAttribute("id",n+t),i.pageName=n,i.obj=t,e=null,o=null,r=null,new TStdRadioButton(i)}function createFocusRadioButton(t,e,n){var i=null;try{i=document.createElement("<INPUT id="+n+t+' type="radio" value="radiobtn" name="radio"/>')}catch(e){(i=document.createElement("input")).setAttribute("id",n+t),i.type="radio",i.name="radio",i.value="radiobtn"}var r=i.style;return r.verticalAlign="middle",r.padding=0,r.margin=0,i.tabIndex=0,e.obj.appendChild(i),i.pageName=n,i.obj=t,e=null,new TStdFocusRadioButton(i)}function createCheckBox(t,e,n){var i=document.createElement("div");e.obj.appendChild(i);var r=document.createElement("input");r.type="checkbox",i.appendChild(r);var o=document.createElement("span"),a="idearb_"+n+t;i.appendChild(o);var s=r.style;return s.verticalAlign="middle",s.padding=0,s.margin=0,s=null,r.setAttribute("id",a),r.setAttribute("name",a),o.style.verticalAlign="middle",o.style.marginLeft=3+px,i.setAttribute("id",n+t),i.pageName=n,i.obj=t,r=null,s=null,e=null,o=null,new TStdCheckBox(i)}function createFlashPlayer(t,e,n){var i=document.createElement("div");return e.obj.appendChild(i),i.setAttribute("id",n+t),i.pageName=n,i.obj=t,e=null,new TStdFlashPlayer(i)}function createVideoFlashPlayer(t,e,n){var i=document.createElement("div");return e.obj.appendChild(i),i.setAttribute("id",n+t),i.pageName=n,i.obj=t,e=null,new TStdFlashVideoPlayer(i)}function createVideoPlayer(t,e,n,i){if(!supports_video())return createVideoFlashPlayer(t,e,n);var r=document.createElement("div");if(e.obj.appendChild(r),r.setAttribute("id",n+t),r.pageName=n,r.obj=t,supports_video()){var o=document.createElement("video");r.appendChild(o),o.style.width="100%",o.style.height="100%"}return new TStdHTML5VideoPlayer(r)}function createCustomVideoPlayer(t,e,n){if(!supports_video())return createVideoFlashPlayer(t,e,n);var i=document.createElement("div");if(e.obj.appendChild(i),i.setAttribute("id",n+t),i.setAttribute("class","cvp_player"),i.pageName=n,i.obj=t,supports_video()){var r=document.createElement("video");i.appendChild(r),r.style.width="100%",r.style.height="100%";var o=document.createElement("div");o.setAttribute("id",n+t+"_cover"),o.setAttribute("class","cvp_cover"),i.appendChild(o);var a=document.createElement("button");a.setAttribute("id",n+t+"_bigplaybtn"),a.setAttribute("class","cvp_bigplaybtn");var s=document.createElement("i");s.setAttribute("class","cvp_bigplaybtn_i is_paused"),a.appendChild(s),i.appendChild(a);var l=document.createElement("div");l.setAttribute("id",n+t+"_controlpanel"),l.setAttribute("class","cvp_controlpanel");var d=document.createElement("button");d.setAttribute("id",n+t+"_playbtn"),d.setAttribute("class","cvp_playbtn");var h=document.createElement("i");h.setAttribute("class","cvp_playbtn_i is_paused"),d.appendChild(h),l.appendChild(d);var u=document.createElement("div");u.setAttribute("id",n+t+"timecount"),u.setAttribute("class","cvp_timecount"),l.appendChild(u);var c=document.createElement("div");c.setAttribute("id",n+t+"_progressbar"),c.setAttribute("class","cvp_progressbar");var p=document.createElement("div");p.setAttribute("id",n+t+"_progressfilled"),p.setAttribute("class","cvp_progressfilled"),c.appendChild(p),l.appendChild(c);var m=document.createElement("button");m.setAttribute("id",n+t+"_subtitlebtn"),m.setAttribute("class","cvp_subtitlebtn");var g=document.createElement("i");g.setAttribute("class","cvp_subtitlebtn_i mute"),m.appendChild(g),l.appendChild(m);var f=document.createElement("button");f.setAttribute("id",n+t+"_volumebtn"),f.setAttribute("class","cvp_volumebtn");var T=document.createElement("i");T.setAttribute("class","cvp_volumebtn_i medium"),f.appendChild(T),l.appendChild(f);var y=document.createElement("button");y.setAttribute("id",n+t+"_fullscreenbtn"),y.setAttribute("class","cvp_fullscreenbtn");var b=document.createElement("i");b.setAttribute("class","cvp_fullscreenbtn_i expand"),y.appendChild(b),l.appendChild(y),i.appendChild(l)}return new TStdCustomVideoPlayer(i)}function createAudioPlayer(t,e,n){if(!supports_mp3())return createAudioFlashPlayer(t,e,n);var i=document.createElement("div");if(e.obj.appendChild(i),i.setAttribute("id",n+t),i.pageName=n,i.obj=t,supports_mp3()){var r=document.createElement("audio");i.appendChild(r),r.style.width=i.width,r.style.height=i.height}return new TStdAudioPlayer(i)}function createAudioFlashPlayer(t,e,n){var i=document.createElement("div");return e.obj.appendChild(i),i.setAttribute("id",n+t),i.pageName=n,i.obj=t,e=null,new TStdFlashAudioPlayer(i)}function createExtTreeView(t,e,n){var i=document.createElement("div");return e.obj.appendChild(i),i.setAttribute("id",n+t),i.pageName=n,i.obj=t,new TExtTreeView(i)}function createTreeView(t,e,n){var i=document.createElement("div");return e.obj.appendChild(i),i.setAttribute("id",n+t),i.pageName=n,i.obj=t,new TStdTreeView(i)}function createScenario(t,e,n){var i=document.createElement("div");return e.obj.appendChild(i),i.setAttribute("id",n+t),i.pageName=n,i.obj=t,new TStdScenario(i)}function createTStdSlider(t,e,n){var i=document.createElement("div");return e.obj.appendChild(i),i.setAttribute("id",n+t),i.pageName=n,i.obj=t,new TStdSlider(i)}function createPageaction(t,e,n){var i=document.createElement("div");return e.obj.appendChild(i),i.setAttribute("id",n+t),i.pageName=n,i.obj=t,new TStdPageAction(i)}function createXMLElement(t,e,n){var i=document.createElement("div");return e.obj.appendChild(i),i.setAttribute("id",n+t),i.pageName=n,i.obj=t,e=null,new TXMLElement(i)}function createSoapElement(t,e,n){var i=document.createElement("div");return e.obj.appendChild(i),i.setAttribute("id",n+t),i.pageName=n,i.obj=t,new TSoapElement(i)}function createExtSoapElement(t,e,n){var i=document.createElement("div");return e.obj.appendChild(i),i.setAttribute("id",n+t),i.pageName=n,i.obj=t,new TExtSoapElement(i)}function createSoapParameter(t,e,n){var i=document.createElement("div");return e.obj.appendChild(i),i.setAttribute("id",n+t),i.pageName=n,i.obj=t,new TSoapParameter(i)}function createSoapResponse(t,e,n){var i=document.createElement("div");return e.obj.appendChild(i),i.setAttribute("id",n+t),i.pageName=n,i.obj=t,new TSoapResponse(i)}function createElementList(t,e,n){var i=document.createElement("ul"),r=document.createElement("li");return i.setAttribute("id",n+t),i.style.display="inline-block",i.pageName=n,i.appendChild(r),e.appendChild(i),i.obj=t,new TStdElementList(i)}function createNaviElementList(t,e,n){var i=document.createElement("ul");return i.setAttribute("id",n+t),i.style.display="inline-block",i.pageName=n,e.appendChild(i),i.obj=t,new TStdNaviElementList(i)}function createSplitContainer(t,e,n){var i=document.createElement("div");return e.obj.appendChild(i),i.setAttribute("id",n+t),i.pageName=n,i.obj=t,e=null,new TStdSplitContainer(i)}function stripAlpha(t){return t.replace(/alpha\([^\)]*\)/gi,"")}function setOpacity(t,e,n){if(e=n?AnyToObject(e,n):AnyToObject(e),IS.IE())var i=10*t;if(null!=e){e.obj&&!e.style&&(e=e.obj);var r=e.style,o=r.filter;(t/=10)>=1&&(t=""),r.opacity=t,IS.IE()&&((t=i)<1&&(t=0),r.filter=t>=100?"":stripAlpha(o)+"alpha(opacity="+t+")",r=null,o=null)}return e=null,!1}function setOpacityHide(t,e){setOpacity(t,e)}function removeAllChilds(t){for(;t.hasChildNodes();)removeAllChilds(t.firstChild),t.removeChild(t.firstChild)}function thisMovie(t){return document.embeds[t]?document.embeds[t]:window.document[t]?window.document[t]:window[t]?window[t]:document[t]?document[t]:null}function loadFile(t,e){thisMovie(t).loadFile(e)}function sendEvent(t,e,n){thisMovie(t).sendEvent(e,n)}function purge(t){var e,n,i,r=t.attributes;if(r)for(n=r.length,e=0;e<n;e+=1)"function"==typeof t[i=r[e].name]&&(delete t[i],t[i]=null);if(r=t.childNodes)for(n=r.length,e=0;e<n;e+=1)purge(t.childNodes[e])}function removeXMLObject(t){for(var e=t.length,n=0;n<e;n++)for(var i in t)"function"==typeof t[i]&&(t[i]=null);var r=t.childNodes;if(r){var o=r.length;for(n=0;n<o;n++)removeXMLObject(t.childNodes[n])}}function renameAll(t,e){t.id&&(t.id=t.id+e);var n=t.childNodes,i=renameAll;if(n)for(var r=n.length,o=0;o<r;o++)i(t.childNodes[o],e)}function renameAllBack(t,e){t.obj&&(t.obj=t.obj.substring(0,t.obj.lastIndexOf(e)));var n=t.childNodes;if(n)for(var i=n.length,r=0;r<i;r++)renameAllBack(t.childNodes[r],e)}function hideToolTip(t){UnTip()}function createToolTipBox(t){Tip(t,BGCOLOR,"#FFFFFF",BORDERCOLOR,"#000000",DURATION,3e3,FONTFACE,"Verdana",FONTSIZE,"11px",OPACITY,80,PADDING,2,CLICKCLOSE,1)}Font.prototype={FontColor:function(t){return arguments.length?"TCssButton"==this.ideaobj.IdeaClass()?"#000000":(this.attr_FontColor=t,void(1==this.obj.disabled&&"TButton"==this.ideaobj.IdeaClass()||(this.obj.style.color=convertColor(t)))):this.attr_FontColor},FontName:function(t){return"TCssButton"==this.ideaobj.IdeaClass()?"See Css":arguments.length?(this.attr_FontName=t,void(this.obj.style.fontFamily=convertFontName(t))):this.attr_FontName},FontSize:function(t){return"TCssButton"==this.ideaobj.IdeaClass()?"0":arguments.length?void(isNumber(t=AnyToInt(t))&&(t++,t++,t++,this.attr_FontSize=t,this.obj.style.fontSize=t+px)):this.attr_FontSize},FontStyle:function(t){if("TCssButton"==this.ideaobj.IdeaClass())return"0";if(!arguments.length)return this.attr_FontStyle;this.attr_FontStyle=t;var e=this.obj.style;null!=e&&(t=AnyToInt(t),e.fontWeight=(t&FSBOLD)==FSBOLD?"bold":"normal",e.fontStyle=(t&FSITALIC)==FSITALIC?"italic":"normal",e.textDecoration=(t&FSSTRIKEOUT)==FSSTRIKEOUT?"line-through":"",e.textDecoration=(t&FSUNDERLINE)==FSUNDERLINE?"underline":"",e=null)}},Items.prototype={CommaText:function(t){if(!arguments.length){for(var e=new StringBuffer,n=this.obj.options,i=n.length,r=0;r<i;r++){var o=n[r].value;(o.indexOf(",")>=0||o.indexOf('"')>=0||""==o)&&(o=this.QuotedStr(o,'"')),e.append(o),i>r+1&&e.append(",")}return e.toString()}if(this.ClearItems(),(t=AnyToStr(t)).indexOf(",")<0)""!=t&&(this.obj.options[0]=new Option(t,t,!1,!1));else if(""!=t){t=t.replace(/\r/g,"");var a=(t=this.parseCommaText(t)).split("\r"),s=a.length;for(r=0;r<s;r++){var l=AnyToStr(a[r]);l.length>1&&'"'==l.charAt(0)&&'"'==l.charAt(l.length-1)?(l=this.ExtractQuotedStr(l,'"'),this.obj.options[r]=new Option(l,l,!1,!1)):""!=l&&(this.obj.options[r]=new Option(l,l,!1,!1))}this.obj.options.selectedIndex=-1}},QuotedStr:function(t,e){return e+(t=(t=AnyToStr(t)).replace(new RegExp(e,"g"),e+e))+e},ExtractQuotedStr:function(t,e){if(t.charAt(0)!=e)return"";var n="",i=(t=(t=t.substr(1)).substr(0,t.length-1)).indexOf(e+e);if(i<0)return t;for(;i>=0;)n=n+t.substr(0,i)+'"',i=(t=t.substr(i+2)).indexOf(e+e);return n+t},SetText:function(t){this.ClearItems();var e=0;if(""!=(t=(t=(t=(t=AnyToStr(t)).replace(/&#x0A;/g,"\r")).replace(/\n\r/g,"\r")).replace(/\n/g,"\r"))){var n=t.split("\r"),i=n.length;for(e=0;e<i;e++)e==i-1?""!=n[e]&&(this.obj.options[e]=new Option(n[e],n[e],!1,!1)):this.obj.options[e]=new Option(n[e],n[e],!1,!1);this.obj.options.selectedIndex=-1}},LoadFromFile:function(t){var e=ReadTextFile(t,!0,pages[this.intpageName]);this.SetText(e)},LoadfromFile:function(t){this.LoadFromFile(t)},setpageName:function(t){this.intPageName=t},GetText:function(){for(var t="",e=this.obj.options,n=e.length,i=0;i<n;i++)t+=e[i].value,i<n-1&&(t+="\n");return e=null,t},parseCommaText:function(t){return doParseCommaText(t)},GetItemCount:function(){return this.obj.options.length},GetItem:function(t){t=AnyToInt(t);var e=this.obj.options;return t>-1&&t<e.length?e[t].value:""},AddItem:function(t){var e=this.obj.options;e[e.length]=new Option(t,t,!1,!1);var n=e.length;return e=null,n},DeleteItem:function(t){var e=this.obj.options;t>-1&&t<e.length&&(e[t]=null),e=null},InsertItem:function(t,e){t=AnyToInt(t);var n=this.obj.options;if(t>=n.length)this.AddItem(e);else{-1==t&&(t=0);var i=n.length,r=null;for(n[i]=new Option(e,e,!1,!1);i>t;i--)(r=n[i]).text=n[i-1].text,r.value=n[i-1].value,r.defaultSelected=n[i-1].defaultSelected,r.selected=n[i-1].selected,r=null;n[t]=new Option(e,e,!1,!1),n=null}},GetItemIndex:function(t,e){var n=-1;isVarUndefined(e)&&(e=!1);for(var i=this.obj.options,r=i.length,o=0;o<r;o++)if(t==i[o].text){n=o;break}if(-1==n&&1==e)for(o=0;o<r;o++)if(i[o].text.toLowerCase().startsWith(t.toLowerCase())){n=o;break}return i=null,n},IndexOf:function(t,e){return isVarUndefined(e)&&(e=!1),this.GetItemIndex(t,e)},ItemIndex:function(t){return this.GetItemIndex(t)},ClearItems:function(){for(var t=this.obj.options,e=t.length,n=0;n<e;n++)t[0]=null;t=null},Copy:function(t,e,n){return e>t.length-1||e<0?"":t.length-e<n?t.substring(e):t.substring(e,e+n)}},NavigationElementItems.prototype={content:null,SetText:function(t){},LoadFromFile:function(t){var e=ReadTextFile(t,!0,pages[this.intpageName]);this.SetText(e)},appendNode:function(t,e,n,i,r){var o=document.createElement("li");e&&o.setAttribute("pageName",e),jQuery(o).addClass("navilistcontent");var a=document.createElement("a");if(a.value=t,a.href="#",jQuery(a).css("display","inline-block"),jQuery(a).css("width","100%"),o.appendChild(a),n){var s=document.createElement("img");s.className="navilistcontent-image";var l=pages[this.obj.pageName][this.obj.obj];s.src="TIdeaPage"==n?l._eGlyphNormal:l._eGlyphCollapsed,a.appendChild(s)}jQuery(a).on("touchstart",function(t){_listmovebefore=jQuery(this).parent()}),jQuery(a).on("pointerdown",function(t){_listmovebefore=jQuery(this).parent()}),jQuery(a).on("mousedown",function(t){_listmovebefore=jQuery(this).parent()}),jQuery(a).on("click",handleNaviListClick);var d=document.createElement("span");jQuery(d).text(t),jQuery(d).addClass("navilistcontent-text"),a.appendChild(d),r.appendChild(o)},LoadfromFile:function(t){this.LoadFromFile(t)},setpageName:function(t){this.intPageName=t},GetText:function(){return""},GetItemCount:function(){return jQuery(this.obj).find("li").size()},GetItem:function(t){return t=AnyToInt(t),jQuery(this.obj).find("li:eq("+t+")").find("a:first").text()},AddItem:function(t,e,n,i,r){return this.appendNode(t,e,n,i,r),jQuery(this.obj).find("li").size()},DeleteItem:function(t){var e=this.obj.options;t>-1&&t<e.length&&(e[t]=null),e=null},GetItemIndex:function(t){return-1},IndexOf:function(t,e){return this.GetItemIndex(t,e)},ItemIndex:function(t){return this.GetItemIndex(t)},ClearItems:function(){jQuery(this.obj).empty()},loadPageLib:function(t){t.startsWith("<?xml")&&(t=t.substring(t.lastIndexOf("?>")+2,t.length));var e=GetXMLDocFromString(t);this.content=e.cloneNode(!0),this.loadNodeLevelforPage("Seiten","Seiten")},getChildNodes:function(t){return getXMLnodeChildesByAttr(this.content,"Name",t)},loadNodeLevelforPage:function(t,e){var n=this.getChildNodes(t);if(n.length>0){var i;pages[this.obj.pageName][this.obj.obj].i_triggerEvent("OnNaviChapterChange",e),this.ClearItems();for(var r=0;r<n.length;r++)i=this.getChildNodes(n[r].getAttribute("Name")),this.AddItem(n[r].getAttribute("Caption"),n[r].getAttribute("Name"),n[r].nodeName,i);jQuery(this.obj).parents(".ui-page").page("destroy").page()}else 1!=AnyToInt(Variablen.System.Tablet())&&pages[this.obj.pageName]._hideNavigationMenue(),Jump(t)},getParentForNodeLevel:function(t){if(null!=(t=jQuery(this.obj).find("li:first").attr("pageName"))&&""!=t){var e=getXMLnodeParenByAttr(this.content,"Name",t);return 1==(e=getXMLnodeParenByAttr(this.content,"Name",e[0].getAttribute("Name"))).length&&"Menue"!==e[0].getAttribute("Name")?(this.loadNodeLevelforPage(e[0].getAttribute("Name"),e[0].getAttribute("Caption")),!1):(this.loadNodeLevelforPage("Seiten","Seiten"),!0)}return this.loadNodeLevelforPage("Seiten","Seiten"),!0},openToPage:function(t){var e=jQuery(this.obj).find('li[pagename="'+t+'"]');if(0==e.size()){var n=getXMLnodeParenByAttr(this.content,"Name",t);if(1==n.length&&"Menue"!==n[0].getAttribute("Name")){pages[this.obj.pageName][this.obj.obj].i_triggerEvent("OnNaviChapterChange",n[0].getAttribute("Caption"));var i=this.getChildNodes(n[0].getAttribute("Name"));if(i.length>0){var r;this.ClearItems();for(var o=0;o<i.length;o++)r=this.getChildNodes(i[o].getAttribute("Name")),this.AddItem(i[o].getAttribute("Caption"),i[o].getAttribute("Name"),i[o].nodeName,r)}}else this.loadNodeLevelforPage("Seiten","Seiten")}this.deselectItem(),(e=jQuery(this.obj).find('li[pagename="'+t+'"]')).changeColorTheme("a"),e.attr("id","select"),1!=AnyToInt(Variablen.System.Phone())&&this.scrollElementVisible(e[0].offsetTop,e[0],jQuery(this.obj).parent().parent())},deselectItem:function(){jQuery(this.obj).find("#select").changeColorTheme("c"),jQuery(this.obj).find("#select").attr("id","")},scrollElementVisible:function(t,e,n){var i=n[0].offsetHeight+n.scrollTop();(t<n.scrollTop()||t+e.offsetHeight>i)&&e.scrollIntoView(!1)},fillNodesfromXML:function(t,e,n,i){for(var r,o=e.childNodes.length,a=0;a<o;a++)if(r=e.childNodes[a],this.AddItem(r.getAttribute("Caption"),r.getAttribute("Name"),r.nodeName,n,i),n++,r.hasChildNodes()||r.nodeName.toLowerCase()==cTStdOrganization.toLowerCase()){jQuery(this.obj).find("li").last().addClass("navilistcontent-folder close");var s=document.createElement("ul");jQuery(s).hide(),jQuery(s).addClass("close"),jQuery(this.obj).find("li").last().append(s),n=this.fillNodesfromXML(void 0,r,n,s)}return n}},ElementList.prototype={content:null,CommaText:function(t,e){if(!arguments.length)return"";arguments.length<2&&(e=!1),this.ClearItems();if((t=AnyToStr(t)).indexOf(",")<0)""!=t&&this.appendNode(t,this.intPageName,e);else if(""!=t){t=t.replace(/\r/g,"");for(var n=(t=this.parseCommaText(t)).split("\r"),i=n.length,r=0;r<i;r++){var o=AnyToStr(n[r]);o.length>1&&'"'==o.charAt(0)&&'"'==o.charAt(o.length-1)?(o=this.ExtractQuotedStr(o,'"'),this.appendNode(o,this.intPageName,e)):""!=o&&this.appendNode(o,this.intPageName,e)}}},QuotedStr:function(t,e){return e+(t=(t=AnyToStr(t)).replace(new RegExp(e,"g"),e+e))+e},ExtractQuotedStr:function(t,e){if(t.charAt(0)!=e)return"";var n="",i=(t=(t=t.substr(1)).substr(0,t.length-1)).indexOf(e+e);if(i<0)return t;for(;i>=0;)n=n+t.substr(0,i)+'"',i=(t=t.substr(i+2)).indexOf(e+e);return n+t},SetText:function(t,e){arguments.length<2&&(e=!1),this.ClearItems();var n=0;if(""!=(t=(t=(t=(t=AnyToStr(t)).replace(/&#x0A;/g,"\r")).replace(/\n\r/g,"\r")).replace(/\n/g,"\r"))){var i=t.split("\r"),r=i.length;for(n=0;n<r;n++)n==r-1?""!=i[n]&&this.appendNode(val,this.intPageName,e):this.appendNode(val,this.intPageName,e);var o=this.obj.obj,a=this.obj.pageName;(o=pages[a][o]).ItemIndex(o.ItemIndex())}},LoadFromFile:function(t){var e=ReadTextFile(t,!0,pages[this.intpageName]);this.SetText(e)},appendNode:function(t,e,n){var i=document.createElement("li");e&&i.setAttribute("pageName",e),i.className="listcontent";var r=document.createElement("a");r.value=t,r.href="javascript:void(0);",i.appendChild(r);var o=document.createElement("span");jQuery(o).text(t),r.appendChild(o),isTouchDevice()?(jQuery(i).on("touchstart",function(t){_listtouchstart=!0}),jQuery(i).on("touchmove",function(t){_listmovebefore=!0}),jQuery(i).on("pointerdown",function(t){_listtouchstart=!0}),1!=AnyToBool(n)&&jQuery(i).on("pointermove",function(t){_listmovebefore=!0})):jQuery(i).on("mousedown",function(t){_listtouchstart=!0}),jQuery(i).on("click",handleListClick),this.obj.appendChild(i)},LoadfromFile:function(t){this.LoadFromFile(t)},setpageName:function(t){this.intPageName=t},GetText:function(){return""},parseCommaText:function(t){if(t.indexOf(",")>-1){if(t.indexOf('"')<0)return t.replace(/,/g,"\r");for(var e=[],n=t.split(","),i=!1,r=[],o=0,a=0;a<n.length;a++)r.push(n[a]),o=1,n[a].indexOf('"')>-1&&(o=n[a].split('"').length%2),0==o&&(i=!i),i?r.push(","):(e.push(r.join("")),r=[]);t=e.join("\r")}return t},GetItemCount:function(){return jQuery(this.obj).find("li").size()},GetItem:function(t){return t=AnyToInt(t),jQuery(this.obj).find("li:eq("+t+")").find("a:first").text()},AddItem:function(t,e){return this.appendNode(t,this.intPageName,e),jQuery(this.obj).find("li").size()},DeleteItem:function(t){var e=this.obj.options;t>-1&&t<e.length&&(e[t]=null),e=null},InsertItem:function(t,e){t=AnyToInt(t);var n=this.obj.options;n.length,-1==t&&(t=0);n.length},GetItemIndex:function(t){return-1},IndexOf:function(t,e){return this.GetItemIndex(t,e)},ItemIndex:function(t){return this.GetItemIndex(t)},ClearItems:function(){jQuery(this.obj).empty()},Copy:function(t,e,n){return e>t.length-1||e<0?"":t.length-e<n?t.substring(e):t.substring(e,e+n)}},TStdComponent.prototype={onpgready:function(){this.OnPageReady&&this.OnPageReady(),this.isInit=!0},onpgshown:function(){this.OnPageShown&&this.OnPageShown()},onpgclose:function(){this.OnPageClose&&this.OnPageClose(),this.deInit()},deInit:function(t){this.obj=null},Parent:function(t){if(!arguments.length)return this.attr_Parent;this.attr_Parent=t},OffsetLeft:function(){return-1e3},OffsetTop:function(){return-1e3},OffsetWidth:function(){return 1},OffsetHeight:function(){return 1}},TStdVisibleComponent.prototype={childes:null,attr_zLayer:0,attr_cssDisplay:"",attr_Dragable:0,attr_Color:0,attr_cssClass:"",attr_Cursor:0,attr_Enabled:1,attr_Hint:"",attr_Height:0,attr_Left:0,attr_ShowHint:0,attr_Top:0,attr_Transparent:0,attr_Draggable:0,attr_Visible:1,attr_Width:0,attr_Font:null,attr_OffsetWidth:0,attr_OffsetHeight:0,attr_OffsetLeft:0,attr_OffsetTop:0,attr_WidthType:"2",attr_TopType:"0",attr_LeftType:"0",attr_HeightType:"0",attr_marginLeft:"0",attr_marginRight:"0",attr_marginBottom:"0",attr_marginTop:"0",attr_Borderradius:"0",attr_Wrap:0,appendObj:null,Font:null,attr_Name:"",attr_JSDisAppearEffect:0,attr_JSAppearEffect:0,attr_Parent:null,attr_TransparencyCover:10,attr_UserDefAttrList:"",attr_EditorComment:"",attr_Indent:0,attr___LI:0,attr___LN:0,attr___PT:0,attr_JSTabIndex:"",colorOrgValue:"",_internal_mobileView:null,drag:null,jg:null,isInit:!1,isShowInit:!1,dragorgValue:0,obj:null,orgValue:null,orgvaluz:"",rel_Top:ideafuncholder.positionholder.Top,rel_Left:ideafuncholder.positionholder.Left,rel_Height:ideafuncholder.positionholder.Height,rel_Width:ideafuncholder.positionholder.Width,TopType:ideafuncholder.positionholder.TopType,LeftType:ideafuncholder.positionholder.LeftType,HeightType:ideafuncholder.positionholder.HeightType,WidthType:ideafuncholder.positionholder.WidthType,i_removeEventList:null,FontUpdate:function(){},Top:function(){var t;return arguments.length>0&&(t=arguments[0]),this.mobileViewSet()?this.rel_Top(t):this.abs_Top(t)},Left:function(){var t;return arguments.length>0&&(t=arguments[0]),this.mobileViewSet()?this.rel_Left(t):this.abs_Left(t)},Height:function(){var t;return arguments.length>0&&(t=arguments[0]),this.mobileViewSet()?this.rel_Height(t):this.abs_Height(t)},Width:function(){var t;return arguments.length>0&&(t=arguments[0]),this.mobileViewSet()?this.rel_Width(t):this.abs_Width(t)},mobileViewSet:function(){var t=pages[this.pageName];return!(!t||!t.int_mobileView)&&t.int_mobileView},cssClass:function(t){if(!arguments.length)return this.attr_cssClass;null!=t&&""!==t&&(jQuery(this.obj).removeClass(this.attr_cssClass).addClass(t),this.attr_cssClass=t)},setAsParent:function(t){var e=(t=AnyToObject(t)).getParentasComp();this.obj.appendChild(t.obj),this.addChild(t),e.removeChild(t),t.Parent(this.pageName+"."+this.Name())},zLayer:function(t){if(!arguments.length)return this.obj.style.zIndex;""==this.obj.style.zIndex&&this.nodeObject&&this.nodeObject.setAttribute("zLayer",t),this.obj.style.zIndex=t,this.orgvaluz=t,this.attr_zLayer=t},JSTabIndex:function(t){if(!arguments.length)return this.attr_JSTabIndex;""!=t&&(t=AnyToInt(t),isNaN(t)||(this.attr_JSTabIndex=t,this.obj.tabIndex=t))},Color:function(t){if(!arguments.length)return this.attr_Color;this.attr_Color=t,1!=this.attr_Transparent&&(this.obj.style.backgroundColor=convertColor(t)),this.colorOrgValue=convertColor(t)},focus:function(){pages[this.pageName].hasFocus(),window.focus();try{this.obj.focus()}catch(t){}},findPosX:function(){return _findPosX(this.obj)},findPosY:function(){return _findPosY(this.obj)},Cursor:function(t){if(!arguments.length)return this.attr_Cursor;this.attr_Cursor=t,this.obj.style.cursor=convertCursor(t)},Draggable:function(t){if(!arguments.length)return this.attr_Draggable;t=AnyToInt(t),this.attr_Draggable=t,this.getSizeObj().draggable=AnyToBool(t),t?jQuery(this.getSizeObj()).css("touch-action","none").css("ms-touch-action","none"):jQuery(this.getSizeObj()).css("touch-action","auto").css("ms-touch-action","auto")},Dragable:function(t){if(!arguments.length)return this.attr_Dragable;t=AnyToInt(t),this.attr_Dragable=t,this.dragorgValue=t,t?jQuery(this.getSizeObj()).css("touch-action","none").css("ms-touch-action","none"):jQuery(this.getSizeObj()).css("touch-action","auto").css("ms-touch-action","auto")},EditorComment:function(t){if(!arguments.length)return this.attr_EditorComment;this.attr_EditorComment=t},Enabled:function(t){if(!arguments.length)return this.attr_Enabled;if(0==(t="undefined"==t?1:AnyToInt(t))){var e=this.Dragable();this.Dragable(0),this.dragorgValue=e,this.attr_Enabled=t}else this.attr_Enabled=t,this.Dragable(this.dragorgValue);this.OnEnabled&&0==pages[this.pageName].PageMode()&&this.OnEnabled(t)},Hint:function(t){if(!arguments.length)return this.attr_Hint;this.attr_Hint=t},marginLeft:function(t){if(!arguments.length)return this.attr_marginLeft;this.attr_marginLeft=t,0!=AnyToInt(t)?this.obj.style.marginLeft=t+"px":this.obj.style.marginLeft=""},marginRight:function(t){if(!arguments.length)return this.attr_marginRight;this.attr_marginRight=t,0!=AnyToInt(t)?this.obj.style.marginRight=t+"px":this.obj.style.marginRight=""},marginTop:function(t){if(!arguments.length)return this.attr_marginTop;this.attr_marginTop=t,0!=AnyToInt(t)?this.obj.style.marginTop=t+"px":this.obj.style.marginTop=""},marginBottom:function(t){if(!arguments.length)return this.attr_marginBottom;this.attr_marginBottom=t,0!=AnyToInt(t)?this.obj.style.marginBottom=t+"px":this.obj.style.marginBottom=""},Borderradius:function(t){if(!arguments.length)return this.attr_Borderradius;this.attr_Borderradius=t,0!=AnyToInt(t)?this.obj.style.borderRadius=t+"px":this.obj.style.borderRadius=""},abs_Height:function(t){try{if(!arguments.length||void 0==arguments[0]){var e=this.obj,n=e.style.height;return n=n.substring(0,n.length-2),1!=this.attr_AutoSize&&isNumber(n)||(n=AnyToInt(e.offsetHeight)<=0?this.attr_Height:e.offsetHeight),AnyToInt(n)}(t=AnyToInt(t))<0&&(t=0),this.attr_Height=t,1==this.attr_AutoSize||isNaN(t)||(this.obj.style.height=this.attr_Height+px)}catch(t){return}},abs_Left:function(t){try{if(!arguments.length||void 0==arguments[0]){var e=this.obj.style.left;return AnyToInt(e=e.substring(0,e.length-2))}this.attr_Left=AnyToInt(t),isNaN(this.attr_Left)||(this.obj.style.left=this.attr_Left+px)}catch(t){return}},Parent:function(t){if(!arguments.length)return this.attr_Parent;this.attr_Parent=t},ShowHint:function(t){if(!arguments.length)return this.attr_ShowHint;this.attr_ShowHint=AnyToInt(t)},abs_Top:function(t){try{if(!arguments.length||void 0==arguments[0]){var e=this.obj.style.top;return AnyToInt(e=e.substring(0,e.length-2))}this.attr_Top=AnyToInt(t),isNaN(this.attr_Top)||(this.obj.style.top=this.attr_Top+px)}catch(t){return}},getAbsTop:function(){return getAbsScreenCoord(this.obj).y},getAbsLeft:function(){return getAbsScreenCoord(this.obj).x},Transparent:function(t){if(!arguments.length)return this.attr_Transparent;t=AnyToInt(t),this.attr_Transparent=t,1==t?this.obj.style.backgroundColor="transparent":null!=this.colorOrgValue&&(this.obj.style.backgroundColor=this.colorOrgValue)},OffsetHeight:function(){if(!arguments.length)return AnyToInt(this.obj.offsetHeight)},OffsetWidth:function(){if(!arguments.length)return AnyToInt(this.obj.offsetWidth)},OffsetTop:function(){if(!arguments.length){var t=this.getSizeObj().offsetTop;return AnyToInt(t+=getBOC(this))}},OffsetLeft:function(){if(!arguments.length){var t=this.getSizeObj(this).offsetLeft;return AnyToInt(t+=getBOC(this))}},abs_Width:function(t){try{if(!arguments.length||void 0==arguments[0]){var e=this.obj,n=e.style.width;return n=n.substring(0,n.length-2),1!=this.attr_AutoSize&&isNumber(n)?AnyToInt(n):AnyToInt(e.offsetWidth)<0?this.attr_Width:AnyToInt(e.offsetWidth)}this.attr_Width=AnyToInt(t),1==this.attr_AutoSize||isNaN(this.attr_Width)||(this.obj.style.width=this.attr_Width+px)}catch(t){return}},Name:function(t){if(!arguments.length)return this.attr_Name;if(""!=this.attr_Name&&this.attr_Name!=t){var e=pages[this.pageName];e[t]=this,e[this.pageName+t]=this;var n=this.obj;n.id=this.pageName+t,n.obj=t,delete e[this.attr_Name],delete e[this.pageName+this.attr_Name],this.obj=$(this.pageName+t),this.nodeObject.setAttribute("Name",t)}this.attr_Name=t},TransparencyCover:function(t){if(!arguments.length)return this.attr_TransparencyCover;t=AnyToInt(t),this.attr_TransparencyCover=t,this.Visible()&&setOpacity(t,this)},JSDisAppearEffect:function(t){if(!arguments.length)return this.attr_JSDisAppearEffect;this.attr_JSDisAppearEffect=t},JSAppearEffect:function(t){if(!arguments.length)return this.attr_JSAppearEffect;this.attr_JSAppearEffect=t},Indent:function(t){if(!arguments.length)return this.attr_Indent;t=AnyToInt(t),this.attr_Indent=t,t>=0&&(this.obj.style.padding=t+px)},isEnabled:function(){return 1==this.attr_Enabled},setVisible:function(t){this.attr_Visible=t},onpgready:function(){if(jQuery(this.obj).bind("_orientationchange",function(t){var e=this.obj,n=this.pageName,i=pages[n][e];i.OnOrientationChange&&null!=i.OnOrientationChange&&i.OnOrientationChange(t.orientation)}),1!=this.isInit){this.Dragable(this.Dragable());for(var t=pages[this.pageName],e=this.childes.length,n=this.childes,i=0;i<e;i++)n[i].Visible&&n[i].Visible(n[i].attr_Visible);this.OnInternalInit&&this.OnInternalInit(),this.OnPageReady&&0==pages[this.pageName].PageMode()&&this.OnPageReady(),e=this.childes.length;for(i=0;i<e;i++)n[i]!=this&&n[i].onpgready();if("TPageAction"==this.IdeaClass()){var r=GetParent(this);r.TimeLimit&&AnyToInt(r.TimeLimit())>0&&this.Name().startsWith("ZeitAb")&&(this.delayTime=AnyToInt(r.TimeLimit()),t.regForDelay[t.regForDelay.length]=this)}this.isInit=!0}},doOnEndEffect:function(t){var e=findIdeaObj(this.obj);if(null!=e){var n=pages[e.pageName];return n[e.obj].OnEndEffect&&n[e.obj].OnEndEffect(t),!0}},onpgshown:function(){if(!this.isShowInit){this.OnPageShown&&0==pages[this.pageName].PageMode()&&this.OnPageShown();for(var t=this.childes.length,e=this.childes,n=0;n<t;n++)e[n].onpgshown();this.isShowInit=!0}},onpgclose:function(){if(this.OnPageClose&&0==pages[this.pageName].PageMode()&&this.OnPageClose(),null!=this.drag&&(this.drag.destroy(),this.drag=null),null!=this.childes){var t=this.childes.length,e=null;for(t-=1;t>=0;t--)"TIdeaPage"==(e=this.childes[t]).IdeaClass()?ClosePage(e.Name()):e.onpgclose()}this.deInit()},doOnMouseUpAbs:function(t,e,n){if(0==pages[this.pageName].PageMode()){var i=findIdeaObj(this.obj);if(null==i)return;var r=pages[i.pageName];return r[i.obj].OnMouseUpAbs&&r[i.obj].OnMouseUpAbs(t,e,n),!0}},deInit:function(t){jQuery(this.obj).stop(!1,!1),IS.IE()&&(removeEvent(this.obj,"mouseenter",ICompsEvent.hoverworkin),removeEvent(this.obj,"mouseleave",ICompsEvent.hoverworkout),jQuery(this.obj).unbind("_orientationchange"));for(var e=0;e<this.i_removeEventList.length;e++)this.i_removeEventList[e].fn&&jQuery(document).unbind(this.i_removeEventList[e].en,this.i_removeEventList[e].fn);if(null!=this.childes){var n=(i=this.childes).length;for(e=0;e<n;e++)delete i[e],i[e]=null}if(null!=this.allComps){var i;for(n=(i=this.allComps).length,e=0;e<n;e++)delete i[e],i[e]=null}var r=pages[this.pageName];this.attr_Parent=null,delete this.attr_Font.obj,this.attr_Font.obj=null,this.attr_Font.ideaobj=null,delete this.nodeObject,this.nodeObject=null,this.attr_Font=null,this.Font=null,this.childes=null,delete r[this.Name()],r[this.Name()]=null,delete r[this.thePageName+this.Name()],r[this.thePageName+this.Name()]=null,this.obj.obj=null,delete this.obj,this.obj=null},Canvas:function(){return this.jg||(this.jg=new jsGraphics(this.obj)),this.jg},getParentasComp:function(){return this.attr_Parent.lastIndexOf?AnyToObject(this.attr_Parent.substring(this.attr_Parent.lastIndexOf(".")+1,this.attr_Parent.length),this.attr_Parent.substring(0,this.attr_Parent.indexOf("."))):this.attr_Parent},OnClick:function(t){var e="",n=pages[this.pageName];n.hasFocus();var i=n[this.Name()];i==this&&this.isEnabled()&&this.JScr_OnClick&&(e=this.JScr_OnClick(),null!=n&&i==this&&i.ExerciseGroup&&AnyToBool(i.ExerciseGroup)&&""!=i.ExerciseGroup()&&n.postProcessEvent("OnClick",e,this))},getSizeObj:function(){return this.obj},cssDisplay:function(t){if(arguments.length<=0)return this.attr_cssDisplay;this.attr_cssDisplay=t,this.getSizeObj().style.display=t},setDisplayMode:function(t){1==t&&(this.getSizeObj().style.display=this._orgDisplayMode),0==t&&("none"!=this.getSizeObj().style.display&&(this._orgDisplayMode=this.getSizeObj().style.display),this.getSizeObj().style.display="none")},Wrap:function(t){if(arguments.length<=0)return this.attr_Wrap;this.attr_Wrap=t,AnyToBool(t)?(jQuery("<br />").insertBefore("#"+this.obj.id),this.obj.style.verticalAlign="top"):jQuery(this.obj).prev("br").remove()}},extendBaseFunction(TStdVisibleComponent.prototype),TStdPage.prototype=new TStdVisibleComponent,TStdPage.prototype.supconst=TStdVisibleComponent,TStdPage.prototype.constructor=TStdPage,extendPageBaseFunction(TStdPage.prototype),TStdPage.prototype.attr_BackGround="",TStdPage.prototype.attr_BackgroundSize="",TStdPage.prototype.attr_BackgroundPosition="",TStdPage.prototype.attr_BackgroundRepeat="",TStdPage.prototype.attr_DisplayMode=0,TStdPage.prototype.attr_Position=0,TStdPage.prototype.attr_Borderstyle=0,TStdPage.prototype.attr__TranslationText="",TStdPage.prototype._PageMode=0,TStdPage.prototype._orgY=0,TStdPage.prototype._orgX=0,TStdPage.prototype.audioobj=null,TStdPage.prototype.videoobj=null,TStdPage.prototype.isplaying=!1,TStdPage.prototype.isInInit=!1,TStdPage.prototype.AudioTimer=null,TStdPage.prototype.isInit=!1,TStdPage.prototype.regForDelay=null,TStdPage.prototype.chgAttrOnTime=null,TStdPage.prototype.timeOutCalls=null,TStdPage.prototype.scenarios=null,TStdPage.prototype._callerPage=null,TStdPage.prototype.Transparent=function(t){if(!arguments.length)return this.attr_Transparent;t=AnyToInt(t),this.attr_Transparent=t,1==t?this.obj.style.backgroundColor="transparent":null!=this.colorOrgValue&&(this.obj.style.backgroundColor=this.colorOrgValue)},TStdPage.prototype.hasFocus=function(t){this.OnFocus&&0==this.PageMode()&&this.OnFocus()},TStdPage.prototype.zLayer=function(t){if(!arguments.length)return this.obj.style.zIndex;""==this.obj.style.zIndex&&this.stringcontentofsite&&this.stringcontentofsite.setAttribute("zLayer",t),this.obj.style.zIndex=t,this.orgvaluz=t,this.attr_zLayer=t},TStdPage.prototype.BackGround=function(t){if(!arguments.length)return this.attr_BackGround;this.attr_BackGround=t,t=expandmetavar(t,this.pageName),this.obj.style.backgroundImage="url("+t+")"},TStdPage.prototype.BackgroundSize=function(t){if(!arguments.length)return this.attr_BackgroundSize;this.attr_BackgroundSize=t;var e=this.obj.style;e.backgroundSize=t,e=null},TStdPage.prototype.BackgroundPosition=function(t){if(!arguments.length)return this.attr_BackgroundPosition;this.attr_BackgroundPosition=t;var e=this.obj.style;e.backgroundPosition=t,e=null},TStdPage.prototype.BackgroundRepeat=function(t){if(!arguments.length)return this.attr_BackgroundRepeat;this.attr_BackgroundRepeat=t;var e=this.obj.style;e.backgroundRepeat=t,e=null},TStdPage.prototype.DisplayMode=function(t){return arguments.length&&(this.attr_DisplayMode=t),this.attr_DisplayMode},TStdPage.prototype.Position=function(t){return arguments.length&&(this.attr_Position=Number(t)),this.attr_Position},TStdPage.prototype.PageMode=function(t){return arguments.length&&"number"==typeof(t=Number(t))&&(this._PageMode=t),this._PageMode},TStdPage.prototype.Borderstyle=function(t){return arguments.length&&(this.attr_Borderstyle=Number(t)),this.attr_Borderstyle},TStdPage.prototype._TranslationText=function(t){return arguments.length&&(this.attr__TranslationText=t),this.attr__TranslationText},TStdPage.prototype.Top=function(t){if(!arguments.length)return TStdVisibleComponent.prototype.Top.call(this);this.isInInit||(this._orgY=t,t=0),TStdVisibleComponent.prototype.Top.call(this,t)},TStdPage.prototype.OrgY=function(){return this._orgY},TStdPage.prototype.Left=function(t){if(!arguments.length)return TStdVisibleComponent.prototype.Left.call(this);this.isInInit||(this._orgX=t,t=0),TStdVisibleComponent.prototype.Left.call(this,t)},TStdPage.prototype.TopType=function(t){if(!arguments.length)return this.attr_TopType;this.attr_TopType=0,this._initTopType=!0,this.Top(this.Top())},TStdPage.prototype.LeftType=function(t){if(!arguments.length)return this.attr_LeftType;this.attr_LeftType=0,this._initTopType=!0,this.Left(this.Left())},TStdPage.prototype.OrgX=function(){return this._orgX},TStdPage.prototype.isPageInit=function(){return this.isInit},TStdPage.prototype.callerPage=function(t){if(!arguments.length)return this._callerPage;this._callerPage=t},TStdPage.prototype.PageIndex=function(){return PageIndex()},TStdPage.prototype.PageCount=function(){return PageCount()},TStdPage.prototype.GetAllChildCount=function(){return this.allComps.length},TStdPage.prototype.GetAllChildAtInd=function(t){return this.allComps[t]},TStdPage.prototype.getPageTime=function(){var t=new Date;return Math.round((t.getTime()-this.StartDate.getTime())/1e3)},TStdBackground.prototype=new TStdVisibleComponent,TStdBackground.prototype.constructor=TStdBackground,TStdBackground.prototype.Picture=function(t){if(arguments.length){this.attr_Picture=t,t=expandmetavar(t,this.pageName);var e=this.obj.style;e.backgroundImage="url("+t+")",e=null}return this.attr_Picture},TStdPresiAssi.prototype=new TStdVisibleComponent,TStdPresiAssi.prototype.constructor=TStdPresiAssi,TStdPresiAssi.prototype.onpgready=function(){this.Visible(0),TStdVisibleComponent.prototype.onpgready.call(this)},TStdImage.prototype=new TStdVisibleComponent,TStdImage.prototype.constructor=TStdImage,TStdImage.prototype.attr_Borderstyle=0,TStdImage.prototype.attr_Borderwidth=1,TStdImage.prototype.attr_BorderColor=CLBLACK,TStdImage.prototype.attr_Borderradius=0,TStdImage.prototype.attr_Picture=null,TStdImage.prototype.attr_FileName=null,TStdImage.prototype.attr_StrechMode=0,TStdImage.prototype.attr_orgWidth=0,TStdImage.prototype.attr_orgHeight=0,TStdImage.prototype.attr_Dragable=FALSE,TStdImage.prototype.attr_cssClass="",TStdImage.prototype.attr_altText="",TStdImage.prototype.Borderstyle=function(t){if(!arguments.length)return this.attr_Borderstyle;this.attr_Borderstyle=AnyToInt(t),pages[this.pageName].PageMode()==pmEdit&&0==this.attr_Borderstyle?(this.obj.className.indexOf("it_framestyle7a")<0&&(this.obj.className="it_framestyle7a "+this.obj.className),this.obj.style.borderStyle="dashed"):(this.obj.className=StrReplace(this.obj.className,"it_framestyle7a ",""),this.obj.className=StrReplace(this.obj.className,"it_framestyle7a",""),pages[this.pageName].PageMode()==pmEdit&&0!=this.attr_Borderstyle&&(this.obj.style.borderWidth=this.attr_Borderwidth+"px"),this.obj.style.borderStyle=1==t?"solid":"none"),this.BorderColor(this.attr_BorderColor)},TStdImage.prototype.Borderwidth=function(t){if(!arguments.length)return this.attr_Borderwidth;this.attr_Borderwidth=AnyToInt(t),pages[this.pageName].PageMode()!=pmEdit||0!=AnyToInt(t)&&0!=this.attr_Borderstyle?((pages[this.pageName].PageMode()!=pmEdit||AnyToInt(t)>0&&0!=this.attr_Borderstyle)&&(this.obj.className=StrReplace(this.obj.className,"it_framestyle7a ",""),this.obj.className=StrReplace(this.obj.className,"it_framestyle7a","")),this.obj.style.borderWidth=t+"px"):this.obj.className.indexOf("it_framestyle7a")<0&&(this.obj.className="it_framestyle7a "+this.obj.className)},TStdImage.prototype.BorderColor=function(t){if(!arguments.length)return this.attr_BorderColor;this.attr_BorderColor=AnyToInt(t),AnyToStr(t).toLowerCase().indexOf("rgb")<=0&&(t=convertColor(t)),this.obj.style.borderColor=t},TStdImage.prototype.Borderradius=function(t){if(!arguments.length)return this.attr_Borderradius;this.attr_Borderradius=AnyToInt(t),this.obj.style.borderRadius=t+"px"},TStdImage.prototype.orgWidth=function(t){if(!arguments.length)return this.attr_orgWidth;0==t&&(t=this.defSize),this.attr_orgWidth=t},TStdImage.prototype.orgHeight=function(t){if(!arguments.length)return this.attr_orgHeight;0==t&&(t=this.defSize),this.attr_orgHeight=t},TStdImage.prototype.Dragable=function(t){if(!arguments.length)return this.attr_Dragable;var e=AnyToInt(t);this.attr_Dragable=e,this.dragorgValue=e,0==pages[this.pageName].PageMode()&&this.SetDragCSS(t)},TStdImage.prototype.SetDragCSS=function(t){t?jQuery(this.obj).css({"moz-user-select":"auto","-webkit-user-select":"auto","-ms-user-select":"auto","user-select":"auto","-webkit-user-drag":"auto","user-drag":"auto"}):jQuery(this.obj).css({"moz-user-select":"none","-webkit-user-select":"none","-ms-user-select":"none","user-select":"none","-webkit-user-drag":"none","user-drag":"none"})},TStdImage.prototype.Picture=function(t){if(!arguments.length)return this.attr_Picture;this.attr_Picture=t,t=expandmetavar(t,this.pageName),this.loadImage(t)},TStdImage.prototype.FileName=function(t){if(!arguments.length)return this.attr_FileName;this.attr_FileName=t,t=expandmetavar(t,this.pageName),this.loadImage(t)},TStdImage.prototype.loadImage=function(t){this.obj.firstChild?this.obj.firstChild.src=url_libs+IDEAEMPTYGIF:this.obj.src=url_libs+IDEAEMPTYGIF,""!=t&&(this.obj.firstChild?this.obj.firstChild.src=t:this.obj.src=t),""==t&&pages[this.pageName].PageMode()==pmEdit?0==this.attr_Borderstyle?this.obj.className="it_basebgcolor4 it_framestyle7a it_imagebackground "+this.attr_cssClass:this.obj.className="it_basebgcolor4 it_imagebackground "+this.attr_cssClass:pages[this.pageName].PageMode()==pmEdit&&(0==this.attr_Borderstyle?this.obj.className="it_framestyle7a "+this.attr_cssClass:this.obj.className=this.attr_cssClass)},TStdImage.prototype.altText=function(t){if(!arguments.length)return this.attr_altText;this.attr_altText=t,this.obj.firstChild?this.obj.firstChild.alt=t:this.obj.alt=t},TStdImage.prototype.StretchMode=function(t){if(!arguments.length)return this.attr_StrechMode;t=AnyToInt(t),this.attr_StrechMode=t},TStdPicture.prototype=new TStdVisibleComponent,TStdPicture.prototype.constructor=TStdPicture,TStdPicture.prototype.attr_Borderstyle=0,TStdPicture.prototype.attr_Borderwidth=1,TStdPicture.prototype.attr_BorderColor=CLBLACK,TStdPicture.prototype.attr_Borderradius=0,TStdPicture.prototype.attr_Picture=null,TStdPicture.prototype.attr_FileName=null,TStdPicture.prototype.attr_orgWidth=0,TStdPicture.prototype.attr_orgHeight=0,TStdPicture.prototype.attr_Dragable=FALSE,TStdPicture.prototype.attr_cssClass="",TStdPicture.prototype.attr_Color=CLWHITE,TStdPicture.prototype.attr_Transparent="",TStdPicture.prototype.attr_altText="",TStdPicture.prototype.attr_SubtitleText="",TStdPicture.prototype.attr_Alignment="",TStdPicture.prototype.attr_ShowSubtitle=1,TStdPicture.prototype.onpgready=function(){this.Height(this.attr_height),TStdVisibleComponent.prototype.onpgready.call(this)},TStdPicture.prototype.Borderstyle=function(t){if(!arguments.length)return this.attr_Borderstyle;this.attr_Borderstyle=AnyToInt(t),pages[this.pageName].PageMode()==pmEdit&&0==this.attr_Borderstyle?(this.obj.className.indexOf("it_framestyle7a")<0&&(this.obj.className="it_framestyle7a "+this.obj.className),this.obj.style.borderStyle="dashed"):(this.obj.className=StrReplace(this.obj.className,"it_framestyle7a ",""),this.obj.className=StrReplace(this.obj.className,"it_framestyle7a",""),pages[this.pageName].PageMode()==pmEdit&&0!=this.attr_Borderstyle&&(this.obj.style.borderWidth=this.attr_Borderwidth+"px"),this.obj.style.borderStyle=1==t?"solid":"none"),this.BorderColor(this.attr_BorderColor)},TStdPicture.prototype.Borderwidth=function(t){if(!arguments.length)return this.attr_Borderwidth;this.attr_Borderwidth=AnyToInt(t),pages[this.pageName].PageMode()!=pmEdit||0!=AnyToInt(t)&&0!=this.attr_Borderstyle?((pages[this.pageName].PageMode()!=pmEdit||AnyToInt(t)>0&&0!=this.attr_Borderstyle)&&(this.obj.className=StrReplace(this.obj.className,"it_framestyle7a ",""),this.obj.className=StrReplace(this.obj.className,"it_framestyle7a","")),this.obj.style.borderWidth=t+"px"):this.obj.className.indexOf("it_framestyle7a")<0&&(this.obj.className="it_framestyle7a "+this.obj.className)},TStdPicture.prototype.BorderColor=function(t){if(!arguments.length)return this.attr_BorderColor;this.attr_BorderColor=AnyToInt(t),AnyToStr(t).toLowerCase().indexOf("rgb")<=0&&(t=convertColor(t)),this.obj.style.borderColor=t},TStdPicture.prototype.Borderradius=function(t){if(!arguments.length)return this.attr_Borderradius;this.attr_Borderradius=AnyToInt(t),this.obj.style.borderRadius=t+"px"},TStdPicture.prototype.Alignment=function(t){if(!arguments.length)return this.attr_Alignment;this.attr_Alignment=AnyToInt(t);var e="",n=this.obj.lastChild.style;switch(this.attr_Alignment){case TALEFTJUSTIFY:e="left";break;case TACENTER:e="center";break;case TARIGHTJUSTIFY:e="right"}n.textAlign=e},TStdPicture.prototype.orgWidth=function(t){if(!arguments.length)return this.attr_orgWidth;0==t&&(t=this.defSize),this.attr_orgWidth=t},TStdPicture.prototype.orgHeight=function(t){if(!arguments.length)return this.attr_orgHeight;0==t&&(t=this.defSize),this.attr_orgHeight=t},TStdPicture.prototype.Height=function(t){if(0==bEditModeResponsive&&0==detectTouchAndMobile.prototype.detectTablet()&&0==detectTouchAndMobile.prototype.detectPhone()){if(!arguments.length)return this.obj.offsetHeight;if(1==this.isInit)if(1==this.attr_ShowSubtitle){this.obj.lastChild.offsetHeight;var e=AnyToInt(this.OffsetHeight())-this.obj.firstChild.offsetHeight;this.obj.firstChild.height=t-e,this.obj.lastChild.top=this.obj.firstChild.height+1}else this.obj.firstChild.height=t;this.attr_height=t}else{if(!arguments.length)return this.obj.offsetHeight;this.obj.style.height="auto"}},TStdPicture.prototype.Dragable=function(t){if(!arguments.length)return this.attr_Dragable;var e=AnyToInt(t);if(this.attr_Dragable=e,this.dragorgValue=e,0==pages[this.pageName].PageMode()){this.SetDragCSS(t);null!=this.obj.firstChild&&(this.obj.firstChild.draggable=AnyToBool(t))}},TStdPicture.prototype.SetDragCSS=function(t){var e=null;null!=this.obj.firstChild?e=this.obj.firstChild:this.obj=this.obj.firstChild,t?jQuery(e).css({"moz-user-select":"auto","-webkit-user-select":"auto","-ms-user-select":"auto","user-select":"auto","-webkit-user-drag":"auto","user-drag":"auto"}):jQuery(e).css({"moz-user-select":"none","-webkit-user-select":"none","-ms-user-select":"none","user-select":"none","-webkit-user-drag":"none","user-drag":"none"})},TStdPicture.prototype.Color=function(t){if(!arguments.length)return this.attr_Color;this.attr_Color=t,1!=this.attr_Transparent&&(this.obj.style.backgroundColor=convertColor(t),this.obj.lastChild&&(this.obj.lastChild.style.backgroundColor=convertColor(t)))},TStdPicture.prototype.Transparent=function(t){if(!arguments.length)return this.attr_Transparent;this.attr_Transparent=t,1!=this.attr_Transparent?(this.obj.style.backgroundColor=convertColor(this.attr_Color),this.obj.lastChild&&(this.obj.lastChild.style.backgroundColor=convertColor(this.attr_Color))):(this.obj.style.backgroundColor="",this.obj.lastChild&&(this.obj.lastChild.style.backgroundColor=""))},TStdPicture.prototype.ShowSubtitle=function(t){if(!arguments.length)return this.attr_ShowSubtitle;var e=AnyToInt(t);this.attr_ShowSubtitle=e,0==e?jQuery(this.obj.lastChild).css("display","none"):jQuery(this.obj.lastChild).css("display","")},TStdPicture.prototype.Picture=function(t){if(!arguments.length)return this.attr_Picture;this.attr_Picture=t,t=expandmetavar(t,this.pageName),this.loadImage(t)},TStdPicture.prototype.FileName=function(t){if(!arguments.length)return this.attr_FileName;this.attr_FileName=t,t=expandmetavar(t,this.pageName),this.loadImage(t)},TStdPicture.prototype.loadImage=function(t){this.obj.firstChild.src=url_libs+IDEAEMPTYGIF,""!=t&&(this.obj.firstChild.src=t,this.obj.firstChild.style.width="100%"),""!=t&&pages[this.pageName].PageMode()==pmEdit&&(this.obj.className=""),""==t&&pages[this.pageName].PageMode()==pmEdit?0==this.attr_Borderstyle?this.obj.className="it_basebgcolor4 it_framestyle7a it_imagebackground it_picture "+this.attr_cssClass:this.obj.className="it_basebgcolor4 it_imagebackground it_picture "+this.attr_cssClass:(pages[this.pageName].PageMode()==pmEdit&&(0==this.attr_Borderstyle?this.obj.className="it_framestyle7a "+this.attr_cssClass:this.obj.className=this.attr_cssClass),this.obj.firstChild.style.width="100%")},TStdPicture.prototype.altText=function(t){if(!arguments.length)return this.attr_altText;this.attr_altText=t,this.obj.firstChild.alt=t},TStdPicture.prototype.SubtitleText=function(t){if(!arguments.length)return this.attr_SubtitleText;this.attr_SubtitleText=t,this.obj.lastChild.innerHTML=t},TStdPDFLink.prototype=new TStdImage,TStdPDFLink.prototype.constructor=TStdPDFLink,TStdFlipCard.prototype=new TStdPicture,TStdFlipCard.prototype.constructor=TStdFlipCard,TStdTextOverPic.prototype=new TStdPicture,TStdTextOverPic.prototype.constructor=TStdTextOverPic,TStdTile.prototype=new TStdTextOverPic,TStdTile.prototype.constructor=TStdTile,TStdZoomImg.prototype=new TStdImage,TStdZoomImg.prototype.constructor=TStdZoomImg,TStdLabel.prototype=new TStdVisibleComponent,TStdLabel.prototype.constructor=TStdLabel,TStdLabel.prototype.attr_Caption=null,TStdLabel.prototype.attr_AutoGlossar=null,TStdLabel.prototype.attr_AutoSize=null,TStdLabel.prototype.attr_Alignment=null,TStdLabel.prototype.attr_Layout=null,TStdLabel.prototype.attr_Scrollable=0,TStdLabel.prototype.attr_LabelMode=1,TStdLabel.prototype.LabelMode=function(t){if(!arguments.length)return this.attr_LabelMode;var e;(this.attr_LabelMode=AnyToInt(t),0==this.attr_LabelMode)?((e=this.obj.style).display="inline-block",(e=this.obj.firstChild.style).display="inline-block",e.width="auto",e.height="auto"):1==this.attr_LabelMode&&((e=this.obj.style).display="inline-table",(e=this.obj.firstChild.style).display="table-cell",e.height="100%",e.width="100%");this.AutoSize(this.attr_AutoSize),this.Alignment(this.attr_Alignment),this.Layout(this.attr_Layout)},TStdLabel.prototype.AutoSize=function(t){if(!arguments.length)return this.attr_AutoSize;if(this.attr_AutoSize=AnyToInt(t),1==this.attr_AutoSize)(e=(n=this.obj).firstChild.style).position="static",e.width="auto",e.marginTop=0+px,n.style.height="auto",n.style.width="auto";else if(this.isInit){var e,n=this.obj;if(1==this.attr_LabelMode)(e=n.firstChild.style).width="100%";n.style.height=n.offsetHeight,n.style.width=n.offsetWidth}},TStdLabel.prototype.Scrollable=function(t){return arguments.length&&(t=AnyToInt(t),this.attr_Scrollable=t,this.obj.style.overflow=1==t?"auto":"hidden"),this.attr_Scrollable},TStdLabel.prototype.AutoGlossar=function(t){if(!arguments.length)return this.attr_AutoGlossar;this.attr_AutoGlossar=AnyToInt(t)},TStdLabel.prototype.Caption=function(t){if(!arguments.length)return this.attr_Caption;t=replace(t,"&#x0A;","<br>"),this.attr_Caption=t,this.obj.firstChild.innerHTML=t,this.Layout(this.attr_Layout)},TStdLabel.prototype.Alignment=function(t){if(!arguments.length)return this.attr_Alignment;this.attr_Alignment=AnyToInt(t);var e="",n=this.obj.firstChild.style;switch(this.attr_Alignment){case TALEFTJUSTIFY:e="left";break;case TACENTER:0==this.attr_LabelMode&&(n.width="100%"),e="center";break;case TARIGHTJUSTIFY:e="right"}n.textAlign=e},TStdLabel.prototype.Layout=function(t){if(!arguments.length)return this.attr_Layout;if(this.attr_Layout=AnyToInt(t),1!=this.attr_AutoSize){var e=this.obj,n=e.firstChild.style;switch(this.attr_Layout){case 0:0==this.attr_LabelMode?(n.position="static",n.paddingTop="0"+px,n.paddingBottom="0"+px,n.marginTop="0"+px):n.verticalAlign="top";break;case 1:if(0==this.attr_LabelMode){n.position="static",n.paddingTop="0"+px,n.paddingBottom="0"+px,n.marginTop="";var i=(e.clientHeight-e.firstChild.offsetHeight)/2;i=i<1?0:i,n.marginTop=i+"px"}else n.verticalAlign="middle";break;case 2:0==this.attr_LabelMode?(n.position="absolute",n.marginTop="",n.marginBottom="0"+px,n.bottom="0px"):n.verticalAlign="bottom"}n=null}},TStdLabel.prototype.Height=function(t){if(!arguments.length)return TStdVisibleComponent.prototype.Height.call(this);TStdVisibleComponent.prototype.Height.call(this,t),this.isInit&&this.Layout(this.Layout())},TStdLabel.prototype.Indent=function(t){if(!arguments.length)return this.attr_Indent;t=AnyToInt(t),this.attr_Indent=t,t>=0&&(this.obj.firstChild.style.padding=t+px)},TStdLabel.prototype.onpgready=function(){this.Layout(this.Layout()),TStdVisibleComponent.prototype.onpgready.call(this)},TStdLabel.prototype.insertGlossar=function(){this.obj.firstChild.innerHTML=insertGlossar(this.Caption()),this.Layout(this.Layout())},TStdLabel.prototype.onpgshown=function(){var t=this.pageName,e=this.Name();if(window.setTimeout("_insertGlossar('"+e+"','"+t+"')",300),TStdVisibleComponent.prototype.onpgshown.call(this),0!=pages[this.pageName].PageMode()&&this.attr_ShowFrame&&0==this.attr_ShowFrame){var n=this.obj.style;n.borderStyle="dashed",n.borderWidth="1px",n.borderColor=convertColor(13421772)}},TStdTextFlipCard.prototype=new TStdLabel,TStdTextFlipCard.prototype.constructor=TStdTextFlipCard,TStdTextFlipCard.prototype.attr_FrameColor=0,TStdTextFlipCard.prototype.attr_FrameWidth=0,TStdTextFlipCard.prototype.attr_ShowFrame=0,TStdTextFlipCard.prototype.wfirst=!0,TStdTextFlipCard.prototype.hfirst=!0,TStdTextFlipCard.prototype.FrameColor=function(t){if(!arguments.length)return this.attr_FrameColor;this.attr_FrameColor=t,1==this.attr_ShowFrame&&(this.obj.style.borderColor=convertColor(t))},TStdTextFlipCard.prototype.FrameWidth=function(t){if(!arguments.length)return this.attr_FrameWidth;this.attr_FrameWidth=t,1==this.attr_ShowFrame&&(this.obj.style.borderWidth=Number(t)+px)},TStdTextFlipCard.prototype.ShowFrame=function(t){if(!arguments.length)return this.attr_ShowFrame;this.attr_ShowFrame=AnyToInt(t),1==this.attr_ShowFrame&&this.FrameWidth(this.attr_FrameWidth),pages[this.pageName].PageMode()==pmEdit&&0==this.attr_ShowFrame?(this.obj.className.indexOf("it_framestyle7a")<0&&(this.obj.className="it_framestyle7a "+this.obj.className),this.obj.style.borderStyle="dashed"):(this.obj.className=StrReplace(this.obj.className,"it_framestyle7a ",""),this.obj.className=StrReplace(this.obj.className,"it_framestyle7a",""),this.obj.style.borderStyle=1==t?"solid":"none"),this.FrameColor(this.attr_FrameColor)},TStdBMPButton.prototype=new TStdVisibleComponent,TStdBMPButton.prototype.constructor=TStdBMPButton,TStdBMPButton.prototype.attr_ActiveGlyph=null,TStdBMPButton.prototype.attr_Caption="",TStdBMPButton.prototype.attr_DownGlyph=null,TStdBMPButton.prototype.attr_UnEnGlyph=null,TStdBMPButton.prototype.attr_UpGlyph=null,TStdBMPButton.prototype.attr_AutoSize=1,TStdBMPButton.prototype.attr_orgWidth=0,TStdBMPButton.prototype.attr_orgHeight=0,TStdBMPButton.prototype.FontUpdate=function(){this.centerVerticalText()},TStdBMPButton.prototype.orgWidth=function(t){if(!arguments.length)return this.attr_orgWidth;this.attr_orgWidth=0!=t?t:this.attr_Width},TStdBMPButton.prototype.orgHeight=function(t){if(!arguments.length)return this.attr_orgHeight;this.attr_orgHeight=0!=t?t:this.attr_Height},TStdBMPButton.prototype.AutoSize=function(t){if(!arguments.length)return this.attr_AutoSize;this.attr_AutoSize=AnyToInt(t);var e=this.obj.firstChild;0==this.attr_AutoSize?(e.style.height=this.attr_Height+"px",e.style.width=this.attr_Width+"px",this.Height(this.attr_Height),this.Width(this.attr_Width)):(0==this.attr_orgHeight&&(this.attr_orgHeight=this.attr_Height),0==this.attr_orgWidth&&(this.attr_orgWidth=this.attr_Width),e.style.height=this.attr_orgHeight+"px",e.style.width=this.attr_orgWidth+"px",this.Height(this.attr_orgHeight),this.Width(this.attr_orgWidth),this.obj.style.height="",this.obj.style.width="",this.centerVerticalText())},TStdBMPButton.prototype.ActiveGlyph=function(t){if(!arguments.length)return this.attr_ActiveGlyph;this.attr_ActiveGlyph=t},TStdBMPButton.prototype.DownGlyph=function(t){if(!arguments.length)return this.attr_DownGlyph;this.attr_DownGlyph=t},TStdBMPButton.prototype.UnEnGlyph=function(t){if(!arguments.length)return this.attr_UnEnGlyph;this.attr_UnEnGlyph=t,0==this.Enabled()&&this.changeImage(this.obj,this.attr_UnEnGlyph)},TStdBMPButton.prototype.UpGlyph=function(t){if(!arguments.length)return this.attr_UpGlyph;this.attr_UpGlyph=t,1==this.Enabled()&&this.changeImage(this.obj,this.attr_UpGlyph)},TStdBMPButton.prototype.Enabled=function(t){if(!arguments.length)return this.attr_Enabled;t=AnyToInt(t),TStdVisibleComponent.prototype.Enabled.call(this,t),null!=this.attr_UnEnGlyph&&null!=this.attr_UpGlyph&&(0==t?this.changeImage(this.obj,this.attr_UnEnGlyph):this.changeImage(this.obj,this.attr_UpGlyph)),pages[this.pageName].isPageInit()&&this.centerVerticalText()},TStdBMPButton.prototype.onpgready=function(){this.changeState();var t=this.obj.childNodes[1],e=this.obj.firstChild;0==this.attr_AutoSize&&(e.style.height=this.attr_Height+"px",e.style.width=this.attr_Width+"px"),t.innerHTML=this.attr_Caption,pages[this.pageName].isPageInit()&&this.centerVerticalText(),TStdVisibleComponent.prototype.onpgready.call(this)},TStdBMPButton.prototype.onpgshown=function(){var t=this.pageName,e=this.Name();window.setTimeout("try {pages['"+t+"']."+e+".centerVerticalText()} catch (e) {};",300),TStdVisibleComponent.prototype.onpgshown.call(this)},TStdBMPButton.prototype.onpgclose=function(){var t=removeEvent;t(this.obj,"mouseover",this.changeState),t(this.obj,"mousedown",this.changeState),t(this.obj,"mouseup",this.changeState),t(this.obj,"mouseout",this.changeState),TStdVisibleComponent.prototype.onpgclose.call(this)},TStdBMPButton.prototype.Height=function(t){var e=this.obj.firstChild;if(0==arguments.length)return this.attr_Height;TStdVisibleComponent.prototype.Height.call(this,t),0==this.attr_AutoSize?(e.style.height=this.attr_Height+"px",e.style.width=this.attr_Width+"px"):(0==this.attr_orgHeight&&(this.attr_orgHeight=this.attr_Height),0==this.attr_orgWidth&&(this.attr_orgWidth=this.attr_Width),""==e.src?(e.style.height=this.attr_orgHeight+"px",e.style.width=this.attr_orgWidth+"px"):(e.style.height="",e.style.width=""),this.obj.style.height="",this.obj.style.width="",this.centerVerticalText())},TStdBMPButton.prototype.Width=function(t){var e=this.obj.firstChild;if(0==arguments.length)return this.attr_Width;TStdVisibleComponent.prototype.Width.call(this,t);e=this.obj.firstChild;0==this.attr_AutoSize?(e.style.height=this.attr_Height+"px",e.style.width=this.attr_Width+"px"):(0==this.attr_orgHeight&&(this.attr_orgHeight=this.attr_Height),0==this.attr_orgWidth&&(this.attr_orgWidth=this.attr_Width),""==e.src?(e.style.height=this.attr_orgHeight+"px",e.style.width=this.attr_orgWidth+"px"):(e.style.height="",e.style.width=""),this.obj.style.height="",this.obj.style.width="",this.centerVerticalText())},TStdBMPButton.prototype.changeImage=function(t,e){if(null==t||null==this.pageName)return!0;if(null!=e&&""!=e){t.style.borderStyle="none";var n=t.firstChild;n.src=expandmetavar(e,this.pageName),0==this.attr_AutoSize?(n.style.height=this.attr_Height+"px",n.style.width=this.attr_Width+"px"):(n.style.height="",n.style.width="",t.style.height="",t.style.width="");var i=pages[this.pageName];this.Visible()&&"hidden"!=t.style.visibility?n.style.visibility="visible":n.style.visibility="hidden",i.isPageInit()&&this.centerVerticalText()}else if(t.firstChild.style.visibility="hidden",t.firstChild.src="",0!=pages[this.pageName].PageMode()){var r=t.style;r.borderStyle="solid",r.borderWidth="2px",r.borderColor=convertColor(35071)}this.Caption(this.attr_Caption);i=pages[this.pageName];return!0},TStdBMPButton.prototype.changeState=function(t){var e=(i=pages[this.pageName])[this.obj];if(0!=i.PageMode())return!0;if(null==e||0==e.Enabled())return!0;if(!AnyToBool(e.Visible()))return!0;var n="";switch(t.type){case"mouseover":n=e.attr_ActiveGlyph;break;case"mousedown":n=e.attr_DownGlyph;break;case"mouseup":n=e.attr_ActiveGlyph;break;case"mouseout":n=e.attr_UpGlyph}""==n&&(n=e.attr_UpGlyph),""!=n&&e.changeImage(this,n);var i=pages[this.pageName];return!0},TStdBMPButton.prototype.Visible=function(t){if(!arguments.length)return this.attr_Visible;TStdVisibleComponent.prototype.Visible.call(this,t);var e=pages[this.pageName],n=this.obj.firstChild;n.style.visibility=1==t?"visible":"hidden",e.isPageInit()&&this.centerVerticalText()},TStdBMPButton.prototype.internalVisibleHidden=function(){this.obj.firstChild.style.visibility="hidden"},TStdBMPButton.prototype.internalVisible=function(){this.Visible(1)},TStdBMPButton.prototype.Caption=function(t){if(!arguments.length)return this.attr_Caption;t!=this.attr_Caption&&(this.attr_Caption=t,this.obj.childNodes[1].innerHTML=t,this.centerVerticalText())},TStdBMPButton.prototype.centerVerticalText=function(){if(""!=this.attr_Caption){var t=this.obj,e=(t.offsetHeight-t.childNodes[1].offsetHeight)/2,n=(t.offsetWidth-t.childNodes[1].offsetWidth)/2;e=e<1?0:e,n=n<1?0:n,t.childNodes[1].style.top=e+"px",t.childNodes[1].style.left=n+"px"}},TStdFlashPlayer.prototype=new TStdVisibleComponent,TStdFlashPlayer.prototype.constructor=TStdFlashPlayer,TStdFlashPlayer.prototype.attr_Filename="",TStdFlashPlayer.prototype.attr_AutoPlay=0,TStdFlashPlayer.prototype.attr_BackGColor=0,TStdFlashPlayer.prototype.attr_UseBackColor=0,TStdFlashPlayer.prototype.attr_Quality=0,TStdFlashPlayer.prototype.attr_ScaleMode=0,TStdFlashPlayer.prototype.attr_Loop=0,TStdFlashPlayer.prototype.count=0,TStdFlashPlayer.prototype.flashPause=!1,TStdFlashPlayer.prototype.fileNotChanged=!0,TStdFlashPlayer.prototype.Filename=function(t){if(!arguments.length)return this.attr_Filename;t!=this.attr_Filename&&(this.fileNotChanged=!0),this.attr_Filename=t},TStdFlashPlayer.prototype.AutoPlay=function(t){if(!arguments.length)return this.attr_AutoPlay;this.attr_AutoPlay=AnyToInt(t)},TStdFlashPlayer.prototype.BackGColor=function(t){if(!arguments.length)return this.attr_BackGColor;this.attr_BackGColor=t,this.Color(t)},TStdFlashPlayer.prototype.UseBackColor=function(t){if(!arguments.length)return this.attr_UseBackColor;this.attr_UseBackColor=t},TStdFlashPlayer.prototype.Quality=function(t){if(!arguments.length)return this.attr_Quality;this.attr_Quality=t},TStdFlashPlayer.prototype.ScaleMode=function(t){if(!arguments.length)return this.attr_ScaleMode;this.attr_ScaleMode=t},TStdFlashPlayer.prototype.Loop=function(t){if(!arguments.length)return this.attr_Loop;this.attr_Loop=t},TStdFlashPlayer.prototype.PlayFlash=function(){if(this.flashPause&&!this.fileNotChanged)return this.flashPause=!1,void this.obj.firstChild.Play();if(this.StopFlash(),""==this.Filename())return this.fileNotChanged=!1,void(flashObj=null);var t=new SWFObject(expandmetavar(this.Filename(),this.pageName),this.pageName+this.Name()+"flashobj",this.Height(),this.Width(),"7","#FFFFFF");t.addParam("wmode","transparent"),t.write(this.pageName+this.Name()),this.obj.firstChild&&null!=this.obj.firstChild&&(this.obj.firstChild.position="absolute",this.obj.firstChild.style.top=0+px,this.obj.firstChild.style.left=0+px,this.obj.firstChild.style.width=this.Width()+px,this.obj.firstChild.style.height=this.Height()+px,this.fileNotChanged=!1,flashObj=null)},TStdFlashPlayer.prototype.StopFlash=function(){this.obj.firstChild&&null!=this.obj.firstChild&&removeAll(this.obj.firstChild)},TStdFlashPlayer.prototype.ForwardFlash=function(){if(null!=this.obj.firstChild){var t=this.obj.firstChild.TGetProperty("/",4),e=parseInt(t)+5;this.obj.firstChild.GotoFrame(e)}},TStdFlashPlayer.prototype.RewindFlash=function(){null!=this.obj.firstChild&&this.obj.firstChild.Rewind()},TStdFlashPlayer.prototype.PauseFlash=function(){null!=this.obj.firstChild&&(this.flashPause=!0,this.obj.firstChild.StopPlay())},TStdFlashPlayer.prototype.onpgshown=function(){if(TStdVisibleComponent.prototype.onpgshown.call(this),1==this.AutoPlay()&&0==pages[this.thePageName].PageMode()&&(this.Transparent(1),this.PlayFlash(),this.obj.style.borderStyle="none"),0!=pages[this.thePageName].PageMode()){this.Transparent(0);var t=this.obj.style;t.borderStyle="solid",t.borderWidth="2px",t.borderColor=convertColor(16750848)}},TStdFlashPlayer.prototype.onpgclose=function(){this.StopFlash(),TStdVisibleComponent.prototype.onpgclose.call(this)},TStdLangComp.prototype=new TStdVisibleComponent,TStdLangComp.prototype.constructor=TStdLangComp,TStdLangComp.prototype.Name=function(t){if(arguments.length<=0)return TStdVisibleComponent.prototype.Name.call(this);TStdVisibleComponent.prototype.Name.call(this,t),jQuery(this.obj).html(t)},TStdPanel.prototype=new TStdVisibleComponent,TStdPanel.prototype.constructor=TStdPanel,TStdPanel.prototype.attr_Alignment=null,TStdPanel.prototype.attr_BevelOuter=null,TStdPanel.prototype.attr_Borderstyle=0,TStdPanel.prototype.attr_Borderwidth=0,TStdPanel.prototype.attr_BorderColor=CLBLACK,TStdPanel.prototype.attr_Borderradius=0,TStdPanel.prototype.attr_BevelWidth=null,TStdPanel.prototype.attr_Caption="",TStdPanel.prototype.attr_Scrollable=0,TStdPanel.prototype.attr_ScrollableX=0,TStdPanel.prototype.attr_ScrollableY=0,TStdPanel.prototype.attr_Scrollbars=0,TStdPanel.prototype.attr_BackgroundImage="",TStdPanel.prototype.attr_BackgroundSize="",TStdPanel.prototype.attr_BackgroundPosition="",TStdPanel.prototype.attr_BackgroundRepeat="",TStdPanel.prototype.scrollDelay=0,TStdPanel.prototype.scrollTimer=null,TStdPanel.prototype.scrollListener=null,TStdPanel.prototype.Scrollable=function(t){return arguments.length&&(t=AnyToInt(t),this.attr_Scrollable=t,this.obj.style.overflow=1==t?"auto":"hidden"),this.attr_Scrollable},TStdPanel.prototype.Scrollbars=function(t){return arguments.length&&(t=AnyToInt(t),this.attr_Scrollbars=t,0==t&&(this.obj.style.overflow="hidden"),1==t&&(this.obj.style.overflow="hidden",this.obj.style.overflowX="auto"),2==t&&(this.obj.style.overflow="hidden",this.obj.style.overflowY="auto"),3==t&&(this.obj.style.overflow="auto")),this.attr_Scrollbars},TStdPanel.prototype.ScrollableX=function(t){return arguments.length&&(t=AnyToInt(t),this.attr_ScrollableX=t,this.obj.style.overflowX=1==t?"auto":"hidden"),this.attr_ScrollableX},TStdPanel.prototype.ScrollableY=function(t){return arguments.length&&(t=AnyToInt(t),this.attr_ScrollableY=t,this.obj.style.overflowY=1==t?"auto":"hidden"),this.attr_ScrollableY},TStdPanel.prototype.Alignment=function(t){if(arguments.length){t=AnyToInt(t),this.attr_Alignment=t;var e="";switch(t){case TALEFTJUSTIFY:e="left";break;case TACENTER:e="center";break;case TARIGHTJUSTIFY:e="right"}this.obj.firstChild.style.textAlign=e}return this.attr_Alignment},TStdPanel.prototype.Caption=function(t){return arguments.length&&(this.attr_Caption=t,this.obj.firstChild.innerHTML=t),this.attr_Caption},TStdPanel.prototype.BevelOuter=function(t){if(!arguments.length)return this.attr_BevelOuter;this.attr_BevelOuter=AnyToInt(t)},TStdPanel.prototype.Borderstyle=function(t){if(!arguments.length)return this.attr_Borderstyle;this.attr_Borderstyle=AnyToInt(t),pages[this.pageName].PageMode()!=pmEdit||0!=this.attr_Borderstyle&&0!=this.attr_Borderwidth?(this.obj.className=StrReplace(this.obj.className,"it_framestyle7a ",""),this.obj.className=StrReplace(this.obj.className,"it_framestyle7a",""),pages[this.pageName].PageMode()==pmEdit&&0!=this.attr_Borderstyle&&(this.obj.style.borderWidth=this.attr_Borderwidth+"px"),this.obj.style.borderStyle=1==t?"solid":"none"):(this.obj.className.indexOf("it_framestyle7a")<0&&(this.obj.className="it_framestyle7a "+this.obj.className),this.obj.style.borderStyle="dashed",this.obj.style.borderWidth="1px"),this.BorderColor(this.attr_BorderColor)},TStdPanel.prototype.Borderwidth=function(t){if(!arguments.length)return this.attr_Borderwidth;this.attr_Borderwidth=AnyToInt(t),pages[this.pageName].PageMode()!=pmEdit||0!=AnyToInt(t)&&0!=this.attr_Borderstyle?((pages[this.pageName].PageMode()!=pmEdit||AnyToInt(t)>0&&0!=this.attr_Borderstyle)&&(this.obj.className=StrReplace(this.obj.className,"it_framestyle7a ",""),this.obj.className=StrReplace(this.obj.className,"it_framestyle7a","")),this.obj.style.borderWidth=t+"px"):this.obj.className.indexOf("it_framestyle7a")<0&&(this.obj.className="it_framestyle7a "+this.obj.className)},TStdPanel.prototype.BorderColor=function(t){if(!arguments.length)return this.attr_BorderColor;this.attr_BorderColor=AnyToInt(t),AnyToStr(t).toLowerCase().indexOf("rgb")<=0&&(t=convertColor(t)),this.obj.style.borderColor=t},TStdPanel.prototype.Borderradius=function(t){if(!arguments.length)return this.attr_Borderradius;this.attr_Borderradius=AnyToInt(t),this.obj.style.borderRadius=t+"px"},TStdPanel.prototype.BevelWidth=function(t){if(!arguments.length)return this.attr_BevelWidth;this.attr_BevelWidth=t},TStdPanel.prototype.onpgshown=function(){this.centerVerticalText(),TStdVisibleComponent.prototype.onpgshown.call(this)},TStdPanel.prototype.centerVerticalText=function(){if(""!=this.attr_Caption){var t=this.obj,e=(t.offsetHeight-t.firstChild.offsetHeight)/2;e=e<1?0:e,t.firstChild.style.marginTop=e+"px"}},TStdPanel.prototype.BackgroundImage=function(t){if(!arguments.length)return this.attr_BackgroundImage;this.attr_BackgroundImage=t,t=expandmetavar(t,this.pageName);var e=this.obj.style;e.backgroundImage="url("+t+")",e=null},TStdPanel.prototype.BackgroundSize=function(t){if(!arguments.length)return this.attr_BackgroundSize;this.attr_BackgroundSize=t;var e=this.obj.style;e.backgroundSize=t,e=null},TStdPanel.prototype.BackgroundPosition=function(t){if(!arguments.length)return this.attr_BackgroundPosition;this.attr_BackgroundPosition=t;var e=this.obj.style;e.backgroundPosition=t,e=null},TStdPanel.prototype.BackgroundRepeat=function(t){if(!arguments.length)return this.attr_BackgroundRepeat;this.attr_BackgroundRepeat=t;var e=this.obj.style;e.backgroundRepeat=t,e=null},TStdPanel.prototype.cbHelper=function(t){t.OnScroll&&t.OnScroll()},TStdPanel.prototype.scrollCB=function(t){null!==t.scrollTimer&&clearTimeout(t.scrollTimer),t.scrollTimer=setTimeout(function(){t.cbHelper(t)},t.scrollDelay)},TStdPanel.prototype.ActivateScrollCB=function(t){if(!arguments.length)return this.scrollDelay;if(this.scrollDelay=t,t>0){var e=this,n=this.scrollCB,i=function(){n(e)};this.obj.addEventListener("scroll",i,!1)}else this.obj.removeEventListener("scroll",i)},TStdTilePanel.prototype=new TStdPanel,TStdTilePanel.prototype.constructor=TStdTilePanel,TStdTimer.prototype=new TStdVisibleComponent,TStdTimer.prototype.constructor=TStdTimer,TStdTimer.prototype.intTimer=null,TStdTimer.prototype.attr_TimerTickPos=0,TStdTimer.prototype.IntervallID=0,TStdTimer.prototype.attr_TimerTickPos=0,TStdTimer.prototype.attr_StartWithPage=0,TStdTimer.prototype.attr_TimerInterval=0,TStdTimer.prototype.attr_TimerTickCount=0,TStdTimer.prototype.attr_TimerEnabled=0,TStdTimer.prototype.StartWithPage=function(t){if(!arguments.length)return this.attr_StartWithPage;this.attr_StartWithPage=AnyToInt(t)},TStdTimer.prototype.TimerInterval=function(t){if(!arguments.length)return this.attr_TimerInterval;this.attr_TimerInterval=AnyToInt(t),null!=this.intTimer&&0!=this.attr_TimerEnabled&&this.intTimer.setInterval(this.attr_TimerInterval)},TStdTimer.prototype.TimerTickCount=function(t){if(!arguments.length)return this.attr_TimerTickCount;this.attr_TimerTickCount=AnyToInt(t)},TStdTimer.prototype.TimerEnabled=function(t){if(!arguments.length)return this.attr_TimerEnabled;this.attr_TimerEnabled=AnyToInt(t),null!=this.intTimer&&(0==this.attr_TimerEnabled?this.stopTimer():this.startTimer())},TStdTimer.prototype.TimerEvent=function(){if(null!=this.intTimer){var t=0;t=(this.Width()-8)/this.attr_TimerTickCount,this.attr_TimerTickPos++,this.OnTimer&&this.OnTimer(),(t*=this.attr_TimerTickPos)>this.Width()-8&&(t=this.Width());var e=this.obj.firstChild.style;if(null==e)return;try{e.width=t+px,e.height=this.Height()+px}catch(t){}e=null,this.attr_TimerTickPos>=this.attr_TimerTickCount&&this.stopTimer()}},TStdTimer.prototype.TimerTickPos=function(t){if(!arguments.length)return this.attr_TimerTickPos;this.attr_TimerTickPos=AnyToInt(t)},TStdTimer.prototype.startTimer=function(){this.OnTimerStart&&this.OnTimerStart(),this.attr_TimerTickPos=0,this.intTimer.setInterval(this.attr_TimerInterval)},TStdTimer.prototype.continueTimer=function(){this.intTimer.setInterval(this.attr_TimerInterval)},TStdTimer.prototype.pauseTimer=function(){this.intTimer.clearInterval()},TStdTimer.prototype.stopTimer=function(){this.intTimer.clearInterval(),this.obj.firstChild.style.width=this.Width()+px,this.OnTimerStop&&this.OnTimerStop()},TStdTimer.prototype.onpgready=function(){this.intTimer=new ideaTimer(this,"TimerEvent"),TStdVisibleComponent.prototype.onpgready.call(this)},TStdTimer.prototype.onpgshown=function(){TStdVisibleComponent.prototype.onpgshown.call(this),1==this.StartWithPage()&&this.TimerEnabled(1)},TStdTimer.prototype.onpgclose=function(){null!=this.intTimer&&(this.intTimer.clearInterval(),this.intTimer.close(),this.intTimer.obj=null),this.intTimer=null,TStdVisibleComponent.prototype.onpgclose.call(this)},TStdFramedLabel.prototype=new TStdLabel,TStdFramedLabel.prototype.constructor=TStdFramedLabel,TStdFramedLabel.prototype.attr_FrameColor=0,TStdFramedLabel.prototype.attr_FrameWidth=0,TStdFramedLabel.prototype.attr_ShowFrame=0,TStdFramedLabel.prototype.wfirst=!0,TStdFramedLabel.prototype.hfirst=!0,TStdFramedLabel.prototype.FrameColor=function(t){if(!arguments.length)return this.attr_FrameColor;this.attr_FrameColor=t,1==this.attr_ShowFrame&&(this.obj.style.borderColor=convertColor(t))},TStdFramedLabel.prototype.FrameWidth=function(t){if(!arguments.length)return this.attr_FrameWidth;this.attr_FrameWidth=t,1==this.attr_ShowFrame&&(this.obj.style.borderWidth=Number(t)+px)},TStdFramedLabel.prototype.ShowFrame=function(t){if(!arguments.length)return this.attr_ShowFrame;this.attr_ShowFrame=AnyToInt(t),1==this.attr_ShowFrame&&this.FrameWidth(this.attr_FrameWidth),pages[this.pageName].PageMode()==pmEdit&&0==this.attr_ShowFrame?(this.obj.className.indexOf("it_framestyle7a")<0&&(this.obj.className="it_framestyle7a "+this.obj.className),this.obj.style.borderStyle="dashed"):(this.obj.className=StrReplace(this.obj.className,"it_framestyle7a ",""),this.obj.className=StrReplace(this.obj.className,"it_framestyle7a",""),this.obj.style.borderStyle=1==t?"solid":"none"),this.FrameColor(this.attr_FrameColor)},TStdHTMLViewer.prototype=new TStdVisibleComponent,TStdHTMLViewer.prototype.constructor=TStdHTMLViewer,TStdHTMLViewer.prototype.attr_AutoGlossar=null,TStdHTMLViewer.prototype.attr_BorderStyle=0,TStdHTMLViewer.prototype.attr_Borderstyle=0,TStdHTMLViewer.prototype.attr_Borderwidth=1,TStdHTMLViewer.prototype.attr_BorderColor=CLBLACK,TStdHTMLViewer.prototype.attr_Borderradius=0,TStdHTMLViewer.prototype.attr_Filename=null,TStdHTMLViewer.prototype.attr_HTMLText=null,TStdHTMLViewer.prototype.attr_DefBackGround=0,TStdHTMLViewer.prototype.attr_DefFontSize=12,TStdHTMLViewer.prototype.attr_DefFontColor=0,TStdHTMLViewer.prototype.attr_DefFontName="Arial",TStdHTMLViewer.prototype.attr_Scrollbars=3,TStdHTMLViewer.prototype.colorOrgValue=0,TStdHTMLViewer.prototype.Scrollbars=function(t){return arguments.length&&(t=AnyToInt(t),this.attr_Scrollbars=t,0==t&&(this.obj.style.overflow="hidden"),1==t&&(this.obj.style.overflow="hidden",this.obj.style.overflowX="auto"),2==t&&(this.obj.style.overflow="hidden",this.obj.style.overflowY="auto"),3==t&&(this.obj.style.overflow="auto")),this.attr_Scrollbars},TStdHTMLViewer.prototype.AutoGlossar=function(t){if(!arguments.length)return this.attr_AutoGlossar;this.attr_AutoGlossar=AnyToInt(t)},TStdHTMLViewer.prototype.Borderstyle=function(t){if(!arguments.length)return this.BorderStyle();this.BorderStyle(t),this.attr_Borderstyle=t},TStdHTMLViewer.prototype.BorderStyle=function(t){if(!arguments.length)return this.attr_BorderStyle;this.attr_BorderStyle=AnyToInt(t),0==AnyToInt(t)&&pages[this.pageName].PageMode()==pmEdit?(this.obj.className.indexOf("it_framestyle7a")<0&&(this.obj.className="it_framestyle7a "+this.obj.className),this.obj.style.borderStyle="dashed"):(this.obj.className=StrReplace(this.obj.className,"it_framestyle7a ",""),this.obj.className=StrReplace(this.obj.className,"it_framestyle7a",""),this.obj.style.borderStyle=1==t?"solid":"none"),this.BorderColor(this.attr_BorderColor)},TStdHTMLViewer.prototype.Borderwidth=function(t){if(!arguments.length)return this.attr_Borderwidth;this.attr_Borderwidth=AnyToInt(t),1!=AnyToInt(t)&&pages[this.pageName].PageMode()==pmEdit&&0==this.attr_Borderstyle?this.obj.style.borderWidth="1px":this.obj.style.borderWidth=t+"px"},TStdHTMLViewer.prototype.BorderColor=function(t){if(!arguments.length)return this.attr_BorderColor;this.attr_BorderColor=AnyToInt(t),AnyToStr(t).toLowerCase().indexOf("rgb")<=0&&(t=convertColor(t)),this.obj.style.borderColor=t},TStdHTMLViewer.prototype.Borderradius=function(t){if(!arguments.length)return this.attr_Borderradius;this.attr_Borderradius=AnyToInt(t),this.obj.style.borderRadius=t+"px"},TStdHTMLViewer.prototype.Filename=function(t){if(!arguments.length)return this.attr_Filename;this.attr_Filename=t,0==t.indexOf("$")&&(t=expandmetavar(t,this.pageName)),""!=t&&pages[this.pageName].PageMode()==pmRuntime&&(this.obj.innerHTML="<iframe style='border-style:none' frameborder='0' framespacing='0' width='100%' height='100%' src='"+t+"'></iframe>"),""!=t&&IS.NN()&&pages[this.pageName].PageMode()==pmRuntime&&(this.obj.firstChild.style.overflow="visible"),""!=t&&pages[this.pageName].PageMode()==pmRuntime&&(this.obj.firstChild.src=t)},TStdHTMLViewer.prototype.scrollBottom=function(){this.obj.scrollTop=this.obj.scrollHeight},TStdHTMLViewer.prototype.DefBackGround=function(t){if(!arguments.length)return this.attr_DefBackGround;this.attr_DefBackGround=t},TStdHTMLViewer.prototype.Color=function(t){if(!arguments.length)return this.attr_Color;""!=t&&(this.attr_Color=t,TStdVisibleComponent.prototype.Color.call(this,t))},TStdHTMLViewer.prototype.DefFontSize=function(t){if(!arguments.length)return this.attr_DefFontSize;this.attr_DefFontSize=t},TStdHTMLViewer.prototype.DefFontColor=function(t){if(!arguments.length)return this.attr_DefFontColor;this.attr_DefFontColor=t},TStdHTMLViewer.prototype.DefFontName=function(t){if(!arguments.length)return this.attr_DefFontName;this.attr_DefFontName=t},TStdHTMLViewer.prototype.HTMLText=function(t){if(!arguments.length)return this.attr_HTMLText;t=replace(t=replace(t=unescape(t),"\\r",""),"\\n","<br/>"),this.attr_HTMLText=t,this.obj.innerHTML=t,TStdHTMLViewer.prototype.insertGlossar=function(){this.obj.innerHTML=insertGlossar(this.obj.innerHTML)},TStdHTMLViewer.prototype.onpgshown=function(){var t=this.pageName,e=this.Name();window.setTimeout("_insertGlossar('"+e+"','"+t+"')",300),TStdVisibleComponent.prototype.onpgshown.call(this),pages[this.pageName].PageMode()!=pmEdit||(0==this.attr_BorderStyle?(this.obj.className.indexOf("it_framestyle7a")<0&&(this.obj.className="it_framestyle7a "+this.obj.className),this.obj.style.borderStyle="dashed"):(this.obj.className=StrReplace(this.obj.className,"it_framestyle7a ",""),this.obj.className=StrReplace(this.obj.className,"it_framestyle7a",""),this.obj.style.borderStyle="solid"))}},TStdPPTViewer.prototype=new TStdVisibleComponent,TStdPPTViewer.prototype.constructor=TStdPPTViewer,TStdPPTViewer.prototype.attr_Filename=null,TStdPPTViewer.prototype.Filename=function(t){if(!arguments.length)return this.attr_Filename;this.attr_Filename=t,0==t.indexOf("$")&&(t=expandmetavar(t,this.pageName)),""!=t&&0==pages[this.pageName].PageMode()&&(this.obj.innerHTML="<iframe width='100%' height='100%' src='"+t+"'></iframe>"),IS.NN()&&(this.obj.style.overflow="visible"),this.obj.src=t},TStdPDFViewer.prototype=new TStdVisibleComponent,TStdPDFViewer.prototype.constructor=TStdPDFViewer,TStdPDFViewer.prototype.attr_Filename=null,TStdPDFViewer.prototype.Filename=function(t){if(!arguments.length)return this.attr_Filename;this.attr_Filename=t,0==t.indexOf("$")&&(t=expandmetavar(t,this.pageName)),""!=t&&0==pages[this.pageName].PageMode()&&(this.obj.innerHTML="<iframe width='100%' height='100%' src='"+t+"'></iframe>"),""!=t&&IS.NN()&&0==pages[this.pageName].PageMode()&&(this.obj.firstChild.style.overflow="visible"),""!=t&&0==pages[this.pageName].PageMode()&&(this.obj.firstChild.src=t)},TStdCMViewer.prototype=new TStdVisibleComponent,TStdCMViewer.prototype.constructor=TStdCMViewer,TStdCMViewer.prototype.attr_Filename=null,TStdCMViewer.prototype.Filename=function(t){if(!arguments.length)return this.attr_Filename;(this.attr_Filename=t,t.length<4)||(0==t.indexOf("$")&&(t=expandmetavar(t,this.pageName)),t=(t=t.replace(".cm","/index.html")).replace(".CM","/index.html"),""!=(t+="?lang="+GetVariableEx("System","LanguageToken","de","Variablen"))&&0==pages[this.pageName].PageMode()&&(t.indexOf("h5p.")>0?this.obj.innerHTML="<iframe allowtransparency='true' width='100%' border='0' frameborder='0' allowfullscreen='allowfullscreen' style='border:0' height='100%' src='"+t+"'></iframe>":this.obj.innerHTML="<iframe allowtransparency='true' width='100%' border='0' style='border:0' height='100%' src='"+t+"'></iframe>",IS.NN()&&(this.obj.firstChild.style.overflow="visible"),this.obj.firstChild.src=t))},TStdCMViewer.prototype.onpgshown=function(){if(TStdVisibleComponent.prototype.onpgshown.call(this),0==pages[this.pageName].PageMode())this.obj.style.overflow="hidden";else{var t=this.obj.style;t.borderStyle="solid",t.borderWidth="1px",t.borderColor=convertColor(52479)}},Lines.prototype={obj:null,SetText:function(t){t=t.replace(/&#x0A;/g,"\n"),this.attr_Lines=t,this.obj.value=t},GetText:function(){return this.obj.value}},TStdMemo.prototype=new TStdVisibleComponent,TStdMemo.prototype.constructor=TStdMemo,TStdMemo.prototype.attr_Borderstyle=0,TStdMemo.prototype.attr_Borderwidth=0,TStdMemo.prototype.attr_Lines=null,TStdMemo.prototype.attr_WordWrap=null,TStdMemo.prototype.attr_Scrollbars=null,TStdMemo.prototype.attr_ReadOnly=null,TStdMemo.prototype.Lines=null,TStdMemo.prototype.WordWrap=function(t){return arguments.length&&(t=Number(t),this.attr_WordWrap=t,this.obj.wrap=0==t?"off":"soft"),this.attr_WordWrap},TStdMemo.prototype.Borderstyle=function(t){if(!arguments.length)return this.attr_Borderstyle;this.attr_Borderstyle=AnyToInt(t),pages[this.pageName].PageMode()==pmEdit&&0==this.attr_Borderstyle?(this.obj.className.indexOf("it_framestyle7a")<0&&(this.obj.className="it_framestyle7a "+this.obj.className),this.obj.style.borderStyle="dashed"):(this.obj.className=StrReplace(this.obj.className,"it_framestyle7a ",""),this.obj.className=StrReplace(this.obj.className,"it_framestyle7a",""),pages[this.pageName].PageMode()==pmEdit&&0!=this.attr_Borderstyle&&(this.obj.style.borderWidth=this.attr_Borderwidth+"px"),this.obj.style.borderStyle=1==t?"solid":"none")},TStdMemo.prototype.Borderwidth=function(t){if(!arguments.length)return this.attr_Borderwidth;this.attr_Borderwidth=AnyToInt(t),pages[this.pageName].PageMode()!=pmEdit||0!=AnyToInt(t)&&0!=this.attr_Borderstyle?((pages[this.pageName].PageMode()!=pmEdit||AnyToInt(t)>0&&0!=this.attr_Borderstyle)&&(this.obj.className=StrReplace(this.obj.className,"it_framestyle7a ",""),this.obj.className=StrReplace(this.obj.className,"it_framestyle7a","")),this.obj.style.borderWidth=t+"px"):this.obj.className.indexOf("it_framestyle7a")<0&&(this.obj.className="it_framestyle7a "+this.obj.className)},TStdMemo.prototype.Scrollbars=function(t){return arguments.length&&(t=Number(t),this.attr_Scrollbars=t,this.obj.style.overflow=0==t?"hidden":1==t?"scroll":"auto"),this.attr_Scrollbars},TStdMemo.prototype.ReadOnly=function(t){return arguments.length&&(t=Number(t),this.attr_ReadOnly=t,this.obj.readOnly=AnyToInt(t)),this.attr_ReadOnly},TStdButton.prototype=new TStdVisibleComponent,TStdButton.prototype.constructor=TStdButton,TStdButton.prototype.attr_Caption="",TStdButton.prototype.attr_BorderWidth=0,TStdButton.prototype.attr_Borderwidth=0,TStdButton.prototype.Enabled=function(t){if(!arguments.length)return TStdVisibleComponent.prototype.Enabled.call(this);if(TStdVisibleComponent.prototype.Enabled.call(this,t),0==t)this.obj.disabled=!0,this.Font.obj.style.color="#808080";else{this.obj.disabled=!1;var e=this.Font.FontColor();null!=e&&this.Font.FontColor(e)}},TStdButton.prototype.Caption=function(t){if(!arguments.length)return this.obj.value;var e=this.obj;t!=e.value&&(e.value=t,e.innerHTML=t)},TStdButton.prototype.BorderWidth=function(t){if(!arguments.length)return this.obj.attr_BorderWidth;this.attr_BorderWidth=t,""==t&&(t=0),this.obj.style.borderWidth=t+px},TStdButton.prototype.Borderwidth=function(t){if(!arguments.length)return this.obj.attr_BorderWidth;this.attr_BorderWidth=t,""==t&&(t=0),this.obj.style.borderWidth=t+px},TStdBitBtn.prototype=new TStdVisibleComponent,TStdBitBtn.prototype.constructor=TStdBitBtn,TStdBitBtn.prototype.attr_Caption="",TStdBitBtn.prototype.attr_Down=0,TStdBitBtn.prototype.attr_BorderWidth=0,TStdBitBtn.prototype.attr_Borderwidth=0,TStdBitBtn.prototype.attr_Glyph="",TStdBitBtn.prototype.attr_Layout=0,TStdBitBtn.prototype.Enabled=function(t){if(!arguments.length)return TStdVisibleComponent.prototype.Enabled.call(this);TStdVisibleComponent.prototype.Enabled.call(this,t),this.obj.disabled=0==t},TStdBitBtn.prototype.Caption=function(t){if(!arguments.length)return this.attr_Caption;t!=this.attr_Caption&&(this.attr_Caption=t,this.setGlyphCaption())},TStdBitBtn.prototype.Borderwidth=function(t){if(!arguments.length)return this.attr_BorderWidth;this.attr_BorderWidth=AnyToInt(t),this.obj.style.borderWidth=this.attr_BorderWidth+px},TStdBitBtn.prototype.Layout=function(t){if(!arguments.length)return this.attr_Layout;this.attr_Layout=AnyToInt(t),this.setGlyphCaption()},TStdBitBtn.prototype.Glyph=function(t){if(!arguments.length)return this.attr_Glyph;t!=this.attr_Glyph&&(this.attr_Glyph=t,this.setGlyphCaption())},TStdBitBtn.prototype.setGlyphCaption=function(){if(""==this.attr_Glyph)return""!=this.attr_Caption?void(this.obj.innerHTML=this.attr_Caption):void 0;var t=expandmetavar(this.attr_Glyph,this.pageName),e=this.Caption();switch(this.Layout()){case 0:this.obj.innerHTML='<img style="vertical-align:middle;" src='+t+'><span style="vertical-align:middle;">&nbsp;'+e+"</span>";break;case 1:this.obj.innerHTML='<span style="vertical-align:middle;">'+e+'&nbsp;</span><img style="vertical-align:middle;" src='+t+">";break;case 2:this.obj.innerHTML="<img src="+t+"><br>"+e;break;case 3:this.obj.innerHTML=e+"<br><img src="+t+">";break;case 4:this.obj.innerHTML='<img style="vertical-align:middle;" src='+t+">"}},TStdBitBtn.prototype.Down=function(t){if(!arguments.length)return this.attr_Down;t=AnyToInt(t),this.attr_Down=t,this.obj.style.borderStyle=1==t?"inset":"outset"},TStdjqSlider.prototype=new TStdVisibleComponent,TStdjqSlider.prototype.constructor=TStdjqSlider,TStdjqSlider.prototype.attr_Min=0,TStdjqSlider.prototype.attr_Max=100,TStdjqSlider.prototype.attr_Value=0,TStdjqSlider.prototype.attr_Position=0,TStdjqSlider.prototype.attr_Orientation="vertical",TStdjqSlider.prototype.onChange=function(t){this.OnChange&&this.OnChange(t)},TStdjqSlider.prototype.Min=function(t){if(!arguments.length||void 0==arguments[0])return jQuery(this.obj).slider("option","min");jQuery(this.obj).slider("option","min",AnyToInt(t))},TStdjqSlider.prototype.Max=function(t){if(!arguments.length||void 0==arguments[0])return jQuery(this.obj).slider("option","max");jQuery(this.obj).slider("option","max",AnyToInt(t))},TStdjqSlider.prototype.Value=function(t){if(!arguments.length||void 0==arguments[0])return jQuery(this.obj).slider("option","value");jQuery(this.obj).slider("option","value",AnyToInt(t))},TStdjqSlider.prototype.Position=function(t){if(!arguments.length||void 0==arguments[0])return jQuery(this.obj).slider("option","value");jQuery(this.obj).slider("option","value",AnyToInt(t))},TStdjqSlider.prototype.Orientation=function(t){if(!arguments.length||void 0==arguments[0])return"vertical"==jQuery(this.obj).slider("option","orientation")?1:0;1==t&&jQuery(this.obj).slider("option","orientation","vertical"),0==t&&jQuery(this.obj).slider("option","orientation","horizontal")},TStdShape.prototype=new TStdVisibleComponent,TStdShape.prototype.constructor=TStdShape,TStdShape.prototype.canvas=null,TStdShape.prototype.attr_FillColor=0,TStdShape.prototype.attr_Fillstyle=6,TStdShape.prototype.attr_FillColor2=0,TStdShape.prototype.attr_ShapeType=0,TStdShape.prototype.attr_LineWidth=0,TStdShape.prototype.attr_LineColor=0,TStdShape.prototype.attr_Image="",TStdShape.prototype.attr_Angle=0,TStdShape.prototype.Width=function(t){if(!arguments.length)return TStdVisibleComponent.prototype.Width.call(this);TStdVisibleComponent.prototype.Width.call(this,t),this.render()},TStdShape.prototype.Height=function(t){if(!arguments.length)return TStdVisibleComponent.prototype.Height.call(this);TStdVisibleComponent.prototype.Height.call(this,t),this.render()},TStdShape.prototype.onpgshown=function(){TStdVisibleComponent.prototype.onpgshown.call(this),pages[this.pageName].PageMode()!=pmEdit||(this.obj.className="it_basebgcolor4 it_framestyle7a "+this.attr_cssClass),this.render()},TStdShape.prototype.FillColor=function(t){if(arguments.length<=0)return this.attr_FillColor;this.attr_FillColor=t,this.render()},TStdShape.prototype.Angle=function(t){if(arguments.length<=0)return AnyToInt(this.attr_Angle);this.attr_Angle=t,this.render()},TStdShape.prototype.Image=function(t){if(arguments.length<=0)return this.attr_Image;this.attr_Image=t,this.render()},TStdShape.prototype.FillColor2=function(t){if(arguments.length<=0)return this.attr_FillColor2;this.attr_FillColor2=t,this.render()},TStdShape.prototype.LineColor=function(t){if(arguments.length<=0)return this.attr_LineColor;this.attr_LineColor=t,this.render()},TStdShape.prototype.LineWidth=function(t){if(arguments.length<=0)return AnyToInt(this.attr_LineWidth);this.attr_LineWidth=t,this.render()},TStdShape.prototype.Fillstyle=function(t){if(arguments.length<=0)return this.attr_Fillstyle;this.attr_Fillstyle=t,this.render()},TStdShape.prototype.ShapeType=function(t){if(arguments.length<=0)return this.attr_ShapeType;this.attr_ShapeType=t,this.render()},TStdShape.prototype.render=function(){if(pages[this.pageName].PageMode()==pmEdit&&(this.obj.className="it_basebgcolor4 it_framestyle7a it_shapebackground "+this.attr_cssClass),this.canvas.clear(),""!=this.attr_Image){var t=expandmetavar(this.attr_Image,this.pageName),e=this;fabric.Image.fromURL(t,function(t){var n="no-repeat";3==e.attr_Fillstyle&&(n="repeat"),5==e.attr_Fillstyle&&t.scaleToWidth(e.OffsetWidth());var i=new fabric.StaticCanvas;i.add(t),i.setDimensions({width:t.getWidth()+0,height:t.getHeight()+0});var r=i.getElement(),o=new fabric.Pattern({source:r,repeat:n});4==e.attr_Fillstyle&&(o.offsetX=(e.OffsetWidth()-t.getWidth())/2,o.offsetY=(e.OffsetHeight()-t.getHeight())/2),e.renderEx(o)})}else this.renderEx(this.FillColor())},TStdShape.prototype.renderEx=function(t){this.canvas.setHeight(this.OffsetHeight()),this.canvas.setWidth(this.OffsetWidth());var e,n=convertColor(this.FillColor()),i=convertColor(this.FillColor2()),r=convertColor(this.LineColor()),o=this.LineWidth(),a=2*o;if(0==this.attr_ShapeType&&(e=new fabric.Line([0,(this.OffsetHeight()-a)/2,this.OffsetWidth()-a,(this.OffsetHeight()-a)/2],{fill:r,stroke:r,strokeWidth:o,selectable:!1})),1==this.attr_ShapeType&&(e=new fabric.Line([(this.OffsetWidth()-a)/2,0,(this.OffsetWidth()-a)/2,this.OffsetHeight()-a],{fill:r,stroke:r,strokeWidth:o,selectable:!1})),3==this.attr_ShapeType&&(e=new fabric.Line([0,this.OffsetHeight()-a,this.OffsetWidth()-a,0],{fill:r,stroke:r,strokeWidth:o,selectable:!1})),2==this.attr_ShapeType&&(e=new fabric.Line([0,0,this.OffsetWidth()-a,this.OffsetHeight()-a],{fill:r,stroke:r,strokeWidth:o,selectable:!1})),4==this.attr_ShapeType){var s=Min(this.OffsetWidth()-a,this.OffsetHeight()-a),l=Min(this.OffsetWidth()-a,this.OffsetHeight()-a);e=new fabric.Rect({top:0,left:0,width:s,height:l,fill:n}),!0}if(5==this.attr_ShapeType){s=(this.OffsetWidth()-a)/2-2,l=(this.OffsetHeight()-a)/2-2;e=new fabric.Ellipse({top:0,left:0,rx:s,ry:l,fill:n})}if(6==this.attr_ShapeType){var d=Min(this.OffsetWidth()-a,this.OffsetHeight()-a)/2-2;e=new fabric.Circle({top:0,left:0,radius:d,fill:n}),!0}if(7==this.attr_ShapeType){s=this.OffsetWidth()-a,l=this.OffsetHeight()-a;e=new fabric.Rect({top:0,left:0,width:s,height:l,fill:n}),!0}var h=0;if(8==this.attr_ShapeType||9==this.attr_ShapeType){s=this.OffsetWidth()-a,l=this.OffsetHeight()-a;var u=(this.OffsetWidth()-a)/3,c=(this.OffsetHeight()-a)/3,p=(this.OffsetWidth()-a)/4,m=(this.OffsetHeight()-a)/4;e=new fabric.Polygon([{x:0,y:m},{x:2*u,y:m},{x:2*u,y:0},{x:s,y:l/2},{x:2*u,y:l},{x:2*u,y:3*m},{x:0,y:3*m}],{left:0,top:0,fill:n}),h=8==this.attr_ShapeType?0:180}if(10==this.attr_ShapeType||11==this.attr_ShapeType){s=this.OffsetWidth()-a,l=this.OffsetHeight()-a,u=(this.OffsetWidth()-a)/3,c=(this.OffsetHeight()-a)/3,p=(this.OffsetWidth()-a)/4,m=(this.OffsetHeight()-a)/4;e=new fabric.Polygon([{x:0,y:c},{x:s/2,y:0},{x:s,y:c},{x:3*p,y:c},{x:3*p,y:l},{x:p,y:l},{x:p,y:c}],{left:0,top:0,fill:n}),h=10==this.attr_ShapeType?0:180}if(this.attr_ShapeType>11&&this.attr_ShapeType<16){s=this.OffsetWidth()-a,l=this.OffsetHeight()-a;13==this.attr_ShapeType&&(h=180),14==this.attr_ShapeType&&(h=270,s=this.OffsetHeight()-a,l=this.OffsetWidth()-a),15==this.attr_ShapeType&&(h=90,s=this.OffsetHeight()-a,l=this.OffsetWidth()-a),e=new fabric.Triangle({top:0,left:0,width:s,height:l,fill:n,angle:h})}if(16==this.attr_ShapeType){s=this.OffsetWidth()-a,l=this.OffsetHeight()-a,u=(this.OffsetWidth()-a)/3,c=(this.OffsetHeight()-a)/3,p=(this.OffsetWidth()-a)/4,m=(this.Height()-a)/4;e=new fabric.Polygon([{x:0,y:l/2},{x:u,y:0},{x:u,y:m},{x:2*u,y:m},{x:2*u,y:0},{x:s,y:l/2},{x:2*u,y:l},{x:2*u,y:3*m},{x:u,y:3*m},{x:u,y:l}],{left:0,top:0,fill:n})}if(17==this.attr_ShapeType){s=this.OffsetWidth()-a,l=this.OffsetHeight()-a,u=(this.OffsetWidth()-a)/3,c=(this.OffsetHeight()-a)/3,p=(this.OffsetWidth()-a)/4,m=(this.OffsetHeight()-a)/4;e=new fabric.Polygon([{x:0,y:c},{x:s/2,y:0},{x:s,y:c},{x:3*p,y:c},{x:3*p,y:2*c},{x:s,y:2*c},{x:s/2,y:l},{x:0,y:2*c},{x:p,y:2*c},{x:p,y:c}],{left:0,top:0,fill:n})}0==this.attr_Fillstyle&&(e.fill="rgba(0,0,0,0)"),2==this.attr_Fillstyle&&e.setGradient("fill",{x1:0,y1:0,x2:0,y2:e.height,colorStops:{0:n,1:i}}),1==this.attr_Fillstyle&&e.setGradient("fill",{x1:0,y1:0,x2:e.width,y2:0,colorStops:{0:n,1:i}}),this.attr_Fillstyle>2&&this.attr_Fillstyle<6&&""!=this.Image()&&(e.fill=t),6==this.attr_Fillstyle&&(e.fill=n),o>0&&e.set({strokeWidth:o,stroke:r}),e.angle=this.Angle()+h,this.canvas.add(e),this.canvas.centerObject(e),e.setCoords(),this.canvas.setBackgroundColor("rgba(0,0,0,0)",this.canvas.renderAll.bind(this.canvas))},TStdSpinButton.prototype=new TStdVisibleComponent,TStdSpinButton.prototype.constructor=TStdSpinButton,TStdSpinButton.prototype.attr_CaptionOn="AN",TStdSpinButton.prototype.attr_CaptionOff="Aus",TStdSpinButton.prototype.attr_State=0,TStdSpinButton.prototype.attr_WidthOn="",TStdSpinButton.prototype.attr_WidthOff="",TStdSpinButton.prototype.onChange=function(t){this.OnChange&&this.OnChange(t)},TStdSpinButton.prototype.onpgclose=function(){var t=this;removeEvent(this.obj.id+"_on","click",function(e){t.ChangeOn(e)}),removeEvent(this.obj.id+"_off","click",function(e){t.ChangeOff(e)}),TStdVisibleComponent.prototype.onpgclose.call(this)},TStdSpinButton.prototype.ChangeOn=function(t){(this.Enabled()||1==this.Enabled())&&(jQuery("#"+this.obj.id+"_off").removeClass("selected"),jQuery("#"+this.obj.id+"_on").addClass("selected"),this.attr_State=1,this.onChange(this.attr_State))},TStdSpinButton.prototype.ChangeOff=function(t){(this.Enabled()||1==this.Enabled())&&(jQuery("#"+this.obj.id+"_on").removeClass("selected"),jQuery("#"+this.obj.id+"_off").addClass("selected"),this.attr_State=0,this.onChange(this.attr_State))},TStdSpinButton.prototype.State=function(t){if(arguments.length<=0)return this.attr_State;1==t?this.ChangeOn():this.ChangeOff()},TStdSpinButton.prototype.CaptionOn=function(t){if(arguments.length<=0)return this.attr_CaptionOn;this.attr_CaptionOn=t,jQuery("#"+this.obj.id+"_on").children(1).text(t)},TStdSpinButton.prototype.CaptionOff=function(t){if(arguments.length<=0)return this.attr_CaptionOff;this.attr_CaptionOff=t,jQuery("#"+this.obj.id+"_off").children(1).text(t)},TStdSpinButton.prototype.WidthOn=function(t){if(arguments.length<=0)return jQuery("#"+this.obj.id+"_on").outerWidth();this.attr_WidthOn=t,""!=t&&jQuery("#"+this.obj.id+"_on").outerWidth(t)},TStdSpinButton.prototype.WidthOff=function(t){if(arguments.length<=0)return jQuery("#"+this.obj.id+"_off").outerWidth();this.attr_WidthOff=t,""!=t&&jQuery("#"+this.obj.id+"_off").outerWidth(t)},TStdCssButton.prototype=new TStdBitBtn,TStdCssButton.prototype.constructor=TStdCssButton,TStdCssButton.prototype.attr_cssClass="defaultCSSbutton",TStdCssButton.prototype.attr_cssClassHover="defaultCSSbuttonHover",TStdCssButton.prototype.attr_cssClassPressed="defaultCSSbuttonPressed",TStdCssButton.prototype.attr_cssClassDisabled="defaultCSSbuttonDisabled",TStdCssButton.prototype.attr_cssClassImage="",TStdCssButton.prototype.btnstate=0,TStdCssButton.prototype.Color=function(t){return"with css defined"},TStdCssButton.prototype.cssClassHover=function(t){if(!arguments.length)return this.attr_cssClassHover;this.attr_cssClassHover=t,this.UpdateClass()},TStdCssButton.prototype.cssClassImage=function(t){if(!arguments.length)return this.attr_cssClassImage;this.attr_cssClassImage=t,this.setGlyphCaption()},TStdCssButton.prototype.cssClassPressed=function(t){if(!arguments.length)return this.attr_cssClassPressed;this.attr_cssClassPressed=t,this.UpdateClass()},TStdCssButton.prototype.cssClassDisabled=function(t){if(!arguments.length)return this.attr_cssClassDisabled;this.attr_cssClassDisabled=t,this.UpdateClass()},TStdCssButton.prototype.onpgclose=function(){var t=this;removeEvent(this.obj,"mouseover",function(e){t.changeState(e)}),removeEvent(this.obj,"mousedown",function(e){t.changeState(e)}),removeEvent(this.obj,"mouseup",function(e){t.changeState(e)}),removeEvent(this.obj,"mouseout",function(e){t.changeState(e)}),TStdBitBtn.prototype.onpgclose.call(this)},TStdCssButton.prototype.Enabled=function(t){if(!arguments.length)return TStdBitBtn.prototype.Enabled.call(this);TStdBitBtn.prototype.Enabled.call(this,t),t=AnyToBool(t),this.btnstate=t?0:-1,this.UpdateClass()},TStdCssButton.prototype.changeState=function(t){if(0==pages[this.obj.pageName].PageMode()){if(0==this.Enabled());else{var e=0;switch(t.type){case"mouseover":e=1;break;case"mousedown":e=2;break;case"mouseup":e=1;break;case"mouseout":e=0}this.btnstate=e}this.UpdateClass()}},TStdCssButton.prototype.UpdateClass=function(){this.btnstate&&(jQuery(this.obj).removeClass(this.cssClassHover()),jQuery(this.obj).removeClass(this.cssClassPressed()),jQuery(this.obj).addClass(this.cssClass()),jQuery(this.obj).addClass(this.cssClassDisabled())),0==this.btnstate&&(jQuery(this.obj).removeClass(this.cssClassPressed()),jQuery(this.obj).removeClass(this.cssClassHover()),jQuery(this.obj).removeClass(this.cssClassDisabled()),jQuery(this.obj).addClass(this.cssClass())),1==this.btnstate&&(jQuery(this.obj).removeClass(this.cssClassPressed()),jQuery(this.obj).removeClass(this.cssClassDisabled()),jQuery(this.obj).addClass(this.cssClass()),jQuery(this.obj).addClass(this.cssClassHover())),2==this.btnstate&&(jQuery(this.obj).removeClass(this.cssClassDisabled()),jQuery(this.obj).removeClass(this.cssClassHover()),jQuery(this.obj).addClass(this.cssClass()),jQuery(this.obj).addClass(this.cssClassPressed()))},TStdCssButton.prototype.setGlyphCaption=function(){if(""==this.attr_Glyph)return""!=this.attr_Caption?void(this.obj.innerHTML=this.attr_Caption):void 0;var t=expandmetavar(this.attr_Glyph,this.pageName),e=this.Caption();if(""==this.attr_cssClassImage)switch(this.Layout()){case 0:this.obj.innerHTML='<img style="vertical-align:middle;" src='+t+'><span style="vertical-align:middle;">&nbsp;'+e+"</span>";break;case 1:this.obj.innerHTML='<span style="vertical-align:middle;">'+e+'&nbsp;</span><img style="vertical-align:middle;" src='+t+">";break;case 2:this.obj.innerHTML="<img src="+t+"><br>"+e;break;case 3:this.obj.innerHTML=e+"<br><img src="+t+">";break;case 4:this.obj.innerHTML='<img style="vertical-align:middle;" src='+t+">"}else this.obj.innerHTML="<span>"+e+'&nbsp;</span><img style="'+this.attr_cssClassImage+'" src='+t+">"},TStdSlider.prototype=new TStdVisibleComponent,TStdSlider.prototype.constructor=TStdSlider,TStdSlider.prototype._line=null,TStdSlider.prototype._icon=null,TStdSlider.prototype.dragg=!1,TStdSlider.prototype.attr_MinValue=0,TStdSlider.prototype.attr_MaxValue=100,TStdSlider.prototype.attr_Position=0,TStdSlider.prototype.attr_Icon="",TStdSlider.prototype.attr_IconHeight=0,TStdSlider.prototype.attr_IconWidth=0,TStdSlider.prototype._minmaxdif=100,TStdSlider.prototype.Position=function(t){var e=this.obj.clientWidth-this._icon.offsetWidth,n=this._minmaxdif;if(arguments.length<=0){var i=n*(this._icon.offsetLeft/e);return this.attr_Position=i,i}if(this.dragg)return this.attr_Position;(t=AnyToInt(t))<this.MinValue()&&(t=this.MinValue()),t>this.MaxValue()&&(t=this.MaxValue());var r=e*(t/n);this._IconPosition(r+this._icon.offsetWidth/2)},TStdSlider.prototype.MinValue=function(t){if(arguments.length<=0)return this.attr_MinValue;t=AnyToInt(t),this.attr_MinValue=t,this._minmaxdif=this.MaxValue()-t},TStdSlider.prototype.MaxValue=function(t){if(arguments.length<=0)return this.attr_MaxValue;t=AnyToInt(t),this.attr_MaxValue=t,this._minmaxdif=t-this.MinValue()},TStdSlider.prototype.doOnPositionChange=function(){var t=findIdeaObj(this.obj);if(null!=t){var e=pages[t.pageName];e[t.obj].OnPositionChange&&e[t.obj].OnPositionChange(this.Position())}},TStdSlider.prototype.doOnPositionChanging=function(){var t=findIdeaObj(this.obj);if(null!=t){var e=pages[t.pageName];e[t.obj].OnPositionChanging&&e[t.obj].OnPositionChanging(this.Position())}},TStdSlider.prototype.Icon=function(t){if(arguments.length<=0)return this.attr_Icon;this.attr_Icon=t,""==t&&(t=url_libs+IDEASLIDERDEFICON),this._icon.src=expandmetavar(t,this.obj.pageName)},TStdSlider.prototype.IconWidth=function(t){if(!arguments.length)return this.attr_IconWidth;this.attr_IconWidth=t,this.calcControls()},TStdSlider.prototype.IconHeight=function(t){if(!arguments.length)return this.attr_IconHeight;this.attr_IconHeight=t,this.calcControls()},TStdSlider.prototype.calcControls=function(){this.attr_IconHeight>0?(this._icon.style.height=this.attr_IconHeight+"px",this._icon.style.top=this.obj.clientHeight/2-this.attr_IconHeight/2+"px"):(this._icon.style.height=this.obj.clientHeight+"px",this._icon.style.top="0px"),this.attr_IconWidth>0?this._icon.style.width=this.attr_IconWidth+"px":this._icon.style.width=this.obj.clientHeight+"px";var t=this.obj.clientWidth;t<1&&(t=1),this._line.style.width=t+"px";var e=this.obj.clientHeight/3;e<1&&(e=1),this._line.style.height=e+"px",this._line.style.top=e+"px"},TStdSlider.prototype.Height=function(t){if(!arguments.length)return TStdVisibleComponent.prototype.Height.call(this);TStdVisibleComponent.prototype.Height.call(this,t),this.calcControls()},TStdSlider.prototype.Width=function(t){if(!arguments.length)return TStdVisibleComponent.prototype.Width.call(this);TStdVisibleComponent.prototype.Width.call(this,t),this.calcControls()},TStdSlider.prototype._IconPosition=function(t){var e=this._icon.offsetWidth,n=t-e/2;n<0&&(n=0),n>this.OffsetWidth()-e&&(n=this.obj.clientWidth-e),this._icon.style.left=n+"px"},TStdSlider.prototype.SetIconPosition=function(t){this._IconPosition(t),this.doOnPositionChanging()},TStdSlider.prototype.msdown_callback=function(t){t.idea.cancelEvent=!0},TStdSlider.prototype.msmove_callback=function(t){t.idea.cancelEvent=!0},TStdSlider.prototype.msup_callback=function(t){t.idea.cancelEvent=!0},TStdSlider.prototype.OnMouseMove=function(t,e,n){this.dragg&&this.SetIconPosition(t)},TStdSlider.prototype.OnMouseUp=function(t,e,n){this.dragg=!1,this.doOnPositionChange()},TStdSlider.prototype.OnMouseDown=function(t,e,n){this.dragg=!0,this.SetIconPosition(t)},TStdSpeedButton.prototype=new TStdBitBtn,TStdSpeedButton.prototype.constructor=TStdSpeedButton,TStdRadioButton.prototype=new TStdVisibleComponent,TStdRadioButton.prototype.constructor=TStdRadioButton,TStdRadioButton.prototype.attr_Caption="",TStdRadioButton.prototype.attr_Checked=0,TStdRadioButton.prototype.attr_GroupName=0,TStdRadioButton.prototype.Caption=complexCaption,TStdRadioButton.prototype.OnClick=function(t){if(null!=t){var e=extractEventTarget(t);null==e||null==e.nodeName||"SPAN"!=e.nodeName&&"INPUT"!=e.nodeName||this.Checked(!0)}TStdVisibleComponent.prototype.OnClick.call(this,t)},TStdRadioButton.prototype.Checked=function(t){if(!arguments.length)return 1==this.obj.firstChild.checked?1:0;t=Number(t),this.obj.firstChild.checked=1==t,this.attr_Checked=t},TStdRadioButton.prototype.JSTabIndex=function(t){if(!arguments.length)return this.attr_JSTabIndex;t=AnyToInt(t),isNaN(t)||(this.attr_JSTabIndex=t,this.obj.tabIndex=-1,this.obj.firstChild.tabIndex=t)},TStdRadioButton.prototype.GroupName=function(t){if(!arguments.length)return this.attr_GroupName;this.attr_GroupName=t;var e="",n="",i=null;for(this.obj.pageName&&(n=e=this.obj.pageName),i=this.getParentasComp();null!=i&&"undefined"!=i&&i.Name()!=e;)n=n+"_"+i.Name(),i=i.getParentasComp();n+="_"+t,this.obj.firstChild.name=n},TStdRadioButton.prototype.Height=function(t){if(!arguments.length)return TStdVisibleComponent.prototype.Height.call(this);TStdVisibleComponent.prototype.Height.call(this,t);var e=this.obj.firstChild;e.offsetHeight>=AnyToInt(t)?e.style.height="100%":(e.style.height="auto",this.obj.style.lineHeight=t+px,e.style.lineHeight=t+px)},TStdRadioButton.prototype.Width=function(t){if(!arguments.length)return TStdVisibleComponent.prototype.Width.call(this);TStdVisibleComponent.prototype.Width.call(this,t);var e=this.obj.firstChild;e.offsetWidth>=AnyToInt(t)?e.style.width="100%":e.style.width="auto"},TStdRadioButton.prototype.onpgshown=function(){this.Height(this.Height()),this.Width(this.Width()),TStdVisibleComponent.prototype.onpgshown.call(this)},TStdRadioButton.prototype.Enabled=function(t){if(!arguments.length)return this.attr_Enabled;t=AnyToInt(t),TStdVisibleComponent.prototype.Enabled.call(this,t),this.obj.firstChild.disabled=0==t?"disabled":""},TStdFocusRadioButton.prototype=new TStdVisibleComponent,TStdFocusRadioButton.prototype.constructor=TStdFocusRadioButton,TStdFocusRadioButton.prototype.attr_Checked=0,TStdFocusRadioButton.prototype.attr_GroupName=0,TStdFocusRadioButton.prototype.Checked=function(t){if(!arguments.length)return 1==this.obj.checked?1:0;t=Number(t),this.obj.checked=1==t,this.attr_Checked=t},TStdFocusRadioButton.prototype.GroupName=function(t){if(!arguments.length)return this.attr_GroupName;this.attr_GroupName=t,this.obj.name=t},TStdFocusRadioButton.prototype.onpgshown=function(){this.Height(this.Height()),this.Width(this.Width()),TStdVisibleComponent.prototype.onpgshown.call(this)},TStdFocusRadioButton.prototype.Enabled=function(t){if(!arguments.length)return this.attr_Enabled;t=AnyToInt(t),TStdVisibleComponent.prototype.Enabled.call(this,t),this.obj.disabled=0==t?"disabled":""},TStdTreeView.prototype=new TStdVisibleComponent,TStdTreeView.prototype.constructor=TStdTreeView,TStdTreeView.prototype.attr_AutoFullExpand=0,TStdTreeView.prototype.attr_AutoExpand=1,TStdTreeView.prototype.attr_Borderstyle=1,TStdTreeView.prototype.attr_Filename="",TStdTreeView.prototype.attr_XMLFilename="",TStdTreeView.prototype.attr_XMLFileName="",TStdTreeView.prototype.attr_GlyphNormal="",TStdTreeView.prototype.attr_GlyphExpanded="",TStdTreeView.prototype.attr_GlyphCollapsed="",TStdTreeView.prototype.attr_ShowLines=0,TStdTreeView.prototype.attr_ShowButtons=0,TStdTreeView.prototype.attr_ItemHLBGColor="",TStdTreeView.prototype.attr_ItemHLFontColor="",TStdTreeView.prototype.attr_Class="",TStdTreeView.prototype.attr_SmallIcons="",TStdTreeView.prototype.attr_Index=0,TStdTreeView.prototype.attr_IconHorAlignment=0,TStdTreeView.prototype.attr_AutoLineBreak=0,TStdTreeView.prototype.content="",TStdTreeView.prototype.isPageReady=!1,TStdTreeView.prototype.IconHorAlignment=function(t){if(!arguments.length)return this.attr_IconHorAlignment;this.attr_IconHorAlignment=AnyToInt(t),this.tree.config.iconHorAlignment=1==this.attr_IconHorAlignment},TStdTreeView.prototype.ItemHLBGColor=function(t){if(!arguments.length)return this.attr_ItemHLBGColor;this.attr_ItemHLBGColor=t,this.tree.config.hlbackgroundColor=t},TStdTreeView.prototype.Class=function(t){if(!arguments.length)return this.attr_Class;this.attr_Class=t,this.tree.config.Class=t},TStdTreeView.prototype.SmallIcons=function(t){if(!arguments.length)return this.attr_SmallIcons;this.attr_SmallIcons=t,this.tree.config.SmallIcons=1==this.attr_SmallIcons},TStdTreeView.prototype.ItemHLFontColor=function(t){if(!arguments.length)return this.attr_ItemHLFontColor;this.attr_ItemHLFontColor=t,this.tree.config.hlColor=t},TStdTreeView.prototype.AutoLineBreak=function(t){if(!arguments.length)return this.attr_AutoLineBreak;this.attr_AutoLineBreak=AnyToInt(t)},TStdTreeView.prototype.JSTabIndex=function(t){if(!arguments.length)return this.attr_JSTabIndex;t=AnyToInt(t),isNaN(t)||(this.attr_JSTabIndex=t,this.obj.tabIndex=t,this.tree.config.lastTabIndex=t+1)},TStdTreeView.prototype.AutoFullExpand=function(t){if(!arguments.length)return this.attr_AutoFullExpand;t=Number(t),this.attr_AutoFullExpand=t},TStdTreeView.prototype.AutoExpand=function(t){if(!arguments.length)return this.attr_AutoFullExpand;t=Number(t),this.attr_AutoExpand=t,this.tree.config.closeSameLevel=1==t},TStdTreeView.prototype.Borderstyle=function(t){if(!arguments.length)return this.attr_Borderstyle;t=AnyToInt(t);this.attr_Borderstyle=t,this.obj.style.borderStyle=1==t?"groove":"none"},TStdTreeView.prototype.Filename=function(t){if(!arguments.length)return this.attr_Filename;this.attr_Filename=t,this.content=ReadTextFile(t,!0),this.tree.selectedNode=null,this.tree.clear(),this.tree.fillNodes(this.tree.root,this.content),""!=this.content&&this.isPageReady&&(this.obj.innerHTML=this.tree.toString())},TStdTreeView.prototype.loadFromString=function(t){arguments.length&&(this.content=t,this.tree.selectedNode=null,this.tree.clear(),this.tree.fillNodes(this.tree.root,this.content),""!=this.content&&this.isPageReady&&(this.obj.innerHTML=this.tree.toString()))},TStdTreeView.prototype.XMLFileName=function(t){if(!arguments.length)return this.XMLFilename();this.XMLFilename(t)},TStdTreeView.prototype.XMLFilename=function(t){if(!arguments.length)return this.attr_XMLFilename;if(t.length>0&&""!=t){this.attr_XMLFilename=t,this.content=ReadTextFile(t,!0),this.content.startsWith("<?xml")&&(this.content=this.content.substring(this.content.lastIndexOf("?>")+2,this.content.length));var e=GetXMLDocFromString(this.content);this.tree.selectedNode=null,this.tree.clear(),this.tree.fillNodesfromXML(this.tree.root,e,0,0),""!=this.content&&this.isPageReady&&(this.obj.innerHTML=this.tree.toString())}},TStdTreeView.prototype.GlyphNormal=function(t){if(!arguments.length)return this.attr_GlyphNormal;this.attr_GlyphNormal=t,t=expandmetavar(t,this.pageName),this.tree.icon.node=t,""!=this.content&&this.isPageReady&&(this.obj.innerHTML=this.tree.toString())},TStdTreeView.prototype.GlyphExpanded=function(t){if(!arguments.length)return this.attr_GlyphExpanded;t=expandmetavar(t,this.pageName),this.tree.icon.folderOpen=t,""!=this.content&&this.isPageReady&&(this.obj.innerHTML=this.tree.toString())},TStdTreeView.prototype.GlyphCollapsed=function(t){if(!arguments.length)return this.attr_GlyphCollapsed;this.attr_Expanded=t,t=expandmetavar(t,this.pageName),this.tree.icon.folder=t,""!=this.content&&this.isPageReady&&(this.obj.innerHTML=this.tree.toString())},TStdTreeView.prototype.ShowLines=function(t){if(!arguments.length)return this.attr_ShowLines;t=Number(t),this.attr_ShowLines=t,this.tree.config.useLines=1==t,""!=this.content&&this.isPageReady&&(this.obj.innerHTML=this.tree.toString())},TStdTreeView.prototype.ShowButtons=function(t){if(!arguments.length)return this.attr_ShowButtons;t=Number(t),this.attr_ShowButtons=t,this.tree.config.useButtons=1==t,""!=this.content&&this.isPageReady&&(this.obj.innerHTML=this.tree.toString())},TStdTreeView.prototype.TreeViewFullExpand=function(t){this.tree.oAll(!0)},TStdTreeView.prototype.TreeViewFullCollapse=function(t){this.tree.oAll(!1)},TStdTreeView.prototype.TreeViewItemCount=function(){return this.tree.nodes.length},TStdTreeView.prototype.LoadTreeView=function(t){this.Filename(t)},TStdTreeView.prototype.LoadXMLTreeView=function(t){this.XMLFilename(t)},TStdTreeView.prototype.SetXMLTreeView=function(t){this.content=t,this.content.startsWith("<?xml")&&(this.content=this.content.substring(this.content.lastIndexOf("?>")+2,this.content.length));var e=GetXMLDocFromString(this.content);this.tree.selectedNode=null,this.tree.clear(),this.tree.fillNodesfromXML(this.tree.root,e,0,0),""!=this.content&&this.isPageReady&&(this.obj.innerHTML=this.tree.toString())},TStdTreeView.prototype.GetXmlNode=function(t){if((t=Number(t))<this.tree.nodes.length)return this.tree.nodes[t].xmlNode},TStdTreeView.prototype.GetTreeViewInfo=function(t){if((t=Number(t))<this.tree.nodes.length)return this.tree.nodes[t].info},TStdTreeView.prototype.SetTreeViewInfo=function(t,e){(t=Number(t))<this.tree.nodes.length&&(this.tree.nodes[t].info=e)},TStdTreeView.prototype.SetTreeViewText=function(t,e){(t=Number(t))<this.tree.nodes.length&&(this.tree.nodes[t].name=e),$("s"+this.pageName+this.obj.obj+t).innerHTML=e},TStdTreeView.prototype.GetTreeViewText=function(t,e){if((t=Number(t))<this.tree.nodes.length)return this.tree.nodes[t].name},TStdTreeView.prototype.Index=function(t){if(!arguments.length)return this.tree.selectedNode;t=AnyToInt(t),this.attr_Index=t,t>-1&&t<this.tree.nodes.length&&this.isPageReady&&this.tree.openTo(t,!0,!1)},TStdTreeView.prototype.getParentIndex=function(t){return isVarUndefined(t)?this.tree.nodes[this.tree.selectedNode].pid:this.tree.nodes[t].pid},TStdTreeView.prototype.onpgready=function(){this.isPageReady=!0,this.obj.innerHTML=this.tree.toString(),TStdVisibleComponent.prototype.onpgready.call(this)},TStdTreeView.prototype.onpgshown=function(){1==this.attr_AutoFullExpand&&this.tree.oAll(!0),this.Index(this.attr_Index),TStdVisibleComponent.prototype.onpgshown.call(this)},TStdTreeView.prototype._onchng=function(){this.isEnabled()&&this.OnChange&&this.OnChange()},TStdTreeView.prototype._onclk=function(){this.isEnabled()&&this.OnClick&&this.OnClick()},TStdTreeView.prototype._ondblclk=function(){this.isEnabled()&&this.OnDblClick&&this.OnDblClick()},TStdTreeView.prototype._onent=function(){this.isEnabled()&&(pages[this.pageName].hasFocus(),this.OnEnter&&this.OnEnter())},TStdTreeView.prototype._onext=function(){this.isEnabled()&&this.OnExit&&this.OnExit()},TStdTreeView.prototype._msdown=function(t){if(this.isEnabled()&&this.OnMouseDown){var e=convertMouseParams(t);this.OnMouseDown(e.x,e.y,e.shiftState)}},TStdTreeView.prototype._msup=function(t){if(this.isEnabled()&&this.OnMouseUp){var e=convertMouseParams(t);this.OnMouseUp(e.x,e.y,e.shiftState)}},TStdTreeView.prototype._msenter=function(){this.isEnabled()&&this.OnMouseEnter&&this.OnMouseEnter()},TStdTreeView.prototype._msexit=function(){this.isEnabled()&&this.OnMouseExit&&this.OnMouseExit()},TStdTreeView.prototype._msmove=function(t){if(this.isEnabled()){if(this.OnMouseMove){var e=convertMouseParams(t);this.OnMouseMove(e.x,e.y,e.shiftState)}this.Dragable()&&this.bewege(t)}},TStdTreeView.prototype._keypressed=function(t){var e;this.isEnabled()&&(this.OnKeyPress&&(t.keyCode?e=t.keyCode:t.which&&(e=t.which),this.OnKeyPress(AsciiToChar(e))))},TStdTreeView.prototype._keyreleased=function(t,e){var n;this.isEnabled()&&(t.keyCode?n=t.keyCode:t.which&&(n=t.which),this.OnKeyUp&&this.OnKeyUp(AsciiToChar(n)),40==n&&this.tree.s(e+1,1,!0),38==n&&this.tree.s(e-1,1,!0))},TStdTreeView.prototype._keytyped=function(t,e){var n;this.isEnabled()&&(this.OnKeyDown&&(t.keyCode?n=t.keyCode:t.which&&(n=t.which),this.OnKeyDown(AsciiToChar(n))))},TStdCheckBox.prototype=new TStdRadioButton,TStdCheckBox.prototype.constructor=TStdCheckBox,TStdCheckBox.prototype.attr_State=null,TStdCheckBox.prototype.OnClick=function(t){if(null!=t){var e=extractEventTarget(t);null!=e&&null!=e.nodeName&&"SPAN"==e.nodeName&&(this.Checked()?this.Checked(!1):this.Checked(!0))}TStdVisibleComponent.prototype.OnClick.call(this,t)},TStdEdit.prototype=new TStdVisibleComponent,TStdEdit.prototype.constructor=TStdEdit,TStdEdit.prototype.attr_BorderStyle=0,TStdEdit.prototype.attr_BorderWidth=0,TStdEdit.prototype.attr_Borderstyle=0,TStdEdit.prototype.attr_Borderwidth=0,TStdEdit.prototype.attr_Alignment=null,TStdEdit.prototype.attr_ReadOnly=0,TStdEdit.prototype.attr_Text="",TStdEdit.prototype.attr_CharCase=0,TStdEdit.prototype.attr_PasswordChar="",TStdEdit.prototype.Alignment=function(t){if(!arguments.length)return this.attr_Alignment;this.attr_Alignment=AnyToInt(t);var e="",n=this.obj.style;switch(this.attr_Alignment){case TALEFTJUSTIFY:e="left";break;case TACENTER:e="center";break;case TARIGHTJUSTIFY:e="right"}n.textAlign=e},TStdEdit.prototype.select=function(){this.obj.select()},TStdEdit.prototype.Enabled=function(t){if(!arguments.length)return this.attr_Enabled;TStdVisibleComponent.prototype.Enabled.call(this,t),this.obj.disabled=0==this.attr_Enabled},TStdEdit.prototype.CharCase=function(t){if(!arguments.length)return this.attr_attr_CharCase;var e="none";switch(t=AnyToInt(t),this.attr_attr_CharCase=t,t){case 0:e="none";break;case 1:e="lowercase";break;case 2:e="uppercase"}this.obj.textTransform=e},TStdEdit.prototype.ReadOnly=function(t){if(!arguments.length)return this.attr_ReadOnly;this.attr_ReadOnly=t,this.obj.readOnly=AnyToBool(t)},TStdEdit.prototype.PasswordChar=function(t){if(!arguments.length)return this.attr_PasswordChar;this.attr_PasswordChar=t},TStdEdit.prototype.Borderstyle=function(t){this.BorderStyle(t)},TStdEdit.prototype.Borderwidth=function(t){this.BorderWidth(t)},TStdEdit.prototype.BorderStyle=function(t){if(!arguments.length)return this.attr_BorderStyle;this.attr_BorderStyle=t;var e=this.obj.style;e.borderStyle=1==t?"inset":"solid",e.borderSize=1==t?"1":"0"},TStdEdit.prototype.Text=function(t){if(!arguments.length)return this.obj.value;this.attr_Text=t,this.obj.value=t},TStdEdit.prototype.BorderWidth=function(t){if(!arguments.length)return this.obj.attr_BorderWidth;this.attr_BorderWidth=t,this.obj.style.borderWidth=t+px},TStdEdit.prototype.onpgclose=function(){removeEvent(this.obj,"keyup",ICompsEvent.editcheck),TStdVisibleComponent.prototype.onpgclose.call(this)},TStdEdit.prototype.onkeyreleased_callback=function(t){t.idea.targ;var e=t.idea.iobj;e.OnChange&&e.OnChange()},TStdListBox.prototype=new TStdVisibleComponent,TStdListBox.prototype.constructor=TStdListBox,TStdListBox.prototype.attr_Items=null,TStdListBox.prototype.Items=null,TStdListBox.prototype.attr_ItemIndex=-1,TStdListBox.prototype.attr_Borderstyle=1,TStdListBox.prototype.attr_Text="",TStdListBox.prototype.attr_MultiSelect="",TStdListBox.prototype.MultiSelect=function(t){if(!arguments.length)return this.attr_MultiSelect;this.attr_MultiSelect=t,1==(t=AnyToInt(t))?this.obj.setAttribute("multiple",""):this.obj.removeAttribute("multiple")},TStdListBox.prototype.ItemIndex=function(t){if(!arguments.length)return this.obj.options.selectedIndex;var e=this.obj.options;t>-2&&t<e.length&&(this.attr_ItemIndex=t,e.selectedIndex=t)},TStdListBox.prototype.Borderstyle=function(t){if(!arguments.length)return this.att_Borderstyle;t=AnyToInt(t),this.att_Borderstyle=t},TStdListBox.prototype.AddListItem=function(t){return this.attr_Items.AddItem(t)},TStdListBox.prototype.GetListItem=function(t){return this.attr_Items.GetItem(t)},TStdListBox.prototype.GetListItemIndex=function(t){return this.attr_Items.GetItemIndex(t)},TStdListBox.prototype.DeleteListItem=function(t){this.attr_Items.DeleteItem(t)},TStdListBox.prototype.InsertListItem=function(t,e){this.attr_Items.InsertItem(t,e)},TStdListBox.prototype.GetListCount=function(t,e){return this.attr_Items.GetItemCount(t,e)},TStdListBox.prototype.SetListText=function(t){this.attr_Items.SetText(t)},TStdListBox.prototype.GetListText=function(){return this.attr_Items.GetText()},TStdListBox.prototype.onpgclose=function(){TStdVisibleComponent.prototype.onpgclose.call(this)},TStdListBox.prototype.deInit=function(){this.Items.ClearItems(),this.Items.obj=null,this.Items.parent=null,this.Items=null,this.attr_Items=null,TStdVisibleComponent.prototype.deInit.call(this)},TStdListBox.prototype.Text=function(t){if(!arguments.length)return this.GetListItem(this.ItemIndex());this.attr_Text=t},TStdListBox.prototype.onchange_callback=function(t){var e;t.keyCode?e=t.keyCode:t.which&&(e=t.which),40!=e&&38!=e||t.idea.iobj.OnClick()},TStdListBox.prototype.msclick_callback=function(t){var e=t.idea.iobj;IS.IE()&&e.OnChange&&e.OnChange()},TStdComboBox.prototype=new TStdListBox,TStdComboBox.prototype.constructor=TStdComboBox,TStdComboBox.prototype.Enabled=function(t){if(!arguments.length)return this.attr_Enabled;t=AnyToInt(t),TStdVisibleComponent.prototype.Enabled.call(this,t),this.obj.disabled=0==t?"disabled":""},TStdHotSpot.prototype=new TStdVisibleComponent,TStdHotSpot.prototype.constructor=TStdHotSpot,TStdHotSpot.prototype.attr_Border=0,TStdHotSpot.prototype.attr_Shadow=0,TStdHotSpot.prototype.Border=function(t){if(!arguments.length)return this.attr_Border;this.attr_Border=AnyToInt(t);var e=this.obj.style;e.borderStyle=1==this.attr_Border?"solid":"none",e.borderWidth="1"+px,e.borderColor=this.colorOrgValue},TStdHotSpot.prototype.Shadow=function(t){if(!arguments.length)return this.attr_Shadow;this.attr_Shadow=AnyToInt(t),1==this.attr_Shadow?setOpacity(5,this.obj.firstChild):setOpacity(0,this.obj.firstChild)},TStdHotSpot.prototype.Color=function(t){if(!arguments.length)return this.attr_Color;TStdVisibleComponent.prototype.Color.call(this,t);var e=this.obj;e.style.borderColor=this.colorOrgValue,e.firstChild.style.backgroundColor=this.colorOrgValue},TStdTrandivel.prototype=new TStdVisibleComponent,TStdTrandivel.prototype.constructor=TStdTrandivel,TStdTrandivel.prototype.attr_Transparency=-1,TStdTrandivel.prototype.attr_Transparent=-1,TStdTrandivel.prototype.attr_TransparentColor=-1,TStdTrandivel.prototype.tempColorBackBuffer=0,TStdTrandivel.prototype.Transparency=function(t){if(!arguments.length)return this.attr_Transparency;this.attr_Transparency=AnyToInt(t),-1!=this.Transparent()&&this.TransparentColor(this.TransparentColor())},TStdTrandivel.prototype.TransparentColor=function(t){if(!arguments.length)return this.attr_TransparentColor;this.attr_TransparentColor=t,-1!=this.Transparent()&&-1!=this.Transparency()&&setOpacity(100,this.obj)},TStdTrandivel.prototype.Transparent=function(t){if(!arguments.length)return this.attr_Transparent;this.attr_Transparent=AnyToInt(t)},TExtTreeView.prototype=new TStdTreeView,TExtTreeView.prototype.constructor=TExtTreeView,TExtTreeView.prototype.attr_Picture="",TExtTreeView.prototype.attr_NumGlyphs=0,TExtTreeView.prototype.Picture=function(t){if(!arguments.length)return this.attr_Picture;if(this.attr_Picture=t,""!=t){t=expandmetavar(null==(t=0==this.attr_NumGlyphs?t:this.attr_Picture0)?t=this.attr_Picture:t,this.pageName);var e=this.tree.icon;e.folder=t,e.folderOpen=t,e.node=t}},TExtTreeView.prototype.NumGlyphs=function(t){if(!arguments.length)return this.attr_NumGlyphs;t=AnyToInt(t),this.attr_NumGlyphs=t,this.Picture(this.Picture())},TExtTreeView.prototype.TreeViewChildCount=function(t){var e=0;return t<this.tree.nodes.length&&(e=this.tree.nodes[t].childs),e},TExtTreeView.prototype.TreeViewGetChildAbsoluteIndex=function(t,e){var n=e;return t<this.tree.nodes.length&&e<=this.tree.nodes[t].childs.length&&(n=t+e),n},TExtTreeView.prototype.TreeViewGetNodeLevel=function(t){var e=0;return t<this.tree.nodes.length&&(e=this.tree.nodes[t].depth),e},TExtTreeView.prototype.TreeViewHasNodeChildren=function(t){var e=0;return t<this.tree.nodes.length&&(e=this.tree.nodes[t].childs),0==e?0:1},TExtTreeView.prototype.TreeViewIsNodeExpanded=function(t){var e=0;return t<this.tree.nodes.length&&(e=this.tree.nodes[t]._io?1:0),e},TExtTreeView.prototype.TreeViewSetImageIndex=function(t,e){if(t=AnyToInt(t),e=AnyToInt(e),""!=this.attr_Picture&&t<this.tree.nodes.length&&e<this.attr_NumGlyphs){var n=expandmetavar(this["attr_Picture"+e],this.pageName);this.tree.nodes[t].icon=n,this.tree.nodes[t].iconOpen=n,$("i"+this.pageName+this.Name()+t).src=n}},TExtTreeView.prototype.TreeViewSetImageFile=function(t,e){if(t=AnyToInt(t),imageIndex=AnyToInt(imageIndex),t<this.tree.nodes.length){var n=expandmetavar(e,this.pageName);this.tree.nodes[t].icon=n,this.tree.nodes[t].iconOpen=n,$("i"+this.pageName+this.Name()+t).src=n}},TExtTreeView.prototype.onpgready=function(){this.Picture(this.Picture()),TStdTreeView.prototype.onpgready.call(this)},TStdAudioComponent.prototype=new TStdVisibleComponent,TStdAudioComponent.prototype.constructor=TStdAudioComponent,TStdAudioComponent.prototype.attr_Flags=0,TStdAudioComponent.prototype.attr_AutoPlay=0,TStdAudioComponent.prototype.attr_FinishWithPage=0,TStdAudioComponent.prototype.attr_Filename="",TStdAudioComponent.prototype.Flags=function(t){if(!arguments.length)return this.attr_Flags;this.attr_Flags=t},TStdAudioComponent.prototype.AutoPlay=function(t){if(!arguments.length)return this.attr_AutoPlay;this.attr_AutoPlay=t},TStdAudioComponent.prototype.FinishWithPage=function(t){if(!arguments.length)return this.attr_FinishWithPage;this.attr_FinishWithPage=t},TStdAudioComponent.prototype.Filename=function(t){if(!arguments.length)return this.attr_Filename;this.attr_Filename=t},TStdAudioComponent.prototype.PlayAudio=function(){var t=pages[this.pageName];t.isPageInit()&&""!=this.attr_Filename&&AudioPlay(this,expandmetavar(this.attr_Filename,this.pageName),this.attr_Flags,this.attr_FinishWithPage,t)},TStdAudioComponent.prototype.onpgshown=function(){TStdVisibleComponent.prototype.onpgshown.call(this),AnyToBool(this.AutoPlay())&&this.PlayAudio()},TStdTipComponent.prototype=new TStdVisibleComponent,TStdTipComponent.prototype.constructor=TStdTipComponent,TStdTipComponent.prototype.attr_BGColor=16777215,TStdTipComponent.prototype.attr_BorderColor=0,TStdTipComponent.prototype.BorderStyle="solid",TStdTipComponent.prototype.attr_BorderWidth=1,TStdTipComponent.prototype.attr_CloseBtn=0,TStdTipComponent.prototype.CloseBtnColor="['#FF0000','#FFFFFF','#FF0000','#FFFFFF']",TStdTipComponent.prototype.attr_Duration=0,TStdTipComponent.prototype.attr_Heigth=0,TStdTipComponent.prototype.attr_FontFace="Verdana",TStdTipComponent.prototype.attr_FontSize=9,TStdTipComponent.prototype.attr_FontWeight=0,TStdTipComponent.prototype.attr_FontColor=0,TStdTipComponent.prototype.attr_TitleFontFace="Verdana",TStdTipComponent.prototype.attr_TitleFontSize=10,TStdTipComponent.prototype.attr_TitleFontColor=16777215,TStdTipComponent.prototype.attr_TitleBGColor=0,TStdTipComponent.prototype.attr_Sticky=0,TStdTipComponent.prototype.attr_ClickClose=1,TStdTipComponent.prototype.BGColor=function(t){if(!arguments.length)return this.attr_BGColor;this.attr_BGColor=t},TStdTipComponent.prototype.BorderColor=function(t){if(!arguments.length)return this.attr_BorderColor;this.attr_BorderColor=t},TStdTipComponent.prototype.BorderWidth=function(t){if(!arguments.length)return this.attr_BorderWidth;this.attr_BorderWidth=t},TStdTipComponent.prototype.CloseBtn=function(t){if(!arguments.length)return this.attr_CloseBtn;this.attr_CloseBtn=t},TStdTipComponent.prototype.Duration=function(t){if(!arguments.length)return this.attr_Duration;this.attr_Duration=t},TStdTipComponent.prototype.Height=function(t){if(!arguments.length)return this.attr_Height;this.attr_Height=t},TStdTipComponent.prototype.FontFace=function(t){if(!arguments.length)return this.attr_FontFace;this.attr_FontFace=t},TStdTipComponent.prototype.FontSize=function(t){if(!arguments.length)return this.attr_FontSize;this.attr_FontSize=t},TStdTipComponent.prototype.FontColor=function(t){if(!arguments.length)return this.attr_FontColor;this.attr_FontColor=t},TStdTipComponent.prototype.FontWeight=function(t){if(!arguments.length)return this.attr_FontWeight;this.attr_FontWeight=t},TStdTipComponent.prototype.TitleFontFace=function(t){if(!arguments.length)return this.attr_TitleFontFace;this.attr_TitleFontFace=t},TStdTipComponent.prototype.TitleFontSize=function(t){if(!arguments.length)return this.attr_TitleFontSize;this.attr_TitleFontSize=t},TStdTipComponent.prototype.TitleFontColor=function(t){if(!arguments.length)return this.attr_TitleFontColor;this.attr_TitleFontColor=t},TStdTipComponent.prototype.TitleBGColor=function(t){if(!arguments.length)return this.attr_TitleBGColor;this.attr_TitleBGColor=t},TStdTipComponent.prototype.Sticky=function(t){if(!arguments.length)return this.attr_Sticky;this.attr_Sticky=t},TStdTipComponent.prototype.ClickClose=function(t){if(!arguments.length)return this.attr_ClickClose;this.attr_ClickClose=t},TStdTipComponent.prototype.SetCloseButtonColors=function(t,e,n,i){this.CloseBtnColor="['#"+convertColorToHEX(t)+"','#"+convertColorToHEX(e)+"','#"+convertColorToHEX(n)+"','#"+convertColorToHEX(i)+"']"},TStdTipComponent.prototype.ShowTip=function(Text,Title){if(null==CallbackAutoGlossar){var bgcolor="#"+convertColorToHEX(this.BGColor()).substring(2),bordercolor="#"+convertColorToHEX(this.BorderColor()).substring(2),fontcolor="#"+convertColorToHEX(this.FontColor()).substring(2),titlefontcolor="#"+convertColorToHEX(this.TitleFontColor()).substring(2),titlebgcolor="#"+convertColorToHEX(this.TitleBGColor()).substring(2);if(Text=StrReplace(Text,"'","&#39;"),0==this.CloseBtn())var clsbtn="false";else var clsbtn="true";if(0==this.FontWeight())var fw="normal";else var fw="bold";if(0==this.Sticky())var sticky="false";else var sticky="true";if(0==this.ClickClose())var bClickClose="false";else var bClickClose="true";var cmd1="Tip('"+Text+"', BGCOLOR, '"+bgcolor+"', BORDERCOLOR, '"+bordercolor+"', BORDERWIDTH,"+this.BorderWidth()+", BORDERSTYLE, '"+this.BorderStyle,cmd2="', CLOSEBTN,"+clsbtn+", CLOSEBTNCOLORS, "+this.CloseBtnColor+", FOLLOWMOUSE, false, DURATION,"+this.Duration()+",HEIGHT,"+this.Height(),cmd3=", FONTFACE,'"+this.FontFace()+"', FONTSIZE, '"+this.FontSize()+"pt', FONTCOLOR,'"+fontcolor+"', FONTWEIGHT, '"+fw+"', TITLEFONTFACE,'"+this.TitleFontFace(),cmd4="', TITLEFONTSIZE, '"+this.TitleFontSize()+"pt', TITLEFONTCOLOR,'"+titlefontcolor+"',TITLEBGCOLOR,'"+titlebgcolor,cmd5="', CLICKCLOSE,"+bClickClose+", STICKY,"+sticky+",TITLE, '"+Title+"', WIDTH, -300)",cmd=cmd1+cmd2+cmd3+cmd4+cmd5;eval(cmd)}else pages[CallbackAutoGlossar.page][CallbackAutoGlossar.func](Title,Text)},TStdSplitContainer.prototype=new TStdVisibleComponent,TStdSplitContainer.prototype.constructor=TStdSplitContainer,TStdSplitContainer.prototype.attr_ChildArrangement=0,TStdSplitContainer.prototype.attr_Orientation=0,TStdSplitContainer.prototype.attr_Borderstyle=0,TStdSplitContainer.prototype.attr_Borderwidth=1,TStdSplitContainer.prototype.attr_BorderColor=CLBLACK,TStdSplitContainer.prototype.attr_Borderradius=0,TStdSplitContainer.prototype.attr_BackgroundImage="",TStdSplitContainer.prototype.attr_BackgroundSize="",TStdSplitContainer.prototype.attr_BackgroundPosition="",TStdSplitContainer.prototype.attr_BackgroundRepeat="",TStdSplitContainer.prototype.Borderstyle=function(t){if(!arguments.length)return this.attr_Borderstyle;this.attr_Borderstyle=AnyToInt(t),pages[this.pageName].PageMode()==pmEdit&&0==this.attr_Borderstyle?(this.obj.className.indexOf("it_framestyle7a")<0&&(this.obj.className="it_framestyle7a "+this.obj.className),this.obj.style.borderStyle="dashed"):(this.obj.className=StrReplace(this.obj.className,"it_framestyle7a ",""),this.obj.className=StrReplace(this.obj.className,"it_framestyle7a",""),this.obj.style.borderStyle=1==t?"solid":"none"),this.BorderColor(this.attr_BorderColor)},TStdSplitContainer.prototype.Borderwidth=function(t){if(!arguments.length)return this.attr_Borderwidth;this.attr_Borderwidth=AnyToInt(t),this.obj.style.borderWidth=t+"px"},TStdSplitContainer.prototype.BorderColor=function(t){if(!arguments.length)return this.attr_BorderColor;this.attr_BorderColor=AnyToInt(t),AnyToStr(t).toLowerCase().indexOf("rgb")<=0&&(t=convertColor(t)),this.obj.style.borderColor=t},TStdSplitContainer.prototype.Borderradius=function(t){if(!arguments.length)return this.attr_Borderradius;this.attr_Borderradius=AnyToInt(t),0!=AnyToInt(t)?this.obj.style.borderRadius=t+"px":this.obj.style.borderRadius=""},TStdSplitContainer.prototype.BackgroundImage=function(t){if(!arguments.length)return this.attr_BackgroundImage;this.attr_BackgroundImage=t,t=expandmetavar(t,this.pageName);var e=this.obj.style;e.backgroundImage="url("+t+")",e=null},TStdSplitContainer.prototype.BackgroundSize=function(t){if(!arguments.length)return this.attr_BackgroundSize;this.attr_BackgroundSize=t;var e=this.obj.style;e.backgroundSize=t,e=null},TStdSplitContainer.prototype.BackgroundPosition=function(t){if(!arguments.length)return this.attr_BackgroundPosition;this.attr_BackgroundPosition=t;var e=this.obj.style;e.backgroundPosition=t,e=null},TStdSplitContainer.prototype.BackgroundRepeat=function(t){if(!arguments.length)return this.attr_BackgroundRepeat;this.attr_BackgroundRepeat=t;var e=this.obj.style;e.backgroundRepeat=t,e=null},TStdSplitContainer.prototype.setBGStyle=function(){if(pages[this.pageName].PageMode()==pmRuntime);else if(1!=AnyToInt(this.attr_Borderstyle)){var t=this.obj.style;t.borderStyle="dotted",t.borderWidth="1px",t.borderColor="#760076"}},TStdSplitContainer.prototype.ChildArrangement=function(t){return arguments.length&&(t=AnyToInt(t),this.attr_ChildArrangement=t),this.attr_ChildArrangement},TStdSplitContainer.prototype.onpgshown=function(){TStdVisibleComponent.prototype.onpgshown.call(this),this.setBGStyle()},TStdSplitContainer.prototype.splitContainer=function(t,e,n){this.attr_Orientation=t,n||(n="System.SplitContainer");var i,r,o,a=e.split(",");for(i=0;i<a.length;i++)o=this.Name()+"_c"+(i+1),(r=InsertVertex(AssistedPage.Name(),n,o,this)).Name(o),r.LeftType(3),r.TopType(3),r.setBGStyle&&r.setBGStyle(),0==t?(r.HeightType(2),r.Height(100),r.Width(a[i])):(r.HeightType(2),r.Height(a[i]));return o},TStdSplitContainer.prototype.clear=function(){var t;for(t=this.childes.length-1;t>=0;t--)this.childes[t].__LN?0==AnyToInt(this.childes[t].__LN())&&DeleteObj(this.childes[t].Name(),"AssistedPage"):DeleteObj(this.childes[t].Name(),"AssistedPage")},TStdSplitContainer.prototype.delComp=function(t){var e;for(e=this.childes.length-1;e>=0;e--)return this.childes[e].Name==t&&(this.childes[e].__LN?0==AnyToInt(this.childes[e].__LN())&&DeleteObj(this.childes[e].Name(),"AssistedPage"):DeleteObj(this.childes[e].Name(),"AssistedPage")),!0;return!1},TStdSplitContainer.prototype.canInsert=function(){return 0==this.childes.length},TStdSplitContainer.prototype.isSplitted=function(){return this.childes.length>1},TStdSplitContainer.prototype.hasComponent=function(){return 1==this.childes.length},TStdSplitContainer.prototype.countContainer=function(){return this.childes.length},TStdSplitContainer.prototype.getContainerSizes=function(){var t,e="";for(l=this.childes.length,t=0;t<l;t++)0==this.attr_Orientation?e+=this.childes[t].Width():e+=this.childes[t].Height(),t+1!=l&&(e+=",");return e},TStdSplitContainer.prototype.updateContainerSizes=function(t){var e,n;for(l=this.childes.length,n=t.split(","),e=0;e<l;e++)0==this.attr_Orientation?this.childes[e].Width(n[e]):this.childes[e].Height(n[e])},TStdSplitContainer.prototype.Orientation=function(t){if(!t)return this.attr_Orientation;this.attr_Orientation=t},TStdSplitContainer.prototype.insertComponent=function(t,e,n,i,r,o,a,s){e||(e=3),n||(n=3),i||(i=2),r||(r=2),o||(o=100),a||(a=100),s||(s=!1);for(var l=t.substring(t.lastIndexOf(".")+1),d=0,h=0;0==h;){"@0"==FindObject(StrConcat(l,d+=1),AssistedPage.Name())&&(h=1)}l=StrConcat(l,d);var u=InsertVertex(AssistedPage.Name(),t,l,this);return u.LeftType(e),u.TopType(n),u.HeightType(i),u.Height(o),u.WidthType(r),u.Width(a),u.Wrap(s),u.Name()},TStdVideoComponent.prototype=new TStdVisibleComponent,TStdVideoComponent.prototype.constructor=TStdVideoComponent,TStdVideoComponent.prototype.attr_Flags=0,TStdVideoComponent.prototype.attr_AutoPlay=0,TStdVideoComponent.prototype.attr_Display=null,TStdVideoComponent.prototype.attr_Filename="",TStdVideoComponent.prototype.canplay=0,TStdVideoComponent.prototype.Flags=function(t){if(!arguments.length)return this.attr_Flags;this.attr_Flags=t},TStdVideoComponent.prototype.Display=function(t){if(!arguments.length)return this.attr_Display;this.attr_Display=t},TStdVideoComponent.prototype.AutoPlay=function(t){if(!arguments.length)return this.attr_AutoPlay;this.attr_AutoPlay=t},TStdVideoComponent.prototype.Filename=function(t){if(!arguments.length)return this.attr_Filename;this.attr_Filename!=t&&(this.attr_Filename=t,1==this.canplay&&this.PlayVideo())},TStdVideoComponent.prototype.PlayVideo=function(){pages[targ.pageName].isPageInit()&&""!=this.attr_Filename&&""!=this.attr_Display&&mediaPlayer.playVideo(expandmetavar(this.attr_Filename,this.pageName),this.attr_Display)},TStdVideoComponent.prototype.onpgshown=function(){TStdVisibleComponent.prototype.onpgshown.call(this),this.PlayVideo(),this.canplay=1},TStdVideoComponent.prototype.onpgclose=function(){TStdVisibleComponent.prototype.onpgclose.call(this),VideoStop()},TTransRichEdit.prototype=new TStdImage,TTransRichEdit.prototype.constructor=TTransRichEdit,TTransRichEdit.prototype.attr_AutoSize=1,TTransRichEdit.prototype.AutoSize=function(t){if(!arguments.length)return this.attr_AutoSize;if(this.attr_AutoSize=AnyToInt(t),1==this.attr_AutoSize){var e=this.obj.style;e.height="auto",e.width="auto"}},Vector.prototype={data:null,increment:null,size:0,getCapacity:function(){return this.data.length},getSize:function(){return this.size},isEmpty:function(){return 0==this.getSize()},getLastElement:function(){if(null!=this.data[this.getSize()-1])return this.data[this.getSize()-1]},getFirstElement:function(){if(null!=this.data[0])return this.data[0]},getElementAt:function(t){try{return this.data[t]}catch(e){return"Exception "+e+" occured when accessing "+t}},addElement:function(t){this.getSize()==this.data.length&&this.resize(),this.data[this.size++]=t},insertElementAt:function(t,e){try{this.size==this.capacity&&this.resize();for(var n=this.data,i=this.getSize();i>e;i--)n[i]=n[i-1];n[e]=t,this.size++}catch(t){return"Invalid index "+i}},removeElementAt:function(t){if(!(this.data.length-1<t)){for(var e=this.data[t],n=this.getSize()-1,i=t;i<n;i++)this.data[i]=this.data[i+1];return this.data[this.getSize()-1]=null,this.size--,e}},removeAllElements:function(){this.size=0;for(var t=0;t<this.data.length;t++)this.data[t]=null},indexOf:function(t){for(var e=0;e<this.getSize();e++)if(this.data[e]==t)return e;return-1},contains:function(t){for(var e=0;e<this.getSize();e++)if(this.data[e]==t)return!0;return!1},resize:function(){newData=new Array(this.data.length+this.increment);for(var t=0;t<this.data.length;t++)newData[t]=this.data[t];this.data=newData},trimToSize:function(){for(var t=new Array(this.getSize()),e=0;e<this.getSize();e++)t[e]=this.data[e];this.size=t.length-1,this.data=t},sort:function(t){var e,n,i,r,o,a=this.getSize(),s=this.data;for(e=1;e<a;e++){for(i=(r=s[e])[t],o=s[n=e-1][t];n>=0&&o>i;)s[n+1]=s[n],--n>=0&&(o=s[n][t]);s[n+1]=r}},clone:function(){for(var t=new Vector(this.size),e=this.size,n=this.data[i],i=0;i<e;i++)t.addElement(n[i]);return t},overwriteElementAt:function(t,e){this.data[e]=t}},TEventInfoList.prototype={objectNames:null,eventNames:null,eventParams:null,addObject:function(t,e,n){return this.objectNames.addElement(e),this.eventNames.addElement(t),this.eventParams.addElement(n),this.objectNames.getSize()-1},addObjectIfNotThere:function(t,e,n){var i=this.indexOfPair(t,e);return i<0&&(i=this.addObject(t,e,n)),i},clear:function(){this.objectNames.removeAllElements(),this.eventNames.removeAllElements(),this.eventParams.removeAllElements()},deleteAt:function(t){this.objectNames.removeElementAt(t),this.eventNames.removeElementAt(t),this.eventParams.removeElementAt(t)},indexOfObject:function(t){return this.objectNames.indexOf(t)},indexOfPair:function(t,e){e instanceof Object&&(e=e.Name());for(var n=this.objectNames.getSize(),i=0;i<n;i++)if(this.indexOfPairIs(t,e,i,!0))return i;return-1},indexOfPairIs:function(t,e,n,i){return this.objectNames.getElementAt(n)==e&&(!i&&t==this.eventNames.getElementAt(n)||i&&t.equalsIgnoreCase(this.eventNames.getElementAt(n)))},size:function(){return this.objectNames.getSize()}},TEventRecPattern.prototype=new TEventInfoList,TEventRecPattern.prototype.constructor=TEventRecPattern,TEventRecPattern.prototype.LCF_ExactMatch=0,TEventRecPattern.prototype.LCF_IgnoreOrder=1,TEventRecPattern.prototype.LCF_IgnoreEventsBetween=2,TEventRecPattern.prototype.LCF_IgnoreThatLastMustBeTheLast=4,TEventRecPattern.prototype.LCF_IgnoreCapitals=16,TEventRecPattern.prototype.owner="",TEventRecPattern.prototype.patternName="",TEventRecPattern.prototype.action="",TEventRecPattern.prototype.comparisonType=0,TEventRecPattern.prototype.doEventMatch=function(t,e,n){return this.eventNames.getElementAt(t)==e&&("*"==eventParams.getElementAt(t)||eventParams.getElementAt(t)==n)},TEventRecPattern.prototype.eventMatches=function(t,e){return!(t<0||e<0)&&(this.objectNames.getElementAt(t)==this.owner.eventHistory.objectNames.getElementAt(e)&&((this.comparisonType&this.LCF_IgnoreCapitals)==this.LCF_IgnoreCapitals?"*"==this.eventParams.getElementAt(t)||this.eventParams.getElementAt(t).equalsIgnoreCase(this.owner.eventHistory.eventParams.getElementAt(e)):"*"==this.eventParams.getElementAt(t)||this.eventParams.getElementAt(t)==this.owner.eventHistory.eventParams.getElementAt(e)))},TEventRecPattern.prototype.matchesOwnerHistory=function(){var t=!1;if(this.size()>this.owner.eventHistory.size())return!1;var e=this.size()-1,n=this.owner.eventHistory.size()-1,i=this.comparisonType&~this.LCF_IgnoreCapitals;if(0==(i&this.LCF_IgnoreThatLastMustBeTheLast)){if(!this.eventMatches(e,n))return!1;e--,n--}switch(i&~this.LCF_IgnoreThatLastMustBeTheLast){case this.LCF_ExactMatch:for(var r=0;r<=e;r++)if(!this.eventMatches(e-r,n-r))return!1;t=!0;break;case this.LCF_IgnoreOrder:for(r=0;r<e;r++){var o=this.indexOfObject(this.owner.eventHistory.objectNames.getElementAt(n-r));if(!this.eventMatches(o,n-r))return!1}t=!0;break;case this.LCF_IgnoreEventsBetween:var a=this.owner.eventHistory.size();for(r=0;r<e;r++){if((o=this.owner.eventHistory.indexOfObject(this.objectNames.getElementAt(e-r)))>a||!this.eventMatches(e-r,o))return!1;a=o}t=!0;break;case this.LCF_IgnoreOrder+this.LCF_IgnoreEventsBetween:for(r=0;r<e;r++){o=this.owner.eventHistory.indexOfObject(this.objectNames.getElementAt(e-r));if(!this.eventMatches(e-r,o))return!1}t=!0}return t},TEventRecorder.prototype=new Vector,TEventRecorder.prototype.constructor=TEventRecorder,TEventRecorder.prototype.owner=null,TEventRecorder.prototype.recordedEvents=null,TEventRecorder.prototype.eventHistory=null,TEventRecorder.prototype.addPattern=function(t,e){this.addElement(new TEventRecPattern(this,t,e))},TEventRecorder.prototype.addToRecordedEvents=function(t,e){null!=t&&null!=e&&this.recordedEvents.addObjectIfNotThere(t,e,"")},TEventRecorder.prototype.clearHistory=function(){this.eventHistory.clear()},TEventRecorder.prototype.processEvent=function(t,e,n,i){if(n instanceof Object&&(n=n.Name()),"$$$"==e)return null;if(this.recordedEvents.indexOfPair(t,n)<0)return null;var r=null,o=this.eventHistory.indexOfPair(t,n);o>=0?(this.eventHistory.deleteAt(o),this.eventHistory.addObject(t,n,e,o)):this.eventHistory.addObject(t,n,e);var a=this.getSize();for(o=0;o<a;o++){var s=this.getElementAt(o),l=s.action==i,d=s.matchesOwnerHistory();if(l&&d){r=s.patternName;break}}return r},TStdScenario.prototype=new TStdVisibleComponent,TStdScenario.prototype.constructor=TStdScenario,TStdScenario.prototype.StopScenario=function(){this.Enabled(0)},TStdPageAction.prototype=new TStdVisibleComponent;TStdPageAction.prototype.constructor=TStdPageAction,TStdPageAction.prototype.attr_UserEvents="",TStdPageAction.prototype.UserEvents=function(t){if(!arguments.length)return this.attr_UserEvents;null!=t&&""==!t&&(this.attr_UserEvents=t,pages[this.pageName].addUserEventPattern(t,this))},TStdTimeline.prototype=new TStdVisibleComponent,TStdTimeline.prototype.constructor=TStdTimeline,TStdTimeline.prototype.attr_StartWithPage=0,TStdTimeline.prototype.attr_TimelinePoints="",TStdTimeline.prototype.attr_TimeCount=0,TStdTimeline.prototype.attr_Time=0,TStdTimeline.prototype.int_Time=0,TStdTimeline.prototype.intTimer=null,TStdTimeline.prototype.timePoints=null,TStdTimeline.prototype.int_TimeInterval=100,TStdTimeline.prototype.int_Pause=!1,TStdTimeline.prototype.Time=function(t){if(!arguments.length)return this.attr_Time;t=AnyToInt(t),this.attr_Time=t,this.int_Time=t},TStdTimeline.prototype.StartWithPage=function(t){if(!arguments.length)return this.attr_StartWithPage;t=AnyToInt(t),this.attr_StartWithPage=t},TStdTimeline.prototype.TimelinePoints=function(t){if(!arguments.length)return this.attr_TimelinePoints;this.attr_TimelinePoints=t;for(var e=null,n=0,i=(t=t.split("&#x0A;")).length;n<i;n++)""!=t[n]&&((e=new Object).event=AnyToInt(t[n].split(";")[1]),e.time=AnyToInt(t[n].split(";")[0]),this.timePoints[n]=e)},TStdTimeline.prototype.TimeCount=function(t){if(!arguments.length)return this.attr_TimeCount;t=AnyToInt(t),this.attr_TimeCount=t},TStdTimeline.prototype.OnTimelineEventExec=function(t){this.OnTimelineEvent(t)},TStdTimeline.prototype.StartTimeline=function(t){this.attr_TimeCount=0,this.attr_Time=this.int_Time,this.startIntTimer()},TStdTimeline.prototype.RestartTimeline=function(t){this.stopIntTimer(),this.attr_TimeCount=0,this.attr_Time=this.int_Time,this.startIntTimer()},TStdTimeline.prototype.StopTimeline=function(t){this.attr_TimeCount=0,this.attr_Time=this.int_Time,this.stopIntTimer()},TStdTimeline.prototype.PauseTimeline=function(t){this.int_Pause?this.startIntTimer():this.stopIntTimer()},TStdTimeline.prototype.onpgshown=function(){TStdVisibleComponent.prototype.onpgshown.call(this),1==this.StartWithPage()&&this.StartTimeline()},TStdTimeline.prototype.TimerEvent=function(){if(null!=this.intTimer)if(this.attr_Time+=this.int_TimeInterval,this.attr_TimeCount<this.timePoints.length){if(this.attr_Time>this.timePoints[this.attr_TimeCount].time){this.attr_TimeCount++;var t=this.pageName,e=this.Name(),n=this.attr_TimeCount-1;window.setTimeout("CallTimeLineEvent('"+t+"','"+e+"',"+n+")",0)}}else this.stopIntTimer()},TStdTimeline.prototype.startIntTimer=function(){this.intTimer.setInterval(this.int_TimeInterval)},TStdTimeline.prototype.stopIntTimer=function(){this.intTimer.clearInterval()},TStdTimeline.prototype.onpgclose=function(){this.intTimer.clearInterval(),this.intTimer.close(),this.intTimer.obj=null,this.intTimer=null,TStdVisibleComponent.prototype.onpgclose.call(this)},TStdTimeline.prototype.onpgready=function(){this.intTimer=new ideaTimer(this,"TimerEvent"),TStdVisibleComponent.prototype.onpgready.call(this)},TStdFlashVideoPlayer.prototype=new TStdVisibleComponent,TStdFlashVideoPlayer.prototype.constructor=TStdFlashVideoPlayer,TStdFlashVideoPlayer.prototype.playerName="",TStdFlashVideoPlayer.prototype.attr_ShowControls=1,TStdFlashVideoPlayer.prototype.attr_Filename="",TStdFlashVideoPlayer.prototype.attr_AutoStart=0,TStdFlashVideoPlayer.prototype.attr_Volume=100,TStdFlashVideoPlayer.prototype.attr_Position=0,TStdFlashVideoPlayer.prototype.attr_Duration=0,TStdFlashVideoPlayer.prototype.attr_TimeLeft=0,TStdFlashVideoPlayer.prototype.attr_State=0,TStdFlashVideoPlayer.prototype.attr_BackColor=16777215,TStdFlashVideoPlayer.prototype.attr_StretchMode=0,TStdFlashVideoPlayer.prototype.attr_Poster="",TStdFlashVideoPlayer.prototype.Poster=function(t){if(!arguments.length)return this.attr_Poster;this.attr_Poster=t},TStdFlashVideoPlayer.prototype.StretchMode=function(t){if(!arguments.length)return this.attr_StretchMode;t=AnyToInt(t),this.attr_StretchMode=t},TStdFlashVideoPlayer.prototype.State=function(t){if(!arguments.length)return this.attr_State;this.attr_State=AnyToInt(t)},TStdFlashVideoPlayer.prototype.BackColor=function(t){if(!arguments.length)return this.attr_BackColor;this.attr_BackColor=AnyToInt(t)},TStdFlashVideoPlayer.prototype.Duration=function(){return this.attr_Duration},TStdFlashVideoPlayer.prototype.TimeLeft=function(t){return this.attr_TimeLeft},TStdFlashVideoPlayer.prototype.ShowControls=function(t){if(!arguments.length)return this.attr_ShowControls;this.attr_ShowControls=AnyToInt(t)},TStdFlashVideoPlayer.prototype.AutoStart=function(t){if(!arguments.length)return this.attr_AutoStart;this.attr_AutoStart=AnyToInt(t)},TStdFlashVideoPlayer.prototype.Filename=function(t){if(!arguments.length)return this.attr_Filename;this.attr_Filename=t;t=expandmetavar(this.attr_Filename,this.pageName);t=document.URL.substr(0,document.URL.lastIndexOf("/")+1)+t,null!=$(this.playerName)&&""!=this.attr_Filename&&(this.attr_TimePosition=0,$(this.playerName).setMediaResourceURL(t),$(this.playerName).setVolume(this.attr_Volume/100))},TStdFlashVideoPlayer.prototype.FilenameMP4=function(t){if(!arguments.length)return this.attr_FilenameMP4;this.attr_FilenameMP4=t;t=expandmetavar(this.attr_FilenameMP4,this.pageName);t=document.URL.substr(0,document.URL.lastIndexOf("/")+1)+t,null!=$(this.playerName)&&""!=this.attr_FilenameMP4&&(this.attr_TimePosition=0,$(this.playerName).setMediaResourceURL(t),$(this.playerName).setVolume(this.attr_Volume/100))},TStdFlashVideoPlayer.prototype.Volume=function(t){if(!arguments.length)return this.attr_Volume;this.attr_Volume=AnyToInt(t);var e=$(this.playerName);null!=e&&e.setVolume(this.attr_Volume/100)},TStdFlashVideoPlayer.prototype.Position=function(t){if(!arguments.length)return this.attr_Position;this.attr_Position=AnyToInt(t);var e=$(this.playerName);null!=e&&"ready"!=e.getState()&&e.canSeekTo(this.attr_Position)&&e.seek(this.attr_Position)},TStdFlashVideoPlayer.prototype.FVPPlayPause=function(){var t=$(this.playerName);if(null!=t){var e=t.getState();"playing"==e?t.pause():"paused"!=e&&"ready"!=e||t.play2()}},TStdFlashVideoPlayer.prototype.Play=function(){var t=$(this.playerName);if(null!=t){t.getState();0!=this.State()&&t.play2()}},TStdFlashVideoPlayer.prototype.Stop=function(){var t=$(this.playerName);0!=this.State()&&(0!=this.State()&&t.FVPStop(),this.attr_Position=0)},TStdFlashVideoPlayer.prototype.Pause=function(){var t=$(this.playerName);if(null!=t){t.getState();0!=this.State()&&t.pause()}},TStdFlashVideoPlayer.prototype.FVPStop=function(){var t=$(this.playerName);null!=$(this.playerName)&&1==this.State()&&t.stop2()},TStdFlashVideoPlayer.prototype.FVPFastForward=function(){var t=$(this.playerName);null!=$(this.playerName)&&t.seek(this.attr_Position+5)},TStdFlashVideoPlayer.prototype.FVPRewind=function(){var t=$(this.playerName);null!=$(this.playerName)&&t.seek(this.attr_Position-5)},TStdFlashVideoPlayer.prototype.Image=function(t){if(!arguments.length)return this.attr_Image;this.attr_Image=t},TStdFlashVideoPlayer.prototype.createMovie=function(t){var e=url_libs+IDEASCRIPTDIR;deconcept.SWFObjectUtil.getPlayerVersion().major>=10&&deconcept.SWFObjectUtil.getPlayerVersion().minor>=1?e+=videoplayer11:e+=videoplayer10;var n=new SWFObject(e,this.playerName,"100%","100%","8");n.addParam("allowfullscreen","true"),n.addParam("allowscriptaccess","always"),n.addParam("wmode","transparent"),""!=this.attr_Poster&&n.addVariable("poster",expandmetavar(this.attr_Poster,this.pageName)),n.addVariable("height","100%"),n.addVariable("width","100%"),n.addVariable("bufferingOverlay",!1),0==this.attr_ShowControls?n.addVariable("controlBarAutoHide",!0):n.addVariable("controlBarAutoHide",!1),n.addVariable("backgroundColor",convertColorToHEX(this.attr_BackColor));var i="";if(""!=this.attr_Filename&&(i=this.attr_Filename),""!=this.attr_FilenameMP4&&""==i&&(i=this.attr_FilenameMP4),""!=i){var r=expandmetavar(i,this.pageName);r=document.URL.substr(0,document.URL.lastIndexOf("/")+1)+r,n.addVariable("src",r)}1==this.attr_AutoStart&&n.addVariable("autoPlay","true"),n.addVariable("volume",this.attr_Volume/100),n.addVariable("name",this.playerName),n.addVariable("style","visibility:visible");n.addVariable("javascriptCallbackFunction","FVPbindEvents"),n.write(this.pageName+this.Name()),this.mediaplayer=n;this.obj.firstChild},TStdFlashVideoPlayer.prototype.onpgshown=function(){if(TStdVisibleComponent.prototype.onpgshown.call(this),0==pages[this.pageName].PageMode())this.createMovie(),this.obj.style.borderStyle="none";else{var t=this.obj.style;t.borderStyle="solid",t.borderWidth="2px",t.borderColor=convertColor(39423)}},TStdFlashVideoPlayer.prototype.onpgclose=function(){this.obj.firstChild&&null!=this.obj.firstChild&&removeAll(this.obj.firstChild),TStdVisibleComponent.prototype.onpgclose.call(this)},TStdFlashVideoPlayer.prototype.onCurrentTimeChange=function(t,e){this.OnPlayingTime&&this.OnPlayingTime(t,e)},TStdFlashVideoPlayer.prototype.onComplete=function(){this.OnPlayingEnd&&this.OnPlayingEnd()},TStdFlashVideoPlayer.prototype.onVolumeChange=function(t,e){this.OnVolumeChange&&this.OnVolumeChange(t,e)},TStdFlashVideoPlayer.prototype.onStateChange=function(t){this.OnStateChange&&this.OnStateChange(t)},TStdHTML5VideoPlayer.prototype=new TStdVisibleComponent,TStdHTML5VideoPlayer.prototype.constructor=TStdHTML5VideoPlayer,TStdHTML5VideoPlayer.prototype.attr_ShowControls=1,TStdHTML5VideoPlayer.prototype.attr_HideDownloadBtn=0,TStdHTML5VideoPlayer.prototype.attr_FullScreenEnabled=!0,TStdHTML5VideoPlayer.prototype.attr_AutoStart=0,TStdHTML5VideoPlayer.prototype.attr_ShowTrackTitles=!1,TStdHTML5VideoPlayer.prototype.attr_Volume=100,TStdHTML5VideoPlayer.prototype.attr_Position=0,TStdHTML5VideoPlayer.prototype.attr_Duration=0,TStdHTML5VideoPlayer.prototype.attr_TimeLeft=0,TStdHTML5VideoPlayer.prototype.attr_FilenameMP4="",TStdHTML5VideoPlayer.prototype.attr_FilenameVTT="",TStdHTML5VideoPlayer.prototype.attr_Filename="",TStdHTML5VideoPlayer.prototype.attr_FilenameWebM="",TStdHTML5VideoPlayer.prototype.attr_State=0,TStdHTML5VideoPlayer.prototype.attr_StretchMode=0,TStdHTML5VideoPlayer.prototype.attr_Poster="",TStdHTML5VideoPlayer.prototype.videoON=0,TStdHTML5VideoPlayer.prototype.playPromise=0,TStdHTML5VideoPlayer.prototype.Poster=function(t){if(!arguments.length)return this.attr_Poster;this.attr_Poster=t},TStdHTML5VideoPlayer.prototype.StretchMode=function(t){if(!arguments.length)return this.attr_StrechMode;t=AnyToInt(t),this.attr_StrechMode=t},TStdHTML5VideoPlayer.prototype.State=function(t){if(!arguments.length)return this.attr_State;var e=this.attr_State;this.attr_State=AnyToInt(t),e!=this.attr_State&&this.OnStateChange&&this.OnStateChange(t)},TStdHTML5VideoPlayer.prototype.Duration=function(t){if(!arguments.length)return this.obj.children[0].duration},TStdHTML5VideoPlayer.prototype.TimeLeft=function(t){if(!arguments.length)return this.attr_TimeLeft;this.attr_TimeLeft=AnyToInt(t)},TStdHTML5VideoPlayer.prototype.ShowControls=function(t){if(!arguments.length)return this.attr_ShowControls;this.attr_ShowControls=AnyToInt(t),pages[this.pageName].PageMode()!=pmRuntime?this.obj.className="it_basebgcolor4 it_framestyle7a it_vpbackground "+this.attr_cssClass:this.obj.style.borderStyle="none",this.obj&&this.obj.children&&this.obj.children.length>0&&(this.obj.children[0].controls=AnyToBool(this.attr_ShowControls))},TStdHTML5VideoPlayer.prototype.HideDownloadBtn=function(t){var e=[],n="";if(!arguments.length)return this.attr_HideDownloadBtn;this.attr_HideDownloadBtn=AnyToInt(t),this.obj.children[0].controlsList&&((n=this.obj.children[0].controlsList.toString()).length>0&&(e=n.split()),AnyToInt(t)>0&&e.indexOf("nodownload")<0?(e.push("nodownload"),this.obj.children[0].controlsList=e.toString()):0==AnyToInt(t)&&e.indexOf("nodownload")>=0&&(e.splice(e.indexOf("nodownload"),1),this.obj.children[0].controlsList=e.toString()))},TStdHTML5VideoPlayer.prototype.ShowTrackTitles=function(t){if(!arguments.length)return this.attr_ShowTrackTitles;this.attr_ShowTrackTitles=AnyToBool(t),pages[this.pageName].PageMode()!=pmEdit&&""!=this.attr_FilenameMP4&&""!=this.attr_FilenameVTT&&this.obj.children[0].textTracks.length>0&&(1==AnyToBool(t)?this.obj.children[0].textTracks[0].mode="showing":this.obj.children[0].textTracks[0].mode="disabled")},TStdHTML5VideoPlayer.prototype.ShowFullScreen=function(t){if(!arguments.length)return this.attr_FullScreenEnabled;this.attr_FullScreenEnabled=AnyToBool(t);var e=this.obj.children[0];e.setAttribute("fullScreenEnabled",t),e.fullScreenEnabled=t,e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullScreen&&e.webkitRequestFullScreen()},TStdHTML5VideoPlayer.prototype.AutoStart=function(t){if(!arguments.length)return this.attr_AutoStart;this.attr_AutoStart=AnyToInt(t)},TStdHTML5VideoPlayer.prototype.FilenameMP4=function(t){if(!arguments.length)return this.attr_FilenameMP4;this.attr_FilenameMP4=t,0==pages[this.pageName].PageMode()&&this.preparePlaying()},TStdHTML5VideoPlayer.prototype.FilenameVTT=function(t){if(!arguments.length)return this.attr_FilenameVTT;if(this.attr_FilenameVTT!=t&&(this.attr_FilenameVTT=t,0==pages[this.pageName].PageMode()&&(this.obj.children[0].children[1]&&this.obj.children[0].removeChild(this.obj.children[0].children[1]),""!=this.attr_FilenameVTT&&this.obj.children[0].children[0]))){var e=document.createElement("track");e.kind="captions",e.src=expandmetavar(this.attr_FilenameVTT,this.pageName),this.obj.children[0].appendChild(e),1==AnyToBool(this.attr_ShowTrackTitles)?this.obj.children[0].textTracks[0].mode="showing":this.obj.children[0].textTracks[0].mode="disabled"}},TStdHTML5VideoPlayer.prototype.FilenameWebM=function(t){if(!arguments.length)return this.attr_FilenameWebM;this.attr_FilenameWebM=t,0==pages[this.pageName].PageMode()&&this.preparePlaying()},TStdHTML5VideoPlayer.prototype.Filename=function(t){if(!arguments.length)return this.attr_Filename;this.attr_Filename=t,0==pages[this.pageName].PageMode()&&this.preparePlaying()},TStdHTML5VideoPlayer.prototype.Volume=function(t){if(arguments.length){if(this.attr_Volume=AnyToInt(t),0==this.videoON)return;this.obj.children[0].children[0]&&(this.obj.children[0].volume=this.attr_Volume/100)}else{if(0==this.videoON)return this.attr_Volume;if(this.obj.children[0].children[0])return DIV(100*this.obj.children[0].volume,1)}},TStdHTML5VideoPlayer.prototype.Position=function(t){if(!arguments.length)return Math.floor(this.obj.children[0].currentTime);this.attr_Position=AnyToInt(t)},TStdHTML5VideoPlayer.prototype.setPosition=function(t){this.obj.children[0].children[0]&&(this.obj.children[0].currentTime=t)},TStdHTML5VideoPlayer.prototype.FVPPlayPause=function(){this.obj.children[0].paused?(this.playPromise=this.obj.children[0].play(),this.State(1)):(this.obj.children[0].pause(),this.State(2))},TStdHTML5VideoPlayer.prototype.Play=function(){this.playPromise=this.obj.children[0].play(),this.State(1)},TStdHTML5VideoPlayer.prototype.Stop=function(){this.obj.children[0].pause(),this.obj.children[0].currentTime=0,this.State(0)},TStdHTML5VideoPlayer.prototype.Pause=function(){this.obj.children[0].pause(),this.State(2)},TStdHTML5VideoPlayer.prototype.FVPStop=function(){try{this.obj.children[0].pause(),this.obj.children[0].currentTime=0}catch(t){}this.State(0)},TStdHTML5VideoPlayer.prototype.FVPFastForward=function(){this.obj.children[0].currentTime=this.obj.children[0].currentTime+10},TStdHTML5VideoPlayer.prototype.FVPRewind=function(){this.obj.children[0].currentTime=this.obj.children[0].currentTime-10},TStdHTML5VideoPlayer.prototype.preparePlaying=function(){if(supports_video()&&""!=this.attr_FilenameMP4){this.obj.children[0].children[1]&&this.obj.children[0].removeChild(this.obj.children[0].children[1]),this.obj.children[0].children[0]&&this.obj.children[0].removeChild(this.obj.children[0].children[0]);var t=document.createElement("source");if(t.src=expandmetavar(this.attr_FilenameMP4,this.pageName),t.type="video/mp4",this.obj.children[0].appendChild(t),this.obj.children[0].load(),""!=this.attr_FilenameVTT){var e=document.createElement("track");e.kind="captions",e.src=expandmetavar(this.attr_FilenameVTT,this.pageName),this.obj.children[0].appendChild(e),1==AnyToBool(this.attr_ShowTrackTitles)?this.obj.children[0].textTracks[0].mode="showing":this.obj.children[0].textTracks[0].mode="disabled"}this.videoON=1}if(supports_webm_video()&&""!=this.attr_FilenameWebM){this.obj.children[0].children[0]&&this.obj.children[0].removeChild(this.obj.children[0].children[0]);var n=document.createElement("source");n.src=expandmetavar(this.attr_FilenameWebM,this.pageName),n.type='video/webm; codecs="vp8, vorbis"',this.obj.children[0].appendChild(n),this.obj.children[0].load(),this.videoON=1}},TStdHTML5VideoPlayer.prototype.onpgshown=function(){this.videoON=0,this.playPromise="",TStdVisibleComponent.prototype.onpgshown.call(this),pages[this.pageName].PageMode()==pmRuntime?(""!=this.attr_Poster&&this.obj.children[0].setAttribute("poster",expandmetavar(this.attr_Poster,this.pageName)),this.preparePlaying(),this.obj.children[0].children[0]&&1==this.videoON&&(this.obj.children[0].volume=this.attr_Volume/100,1==this.attr_AutoStart&&(this.playPromise=this.obj.children[0].play()),this.obj.children[0].controls=AnyToBool(this.attr_ShowControls))):pages[this.pageName].PageMode()==pmEdit&&(this.obj.className="it_basebgcolor4 it_framestyle7a it_vpbackground "+this.attr_cssClass)},TStdHTML5VideoPlayer.prototype.Height=function(t){if(!arguments.length)return TStdVisibleComponent.prototype.Height.call(this);TStdVisibleComponent.prototype.Height.call(this,t),this.obj.children[0].style.height="100%"},TStdHTML5VideoPlayer.prototype.Width=function(t){if(!arguments.length)return TStdVisibleComponent.prototype.Width.call(this);TStdVisibleComponent.prototype.Width.call(this,t),this.obj.children[0].style.width="100%"},TStdHTML5VideoPlayer.prototype.onpgclose=function(){0==pages[this.pageName].PageMode()&&void 0!==this.playPromise&&""!=this.playPromise&&this.playPromise.then(function(){this.obj.children[0].pause()}).catch(function(t){}),TStdVisibleComponent.prototype.onpgclose.call(this)},TStdHTML5VideoPlayer.prototype.onCurrentTimeChange=function(){if(null!=this.parentNode){var t=this.parentNode.pageName,e=this.parentNode.obj;if(null!=t&&void 0!=t&&null!=e&&void 0!=e){var n=pages[t][e];1==n.videoON&&1==n.State()&&(n.TimeLeft(this.duration-this.currentTime),n.OnPlayingTime&&n.OnPlayingTime(this.duration,this.currentTime))}}},TStdHTML5VideoPlayer.prototype.onComplete=function(){if(null!=this.parentNode){var t=this.parentNode.pageName,e=this.parentNode.obj;if(null!=t&&void 0!=t&&null!=e&&void 0!=e){var n=pages[t][e];n.State(0),n.OnPlayingEnd&&n.OnPlayingEnd()}}},TStdHTML5VideoPlayer.prototype.onVolumeChange=function(){if(null!=this.parentNode){var t=this.parentNode.pageName,e=this.parentNode.obj;if(null!=t&&void 0!=t&&null!=e&&void 0!=e){var n=pages[t][e];n.OnVolumeChange&&n.OnVolumeChange(this.muted,DIV(100*this.volume,1))}}},TStdHTML5VideoPlayer.prototype.statechange1=function(){if(null!=this.parentNode){var t=this.parentNode.pageName,e=this.parentNode.obj;if(null!=t&&void 0!=t&&null!=e&&void 0!=e)pages[t][e].State(1)}},TStdHTML5VideoPlayer.prototype.statechange2=function(){if(null!=this.parentNode){var t=this.parentNode.pageName,e=this.parentNode.obj;if(null!=t&&void 0!=t&&null!=e&&void 0!=e)pages[t][e].State(2)}},TStdCustomVideoPlayer.prototype=new TStdHTML5VideoPlayer,TStdCustomVideoPlayer.prototype.constructor=TStdCustomVideoPlayer,TStdCustomVideoPlayer.prototype.cvp_video=0,TStdCustomVideoPlayer.prototype.cvp_cover=1,TStdCustomVideoPlayer.prototype.cvp_bigBtn=2,TStdCustomVideoPlayer.prototype.cvp_controls=3,TStdCustomVideoPlayer.prototype.cvp_playBtn=4,TStdCustomVideoPlayer.prototype.cvp_timecount=5,TStdCustomVideoPlayer.prototype.cvp_progress=6,TStdCustomVideoPlayer.prototype.cvp_subTitleBtn=7,TStdCustomVideoPlayer.prototype.cvp_volumeBtn=8,TStdCustomVideoPlayer.prototype.cvp_resizeBtn=9,TStdCustomVideoPlayer.prototype.fullscreeen=!1,TStdCustomVideoPlayer.prototype.pbMouseDown=!1,TStdCustomVideoPlayer.prototype.attr_mobilFullscreen=!1,TStdCustomVideoPlayer.prototype.attr_autoHide=null,TStdCustomVideoPlayer.prototype_TO=0,TStdCustomVideoPlayer.prototype.onpgshown=function(){TStdHTML5VideoPlayer.prototype.onpgshown.call(this);var t=cvp_getControl(this.cvp_video,this);cvp_initVolume(t,this),t.controls=!1,this.attr_mobilFullscreen||(jQuery(t).attr("webkit-playsinline",""),jQuery(t).attr("playsinline",""));var e=cvp_getControl(this.cvp_controls,this);0==this.attr_ShowControls||0==AnyToInt(this.State())?jQuery(e).addClass("hideControls"):jQuery(e).removeClass("hideControls")},TStdCustomVideoPlayer.prototype.mobilFullscreen=function(t){if(!arguments.length)return this.attr_mobilFullscreen;this.attr_mobilFullscreen=AnyToBool(t)},TStdCustomVideoPlayer.prototype.autoHide=function(t){if(!arguments.length)return AnyToInt(this.attr_autoHide);this.attr_autoHide=AnyToInt(t)},TStdCustomVideoPlayer.prototype.ShowControls=function(t){if(!arguments.length)return this.attr_ShowControls;this.attr_ShowControls=AnyToInt(t);var e=cvp_getControl(this.cvp_controls,this);0==AnyToInt(t)?jQuery(e).addClass("hideControls"):jQuery(e).removeClass("hideControls")},TStdCustomVideoPlayer.prototype.ShowTrackTitles=function(t){if(!arguments.length)return this.attr_ShowTrackTitles;if(this.attr_ShowTrackTitles=AnyToBool(t),pages[this.pageName].PageMode()!=pmEdit)if(""!=this.attr_FilenameMP4&&""!=this.attr_FilenameVTT&&this.obj.children[0].textTracks.length>0){var e=cvp_getControl(this.cvp_subTitleBtn,this),n='<i class="cvp_subtitle_i off"></i>';1==AnyToBool(t)?(this.obj.children[0].textTracks[0].mode="showing",n='<i class="cvp_subtitlebtn_i on"></i>'):(this.obj.children[0].textTracks[0].mode="disabled",n='<i class="cvp_subtitlebtn_i off"></i>'),e.innerHTML=n,e.style.display=""}else{(e=cvp_getControl(this.cvp_subTitleBtn,this)).style.display="none"}},TStdCustomVideoPlayer.prototype.statechange1=function(){1!=this.State()&&(this.State(1),this.OnStateChange&&this.OnStateChange(1))},TStdCustomVideoPlayer.prototype.statechange2=function(){2!=this.State()&&(this.State(2),this.OnStateChange&&this.OnStateChange(2))},TStdIdeaMouse.prototype=new TStdVisibleComponent,TStdIdeaMouse.prototype.constructor=TStdIdeaMouse,TStdIdeaMouse.prototype.attr_LClickPicture=url_libs+IDEAMOUSELCLICKICON,TStdIdeaMouse.prototype.attr_MousePicture=url_libs+IDEAMOUSEICON,TStdIdeaMouse.prototype.attr_RClickPicture=url_libs+IDEAMOUSERCLICKICON,TStdIdeaMouse.prototype.Color=function(t){if(!arguments.length)return""},TStdIdeaMouse.prototype.LClickPicture=function(t){if(!arguments.length)return this.attr_LClickPicture;""!=t&&(this.attr_LClickPicture=t)},TStdIdeaMouse.prototype.RClickPicture=function(t){if(!arguments.length)return this.attr_RClickPicture;""!=t&&(this.attr_RClickPicture=t)},TStdIdeaMouse.prototype.MousePicture=function(t){if(!arguments.length)return this.attr_MousePicture;""!=t&&(this.attr_MousePicture=t);t=expandmetavar(t,this.pageName);this.obj.src=""!=t?t:this.attr_MousePicture},TStdIdeaMouse.prototype.MouseLeftClick=function(){var t=this.pageName+this.Name();this.obj.src=expandmetavar(this.attr_LClickPicture,this.pageName),window.setTimeout("$('"+t+"').src='"+expandmetavar(this.attr_MousePicture,this.pageName)+"'",500)},TStdIdeaMouse.prototype.MouseLeftDblClick=function(){var t=this.pageName+this.Name();this.obj.src=expandmetavar(this.attr_LClickPicture,this.pageName),window.setTimeout("$('"+t+"').src='"+expandmetavar(this.attr_MousePicture,this.pageName)+"'",300),window.setTimeout("$('"+t+"').src='"+expandmetavar(this.attr_LClickPicture,this.pageName)+"'",400),window.setTimeout("$('"+t+"').src='"+expandmetavar(this.attr_MousePicture,this.pageName)+"'",500)},TStdIdeaMouse.prototype.MouseRightClick=function(){var t=this.pageName+this.Name();this.obj.src=expandmetavar(this.attr_RClickPicture,this.pageName),window.setTimeout("$('"+t+"').src='"+expandmetavar(this.attr_MousePicture,this.pageName)+"'",500)},TStdIdeaMouse.prototype.MouseRichtDblClick=function(){var t=this.pageName+this.Name();this.obj.src=expandmetavar(this.attr_RClickPicture,this.pageName),window.setTimeout("$('"+t+"').src='"+expandmetavar(this.attr_MousePicture,this.pageName)+"'",300),window.setTimeout("$('"+t+"').src='"+expandmetavar(this.attr_RClickPicture,this.pageName)+"'",400),window.setTimeout("$('"+t+"').src='"+expandmetavar(this.attr_MousePicture,this.pageName)+"'",500)},TStdIdeaMouse.prototype.MouseMoveTo=function(t,e,n){new ChangeAttrOnTimeObj(this,"Left",AnyToInt(t),AnyToInt(n),1,this.pageName),new ChangeAttrOnTimeObj(this,"Top",AnyToInt(e),AnyToInt(n),1,this.pageName)},TXMLElement.prototype=new TStdVisibleComponent,TXMLElement.prototype.constructor=TXMLElement,TXMLElement.prototype.internal_xmlElement=null,TXMLElement.prototype.xmlDoc=null,TXMLElement.prototype.parser=null,TXMLElement.prototype.onpgshown=function(){TStdVisibleComponent.prototype.onpgshown.call(this),0==pages[this.pageName].PageMode()?this.Visible(0):null!=this.obj&&(this.Visible(1),jQuery(this.obj).css({"background-color":"#cccccc","border-color":"#000000","border-style":"solid","border-width":"1px","text-align":"center","padding-top":"5px"}),jQuery(this.obj).html("XML"))},TXMLElement.prototype.createNewElement=function(t){var e=new TXMLElement(null);return e.internal_xmlElement=t,e},TXMLElement.prototype.removeChild=function(t){if(null!=this.internal_xmlElement&&t<this.internal_xmlElement.childNodes.length)return this.createNewElement(this.internal_xmlElement.removeChild(this.internal_xmlElement.childNodes[t]))},TXMLElement.prototype.moveOneUp=function(t){if(null!=this.internal_xmlElement&&t<this.internal_xmlElement.childNodes.length){var e=this.internal_xmlElement.removeChild(this.internal_xmlElement.childNodes[t]);this.internal_xmlElement.insertBefore(e,this.internal_xmlElement.childNodes[t-1])}},TXMLElement.prototype.swapAttrVal=function(t,e,n){if(0==isVarUndefined(t.attributes[n])&&0==isVarUndefined(t.attributes[n])){var i=t.getAttribute(n);t.setAttribute(n,e.getAttribute(n)),e.setAttribute(n,i)}},TXMLElement.prototype.swapNodes=function(t,e,n){if(null==this.internal_xmlElement)return!1;isVarUndefined(n)&&(n=!1);var i,r,o,a,s,l,d;return i=selectXMLNodes("//*[@Name='"+t+"']",this.internal_xmlElement),r=selectXMLNodes("//*[@Name='"+e+"']",this.internal_xmlElement),0!=i.length&&0!=r.length&&(o=i[0],a=r[0],l=o.parentNode,d=a.parentNode,s=o.nextSibling,o=l.removeChild(o),o=d.insertBefore(o,a),a=l.removeChild(a),null!=s&&s.getAttribute("Name")==a.getAttribute("Name")&&(s=o),a=l.insertBefore(a,s),1==n&&(this.swapAttrVal(o,a,"Wrap"),this.swapAttrVal(o,a,"LeftType"),this.swapAttrVal(o,a,"Left"),this.swapAttrVal(o,a,"TopType"),this.swapAttrVal(o,a,"Top"),this.swapAttrVal(o,a,"WidthType"),this.swapAttrVal(o,a,"Width"),this.swapAttrVal(o,a,"HeightType"),this.swapAttrVal(o,a,"Height")),!0)},TXMLElement.prototype.moveBefore=function(t,e){if(null==this.internal_xmlElement)return!1;var n,i;return n=selectXMLNodes("//*[@Name='"+t+"']",this.internal_xmlElement)[0],i=(i=selectXMLNodes("//*[@Name='"+e+"']",this.internal_xmlElement)[0]).parentNode.removeChild(i),n.parentNode.insertBefore(i,n),!0},TXMLElement.prototype.moveBehind=function(t,e){if(null==this.internal_xmlElement)return!1;var n,i;if(n=selectXMLNodes("//*[@Name='"+t+"']",this.internal_xmlElement)[0],i=selectXMLNodes("//*[@Name='"+e+"']",this.internal_xmlElement)[0],n.nextSibling){if(n.nextSibling.getAttribute("Name")==e)return!0;i=i.parentNode.removeChild(i),(n=n.nextSibling).parentNode.insertBefore(i,n)}else n.parentNode.appendChild(i);return!0},TXMLElement.prototype.moveUnder=function(t,e){if(null==this.internal_xmlElement)return!1;var n,i;return n=selectXMLNodes("//*[@Name='"+t+"']",this.internal_xmlElement)[0],i=selectXMLNodes("//*[@Name='"+e+"']",this.internal_xmlElement)[0],n.appendChild(i),!0},TXMLElement.prototype.moveOneDown=function(t){if(null!=this.internal_xmlElement&&t<this.internal_xmlElement.childNodes.length){var e=this.internal_xmlElement.removeChild(this.internal_xmlElement.childNodes[t]);this.internal_xmlElement.insertBefore(e,this.internal_xmlElement.childNodes[t+1])}},TXMLElement.prototype.moveLevelDown=function(t,e,n){if(null!=this.internal_xmlElement&&t<this.internal_xmlElement.childNodes.length){for(var i,r,o=null,a=this.internal_xmlElement.childNodes,s=t+1,l=this.internal_xmlElement.childNodes.length;s<l;s++){if((r=a[s]).hasChildNodes()){i=r.childNodes[0];break}if(3==arguments.length&&(r.getAttribute(e)==n||r.getAttribute(e.toLowerCase())==n)){var d=this.internal_xmlElement.removeChild(a[t]);o=r.appendChild(d);break}}if(null!=i){d=this.internal_xmlElement.removeChild(this.internal_xmlElement.childNodes[t]);o=r.insertBefore(d,i)}if(o){var h=0;do{for(;o.previousSibling;)o=o.previousSibling,h++;null!=(o=o.parentNode)&&h++}while(null!=o);return h-=2}return-1}},TXMLElement.prototype.moveLevelUp=function(t){if(null!=this.internal_xmlElement&&t<this.internal_xmlElement.childNodes.length){pnode=this.internal_xmlElement;var e=this.internal_xmlElement.removeChild(this.internal_xmlElement.childNodes[t]),n=this.internal_xmlElement.parentNode.insertBefore(e,pnode);if(n){var i=0;do{for(;n.previousSibling;)n=n.previousSibling,i++;null!=(n=n.parentNode)&&i++}while(null!=n);return i-=2}return-1}},TXMLElement.prototype.getChildCount=function(){if(null!=this.internal_xmlElement)return this.internal_xmlElement.childNodes.length},TXMLElement.prototype.getElementsByNameCount=function(t){if(null!=this.internal_xmlElement)return this.internal_xmlElement.getElementsByTagName(t).length},TXMLElement.prototype.getElementsByNameAt=function(t,e){if(null!=this.internal_xmlElement)return this.createNewElement(this.internal_xmlElement.getElementsByTagName(t)[e])},TXMLElement.prototype.deleteChildByNameAt=function(t,e){if(null!=this.internal_xmlElement){var n=this.internal_xmlElement.getElementsByTagName(t)[e];this.internal_xmlElement.removeChild(n)}},TXMLElement.prototype.getChildAt=function(t){if(null!=this.internal_xmlElement&&t<this.internal_xmlElement.childNodes.length)return this.createNewElement(this.internal_xmlElement.childNodes[t])},TXMLElement.prototype.getChildByName=function(t){if(null!=this.internal_xmlElement){for(var e=this.internal_xmlElement.childNodes,n=e.length,i=0;i<n;i++)if(e[i].nodeName.toLowerCase()==t.toLowerCase())return this.createNewElement(e[i]);return null}},TXMLElement.prototype.readScriptData=function(t){var e="undefined";if(null!=this.internal_xmlElement&&this.internal_xmlElement.hasChildNodes()){var n=this.internal_xmlElement.childNodes.length;t="JScr_"+t;for(var i=0;i<n;i++)if(this.internal_xmlElement.childNodes[i].getAttribute("Name")==t){e=this.internal_xmlElement.childNodes[i].getAttribute(cScriptData),e=makeScriptNice(e);break}}return e},TXMLElement.prototype.readScriptParams=function(t){var e="";if(null!=this.internal_xmlElement&&this.internal_xmlElement.hasChildNodes()){var n=this.internal_xmlElement.childNodes.length;t="JScr_"+t;for(var i=0;i<n;i++)if(this.internal_xmlElement.childNodes[i].getAttribute("Name")==t){e=this.internal_xmlElement.childNodes[i].getAttribute(cScriptParam);break}}return e},TXMLElement.prototype.GetNodeByNameAttr=function(t){if(null!=this.internal_xmlElement){this.internal_xmlElement.childNodes;var e=this.internal_xmlElement.getAttribute("Name");if(void 0===e||void 0==e||null==e)return null;if(e.toLowerCase()==t.toLowerCase())return this.createNewElement(this.internal_xmlElement);if(this.internal_xmlElement.hasChildNodes())return function t(e,n,i){for(var r=n.childNodes,o=r.length,a=null,s=0;s<o;s++){var l=r[s],d=l.getAttribute("Name");if(void 0!==d&&void 0!=d&&null!=d&&d.toLowerCase()==i.toLowerCase())return a=e.createNewElement(l);if(l.hasChildNodes()&&null!=(a=t(e,l,i)))return a}return null}(this,this.internal_xmlElement,t)}return null},TXMLElement.prototype.deleteChildByName=function(t){if(null!=this.internal_xmlElement){for(var e=this.internal_xmlElement.childNodes,n=e.length,i=0;i<n;i++)if(e[i].nodeName.toLowerCase()==t.toLowerCase())return this.createNewElement(this.internal_xmlElement.removeChild(e[i]));return null}},TXMLElement.prototype.getChildByAttrCondition=function(t,e){if(null!=this.internal_xmlElement)for(var n=this.internal_xmlElement.childNodes,i=0;i<n.length;i++)if(null!=n[i].getAttribute(t)&&n[i].getAttribute(t)==e)return this.createNewElement(n[i]);return"@nil"},TXMLElement.prototype.deleteChildByAttrCondition=function(t,e){if(null!=this.internal_xmlElement)for(var n=this.internal_xmlElement.childNodes,i=n.length,r=0;r<i;r++)if(null!=n[r].getAttribute(t)&&n[r].getAttribute(t)==e)return this.createNewElement(this.internal_xmlElement.removeChild(n[r]));return"@nil"},TXMLElement.prototype.getChildByAttrConditionAsList=function(t,e){var n=new StringBuffer;if(null!=this.internal_xmlElement)for(var i=this.internal_xmlElement.childNodes,r=i.length,o=0;o<r;o++)null!=i[o].getAttribute(t)&&i[o].getAttribute(t)==e&&n.append(""!=n?",":"").append(i[o].nodeName);return n.toString()},TXMLElement.prototype.getNodeName=function(){if(null!=this.internal_xmlElement)return this.internal_xmlElement.nodeName},TXMLElement.prototype.setNodeValue=function(t){null!=this.internal_xmlElement&&(this.internal_xmlElement.nodeValue=t)},TXMLElement.prototype.getNodeValue=function(){if(null!=this.internal_xmlElement)return this.internal_xmlElement.nodeValue},TXMLElement.prototype.getNode=function(){if(null!=this.internal_xmlElement)return this.internal_xmlElement},TXMLElement.prototype.getParentNode=function(){if(null!=this.internal_xmlElement)return this.createNewElement(this.internal_xmlElement.parentNode)},TXMLElement.prototype.getContent=function(){if(null!=this.internal_xmlElement)return void 0!==this.internal_xmlElement.text?this.internal_xmlElement.text:this.internal_xmlElement.textContent},TXMLElement.prototype.setContent=function(t){null!=this.internal_xmlElement&&(void 0!==this.internal_xmlElement.text?this.internal_xmlElement.text=t:this.internal_xmlElement.textContent=t)},TXMLElement.prototype.getAttributeCount=function(){if(null!=this.internal_xmlElement)return this.internal_xmlElement.attributes.length},TXMLElement.prototype.getAttributeAt=function(t){if(null!=this.internal_xmlElement&&t<this.internal_xmlElement.attributes.length)return this.internal_xmlElement.attributes[t].nodeValue},TXMLElement.prototype.getAttributeNameAt=function(t){if(null!=this.internal_xmlElement&&t<this.internal_xmlElement.attributes.length)return this.internal_xmlElement.attributes[t].name},TXMLElement.prototype.getAttributeValueAt=function(t){if(null!=this.internal_xmlElement&&t<this.internal_xmlElement.attributes.length)return this.internal_xmlElement.attributes[t].value},TXMLElement.prototype.getAttributeNodeNameAt=function(t){if(null!=this.internal_xmlElement&&t<this.internal_xmlElement.attributes.length)return this.internal_xmlElement.attributes[t].nodeName},TXMLElement.prototype.getAttributeTextAt=function(t){if(null!=this.internal_xmlElement&&t<this.internal_xmlElement.attributes.length)return this.internal_xmlElement.attributes[t].text},TXMLElement.prototype.setAttributeAt=function(t,e){null!=this.internal_xmlElement&&t<this.internal_xmlElement.attributes.length&&(this.internal_xmlElement.attributes[t].nodeValue=e)},TXMLElement.prototype.getAttributeByName=function(t,e){if(null!=this.internal_xmlElement){var n=this.internal_xmlElement.getAttribute(t);return"null"==AnyToStr(n)&&0==isVarUndefined(e)?e:n}return 0==isVarUndefined(e)?e:null},TXMLElement.prototype.setAttribute=function(t,e,n){null!=this.internal_xmlElement&&(void 0===this["attr_"+t]&&void 0===this[t+"Set"]&&0==isVarUndefined(n)&&(this["attr_"+t]=e,this[t]=createSetterGetter(t)),this.internal_xmlElement.setAttribute(t,e))},TXMLElement.prototype.addElement=function(t){if(null==this.internal_xmlElement)return null;var e=this.internal_xmlElement.ownerDocument.createElement(t);return this.internal_xmlElement.appendChild(e),this.createNewElement(e)},TXMLElement.prototype.addCDataElement=function(t){if(null==this.internal_xmlElement)return null;var e=this.internal_xmlElement.ownerDocument.createCDATASection(t);return this.internal_xmlElement.appendChild(e),this.createNewElement(e)},TXMLElement.prototype.loadXML=function(t){loadXML(expandmetavar(t,this.pageName)),this.internal_xmlElement=GetXMLDoc().documentElement},TXMLElement.prototype.loadXMLfromString=function(t){this.internal_xmlElement=GetXMLDocFromString(t)},TXMLElement.prototype.toString=function(){var t="";return null==this.internal_xmlElement?t:t=this.internal_xmlElement.xml?this.internal_xmlElement.xml:serializeNode(this.internal_xmlElement)},TXMLElement.prototype.insertBefore=function(t,e){if(null!=this.internal_xmlElement&&e<this.internal_xmlElement.childNodes.length){var n=this.internal_xmlElement.childNodes[e],i=this.internal_xmlElement.ownerDocument.createElement(t);return this.internal_xmlElement.insertBefore(i,n),i}},TXMLElement.prototype.deInit=function(t){this.obj=null,this.internal_xmlElement=null,this.xmlDoc=null,this.parser=null},TXMLElement.prototype.GetElementByAbsIndex=function(t,e){if(null==this.internal_xmlElement||t<0)return null;1==arguments.length&&((e=new Object).Value=0);this.internal_xmlElement.childNodes;var n=this.internal_xmlElement.childNodes.length,i=null,r=0;for(n=this.internal_xmlElement.childNodes.length;r<n;r++){if(e.Value>t)return null;if(e.Value==t)return this.createNewElement(this.internal_xmlElement.childNodes[r]);if(e.Value++,this.internal_xmlElement.childNodes[r].hasChildNodes()){if(null!=(i=this.createNewElement(this.internal_xmlElement.childNodes[r]).GetElementByAbsIndex(t,e)))return i;if(e.Value>t)return null}}return i},TSoapElement.prototype=new TStdComponent,TSoapElement.prototype.constructor=TSoapElement,TSoapElement.prototype.attr_ServerURL=null,TSoapElement.prototype.attr_WSDLURL=null,TSoapElement.prototype.attr_TabId=null,TExtSoapElement.prototype.TabId=function(t){if(!arguments.length)return this.attr_TabId;this.attr_TabId=t},TSoapElement.prototype.ServerURL=function(t){if(!arguments.length)return this.attr_ServerURL;this.attr_ServerURL=t},TSoapElement.prototype.WSDLURL=function(t){if(!arguments.length)return this.attr_WSDLURL;this.attr_WSDLURL=t},TSoapElement.prototype.Invoke=function(t,e,n,i,r,o){var a=null;i?this.SOAPClient.invoke(this.attr_ServerURL,this.attr_WSDLURL,t,e.pl,i,this.attr_TabId,r,o):a=this.SOAPClient.invoke(this.attr_ServerURL,this.attr_WSDLURL,t,e.pl,i,this.attr_TabId,r,o),n.internalRes=a},TExtSoapElement.prototype=new TStdComponent,TExtSoapElement.prototype.constructor=TExtSoapElement,TExtSoapElement.prototype.attr_ServerURL=null,TExtSoapElement.prototype.attr_WSDLURL=null,TExtSoapElement.prototype.pl=null,TExtSoapElement.prototype.internalRes=null,TExtSoapElement.prototype.attr_ComError=0,TExtSoapElement.prototype.atrr_ComErrorString="",TExtSoapElement.prototype.SOAPClient=null,TExtSoapElement.prototype.attr_TabId=null,TExtSoapElement.prototype.TabId=function(t){if(!arguments.length)return this.attr_TabId;this.attr_TabId=t},TExtSoapElement.prototype.ServerURL=function(t){if(!arguments.length)return this.attr_ServerURL;this.attr_ServerURL=t},TExtSoapElement.prototype.WSDLURL=function(t){if(!arguments.length)return this.attr_WSDLURL;this.attr_WSDLURL=t},TExtSoapElement.prototype.ComError=function(t){if(!arguments.length)return this.SOAPClient.error;this.SOAPClient.error=0},TExtSoapElement.prototype.ComErrorString=function(t){if(!arguments.length)return this.SOAPClient.errorstring;this.SOAPClient.errorstring=t},TExtSoapElement.prototype.Invoke=function(t,e,n){var i=null;(e=!isVarUndefined(e)&&AnyToBool(e))?this.SOAPClient.invoke(this.attr_ServerURL,this.attr_WSDLURL,t,this.pl,e,this.attr_TabId,n):i=this.SOAPClient.invoke(this.attr_ServerURL,this.attr_WSDLURL,t,this.pl,e,this.attr_TabId,n),this.internalRes=i},TExtSoapElement.prototype.AddParameter=function(t,e){this.pl.add(t,e)},TExtSoapElement.prototype.ResetParameters=function(){this.SOAPClient.error=0,this.SOAPClient.errorstring="",this.pl=new SOAPClientParameters},TExtSoapElement.prototype.GetParameter=function(t,e){return null==this.internalRes?"":this.internalRes[t]?!this.internalRes[t]instanceof Function?this.internalRes[t]():this.internalRes[t]:""},TSoapParameter.prototype=new TStdComponent,TSoapParameter.prototype.constructor=TSoapParameter,TSoapParameter.prototype.pl=null,TSoapParameter.prototype.AddParameter=function(t,e){this.pl.add(t,e)},TSoapParameter.prototype.ResetParameters=function(){this.pl=new SOAPClientParameters},TSoapResponse.prototype=new TStdComponent,TSoapResponse.prototype.constructor=TSoapResponse,TSoapResponse.prototype.internalRes=null,TSoapResponse.prototype.GetParameter=function(t,e){return null==this.internalRes?"":this.internalRes[t]?!this.internalRes[t]instanceof Function?this.internalRes[t]():this.internalRes[t]:""};var ICompsEvent={IdeaScriptEvent:{touchstart:"msdown",touchmove:"msmove",touchend:"msup",pointerdown:"msdown",pointermove:"msmove",pointerup:"msup",click:"onclk",dblclick:"ondblclk",mousedown:"msdown",mouseup:"msup",mouseover:"msenter",mouseout:"msexit",mousemove:"msmove",keypress:"keypressed",keydown:"keytyped",keyup:"keyreleased",focusin:"onent",focusout:"onext",focus:"onent",blur:"onext",contextmenu:"oncontextmenu",change:"onChange",dragenter:"dragEnter",dragstart:"msdown",dragend:"msup",drag:"msmove",drop:"dragDrop",dragover:"dragOver",webkitTransitionEnd:"transEnd",oTransitionEnd:"transEnd",transitionend:"transEnd"},msdown_event_befire:null,last_msdown_event:null,currentX:0,currentY:0,SWIPE_DELTA_DISTANCE:100,SWIPE_RIGHT:1,SWIPE_LEFT:2,SWIPE_UP:3,SWIPE_DOWN:4,lastMove:null,onEvent:function(t){if(!t)t=window.event;if(1==hookcallback(t))return t.preventDefault(),stopPropagation(t),!1;if((!noTouchEvent||"touchstart"!=t.type&&"touchend"!=t.type)&&(!noMouseEvent||"mousedown"!=t.type&&"mouseup"!=t.type)){if("mousedown"==t.type&&(noTouchEvent=!0),"touchstart"==t.type&&(noMouseEvent=!0),"mouseup"==t.type&&window.setTimeout(function(){noTouchEvent=!1},100),"touchend"==t.type&&window.setTimeout(function(){noMouseEvent=!1},100),t.idea={},convertMouseParams(t),t.idea.realtarg=extractEventTarget(t),void 0===t.ms_idea_fix?t.idea.targ=findIdeaObj(t.idea.realtarg):t.idea.targ=t.ms_idea_dd_fixobj,t.idea.cancelEvent=!1,t.idea.draganddropactive=!1,"mouseup"==t.type&&null!=act_ResizeElement&&act_ResizeElement.msup_callback(t),null==t.idea.targ)return!0;t.idea.page=pages[t.idea.targ.pageName],t.idea.iobj=t.idea.page[t.idea.targ.obj];var e=t.idea.iobj;if(void 0===e)return!0;var n=!0;if("click"==t.type){var i=jQuery(e.obj).prop("id");n=jQuery(this).prop("id")==i}if(n){var r="",o=ICompsEvent.IdeaScriptEvent[t.type];ICompsEvent.hasOwnProperty(o)&&(r=ICompsEvent[o](t)),e.ExerciseGroup&&AnyToBool(e.ExerciseGroup)&&""!=e.ExerciseGroup()&&page.postProcessEvent(t.idea.ideascripthandler,r,t.idea.iobj)}return!t.idea.cancelEvent||(t.preventDefault&&t.preventDefault(),stopPropagation(t),t.returnValue=!1,!1)}},onent:function(t){t.idea.page.hasFocus();var e="",n=t.idea.iobj;return n.isEnabled()&&n.OnEnter&&(e=n.OnEnter()),t.idea.ideascripthandler="OnEnter",e},onext:function(t){var e=t.idea.iobj,n="";return e.isEnabled()&&e.OnExit&&(n=e.OnExit()),t.idea.ideascripthandler="OnExit",n},onclk:function(t){var e=t.idea.iobj;if(e.msclick_callback&&e.msclick_callback(t),"tspeedbutton"!==e.IdeaClass()&&"tskinspeedbutton"!==e.IdeaClass()||e.Down(!e.Down()),"tstdextjstreeview"===e.Subclass().toLowerCase())return!0;if("tstdnavigationlist"===e.Subclass().toLowerCase()||"tnavigationlist"===e.Subclass().toLowerCase())return!0;if("tst"===e.Subclass().toLowerCase())return!0;var n=e.OnClick(t);return t.idea.ideascripthandler="OnClick",n},ondblclk:function(t){var e=t.idea.iobj,n="";return e.isEnabled()&&e.OnDblClick&&(n=e.OnDblClick()),t.idea.ideascripthandler="OnDblClick",n},transEnd:function(t){var e=t.idea.iobj,n="";return e.isEnabled()&&e.OnTransitionEnd&&(n=e.OnTransitionEnd()),t.idea.ideascripthandler="OnTransitionEnd",n},dragStart:function(t){var e=t.idea.iobj;if(!e.Draggable||0==e.Draggable())return"";t.idea.ideascripthandler="OnDragStart";var n="";return t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("Text",t.target.getAttribute("id")),t.dataTransfer.setDragImage(t.target,0,0),e&&e.OnDragStart&&(n=e.OnDragStart()),n},dragEnter:function(t){var e=t.idea.iobj;t.idea.ideascripthandler="OnDragEnter";var n="";if(e&&e.OnDragEnter){var i=$(t.dataTransfer.getData("Text"));i=pages[i.pageName][i.obj],n=e.OnDragEnter(i)}return n},dragOver:function(t){var e=t.idea.iobj;t.idea.ideascripthandler="OnDragOver";var n="";if(e&&e.OnDragOver){var i=$(t.dataTransfer.getData("Text"));i=pages[i.pageName][i.obj],n=e.OnDragOver(i)}return t.preventDefault&&t.preventDefault(),n},dragEnd:function(t){var e=t.idea.iobj;if(!e.Draggable||0==e.Draggable())return"";t.idea.ideascripthandler="OnDragEnd";var n="";return e&&e.OnDragEnd&&(n=e.OnDragEnd()),t.idea.cancelEvent=!0,t.preventDefault&&t.preventDefault(),n},dragDrop:function(t){var e=t.idea.iobj;if(e&&e.OnDrop){var n=$(t.dataTransfer.getData("Text"));n=pages[n.pageName][n.obj],e.OnDrop(n)}return t.idea.cancelEvent=!0,""},msdown:function(t){if(AUTORENSYSTEMMODE||"touchstart"!=t.type){if("mousedown"==t.type&&mouseDnHandled)return void(mouseDnHandled=!1)}else mouseDnHandled=!0;if(!mouseIsDown){mouseIsDown=!0;var e=t.idea.iobj,n="";if(ICompsEvent.msdown_event_befire=t,ICompsEvent.last_msdown_event=t,t.idea.msmove=!1,e.msdown_callback(t),!e.obj._isMF&&e.isEnabled()&&(1==e.Dragable()||(!Modernizr.draganddrop||IS.dTM.detectTIE()||IS.dTM.detectiOSDevice()||IS.dTM.detectAndroid())&&e.Draggable&&1==e.Draggable())&&null==act_ResizeElement){var i=e.obj;if(e.Draggable&&1==e.Draggable()){var r=jQuery(i).clone();r[0].orgDisplay=i.style.display,r.attr("id","tempDND").appendTo(jQuery("body")),r.css("position","absolute"),$temp=jQuery(i),r[0].style.top=$temp.offset().top+px,r[0].style.left=$temp.offset().left+px,r[0].style.width=i.offsetWidth+px,r[0].style.height=i.offsetHeight+px,r[0].style.zIndex=maxZ++,r[0].style.margin=0+px,i.style.visibility="hidden",r[0].obj=i.obj,r[0].pageName=i.pageName,i=r[0]}dragDrop.initElement(i),dragDrop.startDragMouse(t,i),t.idea.cancelEvent=!0,t.preventDefault&&t.preventDefault(),t.idea.draganddropactive=!0}if(e.isEnabled()&&e.OnMouseDown){var o=t.idea.mouseCords;t.idea.targ!=t.idea.realtarg&&(o=getRelCoordOnParent(t.idea.realtarg,t.idea.targ,o)),n=e.OnMouseDown(o.x,o.y,o.shiftState,o.Absx,o.Absy,t)}return t.idea.ideascripthandler="OnMouseDown",n}},msup:function(t){if(AUTORENSYSTEMMODE||"touchend"!=t.type){if("mouseup"==t.type&&mouseUpHandled)return void(mouseUpHandled=!1)}else mouseUpHandled=!0;mouseIsDown=!1;var e=t.idea.iobj;if(void 0===e)return!1;var n="";if(null!=act_ResizeElement)return act_ResizeElement.Dragable(act_ResizeElement.orgDrag),act_ResizeElement.OnResizeEnd&&act_ResizeElement.OnResizeEnd(),act_ResizeElement=null,!1;if(e.isEnabled()&&(e.OnMouseUp||e.doOnMouseUpAbs)){var i=null;(i=t.idea.mouseCords).shiftState=mouseButton(t),t.idea.targ!=t.idea.realtarg&&(i=getRelCoordOnParent(t.idea.realtarg,t.idea.targ,i)),n=e.OnMouseUp?e.OnMouseUp(i.x,i.y,i.shiftState,i.Absx,i.Absy,t):e.doOnMouseUpAbs(i.Absx,i.Absy,i.shiftState)}if(isTouchDevice()){var r=ICompsEvent.swipeHandler(t);r>-1&&0==AnyToBool(e.Dragable())&&0==AnyToBool(e.Draggable())&&(t.preventDefault(),e.OnSwipe&&e.OnSwipe(r),e!=t.idea.page&&t.idea.page.OnSwipe&&t.idea.page.OnSwipe(r)),-1==r&&ICompsEvent.last_msdown_event&&ICompsEvent.last_msdown_event.idea.iobj==e&&ICompsEvent.msdown_event_befire.iobj}return ICompsEvent.last_msdown_event=null,t.idea.ideascripthandler="OnMouseUp",n},msenter:function(t){var e=t.idea.iobj,n="";return null!=CallbackAutoGlossar||isTouchDevice()||1!=e.ShowHint()||""==e.Hint()||createToolTipBox(e.Hint()),isVisualChildOf(t)?n:(e.isEnabled()&&e.OnMouseEnter&&(n=e.OnMouseEnter(t)),n)},msexit:function(t){var e=t.idea.iobj,n="";null!=CallbackAutoGlossar||isTouchDevice()||1!=e.ShowHint()||""==e.Hint()||hideToolTip(e);n="";return e.isEnabled()&&e.OnMouseExit&&(n=e.OnMouseExit(t)),n},msmove:function(t){var e=t.idea.iobj,n=t||window.event;if(isTouchDevice()&&n.touches&&1==n.touches.length&&(ICompsEvent.last_msdown_event.idea.msmove=!0,ICompsEvent.currentX=n.touches[0].pageX,ICompsEvent.currentY=n.touches[0].pageY),ICompsEvent.lastMove=t.idea.mouseCords,null!=act_ResizeElement&&null==dragDrop.draggedObject||e.msmove_callback(t),e.isEnabled()&&e.OnMouseMove){var i=t.idea.mouseCords;t.idea.targ!=t.idea.realtarg&&(i=getRelCoordOnParent(t.idea.realtarg,t.idea.targ,i)),e.OnMouseMove(i.x,i.y,i.shiftState,i.Absx,i.Absy,t)}return!0},keypressed:function(t){var e,n=t.idea.iobj,i="";n.isEnabled()&&n.OnKeyPress&&(t.keyCode?e=t.keyCode:t.which&&(e=t.which),i=n.OnKeyPress(AsciiToChar(e)));return i},keyreleased:function(t){var e=t.idea.iobj,n="";if(e.onkeyreleased_callback(t),e.isEnabled()&&e.OnKeyUp){var i=convertKeyEventParams(t);n=e.OnKeyUp(i.keyValue,i.shiftState)}return n},keytyped:function(t){var e=t.idea.iobj,n="";if(e.isEnabled()&&e.OnKeyDown){var i=convertKeyEventParams(t);n=e.OnKeyDown(i.keyValue,i.shiftState)}return n},oncontextmenu:function(t){var e=t.idea.iobj,n="";return e.isEnabled()&&e.OnContextMenu&&(n=e.OnContextMenu(),t.idea.cancelEvent=!0),n},onChange:function(t){var e=t.idea.iobj,n="";return e.onchange_callback(t),e.OnChange&&(n=e.OnChange()),n},hoverworkout:function(t){return hasClass(this,"topmenuhover")?removeClass(this,"topmenuhover"):hasClass(this,"buttonhover")?removeClass(this,"buttonhover"):hasClass(this,"assibuttonhover")?removeClass(this,"assibuttonhover"):hasClass(this,"menuhover")?removeClass(this,"menuhover"):hasClass(this,"premmenuhover")?removeClass(this,"premmenuhover"):hasClass(this,"prembuttonhover")?removeClass(this,"prembuttonhover"):hasClass(this,"Toolbarbuttonhover")&&removeClass(this,"Toolbarbuttonhover"),!0},hoverworkin:function(t){return hasClass(this,"topmenu")?addClass(this,"topmenuhover"):hasClass(this,"button")?addClass(this,"buttonhover"):hasClass(this,"assibutton")?addClass(this,"assibuttonhover"):hasClass(this,"menu")?addClass(this,"menuhover"):hasClass(this,"premmenu")?addClass(this,"premmenuhover"):hasClass(this,"prembutton")?addClass(this,"prembuttonhover"):hasClass(this,"Toolbarbutton")&&addClass(this,"Toolbarbuttonhover"),!0},swipeHandler:function(t){var e=-1,n=ICompsEvent.currentX,i=ICompsEvent.currentY;if(r=n,ICompsEvent.last_msdown_event){if(!ICompsEvent.last_msdown_event.idea.msmove)return-1;ICompsEvent.last_msdown_event.idea.mouseCords.Absy;var r=ICompsEvent.last_msdown_event.idea.mouseCords.Absx}var o=r-n,a=i-i;if(Math.round(Math.sqrt(Math.pow(o,2)+Math.pow(a,2)))>ICompsEvent.SWIPE_DELTA_DISTANCE){var s=Math.round(180*Math.atan2(a,o)/Math.PI);s<0&&(s=360-Math.abs(s)),e=s<=45&&s>=0?ICompsEvent.SWIPE_LEFT:s<=360&&s>=315?ICompsEvent.SWIPE_LEFT:s>=135&&s<=225?ICompsEvent.SWIPE_RIGHT:s>45&&s<135?ICompsEvent.SWIPE_DOWN:ICompsEvent.SWIPE_UP}return e}};function TStringList(){this.Strings=[],this.Values={}}function customSort(t,e){return(t=(t=(t=(t=(t=t.toLowerCase()).replace(/ä/g,"a")).replace(/ö/g,"o")).replace(/ü/g,"u")).replace(/ß/g,"s"))==(e=(e=(e=(e=(e=e.toLowerCase()).replace(/ä/g,"a")).replace(/ö/g,"o")).replace(/ü/g,"u")).replace(/ß/g,"s"))?0:t>e?1:-1}function createStringlist(){return new TStringList}function TStdFlashAudioPlayer(t){arguments.length<=0||(TStdFlashVideoPlayer.call(this,t),this.playerName=t.id+"ap",this.Height(35),this.Color(13421772))}function TStdAudioPlayer(t){arguments.length<=0||(TStdHTML5VideoPlayer.call(this,t),jQuery(this.obj.children[0]).bind("canplaythrough",this.statechange3))}function createjButton(t,e,n){var i=document.createElement("div");i.setAttribute("id",n+t),i.setAttribute("class","ideateam"),i.className="ideateam";var r=document.createElement("button");r.setAttribute("id",n+"_btn_"+t),i.appendChild(r),e.obj.appendChild(i),i.pageName=n,i.obj=t;var o=new TStdjButton(i);return jQuery(r).button(),o._BtnObject=r,o}function TStdjButton(t){arguments.length<=0||(TStdVisibleComponent.call(this,t),t.className="ideateam")}function TStdElementList(t){arguments.length<=0||(this.obj=t,this.attr_Items=new ElementList(this.obj),this.Items=this.attr_Items,this.Items.setpageName(this.pageName),TStdVisibleComponent.call(this,t))}function TStdNaviElementList(t){arguments.length<=0||(TStdVisibleComponent.call(this,t),this.attr_Items=new NavigationElementItems(this.obj),this.Items=this.attr_Items,this.Items.setpageName(this.pageName))}function TStdTabBar(t){if(!(arguments.length<=0)){t.className="ideateam",TStdVisibleComponent.call(this,t),this.pTabBarContent=document.createElement("div"),this.pTabBarContent.style.position="relative",this.pTabBarContentId=this.obj.id+"tabs",this.pTabBarContent.setAttribute("id",this.pTabBarContentId);var e=document.createElement("ul");this.pTabBarContent.appendChild(e),t.appendChild(this.pTabBarContent),this.init()}}function createTStdTabBar(t,e,n){var i=document.createElement("div");return e.obj.appendChild(i),i.setAttribute("id",n+t),i.pageName=n,i.obj=t,new TStdTabBar(i)}function TStdAccordion2(t){arguments.length<=0||(this.index2id=[],this.id2index=[],TStdVisibleComponent.call(this,t),t.className="ideateam",this.Init())}function createTStdAccordion2(t,e,n){var i=document.createElement("div");return e.obj.appendChild(i),i.setAttribute("id",n+t),i.pageName=n,i.obj=t,i._zw=document.createElement("div"),i._zw.style.position="relative",i._zw.className="ideateam",i._zw.style.top="0px",i._zw.style.left="0px",i._zw.style.MozBoxSizing="content-box",i._zw.style.msBoxSizing="content-box",i._zw.style.webkitBoxSizing="content-box",i._zw.style.boxSizing="content-box",i.c_obj=document.createElement("div"),i._zw.appendChild(i.c_obj),i.appendChild(i._zw),new TStdAccordion2(i)}function TStdAccordion3(t){arguments.length<=0||(this.index2id=[],this.id2index=[],TStdVisibleComponent.call(this,t),t.className="ideateam",this.Init())}function createTStdAccordion3(t,e,n){var i=document.createElement("div");return e.obj.appendChild(i),i.setAttribute("id",n+t),i.pageName=n,i.obj=t,i._zw=document.createElement("div"),i._zw.style.position="relative",i._zw.className="ideateam",i._zw.style.width="100%",i._zw.style.height="100%",i._zw.style.top="0px",i._zw.style.left="0px",i._zw.style.MozBoxSizing="content-box",i._zw.style.msBoxSizing="content-box",i._zw.style.webkitBoxSizing="content-box",i._zw.style.boxSizing="content-box",i.c_obj=document.createElement("div"),i._zw.appendChild(i.c_obj),i.appendChild(i._zw),new TStdAccordion3(i)}function createTStdTable(t,e,n){var i=document.createElement("div");e.obj.appendChild(i),i.setAttribute("id",n+t);var r=document.createElement("div");return i.appendChild(r),i.pageName=n,i.obj=t,e=null,r=null,new TStdTable(i)}function TStdTable(t){if(!(arguments.length<=0)){TStdVisibleComponent.call(this,t);var e=this.obj.firstChild.style;e.width="100%",e.height="auto"}}function createSortableList(t,e,n){var i=document.createElement("div");return e.obj.appendChild(i),i.setAttribute("id",n+t),i.pageName=n,i.obj=t,new TStdsortableList(i)}function TStdsortableList(t){arguments.length<=0||TStdVisibleComponent.call(this,t)}function createGroup(t,e,n){var i=document.createElement("div");return e.obj.appendChild(i),i.setAttribute("id",n+t),i.pageName=n,i.obj=t,new TStdGroup(i)}function TStdGroup(t){arguments.length<=0||TStdVisibleComponent.call(this,t)}Array.prototype.indexOf=function(t,e){var n,i=this.length,r=0;for(arguments.length>1&&1==e&&(t=t.toUpperCase()),Number(arguments[1]);r<i;r++)if(r in this&&(n=this[r],arguments.length>1&&1==e&&(n=n.toUpperCase()),n===t))return r;return-1},TStringList.prototype.constructor=TStringList,TStringList.prototype.AddItem=function(t){this.Strings.push(t)},TStringList.prototype.InsertItem=function(t,e){this.Strings.splice(t,0,e)},TStringList.prototype.DeleteItem=function(t){this.Strings.splice(t,1)},TStringList.prototype.GetItem=function(t){return this.Strings[t]},TStringList.prototype.SetItemValue=function(t,e){return this.Strings[t]=e},TStringList.prototype.Clear=function(){this.Strings=[]},TStringList.prototype.CommaText=function(t){if(!(arguments.length>0&&null!=t)){var e=[],n=this.Strings.length;for(a=0;a<n;a++){var i=this.Strings[a]+"";(i.indexOf(",")>=0||i.indexOf('"')>=0||""==i)&&(i='"'+i.replace(new RegExp('"',"g"),'""')+'"'),e.push(i)}return e.join(",")}if(this.Clear(),""!=t&&t.length>0)for(var r=doParseCommaText(t).split("\r"),o=r.length,a=0;a<o;a++)a==o-1?""!=r[a]&&this.AddItem(r[a]):this.AddItem(r[a])},TStringList.prototype.Sort=function(){this.Strings.sort(customSort)},TStringList.prototype.IndexOf=function(t,e){return this.Strings.indexOf(t,e)},TStringList.prototype.Count=function(){return this.Strings.length},TStdFlashAudioPlayer.prototype=new TStdFlashVideoPlayer,TStdFlashAudioPlayer.prototype.constructor=TStdFlashAudioPlayer,TStdFlashAudioPlayer.prototype.Height=function(t){if(!arguments.length)return TStdVisibleComponent.prototype.Height.call(this);TStdVisibleComponent.prototype.Height.call(this,35)},TStdFlashAudioPlayer.prototype.createAudio=function(t){var e=url_libs+IDEASCRIPTDIR;deconcept.SWFObjectUtil.getPlayerVersion().major>=10&&deconcept.SWFObjectUtil.getPlayerVersion().minor>=1?e+=videoplayer11:e+=videoplayer10;var n=new SWFObject(e,this.playerName,this.Width(),this.Height(),"8");if(n.addParam("allowfullscreen","false"),n.addParam("allowscriptaccess","always"),n.addVariable("height",this.Height()),n.addVariable("width",this.Width()+36),0==this.attr_ShowControls?(n.addVariable("controlBarAutoHide",!0),this.Visible(1),this.Left(-1e3),this.Top(-1e3)):(n.addVariable("controlBarAutoHide",!1),this.Visible(1)),""!=this.attr_Filename){var i,r=expandmetavar(this.attr_Filename,this.pageName);i=(i=window.location.href).substring(0,i.lastIndexOf("/")+1),i=unescape(i+r),n.addVariable("src",i)}1==this.attr_AutoStart&&n.addVariable("autoPlay","true"),n.addVariable("volume",this.attr_Volume/100);n.addVariable("javascriptCallbackFunction","FVPbindEvents"),n.write(this.pageName+this.Name()),this.mediaplayer=n;var o=this.obj.firstChild;null!=o&&(o.style.position="absolute",o.style.top=0+px,o.style.left=0+px,o.style.width=AnyToInt(this.Width())+36+"px",o.style.height=this.Height()+"px")},TStdFlashAudioPlayer.prototype.onpgshown=function(){if(TStdVisibleComponent.prototype.onpgshown.call(this),0==pages[this.pageName].PageMode())this.createAudio(),this.obj.style.borderStyle="none",this.Color(13421772);else{var t=this.obj.style;t.borderStyle="solid",t.borderWidth="2px",t.borderColor=convertColor(39423)}},TStdAudioPlayer.prototype=new TStdHTML5VideoPlayer,TStdAudioPlayer.prototype.constructor=TStdAudioPlayer,TStdAudioPlayer.prototype.preparePlaying=function(){if(supports_mp3()&&""!=this.attr_Filename){this.obj.children[0].children[0]&&this.obj.children[0].removeChild(this.obj.children[0].children[0]);var t=document.createElement("source");t.src=expandmetavar(this.attr_Filename,this.pageName),t.type="audio/mpeg",this.obj.children[0].appendChild(t),this.obj.children[0].load(),this.videoON=1}},TStdAudioPlayer.prototype.onpgshown=function(){if(TStdVisibleComponent.prototype.onpgshown.call(this),0==pages[this.pageName].PageMode())this.preparePlaying(),this.obj.children[0].children[0]&&1==this.videoON&&(this.obj.children[0].volume=this.attr_Volume/100,1==this.attr_AutoStart&&this.obj.children[0].play(),1==this.attr_ShowControls?this.obj.children[0].controls=AnyToBool(this.attr_ShowControls):this.Visible(0));else{var t=this.obj.style;t.borderStyle="solid",t.borderWidth="2px",t.borderColor=convertColor(39423)}},TStdAudioPlayer.prototype.Height=function(t){if(!arguments.length)return TStdVisibleComponent.prototype.Height.call(this);TStdVisibleComponent.prototype.Height.call(this,t),this.obj.children[0].style.height=t},TStdAudioPlayer.prototype.Width=function(t){if(!arguments.length)return TStdVisibleComponent.prototype.Width.call(this);TStdVisibleComponent.prototype.Width.call(this,t),this.obj.children[0].style.width=t},TStdjButton.prototype._BtnObject=null,TStdjButton.prototype=new TStdVisibleComponent,TStdjButton.prototype.constructor=TStdjButton,TStdjButton.prototype.attr_Caption="",TStdjButton.prototype.attr_cssClass="ideateam",TStdjButton.prototype.Enabled=function(t){if(!arguments.length)return TStdVisibleComponent.prototype.Enabled.call(this);TStdVisibleComponent.prototype.Enabled.call(this,t),this._BtnObject.disabled=0==t},TStdjButton.prototype.Caption=function(t){if(!arguments.length){var e=this._BtnObject;return jQuery(e).text()}e=this._BtnObject;jQuery(e).text(t),jQuery("span > span",jQuery(e).parent()).html(t)},TStdElementList.prototype=new TStdVisibleComponent,TStdElementList.prototype.constructor=TStdElementList,TStdElementList.prototype.attr_Items=null,TStdElementList.prototype.Items=null,TStdElementList.prototype.attr_ItemIndex=-1,TStdElementList.prototype.attr_Borderstyle=1,TStdElementList.prototype.attr_Text="",TStdElementList.prototype.attr_XMLFileName="",TStdElementList.prototype.attr_MultiSelect="",TStdElementList.prototype.MultiSelect=function(t){if(!arguments.length)return this.attr_MultiSelect},TStdNaviElementList.prototype.Index=function(t){if(!arguments.length)return this.ItemIndex();this.ItemIndex(t)},TStdElementList.prototype.ItemIndex=function(t){if(t=AnyToInt(t),!arguments.length)return this.attr_ItemIndex;t>-1&&(this.attr_ItemIndex=t,$lilist=jQuery(this.obj).find("li"),$lilist.length>t&&(jQuery(this.obj).find(".selectedelement").removeClass("selectedelement"),$lilist.eq(t).children().first().addClass("selectedelement")))},TStdElementList.prototype.Borderstyle=function(t){if(!arguments.length)return this.att_Borderstyle;t=AnyToInt(t),this.att_Borderstyle=t},TStdElementList.prototype.AddListItem=function(t){return this.attr_Items.AddItem(t)},TStdElementList.prototype.GetListItem=function(t){return this.attr_Items.GetItem(t)},TStdElementList.prototype.GetListItemIndex=function(t){return this.attr_Items.GetItemIndex(t)},TStdElementList.prototype.DeleteListItem=function(t){this.attr_Items.DeleteItem(t)},TStdElementList.prototype.InsertListItem=function(t,e){this.attr_Items.InsertItem(t,e)},TStdElementList.prototype.GetListCount=function(t,e){return this.attr_Items.GetItemCount(t,e)},TStdElementList.prototype.SetListText=function(t){this.attr_Items.SetText(t)},TStdElementList.prototype.GetListText=function(){return this.attr_Items.GetText()},TStdElementList.prototype.Text=function(t){if(!arguments.length)return this.GetListItem(this.ItemIndex());this.attr_Text=t},TStdElementList.prototype.XMLFileName=function(t){if(!arguments.length)return this.attr_XMLFileName;this.attr_XMLFileName=t,t.length>0&&""!=t&&this.attr_Items.loadPageLib(t),""===t&&this.attr_Items.ClearItems()},TStdNaviElementList.prototype=new TStdVisibleComponent,TStdNaviElementList.prototype.constructor=TStdNaviElementList,TStdNaviElementList.prototype.attr_Items=null,TStdNaviElementList.prototype.Items=null,TStdNaviElementList.prototype.attr_ItemIndex=-1,TStdNaviElementList.prototype.attr_Index=-1,TStdNaviElementList.prototype.attr_Borderstyle=1,TStdNaviElementList.prototype.attr_Text="",TStdNaviElementList.prototype.attr_XMLFileName="",TStdNaviElementList.prototype.attr_MultiSelect="",TStdNaviElementList.prototype.attr_Picture="",TStdNaviElementList.prototype.attr_NumGlyphs=0,TStdNaviElementList.prototype.attr_GlyphNormal="",TStdNaviElementList.prototype.attr_GlyphExpanded="",TStdNaviElementList.prototype.attr_GlyphCollapsed="",TStdNaviElementList.prototype.attr_AutoFullExpand=0,TStdNaviElementList.prototype.attr_MultiExpand=0,TStdNaviElementList.prototype._eGlyphNormal="",TStdNaviElementList.prototype._eGlyphCollapsed="",TStdNaviElementList.prototype._eGlyphExpanded="",TStdNaviElementList.prototype.MultiSelect=function(t){if(!arguments.length)return this.attr_MultiSelect},TStdNaviElementList.prototype.AutoFullExpand=function(t){if(!arguments.length)return this.attr_AutoFullExpand;this.attr_AutoFullExpand=AnyToInt(t),1==this.attr_AutoFullExpand&&(jQuery(this.obj).find("ul").removeClass("close").addClass("open").show(),jQuery(this.obj).find("ul").parent().removeClass("close").addClass("open").show())},TStdNaviElementList.prototype.MultiExpand=function(t){if(!arguments.length)return this.attr_MultiExpand;this.attr_MultiExpand=AnyToInt(t)},TStdNaviElementList.prototype.ItemIndex=function(t){if(!arguments.length)return this.Index();this.Index(t)},TStdNaviElementList.prototype.Index=function(t){if(t=AnyToInt(t),!arguments.length)return this.attr_ItemIndex;t>-1&&(this.attr_ItemIndex=t,$lilist=jQuery(this.obj).find("li"),$lilist.length>t&&(jQuery(this.obj).find("ul").removeClass("open").addClass("close").hide(),jQuery(this.obj).find("ul").parent().removeClass("open").addClass("close"),$lilist.eq(t).parentsUntil(".IdeaComponent","ul").removeClass("close").addClass("open").show(),$lilist.eq(t).parentsUntil(".IdeaComponent","ul").parent().removeClass("close").addClass("open").show(),jQuery(this.obj).find(".navilistcontent-selectedelement").removeClass("navilistcontent-selectedelement"),$lilist.eq(t).children().first().addClass("navilistcontent-selectedelement")))},TStdNaviElementList.prototype.Borderstyle=function(t){if(!arguments.length)return this.attr_Borderstyle;t=AnyToInt(t),this.attr_Borderstyle=t},TStdNaviElementList.prototype.AddListItem=function(t){return this.attr_Items.AddItem(t)},TStdNaviElementList.prototype.GetListItem=function(t){return this.attr_Items.GetItem(t)},TStdNaviElementList.prototype.GetListItemIndex=function(t){return this.attr_Items.GetItemIndex(t)},TStdNaviElementList.prototype.DeleteListItem=function(t){this.attr_Items.DeleteItem(t)},TStdNaviElementList.prototype.InsertListItem=function(t,e){this.attr_Items.InsertItem(t,e)},TStdNaviElementList.prototype.GetListCount=function(t,e){return this.attr_Items.GetItemCount(t,e)},TStdNaviElementList.prototype.SetListText=function(t){this.attr_Items.SetText(t)},TStdNaviElementList.prototype.GetListText=function(){return this.attr_Items.GetText()},TStdNaviElementList.prototype.Text=function(t){if(!arguments.length)return this.GetListItem(this.ItemIndex());this.attr_Text=t},TStdNaviElementList.prototype.XMLFileName=function(t){if(!arguments.length)return this.attr_XMLFileName;this.attr_XMLFileName=t,t.length>0&&""!=t&&this.attr_Items.loadPageLib(t),""===t&&this.attr_Items.ClearItems()},TStdNaviElementList.prototype.SetXMLTreeView=function(t){this.content=t,this.content.startsWith("<?xml")&&(this.content=this.content.substring(this.content.lastIndexOf("?>")+2,this.content.length)),this.content=GetXMLDocFromString(this.content),this.Items.ClearItems(),this.Items.fillNodesfromXML(this.content.firstChild,this.content.firstChild,0,this.obj),this.ItemIndex(this.ItemIndex()),this.AutoFullExpand(this.AutoFullExpand())},TStdNaviElementList.prototype.Picture=function(t){if(!arguments.length)return this.attr_Picture;this.attr_Picture=t,""!=t&&(t=expandmetavar(null==(t=0==this.attr_NumGlyphs?t:this.attr_Picture0)?t=this.attr_Picture:t,this.pageName))},TStdNaviElementList.prototype.NumGlyphs=function(t){if(!arguments.length)return this.attr_NumGlyphs;t=AnyToInt(t),this.attr_NumGlyphs=t,this.Picture(this.Picture())},TStdNaviElementList.prototype.TreeViewSetImageIndex=function(t,e){t=AnyToInt(t),e=AnyToInt(e);var n=jQuery(this.obj);if(""!=this.attr_Picture&&t<n.find("a").length&&e<this.attr_NumGlyphs){var i=expandmetavar(this["attr_Picture"+e],this.pageName),r=n.find("a").eq(t);r.attr("_icon",i),r.attr("_iconOpen",i),r.children().eq(0).attr("src",i)}},TStdNaviElementList.prototype.TreeViewSetImageFile=function(t,e){t=AnyToInt(t),imageIndex=AnyToInt(imageIndex);var n=jQuery(this.obj);if(t<n.find("a").length){var i=expandmetavar(e,this.pageName),r=n.find("a").eq(t);r.attr("_icon",i),r.attr("_iconOpen",i),r.children().eq(0).attr("src",i)}},TStdNaviElementList.prototype.TreeViewItemCount=function(){return jQuery(this.obj).find("a").length},TStdNaviElementList.prototype.TreeViewIsNodeExpanded=function(t){var e=0,n=jQuery(this.obj);return(t=AnyToInt(t))<n.find("a").length&&($node=n.find("a").eq(t),e=0==$node.parentsUntil(".IdeaComponent","ul.closed").length?1:0),e},TStdNaviElementList.prototype.getLevel=function(t){var e=jQuery(this.obj);return t=AnyToInt(t),e.find("a").eq(t).parentsUntil(".IdeaComponent","ul").length},TStdNaviElementList.prototype.addClass=function(t,e){var n=jQuery(this.obj);t=AnyToInt(t),n.find("a").eq(t).addClass(e)},TStdNaviElementList.prototype.removeClass=function(t,e){var n=jQuery(this.obj);t=AnyToInt(t),n.find("a").eq(t).removeClass(e)},TStdNaviElementList.prototype.GlyphNormal=function(t){if(!arguments.length)return this.attr_GlyphNormal;this.attr_GlyphNormal=t,this._eGlyphNormal=expandmetavar(t,this.pageName)},TStdNaviElementList.prototype.GlyphExpanded=function(t){if(!arguments.length)return this.attr_GlyphExpanded;this.attr_GlyphExpanded=t,this._eGlyphExpanded=expandmetavar(t,this.pageName)},TStdNaviElementList.prototype.GlyphCollapsed=function(t){if(!arguments.length)return this.attr_GlyphCollapsed;this.attr_GlyphCollapsed=t,this._eGlyphCollapsed=expandmetavar(t,this.pageName)},TStdNaviElementList.prototype._IsChapter=function(t){var e=jQuery(this.obj);t=AnyToInt(t);var n=e.find("li");return t>=n.length?0:n.eq(t).hasClass("navilistcontent-folder")?1:0},TStdNaviElementList.prototype.getPagenameForIndex=function(t){var e=jQuery(this.obj);return t=AnyToInt(t),e.find("li").eq(t).attr("pagename")},TStdNaviElementList.prototype.getPagenameForIndex=function(t){var e=jQuery(this.obj);return t=AnyToInt(t),e.find("li").eq(t).attr("pagename")},TStdNaviElementList.prototype.getIndexForPagename=function(t){var e=jQuery(this.obj);return e.find("li").index(e.find("li[pagename='"+t+"']"))},TStdNaviElementList.prototype.getChildrenCount=function(t){var e=jQuery(this.obj);return t=AnyToInt(t),e.find("li").eq(t).children("ul").children("li").length},TStdTabBar.prototype=new TStdVisibleComponent,TStdTabBar.prototype.constructor=TStdTabBar,TStdTabBar.prototype.pTabBar=null,TStdTabBar.prototype.pTabBarContent=null,TStdTabBar.prototype.pTabBarContentId=null,TStdTabBar.prototype._useClose=!1,TStdTabBar.prototype._tabTemplate="",TStdTabBar.prototype._panelTemplate="<div id='#{id}' style='padding:0px;margin:0px;'></div>",TStdTabBar.prototype.init=function(){var t=this;this._tabTemplate="<li><a href='#{href}' id='a-#{href}'>#{label}</a>",this._useClose&&(this._tabTemplate+="<span class='ui-icon ui-icon-close' style='display:inline-block;'>Close Tab</span>"),this._tabTemplate+="</li>",this.pTabBar=jQuery("#"+this.pTabBarContentId).tabs({activate:function(e,n){t.doOnSelect(e,n)}}),this._useClose&&this.pTabBar.delegate("span.ui-icon-close","click",function(){t.doOnCloseTab(this)})},TStdTabBar.prototype.useClose=function(t){this._useClose=t,jQuery(this.pTabBar).tabs("destroy"),this.init()},TStdTabBar.prototype.doOnSelect=function(t,e){var n=e.newTab.index(),i=findIdeaObj(this.obj);if(null!=i){var r=pages[i.pageName];return r[i.obj].OnSelect&&r[i.obj].OnSelect(n),!0}},TStdTabBar.prototype.doOnCloseTab=function(t){var e=t.previousSibling.id;e=e.substr(e.length-1,1);var n=findIdeaObj(this.obj);if(null!=n){var i=pages[n.pageName];return i[n.obj].OnCloseTab&&i[n.obj].OnCloseTab(e),!0}},TStdTabBar.prototype.Count=function(t){return this.pTabBar.children().children("li").size()},TStdTabBar.prototype.RefreshIndex=function(){this.pTabBarContentId;for(var t=this.Count(),e=0;e<t;e++)this.pTabBar.find(".ui-tabs-nav li:eq("+e+")").attr("aria-labelledby",this.pTabBarContentId+"-"+e).attr("aria-controls","a-#"+this.pTabBarContentId+"-"+e).find(".ui-tabs-anchor").prop("href","#"+this.pTabBarContentId+"-"+e).prop("id","a-#"+this.pTabBarContentId+"-"+e),this.pTabBar.find(".ui-tabs-nav li:eq("+e+")").find(".ui-tabs-panel").prop("id",this.pTabBarContentId+"-"+e).attr("aria-labelledby","a-#"+this.pTabBarContentId+"-"+e)},TStdTabBar.prototype.AddTab=function(t){var e=this.pTabBarContentId,n=this.Count();return jQuery(this._tabTemplate.replace(/#\{href\}/g,"#"+e+"-"+n).replace(/#\{label\}/g,t)).appendTo(this.pTabBar.find(".ui-tabs-nav")).append(this._panelTemplate.replace(/#\{id\}/g,e+"-"+n)),this.pTabBar.tabs("refresh"),this.Count()},TStdTabBar.prototype.DeleteTab=function(t){var e=this.pTabBar.find(".ui-tabs-nav li:eq("+t+")").remove().attr("aria-controls");jQuery("#"+e).remove(),this.RefreshIndex(),this.pTabBar.tabs("refresh")},TStdTabBar.prototype.Rename=function(t,e){$("a-#"+this.pTabBarContentId+"-"+t).innerHTML=e},TStdTabBar.prototype.getCaption=function(t){return $("a-#"+this.pTabBarContentId+"-"+t).innerHTML},TStdTabBar.prototype.SelectTab=function(t){this.pTabBar.tabs("option","active",t),this.pTabBar.tabs("refresh")},TStdTabBar.prototype.getNeedHeight=function(){return this.obj.firstChild.offsetHeight},TStdAccordion2.prototype=new TStdVisibleComponent,TStdAccordion2.prototype.constructor=TStdAccordion2,TStdAccordion2.prototype.accord=null,TStdAccordion2.prototype.attr_length=0,TStdAccordion2.prototype.attr_AutoHeight=!0,TStdAccordion2.prototype.index2id=null,TStdAccordion2.prototype.id2index=null,TStdAccordion2.prototype.AutoHeight=function(t){return arguments.length>0&&(t=AnyToBool(t))!=this.attr_AutoHeight&&(this.attr_AutoHeight=t),this.attr_AutoHeight},TStdAccordion2.prototype.AccordionaddItem=function(t,e,n){if(!t||""==t)return null;n=AnyToBool(n);var i=document.createElement("h3");i.id=this.Name()+"_h3_"+t;var r=document.createElement("a");r.id=this.Name()+"_a_"+t,r.href="javascript:void(0);",r.innerHTML=e;var o=document.createElement("div");o.id=this.Name()+"_main_content_"+t;var a=document.createElement("div");a.id=this.Name()+"_content_"+t,o.appendChild(a),i.appendChild(r),this.accord.accordion("destroy"),0==this.attr_length&&(n=!1),n?(this.obj.c_obj.insertBefore(o,this.obj.c_obj.firstChild),this.obj.c_obj.insertBefore(i,this.obj.c_obj.firstChild),this.Index2IDinsertToFirst(t)):(this.obj.c_obj.appendChild(i),this.obj.c_obj.appendChild(o),this.index2id[this.attr_length]=t,this.id2index[t]=this.attr_length);this.attr_length,this.attr_length++;this.Init(),this.accord&&this.accord.accordion("refresh")},TStdAccordion2.prototype.Index2IDinsertToFirst=function(t){this.id2index=[];var e=[],n=0;e[n]=t,this.id2index[t]=n;for(var i=0;i<=this.attr_length;i++)e[++n]=this.index2id[i],this.id2index[this.index2id[i]]=n;this.index2id=e.slice(0,e.length)},TStdAccordion2.prototype.Updating=function(t){return arguments.length>0&&(t=AnyToBool(t),this.attr_Updating!=t&&(t||this.accord,this.attr_Updating=t)),this.attr_Updating},TStdAccordion2.prototype.doOnChange=function(t,e){var n=this.index2id[e.newHeader.index("h3")],i=findIdeaObj(this.obj),r=pages[i.pageName][i.obj];if(r.OnChange)try{r.OnChange()}catch(t){}if(r.OnActivate)try{r.OnActivate(n)}catch(t){}this.UpdateAccordionSize()},TStdAccordion2.prototype.doOnBeforeChange=function(t,e){var n=this.index2id[e.newHeader.index("h3")],i=findIdeaObj(this.obj),r=pages[i.pageName][i.obj];if(r.OnBeforeChange)try{r.OnBeforeChange()}catch(t){}if(r.OnBeforeActivate)try{r.OnBeforeActivate(n)}catch(t){}},TStdAccordion2.prototype.Init=function(){var t=this;this.accord=jQuery(this.obj.c_obj).accordion({animate:!1,heightStyle:"content",activate:function(e,n){t.doOnChange(e,n)},beforeActivate:function(e,n){t.doOnBeforeChange(e,n)}}),jQuery("div[id='"+this.obj.id+"']").find("*").css({MozBoxSizing:"content-box",msBoxSizing:"content-box",webkitBoxSizing:"content-box",boxSizing:"content-box"})},TStdAccordion2.prototype.Clear=function(){for(var t=null,e=0,n=null,i=0;i<=this.attr_length;i++)e=this.index2id[i],(t=$(this.Name()+"_content_"+e))&&t.firstChild&&(n=t.removeChild(t.firstChild),AnyToObject(this.pageName).obj.appendChild(n));this.accord.accordion("destroy"),this.obj.c_obj.innerHTML="",this.Init(),this.index2id=[],this.id2index=[],this.attr_length=0},TStdAccordion2.prototype.Count=function(){return this.attr_length},TStdAccordion2.prototype.AccordionaddObject=function(t,e){e=AnyToObject(e);var n=$(this.Name()+"_content_"+t);n&&e.obj.parentNode!=n&&(null!=e.obj.parentNode&&e.obj.parentNode.removeChild(e.obj),n.appendChild(e.obj)),this.UpdateAccordionSize()},TStdAccordion2.prototype.AccordionremoveObject=function(t,e,n){e=AnyToObject(e),n=AnyToObject(n);var i=$(this.Name()+"_content_"+t);i&&(e.obj.parentNode==i&&i.removeChild(e.obj),null!=n.obj.parentNode&&n.obj.parentNode.appendChild(e.obj)),this.UpdateAccordionSize()},TStdAccordion2.prototype.getActive=function(){return this.accord.accordion("option","active")},TStdAccordion2.prototype.Accordionopen=function(t){var e=this.id2index[t];this.accord.accordion("option","active",e),this.accord.accordion("refresh"),this.UpdateAccordionSize()},TStdAccordion2.prototype.deInit=function(){this.accord.accordion("destroy"),this.accord=null,TStdVisibleComponent.prototype.deInit.call(this)},TStdAccordion2.prototype.onpgready=function(){TStdVisibleComponent.prototype.onpgready.call(this)},TStdAccordion2.prototype.UpdateAccordionSize=function(){if(this.obj._zw.style.width=this.Width()+"px",this.obj._zw.style.height=this.Height()+"px",this.accord&&(this.accord.accordion("refresh"),this.attr_AutoHeight)){var t=$(this.Name()+"_content_"+this.index2id[this.getActive()]);null!=t&&null!=t.firstChild&&(t.style.height=t.firstChild.offsetHeight+"px",t.firstChild.style.top="inherit")}},TStdAccordion2.prototype.Width=function(t){if(!arguments.length)return TStdVisibleComponent.prototype.Width.call(this);TStdVisibleComponent.prototype.Width.call(this,t),this.UpdateAccordionSize()},TStdAccordion2.prototype.Height=function(t){if(!arguments.length)return TStdVisibleComponent.prototype.Height.call(this);TStdVisibleComponent.prototype.Height.call(this,t),this.UpdateAccordionSize()},TStdAccordion2.prototype.OnClick=function(){this.accord&&this.accord.accordion("refresh"),TStdVisibleComponent.prototype.OnClick.call(this)},TStdAccordion3.prototype=new TStdVisibleComponent,TStdAccordion3.prototype.constructor=TStdAccordion2,TStdAccordion3.prototype.accord=null,TStdAccordion3.prototype.attr_length=0,TStdAccordion3.prototype.attr_AutoHeight=!0,TStdAccordion3.prototype.index2id=null,TStdAccordion3.prototype.id2index=null,TStdAccordion3.prototype.AutoHeight=function(t){return arguments.length>0&&(t=AnyToBool(t))!=this.attr_AutoHeight&&(this.attr_AutoHeight=t),this.attr_AutoHeight},TStdAccordion3.prototype.AccordionaddItem=function(t,e,n){if(!t||""==t)return null;n=AnyToBool(n);var i=document.createElement("h3");i.id=this.Name()+"_h3_"+t;var r=document.createElement("a");r.id=this.Name()+"_a_"+t,r.href="javascript:void(0);",r.innerHTML=e;var o=document.createElement("div");o.id=this.Name()+"_main_content_"+t;var a=document.createElement("div");a.id=this.Name()+"_content_"+t,o.appendChild(a),i.appendChild(r),this.accord.accordion("destroy"),0==this.attr_length&&(n=!1),n?(this.obj.c_obj.insertBefore(o,this.obj.c_obj.firstChild),this.obj.c_obj.insertBefore(i,this.obj.c_obj.firstChild),this.Index2IDinsertToFirst(t)):(this.obj.c_obj.appendChild(i),this.obj.c_obj.appendChild(o),this.index2id[this.attr_length]=t,this.id2index[t]=this.attr_length);this.attr_length,this.attr_length++;this.Init(),this.accord&&this.accord.accordion("refresh")},TStdAccordion3.prototype.Index2IDinsertToFirst=function(t){this.id2index=[];var e=[],n=0;e[n]=t,this.id2index[t]=n;for(var i=0;i<=this.attr_length;i++)e[++n]=this.index2id[i],this.id2index[this.index2id[i]]=n;this.index2id=e.slice(0,e.length)},TStdAccordion3.prototype.Updating=function(t){return arguments.length>0&&(t=AnyToBool(t),this.attr_Updating!=t&&(t||this.accord,this.attr_Updating=t)),this.attr_Updating},TStdAccordion3.prototype.doOnChange=function(t,e){var n=this.index2id[e.newHeader.index("h3")],i=findIdeaObj(this.obj),r=pages[i.pageName][i.obj];if(r.OnChange)try{r.OnChange()}catch(t){}if(r.OnActivate)try{r.OnActivate(n)}catch(t){}this.UpdateAccordionSize()},TStdAccordion3.prototype.doOnBeforeChange=function(t,e){var n=this.index2id[e.newHeader.index("h3")],i=findIdeaObj(this.obj),r=pages[i.pageName][i.obj];if(r.OnBeforeChange)try{r.OnBeforeChange()}catch(t){}if(r.OnBeforeActivate)try{r.OnBeforeActivate(n)}catch(t){}},TStdAccordion3.prototype.Init=function(){var t=this;this.accord=jQuery(this.obj.c_obj).accordion({animate:!1,heightStyle:"content",activate:function(e,n){t.doOnChange(e,n)},beforeActivate:function(e,n){t.doOnBeforeChange(e,n)}}),jQuery("div[id='"+this.obj.id+"']").find("*").css({MozBoxSizing:"content-box",msBoxSizing:"content-box",webkitBoxSizing:"content-box",boxSizing:"content-box"})},TStdAccordion3.prototype.Clear=function(){for(var t=null,e=0,n=null,i=0;i<=this.attr_length;i++)e=this.index2id[i],(t=$(this.Name()+"_content_"+e))&&t.firstChild&&(n=t.removeChild(t.firstChild),AnyToObject(this.pageName).obj.appendChild(n));this.accord.accordion("destroy"),this.obj.c_obj.innerHTML="",this.Init(),this.index2id=[],this.id2index=[],this.attr_length=0},TStdAccordion3.prototype.Count=function(){return this.attr_length},TStdAccordion3.prototype.AccordionaddObject=function(t,e){e=AnyToObject(e);var n=$(this.Name()+"_content_"+t);n&&e.obj.parentNode!=n&&(null!=e.obj.parentNode&&e.obj.parentNode.removeChild(e.obj),n.appendChild(e.obj)),this.UpdateAccordionSize()},TStdAccordion3.prototype.AccordionremoveObject=function(t,e,n){e=AnyToObject(e),n=AnyToObject(n);var i=$(this.Name()+"_content_"+t);i&&(e.obj.parentNode==i&&i.removeChild(e.obj),null!=n.obj.parentNode&&n.obj.parentNode.appendChild(e.obj)),this.UpdateAccordionSize()},TStdAccordion3.prototype.getActive=function(){return this.accord.accordion("option","active")},TStdAccordion3.prototype.Accordionopen=function(t){var e=this.id2index[t];this.accord.accordion("option","active",e),this.accord.accordion("refresh"),this.UpdateAccordionSize()},TStdAccordion3.prototype.deInit=function(){this.accord.accordion("destroy"),this.accord=null,TStdVisibleComponent.prototype.deInit.call(this)},TStdAccordion3.prototype.onpgready=function(){TStdVisibleComponent.prototype.onpgready.call(this)},TStdAccordion3.prototype.UpdateAccordionSize=function(){if(this.accord&&(this.accord.accordion("refresh"),this.attr_AutoHeight)){var t=$(this.Name()+"_content_"+this.index2id[this.getActive()]);null!=t&&null!=t.firstChild&&(t.firstChild.style.top="inherit")}},TStdAccordion3.prototype.Width=function(t){if(!arguments.length)return TStdVisibleComponent.prototype.Width.call(this);TStdVisibleComponent.prototype.Width.call(this,t),this.UpdateAccordionSize()},TStdAccordion3.prototype.Height=function(t){if(!arguments.length)return TStdVisibleComponent.prototype.Height.call(this);TStdVisibleComponent.prototype.Height.call(this,t),this.UpdateAccordionSize()},TStdAccordion3.prototype.OnClick=function(){this.accord&&this.accord.accordion("refresh"),TStdVisibleComponent.prototype.OnClick.call(this)},TStdTable.prototype=new TStdVisibleComponent,TStdTable.prototype.constructor=TStdTable,TStdTable.prototype.attr_rowCount=0,TStdTable.prototype.attr_colCount=0,TStdTable.prototype.attr_maxRows=50,TStdTable.prototype.attr_Color=CLWHITE,TStdTable.prototype.attr_maxCols=10,TStdTable.prototype.attr_ReadOnly=!1,TStdTable.prototype.attr_markEditable=!1,TStdTable.prototype.attr_tableHeader=!0,TStdTable.prototype.attr_tableText="",TStdTable.prototype.attr_tableData="",TStdTable.prototype.attr_orgTableData="",TStdTable.prototype.attr_staticTextMode="0",TStdTable.prototype.attr_Borderstyle="0",TStdTable.prototype.attr_BorderColor=CLBLACK,TStdTable.prototype.attr_Borderwidth=1,TStdTable.prototype.attr_Grid=!0,TStdTable.prototype.curRow=0,TStdTable.prototype.curCol=0,TStdTable.prototype.lastEditCol=0,TStdTable.prototype.lastEditRow=0,TStdTable.prototype.attr_autoDelete=!0,TStdTable.prototype.attr_autoDisable=!0,TStdTable.prototype._cSep1="#"+String.fromCharCode(255)+"#",TStdTable.prototype._cSep2="#"+String.fromCharCode(255)+String.fromCharCode(255)+"#",TStdTable.prototype._cSep3="#"+String.fromCharCode(255)+String.fromCharCode(255)+String.fromCharCode(255)+"#",TStdTable.prototype._dtMetaData=2,TStdTable.prototype._dtText=3,TStdTable.prototype._dtSolution=4,TStdTable.prototype._stCellType=0,TStdTable.prototype._stEnums=1,TStdTable.prototype._stCBPreset=2,TStdTable.prototype._stNone=0,TStdTable.prototype.onpgshown=function(){this.pageName,this.Name();0==AnyToBool(this.attr_Transparent)?this.obj.style.backgroundColor=convertColor(this.attr_Color):this.obj.style.backgroundColor="transparent",this.updTableText(),this.repaint(),TStdVisibleComponent.prototype.onpgshown.call(this)},TStdTable.prototype.onpgready=function(){this.attr_orgTableData=this.attr_tableData,TStdVisibleComponent.prototype.onpgready.call(this)},TStdTable.prototype.getOrgCellText=function(t,e){var n=this.attr_tableData;this.attr_tableData=this.attr_orgTableData;var i=this.getCellText(t,e);return this.attr_tableData=n,i},TStdTable.prototype.resetTableText=function(){var t,e,n,i=AnyToInt(this.attr_rowCount),r=AnyToInt(this.attr_colCount);for(t=1;t<=i;t++)for(e=1;e<=r;e++)AnyToInt(this.getCellType(t,e))>=1&&(n=this.getOrgCellText(t,e),this.setCellText(t,e,n));return!0},TStdTable.prototype.delRowData=function(t){var e,n=[],i=[];for(this.attr_tableData.length>0&&(n=this.attr_tableData.split(this._cSep3)),e=n.length;e>0;)i=[],n[--e].length>0&&(i=n[e].split(this._cSep2)),i.length>0&&AnyToInt(i[0])==AnyToInt(t)&&n.splice(e,1);return this.attr_tableData=n.join(this._cSep3),!0},TStdTable.prototype.delColData=function(t){var e,n=[],i=[];for(this.attr_tableData.length>0&&(n=this.attr_tableData.split(this._cSep3)),e=n.length;e>0;)i=[],n[--e].length>0&&(i=n[e].split(this._cSep2)),i.length>1&&AnyToInt(i[1])==AnyToInt(t)&&n.splice(e,1);return this.attr_tableData=n.join(this._cSep3),!0},TStdTable.prototype.getCellClasses=function(t,e){var n,i=[],r=AnyToInt(this.attr_colCount);return 1==pages[this.pageName].PageMode()&&t==this.curRow&&e==this.curCol&&i.push("activecell"),0==pages[this.pageName].PageMode()&&1==AnyToBool(this.attr_markEditable)&&0==AnyToBool(this.attr_Readonly)&&AnyToInt(this.getCellType(t,e))>0&&i.push("editablecell"),e==AnyToInt((r+r%2)/2)&&(1==t&&1==AnyToBool(this.attr_tableHeader)?i.push("centercolheader"):i.push("centercol")),0==pages[this.pageName].PageMode()&&null!=this.OnGetClass&&(n=i.join(" "),isVarUndefined(n=this.OnGetClass(t,e,n))||(i=0==n.length?[]:n.split(" "))),n="",i.length>0&&(n=i.join(" ")),n},TStdTable.prototype.shrinkData=function(){var t,e=AnyToInt(this.attr_rowCount),n=AnyToInt(this.attr_maxRows),i=AnyToInt(this.attr_colCount),r=AnyToInt(this.attr_maxCols);for(t=e,t=e+1;t<=n;t++)this.delRowData(t);for(t=i+1;t<=r;t++)this.delColData(t);return""},TStdTable.prototype.updTableText=function(){var t,e,n,i,r,o,a,s,l,d;if(null==this.obj)return!1;this.obj.pageName,this.Name();if(l=AnyToInt(this.attr_colCount),s=AnyToInt(this.attr_rowCount),"",n="",d=1,1==AnyToBool(this.attr_tableHeader)){for(a=1;a<=l;a++)n=(r=this.getCellClasses(1,a)).length>0?n+"<th class="+scDQ+r+scDQ+">"+this.getCellText(1,a)+"</th>":n+"<th>"+this.getCellText(1,a)+"</th>";n="<thead><tr><th>#</th>"+n+"</tr></thead>",d=2}for(e="",o=d;o<=s;o++){for(i="",a=1;a<=l;a++)i=(r=this.getCellClasses(o,a)).length>0?i+"<td class="+scDQ+r+scDQ+">"+this.getCellText(o,a)+"</td>":i+"<td>"+this.getCellText(o,a)+"</td>";e=(o+d-1)%2==0?e+"<tr class="+scDQ+"oddrow"+scDQ+"><td>"+AnyToStr(o)+"</td>"+i+"</tr>":e+"<tr class="+scDQ+"evenrow"+scDQ+"><td>"+AnyToStr(o)+"</td>"+i+"</tr>"}return t='<table class="table table-striped #grid#" id="#tableid#">'+n+(e="<tbody>"+e+"</tbody>")+"</table>",this.attr_tableText=t,!0},TStdTable.prototype._ct2ctText=function(t){return 1==AnyToBool(this.attr_ReadOnly)?"ro":1==AnyToInt(t)?"input":2==AnyToInt(t)?"number":3==AnyToInt(t)?"select":4==AnyToInt(t)?"checkbox":"ro"},TStdTable.prototype.repaint=function(){var t,e,n,i,r,o,a,s,l,d,h=this,u=[],c=[],p=[],m=[];for(s=StrReplace(this.attr_tableText,"#tableid#",this.obj.pageName+this.Name()+"_table"),s=0==AnyToBool(this.attr_Grid)?StrReplace(s,"#grid#","table-borderless"):StrReplace(s,"#grid#","table-bordered"),jQuery(this.obj).html(s),r=AnyToInt(this.attr_colCount),i=AnyToInt(this.attr_rowCount),c=[],p=[],m=[],t=1==AnyToBool(this.attr_tableHeader)?2:1;t<=i;t++){for(row=[],m=[],(p=[]).push(AnyToStr(1)),p.push("#"),p.push(this._ct2ctText(0)),m.push(new Array([])),m[m.length-1]=p,p=[],e=1;e<=r;e++){if((p=[]).push(AnyToStr(e)),p.push(AnyToStr(t)+"_"+AnyToStr(e)),a=this.getCellType(t,e),p.push(this._ct2ctText(a)),3==a||4==a){for(u=[],(l=this.getCellEnums(t,e)).trim().length>0&&(u=l.split(scLF)),l="{",o=0;o<u.length;o++)l=l+scDQ+AnyToStr(o)+scDQ+": "+scDQ+u[o]+scDQ,o<u.length-1&&(l+=",");l+="}",p.push(l)}m.push(new Array([])),m[m.length-1]=p}c.push(new Array([])),c[c.length-1]=m}d=0==detectTouchAndMobile.prototype.detectTablet()&&0==detectTouchAndMobile.prototype.detectPhone()?"click":"touchstart",jQuery("#"+this.obj.pageName+this.Name()+"_table").Tabledit({url:"./script/table.php",eventType:d,autoDisable:AnyToBool(this.attr_autoDisable),hideIdentifier:!0,editButton:!1,deleteButton:!1,restoreButton:!1,columns:{identifier:[0,"id"],editable:c},onAjax:function(t,e){if(isVarUndefined(pages[h.pageName]))return e;if("edit"==t&&h.OnCellEdit){var i,r,o=[],a=0,s=0,l="";for(e.length>0&&(o=e.split("&")),n=0;n<o.length;n++)o[n].indexOf("_")>0&&o[n].indexOf("action=edit")<0&&o[n].indexOf("=")>0&&((i=(r=o[n]).indexOf("_"))>0&&(a=AnyToInt(r.substr(0,i)),i=(r=r.substr(i+1)).indexOf("=")),i>0&&(s=AnyToInt(r.substr(0,i)),l=r.substr(i+1),h.OnCellEdit(a,s,l)))}return e}}),1==AnyToInt(this.attr_Borderstyle)?(this.obj.style.borderStyle="solid",this.obj.style.borderWidth=AnyToStr(AnyToInt(this.attr_Borderwidth))+"px",this.obj.style.borderColor=convertColor(this.attr_BorderColor)):(this.obj.style.borderStyle="none",this.obj.style.borderWidth="0px")},TStdTable.prototype.getCellData=function(t,e,n,i){var r,o=[],a=[],s=[];for(this.attr_tableData.length>0&&(o=this.attr_tableData.split(this._cSep3)),r=0;r<o.length;r++)if(a=[],o[r].length>0&&(a=o[r].split(this._cSep2)),a.length>1&&AnyToInt(a[0])==AnyToInt(t)&&AnyToInt(a[1])==AnyToInt(e))if(a.length>n){if(n!=this._dtMetaData)return a[n];if(s=[],a[n].length>0&&(s=a[n].split(this._cSep1)),s.length>i)return s[i]}else r=o.length;return n==this._dtText?"":n==this._dtMetaData&&i==this._stCellType?"0":(n==this._dtMetaData&&this._stEnums,"")},TStdTable.prototype.setCellData=function(t,e,n,i,r){var o,a=[],s=[],l=[];for(this.attr_tableData.length>0&&(a=this.attr_tableData.split(this._cSep3)),o=0;o<a.length;o++)if(s=[],a[o].length>0&&(s=a[o].split(this._cSep2)),s.length>1&&AnyToInt(s[0])==AnyToInt(t)&&AnyToInt(s[1])==AnyToInt(e))return s.length>n?n==this._dtMetaData?(l=[],s[n].length>0&&(l=s[n].split(this._cSep1)),l.length>i?l[i]=r:(i==this._stEnums&&l.length<=this._stCellType&&l.push("0"),l.push(r)),s[n]=l.join(this._cSep1),a[o]=s.join(this._cSep2),this.attr_tableData=a.join(this._cSep3),void(o=a.length)):(s[n]=r,a[o]=s.join(this._cSep2),this.attr_tableData=a.join(this._cSep3),void(o=a.length)):n==this._dtMetaData?(l=[],i==this._stEnums&&l.push("0"),l.push(r),s[n]=l.join(this._cSep1),a[o]=s.join(this._cSep2),this.attr_tableData=a.join(this._cSep3),void(o=a.length)):(s.length<=this._dtMetaData&&s.push("0"),n==this._dtSolution&&s.length<=this._dtText&&s.push(""),s.push(r),a[o]=s.join(this._cSep2),this.attr_tableData=a.join(this._cSep3),void(o=a.length));(s=[]).push(AnyToStr(t)),s.push(AnyToStr(e)),n==this._dtMetaData?(l=[],i==this._stEnums&&l.push("0"),l.push(r),s[n]=l.join(this._cSep1)):(s.push("0"),s.push(r),n==this._dtSolution&&(s.push(""),s.push(r))),a.push(s.join(this._cSep2)),this.attr_tableData=a.join(this._cSep3)},TStdTable.prototype.getCellText=function(t,e){var n=this.getCellData(t,e,this._dtText,this._stNone);return n=decodeURIComponent(n),1!=AnyToInt(this.attr_staticTextMode)&&(n=(n+="").replace(/<\/?\w+((\s+\w+(\s*=\s*(?:".*?"|'.*?'|[^'">\s]+))?)+\s*|\s*)\/?>/g,"")),n},TStdTable.prototype.setCellText=function(t,e,n){this.setCellData(t,e,this._dtText,this._stNone,encodeURIComponent(n)),this.updTableText()},TStdTable.prototype.getCellEnums=function(t,e){var n=this.getCellData(t,e,this._dtMetaData,this._stEnums);return decodeURIComponent(n)},TStdTable.prototype.setCellEnums=function(t,e,n){this.setCellData(t,e,this._dtMetaData,this._stEnums,encodeURIComponent(n))},TStdTable.prototype.getCellEnumVal=function(t,e,n){var i=[],r=this.getCellData(t,e,this._dtMetaData,this._stEnums);return(r=decodeURIComponent(r)).length>0&&(i=r.split(scLF)),n<i.length?i[n]:""},TStdTable.prototype.getCellCBText=function(t,e){var n=this.getCellData(t,e,this._dtText,this._stNone);return n=decodeURIComponent(n),1!=AnyToInt(this.attr_staticTextMode)&&(n=(n+="").replace(/<\/?\w+((\s+\w+(\s*=\s*(?:".*?"|'.*?'|[^'">\s]+))?)+\s*|\s*)\/?>/g,"")),n},TStdTable.prototype.setCellCBText=function(t,e,n){this.setCellData(t,e,this._dtText,this._stNone,encodeURIComponent(n)),this.updTableCBText()},TStdTable.prototype.getCellType=function(t,e){return this.getCellData(t,e,this._dtMetaData,this._stCellType)},TStdTable.prototype.setCellType=function(t,e,n){this.setCellData(t,e,this._dtMetaData,this._stCellType,n)},TStdTable.prototype.getCellSolution=function(t,e){var n=this.getCellData(t,e,this._dtSolution,this._stNone);return n=decodeURIComponent(n)},TStdTable.prototype.setCellSolution=function(t,e,n){this.setCellData(t,e,this._dtSolution,this._stNone,encodeURIComponent(n))},TStdTable.prototype.ReadOnly=function(t){return arguments.length&&(this.attr_ReadOnly=t),this.attr_ReadOnly},TStdTable.prototype.markEditable=function(t){return arguments.length&&(this.attr_markEditable=t),this.attr_markEditable},TStdTable.prototype.tableHeader=function(t){return arguments.length&&(this.attr_tableHeader=t),this.attr_tableHeader},TStdTable.prototype.staticTextMode=function(t){return arguments.length&&(this.attr_staticTextMode=t),this.attr_staticTextMode},TStdTable.prototype.Color=function(t){return arguments.length&&(this.attr_Color=t,0==AnyToBool(this.attr_Transparent)?this.obj.style.backgroundColor=convertColor(t):this.obj.style.backgroundColor="transparent"),this.attr_Color},TStdTable.prototype.maxRows=function(t){return arguments.length&&(this.attr_maxRow=t),this.attr_maxRow},TStdTable.prototype.maxCols=function(t){return arguments.length&&(this.attr_maxCol=t),this.attr_maxCol},TStdTable.prototype.rowCount=function(t){return arguments.length&&(this.attr_rowCount=t,1==AnyToBool(this.attr_autoDelete)&&this.shrinkData()),this.attr_rowCount},TStdTable.prototype.colCount=function(t){return arguments.length&&(this.attr_colCount=t,1==AnyToBool(this.attr_autoDelete)&&this.shrinkData()),this.attr_colCount},TStdTable.prototype.autoDelete=function(t){return arguments.length&&(this.attr_autoDelete=t),this.attr_autoDelete},TStdTable.prototype.autoDisable=function(t){return arguments.length&&(this.attr_autoDisable=t),this.attr_autoDisable},TStdTable.prototype.tableText=function(t){return arguments.length&&(this.attr_tableText=t),this.attr_tableText},TStdTable.prototype.tableData=function(t){return arguments.length&&(this.attr_tableData=t),this.attr_tableData},TStdTable.prototype.Borderstyle=function(t){if(!arguments.length)return this.attr_Borderstyle;this.attr_Borderstyle=AnyToInt(t),1==AnyToInt(t)&&(this.obj.style.borderStyle="solid",this.obj.style.borderWidth=AnyToStr(AnyToInt(this.attr_Borderwidth))+"px",this.obj.style.borderColor=convertColor(this.attr_BorderColor))},TStdTable.prototype.Borderwidth=function(t){if(!arguments.length)return this.attr_Borderwidth;this.attr_Borderwidth=AnyToInt(t),this.obj.style.borderWidth=AnyToStr(AnyToInt(this.attr_Borderwidth))+"px"},TStdTable.prototype.BorderColor=function(t){if(!arguments.length)return this.attr_BorderColor;this.attr_BorderColor=AnyToInt(t),this.obj.style.borderColor=convertColor(t)},TStdTable.prototype.Grid=function(t){if(!arguments.length)return this.attr_Grid;this.attr_Grid=AnyToInt(t)},TStdTable.prototype.Transparent=function(t){if(!arguments.length)return this.attr_Transparent;this.attr_Transparent=AnyToInt(t),0==AnyToBool(t)?this.obj.style.backgroundColor=convertColor(this.attr_Color):this.obj.style.backgroundColor="transparent"},TStdTable.prototype.stopEditMode=function(){simulate(document.getElementById(this.obj.id),"click")},TStdsortableList.prototype=new TStdVisibleComponent,TStdsortableList.prototype.constructor=TStdsortableList,TStdsortableList.prototype.attr_Elements="",TStdsortableList.prototype.attr_Randomize="",TStdsortableList.prototype.attr_Axis=0,TStdsortableList.prototype.attr_Result="",TStdsortableList.prototype.Elements=function(t){return arguments.length&&(this.attr_Elements=t),this.attr_Elements},TStdsortableList.prototype.Axis=function(t){return arguments.length&&(this.attr_Axis=t),this.attr_Axis},TStdsortableList.prototype.Randomize=function(t){return arguments.length&&(this.attr_Randomize=AnyToBool(t)),AnyToBool(this.attr_Randomize)},TStdsortableList.prototype.Result=function(){return 0==pages[this.pageName].PageMode()&&(this.attr_Result=jQuery("#selectable-"+this.Name()).sortable("toArray").toString()),this.attr_Result},TStdsortableList.prototype.onpgshown=function(){if(0==pages[this.pageName].PageMode()){var t="";if(1==this.attr_Axis)t='{axis: "x"}';if(2==this.attr_Axis)t='{axis: "y"}';var e='jQuery( "#selectable-'+this.Name()+'" ).sortable('+t+');jQuery( "#selectable-'+this.Name()+'" ).disableSelection();var x=jQuery("#selectable-'+this.Name()+' br").length;for(var i=0;i<x;i++) jQuery("#selectable-'+this.Name()+' br")[0].remove();jQuery("#selectable-'+this.Name()+'").css("display","block");pages["'+this.pageName+'"]["'+this.Name()+'"].Visible(1);';window.setTimeout(e,10)}TStdVisibleComponent.prototype.onpgshown.call(this)},TStdsortableList.prototype.enableDD=function(){if(0==pages[this.pageName].PageMode()){var t="";if(1==this.attr_Axis)t='{axis: "x"}';if(2==this.attr_Axis)t='{axis: "y"}';var e='jQuery( "#selectable-'+this.Name()+'" ).sortable('+t+');jQuery( "#selectable-'+this.Name()+'" ).disableSelection();var x=jQuery("#selectable-'+this.Name()+' br").length;for(var i=0;i<x;i++) jQuery("#selectable-'+this.Name()+' br")[0].remove();jQuery("#selectable-'+this.Name()+'").css("display","block");pages["'+this.pageName+'"]["'+this.Name()+'"].Visible(1);';window.setTimeout(e,10)}},TStdsortableList.prototype.arrange=function(t){var e="sel-edit-";0==pages[this.pageName].PageMode()&&(e="selectable-");var n,i="<ul id='"+e+this.Name()+"'>",r=this.Elements().split(",");n=-1!=t.indexOf("‚")?t.split("‚"):t.split(",");var o=0;for(o=0;o<n.length;o++)i+="<li id='"+n[o]+"' class='ui-widget-content'>"+r[n[o]]+"</li>";i+="</ul>",this.obj.innerHTML=i},TStdsortableList.prototype.repaint=function(){var t="sel-edit-";0==pages[this.pageName].PageMode()&&(t="selectable-");for(var e,n,i="<ul id='"+t+this.Name()+"'>",r=this.Elements().split(","),o=this.Elements().split(","),a=0;r.length>0;)this.Randomize()&&0==pages[this.pageName].PageMode()?(e=r[a=Math.floor(Math.random()*r.length)],r.splice(a,1),n=o.indexOf(e)):(n=a,e=r[0],r.splice(0,1),a++),i+="<li id='"+n+"' class='ui-widget-content'>"+e+"</li>";i+="</ul>",this.obj.innerHTML=i},TStdsortableList.prototype.onpgready=function(){this.repaint(),0==pages[this.pageName].PageMode()&&this.Visible(0),TStdVisibleComponent.prototype.onpgready.call(this)},TStdGroup.prototype=new TStdVisibleComponent,TStdGroup.prototype.constructor=TStdGroup;var gvCFW=null;function resizeOnNewSM(t,e,n){var i,r,o=0,a="";if(null==(r=AnyToObject(t,n))||!r.StretchMode)return!1;if(i=r.StretchMode(),"tstdimage"==(a=(a=r.Subclass()).toLowerCase())){if(i==smOrgImageSize)return r.Borderstyle&&AnyToInt(r.Borderstyle())==bsSingle&&(o=AnyToInt(r.Borderwidth())),r.Width(AnyToInt(r.orgWidth())+2*o),r.Height(AnyToInt(r.orgHeight())+2*o),!0;if(i==smProportional)return e==rmHorizontal?r.Width(AnyToInt(r.orgWidth())*AnyToInt(r.OffsetHeight())/AnyToInt(r.orgHeight())):r.Height(AnyToInt(r.orgHeight())*AnyToInt(r.OffsetWidth())/AnyToInt(r.orgWidth())),!0}if("tstdpicture"==a){if(i==smOrgImageSize){if(AnyToInt(r.Borderstyle())==bsSingle&&(o=AnyToInt(r.Borderwidth())),1==r.attr_ShowSubtitle){r.Width(AnyToInt(r.orgWidth())+2*o);var s=r.obj.lastChild.offsetHeight;r.obj.firstChild.height=r.orgHeight(),r.obj.lastChild.top=r.obj.firstChild.offsetHeight+1,r.Height(r.obj.firstChild.offsetTop+r.obj.firstChild.offsetHeight+s+1+2*o)}else r.Width(AnyToInt(r.orgWidth())+2*o),r.Height(AnyToInt(r.orgHeight())+2*o);return!0}if(i==smProportional){var l=0,d=r.OffsetHeight();return 1==r.attr_ShowSubtitle&&(l=r.obj.lastChild.offsetHeight,d=r.obj.firstChild.offsetHeight),e==rmHorizontal?r.Width(AnyToInt(r.orgWidth())*AnyToInt(d)/AnyToInt(r.orgHeight())):1==r.attr_ShowSubtitle?(r.obj.firstChild.height=AnyToInt(r.orgHeight())*AnyToInt(r.OffsetWidth())/AnyToInt(r.orgWidth()),r.obj.lastChild.top=r.obj.firstChild.offsetHeight+1,r.Height(r.obj.firstChild.offsetTop+r.obj.firstChild.offsetHeight+l+1)):r.Height(AnyToInt(r.orgHeight())*AnyToInt(r.OffsetWidth())/AnyToInt(r.orgWidth())),!0}}if("tstdflashvideoplayer"==a||"tstdhtml5videoplayer"==a||"tstdcustomvideoplayer"==a||"tstdflashplayer"==a){var h=0,u=0;if(e==rmHorizontal){if(u=AnyToInt(r.Height()),"tstdflashvideoplayer"==a&&1==AnyToBool(r.ShowControls())&&(u-=35),i==smp4To3&&(h=parseInt(4*u/3)),i==smp16To9&&(h=parseInt(16*u/9)),h>0)return r.Width(h),!0}else if(u=AnyToInt(r.Width()),i==smp4To3&&(h=parseInt(.75*u)),i==smp16To9&&(h=parseInt(.5625*u)),h>0)return"tstdflashvideoplayer"==a&&1==AnyToBool(r.ShowControls())&&(h+=35),r.Height(h),!0}return!1}function isVarUndefined(t){return void 0===t||null==t||"undefined"===t}function readVariable(t,e){return GetProjectSettings(t,e)}function writeVariable(t,e,n){SetProjectSettings(t,e,n)}function NextPage(t){null!=window.IDEAMAPI&&null!=window.IDEAMAPI.NextPage?window.IDEAMAPI.NextPage():(t||(t=pages[getPageFromCallstack(NextPage.caller)]),NextPageEx(t))}function NextPageEx(t){t||(t=pages[getPageFromCallstack(NextPageEx.caller)]),dpat=new detectTouchAndMobile,dpat.init_userAgent();var e="",n=0;1!=dpat.detectPhone()&&1!=dpat.detectTablet()?(n=desktopPageName[t.Name()],++n<=desktopPageName.result&&(e=desktopPageIndex[n])):1==dpat.detectPhone()?(n=phonePageName[t.Name()],++n<=phonePageName.result&&(e=phonePageIndex[n])):1==dpat.detectTablet()&&(n=tabletPageName[t.Name()],++n<=tabletPageName.result&&(e=tabletPageIndex[n])),""!=e&&JumpEx(e,t)}function findNextPage(t){if(null==t)return null;if(null==t.nextSibling)for(;null!=t.parentNode&&null==t.nextSibling;)t=t.parentNode;if(null==t.nextSibling)return null;if("TIdeaPage"==t.nextSibling.nodeName)return t.nextSibling;t=t.nextSibling;for(var e=!1;0==e;){for(;null!=t.firstChild&&"TIdeaPage"!=t.nodeName;)t=t.firstChild;if("TIdeaPage"==t.nodeName)e=!0;else if(null==t.firstChild){for(;null==t.nextSibling;)t=t.parentNode;t=t.nextSibling}}return t}function Jump(t,e){return null!=window.IDEAMAPI&&null!=window.IDEAMAPI.Jump?void window.IDEAMAPI.Jump(t,e):(e||""===e||(e=pages[getPageFromCallstack(Jump.caller)]),void JumpEx(t,e))}function JumpEx(t,e){if(AuthorMode!=amPreview)if(e||""===e||(e=pages[getPageFromCallstack(JumpEx.caller)]),hideToolTip(),AnyToBool(allowTransCoverPanel)&&createTransCoverPanel(),audio.currentObj=null,AudioStop(),t.lastIndexOf?t.lastIndexOf(".")>-1&&(t=t.substring(t.lastIndexOf(".")+1,t.length)):t=t.Name(),""!==e){var n=e.Name();window.setTimeout("innerPageRunTime('"+t+"','"+n+"', false, false)",10)}else window.setTimeout("innerPageRunTime('"+t+"','', false, false)",10)}function ClosePage(){var t,e=null;if(1!=isVarUndefined(t=arguments.length>0?AnyToObject(arguments[0]):pages[getPageFromCallstack(ClosePage.caller)])){if(hideToolTip(),audio.currentObj=null,AudioStop(),0==isVarUndefined(t.Parent())&&""!=t.Parent())if((e=t.Parent()).lastIndexOf(".")>-1){var n=e.substring(e.lastIndexOf(".")+1,e.length);e=e.substring(0,e.indexOf("."))+n}var i=t.obj,r=t.getParentasComp();r&&r.removeChild(t),closePage(t),isVarUndefined(gvCFW)?pageHistory.pop():0==gvCFW._PopUpMode()&&pageHistory.pop(),null!=t.callerPage()&&(removeCoverPanel(t.callerPage()+"TransCoverPanel"),isVarUndefined(gvCFW),null!=window.IDEAMAPI&&null!=window.IDEAMAPI.newPage&&MAPI.newPage(pages[t.callerPage()],!1,!1)),removeElement(i)}}function CloseProgram(t){var e;if(isVarUndefined(t)&&(t=!1),window.AICCMODEINIT)if(null==window.IDEAMAPI||null==window.IDEAMAPI.CloseProgram||0!=t){if(AuthorMode!=amPreview){if(hideToolTip(),IsInProtocolMode()&&IsProtocolBitSet(1)){var n=new Date;Protocol("Recordtyp=1,Datum="+generateIFormatDate(n)+",Zeit="+generateIFormatTime(n)+",Dauer="+Math.round((n.getTime()-StartDate.getTime())/1e3)+",,,,")}if(0==t){for(e in pages)pages[e].OnBeforeCloseProgram&&pages[e].OnBeforeCloseProgram();for(e in pages)pages[e].OnCloseProgram&&pages[e].OnCloseProgram()}if(null==CloseProgramCallbackPage){if(pageHistory.isClosed=!0,""!=ideaendmessage){var i=getDocumentHeight()-24;getDocumentWidth();document.getElementsByTagName("body")[0].innerHTML='<table width="100%" height="'+i+'" border="0" cellpadding="0" cellspacing="0"><tr><td align="center" valign="middle"><img src="'+url_libs+IDEAENDSCREENIMAGE+'"><br><br></img>'+ideaendmessage+"</font></td></tr></table>",window.close()}}else AnyToObject(CloseProgramCallbackPage)[CloseProgramCallbackFuncname]()}}else window.IDEAMAPI.CloseProgram()}function ExitProgram(){var t;for(t in hideToolTip(),pages)pages[t].OnBeforeCloseProgram&&pages[t].OnBeforeCloseProgram();for(t in pages)pages[t].OnCloseProgram&&pages[t].OnCloseProgram();for(t in pages)ClosePage(pages[t]);var e=GetVariableEx("Projectsettings","CSSFile","");""!=e&&removejscssfile(e=expandmetavarEx(e,"Variablen"),"css"),""!=(e=GetVariableEx("Projectsettings","TextCSSFile",""))&&removejscssfile(e=expandmetavarEx(e,"Variablen"),"css"),pages=[],callbackContainerPage=null,callbackContainerComp=null,Variablen=new Object,variablen=new Object,(allPageName={}).result=-1,(allPageIndex={}).result="",(desktopPageName={}).result=-1,(desktopPageIndex={}).result="",(tabletPageName={}).result=-1,(tabletPageIndex={}).result="",(phonePageName={}).result=-1,(phonePageIndex={}).result=""}function PrintWindow(){window.print()}function JumpPopUp(t){ClosePage(),CallPage(t)}var CallPageCaller=null;function CallPage(t,e,n,i,r){isVarUndefined(n)&&(n=!1),"true"!=arguments[2]&&1!=arguments[2]||(n=!0),isVarUndefined(i)&&(i=!1),hideToolTip();var o=pages[getPageFromCallstack(CallPage.caller)];if(o?CallPageCaller=o:o=CallPageCaller,null!=o)if(!o.CallPage||n){if(isVarUndefined(r)&&(r=o.Name()),createCoverPanel(r,o.Name()+"TransCoverPanel"),AnyToBool(allowTransCoverPanel)&&createTransCoverPanel(),1==i)return innerPageRunTime(t,o.Name(),!0,e);window.setTimeout("innerPageRunTime('"+t+"','"+o.Name()+"', true,"+e+")",10)}else o.CallPage(t)}function IsNextPage(t){if(AuthorMode==amPreview)return 0;if(t||(t=pages[getPageFromCallstack(IsNextPage.caller)]),t._OnBeforeIsNextPage&&t._OnBeforeIsNextPage(),t._IsNextPage){if("1"==t._IsNextPage())return!0;if("0"==t._IsNextPage())return!1}return GetAbsPageIndex(t.Name())<GetAbsPageCount()}function IsPreviousPage(t){if(AuthorMode==amPreview)return 0;if(t||(t=pages[getPageFromCallstack(IsPreviousPage.caller)]),t._OnBeforeIsPreviousPage&&t._OnBeforeIsPreviousPage(),t._IsPreviousPage){if("1"==t._IsPreviousPage())return!0;if("0"==t._IsPreviousPage())return!1}return pageHistory.length>1?1:0}function PreviousPage(t){null!=window.IDEAMAPI&&null!=window.IDEAMAPI.PreviousPage?window.IDEAMAPI.PreviousPage():(t||(t=pages[getPageFromCallstack(PreviousPage.caller)]),PreviousPageEx(t))}function PreviousPageEx(t){if(t||(t=pages[getPageFromCallstack(PreviousPageEx.caller)]),AuthorMode!=amPreview&&(audio.currentObj=null,!(pageHistory.length<2))){AudioStop(),hideToolTip(),AnyToBool(allowTransCoverPanel)&&createTransCoverPanel();var e=t.Name();pageHistory.pop();var n=pageHistory[pageHistory.length-1];window.setTimeout("innerPageRunTime('"+n+"','"+e+"', false, false)",10)}}function PageIndex(t){if(!t)t=pages[getPageFromCallstack(PageIndex.caller)];return scanPageLib(t,!0)}function PageCount(t,e){if(void 0===e&&(e="TIdeaPage"),!t)t=pages[getPageFromCallstack(PageCount.caller)];return scanPageLib(t,!1,e)}function GetPageByIndexFromPageLib(t){var e=findPageInPageLib("");if(null==e)return"";for(var n=e.parentNode,i=0,r=0;r<n.childNodes.length;r++){var o=n.childNodes[r];if(0==o.childNodes.length&&"1"!=o.getAttribute("IsCFWPage")){if(i==t)return o.getAttribute("Name");i++}}return""}function scanPageLib(t,e,n){void 0===n&&(n="TIdeaPage");var i=0;if("TIdeaPage"==n){var r=findPageInPageLib(t.Name(),n);if(null==r)return i;var o=r.parentNode}else{if(null==(o=findPageInPageLib(t,n)))return i;r=o}for(var a=null,s=0;s<o.childNodes.length&&(0==(a=o.childNodes[s]).childNodes.length&&"1"!=a.getAttribute("IsCFWPage")&&i++,!e||a!=r);s++);return i}function PageCountABS(t){if(!t)t=pages[getPageFromCallstack(PageCountABS.caller)];return scanPageLibABS(t,!1)}function GetPageByIndexFromPageLibABS(t){for(var e=PageLibrary.getElementsByTagName("TIdeaPage"),n=e.length,i=0,r=0;r<n;r++)if("1"!=e[r].getAttribute("IsCFWPage")){if(i==t)return e[r].getAttribute("Name");i++}return""}function getSharedPSFromPageLib(){var t="",e=(null!=PageLibrary.parentNode?PageLibrary.parentNode:PageLibrary).getElementsByTagName("TProject");return e.length>0&&(null!=(t=e[0].getAttribute("SharedPS"))&&"undefined"!=t||(t="")),t}function scanPageLibABS(t,e){for(var n=0,i=PageLibrary.getElementsByTagName("TIdeaPage"),r=t.Name(),o=i.length,a=0;a<o;a++)if("1"!=i[a].getAttribute("IsCFWPage")&&(n++,e&&i[a].getAttribute("Name").toLowerCase()==r.toLowerCase()))return a;return n}function MessageBox(t){alert(t)}function HideMobileDialog(){jQuery("#IdeaRTPopupMobile").hide(),jQuery("#IdeaRTPopupMobileOverlay").remove(),jQuery("#IdeaRTPopupMobile").hide()}function ShowMobileDialog(t,e,n){isVarUndefined(n)&&(n=""),t instanceof Object&&(0==jQuery("#IdeaRTPopupMobile").length&&(jQuery(".CFW_S_Idea").last().append(jQuery('<div id="IdeaRTPopupMobile"><div><span><span id="IdeaRTPopupMobile_Caption">'+e+'</span></span><span id="PopUpMobileClose">Close</span></div><div id="IdeaRTPopupMobileCont"></div></div>')),jQuery("#IdeaRTPopupMobile").hide(),jQuery("#PopUpMobileClose").on("click",function(t,e){var i=jQuery("#IdeaRTPopupMobileCont").children().eq(0),r=pages[i[0].pageName][i[0].obj],o=r.getParentasComp(),a=r._orderAtParentCache;a>0?jQuery(o.obj).children().eq(a-1).after(i):jQuery(o.obj).append(i),r.OnClosePopup&&r.OnClosePopup(n),jQuery("#IdeaRTPopupMobileOverlay").remove(),jQuery("#IdeaRTPopupMobile").hide(),jQuery(document).trigger("onMobileDialogClose",n)})),t._orderAtParentCache=jQuery(t.obj).parent().children().index(jQuery(t.obj)),void 0!=jQuery("#IdeaRTPopupMobile")[0]&&jQuery("#IdeaRTPopupMobile")[0].customParam==n&&HideMobileDialog(),jQuery(".CFW_S_Idea").last().append(jQuery('<div id="IdeaRTPopupMobileOverlay"></div>')),jQuery("#IdeaRTPopupMobile_Caption").html(e),jQuery("#IdeaRTPopupMobileOverlay")[0].style.bottom="",jQuery("#IdeaRTPopupMobileOverlay").on("click",function(t,e){jQuery("#PopUpMobileClose").click()}),jQuery("#IdeaRTPopupMobileCont").append(t.obj),jQuery("#IdeaRTPopupMobile")[0].customParam=n,jQuery("#IdeaRTPopupMobile").show(),_centerMobileDialog())}function _centerMobileDialog(){var t=jQuery("#IdeaRTPopupMobile").height()+jQuery("#IdeaRTPopupMobileCont").children().eq(0).height();t=(jQuery(".CFW_S_Idea").last().height()-t)/2-112;t=Math.max(56,t),jQuery("#IdeaRTPopupMobile").css("marginTop",t+"px")}function AnyToInt(t){return t?null==t?0:("string"==typeof t&&(t=t.toLowerCase()),"false"==t?0:"true"==t?1:1==t?1:0==t?0:""==t?0:parseInt(t,10)):0}function AnyToBool(t){return t=1==t||"1"==t||1==t||"true"==t}function AnyToStr(t){return""+t}function IntToString(t){return""+t}function DefineGlobalVar(t,e){t=AnyToStr(t),window[t]=e}function Add(t,e){if(!(arguments.length<1)){for(var n=0,i=0;i<arguments.length;i++)n+=parseInt(arguments[i]);return n}}function Sub(t,e){if(!(arguments.length<1)){for(var n=arguments[0],i=1;i<arguments.length;i++)n-=parseInt(arguments[i]);return n}}function Min(t,e){return arguments.length<1?0:Math.min(t,e)}function Max(t,e){return arguments.length<1?0:Math.max(t,e)}function Abs(t){return arguments.length<1?0:Math.abs(t)}function MULT(t,e){if(!(arguments.length<1)){for(var n=arguments[0],i=1;i<arguments.length;i++)n*=parseInt(arguments[i]);return n}}function DIV(t,e){if(!(arguments.length<2)){for(var n=arguments[0],i=1;i<arguments.length;i++)n/=parseInt(arguments[i]);return Math.floor(n)}}function Modulo(t,e){return t%e}function GE(t,e){return parseInt(t)>=parseInt(e)}function GT(t,e){return parseInt(t)>parseInt(e)}function LE(t,e){return parseInt(t)<=parseInt(e)}function LT(t,e){return parseInt(t)<parseInt(e)}function EQ(t,e){return"true"==e&&(e=AnyToBool(e)),t==e}function NE(t,e){return t!=e}function AND(t,e){return AnyToBool(t)&&AnyToBool(e)}function OR(t,e){return AnyToBool(t)||AnyToBool(e)}function NOT(t){return AnyToInt(!AnyToBool(t))}function AnyToObject(t,e){return"object"==typeof t?t:pages[t]?pages[t]:"Text"!=t&&window[t]?window[t]:null!=(e=1==arguments.length?pages[getPageFromCallstack(AnyToObject.caller)]:AnyToObject(e))&&e[t]?e[t]:null}function AsciiToChar(t){return String.fromCharCode(t)}function AddLineBreak(t){return t+"<br>"}function BinaryAND(t,e){return t&e}function BinaryOR(t,e){return t|e}function CompareStr(t,e){return t.compareTo(e)}function CharToAscii(t){return t.charCodeAt(0)}function CharToASCII(t){return t.charCodeAt(0)}function IDate(){var t=new Date,e=t.getMonth()+1;return t.getDate()+"."+e+"."+t.getFullYear()}function GetMetavarValue(t,e){return expandmetavar("$("+t+"$)",(e=1==arguments.length?pages[getPageFromCallstack(GetMetavarValue.caller)]:pages[e]).Name())}function GetProjectSettings(t,e,n){n||(n=Variablen.vartreenode);var i=findNode(t,n);if(null!==i)for(var r=i.attributes,o=r.length,a=0;a<o;a++)if(r[a].name.toLowerCase()==e.toLowerCase())return r[a].value;return""}function Random(t){return t=AnyToInt(t),Math.floor(Math.random()*t)}function Randomize(){}function SetProjectSettings(t,e,n,i){i||(i=Variablen.vartreenode);var r=findNode(t,i);if(null!==r){var o=r.attributes;null!=(o=o.getNamedItem(e))&&(o.value=n)}}function SetProjectVar(t,e,n){SetProjectSettings(n,t,e)}function SetMetavarValue(t,e){return SetProjectVar(t,e,MetavarNodeName)}function StrCopy(t,e,n){e--;var i=new String(t);if(e>i.length-1||e<0)return"";if(i.length-e<=n)var r=i.substring(e);else r=i.substring(e,e+n);return r}function StrDelete(t,e,n){var i;e--;var r=new String(t);return e>r.length-1||e<0?r:(i=e+n)>r.length-1?r.substring(0,e):r.substring(0,e)+r.substring(i)}function StrInsert(t,e,n){return--n>e.length-1||n<0?e:e.substring(0,n)+t+e.substring(n)}function StrLen(t){var e=new String(t),n=Number(e.length);return Number(n)}function StrLower(t){return t.toLowerCase()}function StrPos(t,e){if(null==e||void 0==e||null==t||0==t.length)return 0;var n=e.indexOf(t);return-1==n?0:++n}function StrPosIgnoreCase(t,e){if(arguments.length<2||isVarUndefined(t)||isVarUndefined(e))return 0;var n=t.length,i=e.length;if(0==t.length||0==e.length)return 0;for(var r=0;r+n<=i;r++)if(e.substring(r,r+n).equalsIgnoreCase(t))return r+1;return 0}function StrReplace(t,e,n){var i,r="";if(e==n)return t;if(0==StrPosIgnoreCase(e,t))return t;for(;-1!=(i=StrPosIgnoreCase(e,t)-1);)0!=i&&(r+=t.substring(0,i)),r+=n,t=t.substring(i+e.length);return r+t}function StrConcat(){for(var t=[],e=arguments.length,n=0;n<e;n++)t.push(arguments[n]);return t.join("")}function StrSetLength(t,e){var n=t.length;if(e<0)return"";for(var i=n;i<e;i++)t+=" ";return t.substring(0,e)}function StrToInt(t){return AnyToInt(t)}function StrUpper(t){return t.toUpperCase()}function Time(){var t=new Date,e=t.getHours(),n=t.getMinutes(),i=t.getSeconds();return n<10&&(n="0"+n),i<10&&(i="0"+i),e+":"+n+":"+i}function ChildCount(t){if(null==t)return 0;var e=AnyToObject(t);return null==e?0:void 0===e.childes?0:e.childes.length}function GetChildrenCount(t){return ChildCount(t)}function GetChild(t,e){if(e<(t=AnyToObject(t)).childes.length)return t.childes[e]}function GetAttr(t,e,n){return GetStrAttr(t,e,n)}function GetIntAttr(t,e,n){return AnyToInt(GetStrAttr(t,e,n))}function GetStrAttr(t,e,n){return t.indexOf(".")>-1&&(e=t.substring(t.indexOf(".")+1,t.length),t=t.substring(0,t.indexOf("."))),"string"==typeof e&&e.indexOf(".")>-1&&(t=e.substring(e.indexOf(".")+1,e.length),e=e.substring(0,e.indexOf("."))),null!=(e=AnyToObject(e,n||(n=pages[getPageFromCallstack(GetStrAttr.caller)])))?isdDefPropOnObject(t,e)?""+e[t]():"undefined":""}function GetParent(t){return AnyToObject((t=AnyToObject(t)).Parent())}function isChildOf(t,e){return e=AnyToObject(e),t=AnyToObject(t),AnyToObject(comp.Parent())==t}function FindObject(t,e){1==arguments.length&&(e=pages[getPageFromCallstack(FindObject.caller)]);var n=AnyToObject(t,e);return null==n||"@0"==n?"@0":n.Name()}function FindObjectUnder(t){var e="";arguments.length>1&&(e=arguments[1]);var n,i,r,o=AnyToObject(t),a=null,s=o.Parent();if(null!=o&&null!=s){i=o.Left()+o.Width()/2,r=o.Top()+o.Height()/2;for(var l=s.childes.length-1;l>=0;l--)if((n=s.childes[l])!=o&&null!=n&&(""==e||e==GetStrAttr("ExerciseGroup",n))&&!(i<n.Left()||i>=n.Left()+n.Width()||r<n.Top()||r>=n.Top()+n.Height())){a=n;break}null==a&&(n=s,a=s)}return a.Name()}function FindObjectsUnder(t){var e="";vertexlist="",arguments.length>1&&(e=arguments[1]);var n,i,r,o=AnyToObject(t),a=o.Parent();if(null!=o&&null!=a){i=o.Left()+o.Width()/2,r=o.Top()+o.Height()/2;for(var s=a.childes.length-1;s>=0;s--)(n=a.childes[s])!=o&&null!=n&&(""!=e&&e!=GetStrAttr("ExerciseGroup",n)||i<n.Left()||i>=n.Left()+n.Width()||r<n.Top()||r>=n.Top()+n.Height()||(vertexlist+=n.Name()+","));vertexlist+=a.Name()}return vertexlist}function SetAttr(t,e,n,i){SetStrAttr(t,e,n,i)}function SetBounds(t,e,n,i,r){null!=(t=AnyToObject(t))&&(t.Height(r),t.Width(i),t.Top(n),t.Left(e))}function SetColor(t,e){"string"==typeof t&&t.indexOf(".")>-1&&(attrName=t.substring(t.indexOf(".")+1,t.length),t=t.substring(0,t.indexOf("."))),null!=(t=AnyToObject(t))&&t.Color(e)}function SetStrAttr(t,e,n,i){t.indexOf(".")>-1&&(n=t.substring(t.indexOf(".")+1,t.length),t=t.substring(0,t.indexOf("."))),"string"==typeof n&&n.indexOf(".")>-1&&(t=n.substring(n.indexOf(".")+1,n.length),n=n.substring(0,n.indexOf("."))),null!=(n=AnyToObject(n,i||(i=pages[getPageFromCallstack(SetStrAttr.caller)])))&&n[t]&&n[t](e)}function SetPosition(t,e,n,i){null!=(t=i?AnyToObject(t,i):AnyToObject(t))&&(t.Top(n),t.Left(e))}function SetIntAttr(t,e,n,i){SetStrAttr(t,e,n,i)}function SetSize(t,e,n){null!=(t=AnyToObject(t))&&(t.Height(n),t.Width(e))}function Show(t,e,n,i){i||(i=1e3);var r=AnyToInt(i);if(null!=(t=AnyToObject(t))){var o=jQuery(t.obj).css("width"),a=jQuery(t.obj).css("height"),s=function(){null!=t&&null!=t.obj&&(t.obj.style.display="",jQuery(t.obj).css("width",o),jQuery(t.obj).css("height",a),t.doOnEndEffect(1))},l=function(){null!=t&&null!=t.obj&&(t.Visible(0),t.obj.style.display="",jQuery(t.obj).css("width",o),jQuery(t.obj).css("height",a),t.doOnEndEffect(0))};if(1==e&&0==t.Visible())switch(jQuery(t.obj).stop(!1,!0),isVarUndefined(n)&&(n=t.JSAppearEffect()),AnyToInt(n=Min(25,n=Max(0,n=AnyToInt(n))))){case 0:t.Visible(1);break;case 1:showOpacityEffect(t,r);break;case 2:flyFromTopEffect(t,r);break;case 3:flyFromLeftEffect(t,r);break;case 4:flyFromBottomEffect(t,r);break;case 5:flyFromRigthEffect(t,r);break;case 6:flyFromTopLeftEffect(t,r);break;case 7:flyFromTopRightEffect(t,r);break;case 8:flyFromBottomRightEffect(t,r);break;case 9:flyFromBottomLeftEffect(t,r);break;case 10:flyFromTopOpacityEffect(t,r);break;case 11:flyFromLeftOpacityEffect(t,r);break;case 12:flyFromBottomOpacityEffect(t,r);break;case 13:flyFromRigthOpacityEffect(t,r);break;case 14:flyFromTopLeftOpacityEffect(t,r);break;case 15:flyFromTopRightOpacityEffect(t,r);break;case 16:flyFromBottomRightOpacityEffect(t,r);break;case 17:flyFromBottomLeftOpacityEffect(t,r);break;case 18:t.Visible(1),jQuery(t.obj).hide(),jQuery(t.obj).show("puff",{},r,s);break;case 19:t.Visible(1),jQuery(t.obj).hide(),jQuery(t.obj).show("fold",{},r,s);break;case 20:t.Visible(1),jQuery(t.obj).hide(),jQuery(t.obj).show("scale",{},r,s);break;case 21:t.Visible(1),jQuery(t.obj).hide(),jQuery(t.obj).show("slide",{direction:"right"},r,s);break;case 22:t.Visible(1),jQuery(t.obj).hide(),jQuery(t.obj).show("slide",{direction:"left"},r,s);break;case 23:t.Visible(1),jQuery(t.obj).hide(),jQuery(t.obj).show("slide",{direction:"up"},r,s);break;case 24:t.Visible(1),jQuery(t.obj).hide(),jQuery(t.obj).show("slide",{direction:"down"},r,s);break;case 25:t.Visible(1),jQuery(t.obj).hide(),jQuery(t.obj).show("explode",{},r,s)}else if(0==e&&1==t.Visible())switch(jQuery(t.obj).stop(!1,!0),isVarUndefined(n)&&(n=t.JSDisAppearEffect()),AnyToInt(n=Min(25,n=Max(0,n=AnyToInt(n))))){case 0:t.Visible(0);break;case 1:hideOpacityEffect(t,r);break;case 2:flyToTopEffect(t,r);break;case 3:flyToLeftEffect(t,r);break;case 4:flyToBottomEffect(t,r);break;case 5:flyToRigthEffect(t,r);break;case 6:flyToTopLeftEffect(t,r);break;case 7:flyToTopRightEffect(t,r);break;case 8:flyToBottomRightEffect(t,r);break;case 9:flyToBottomLeftEffect(t,r);break;case 10:flyToTopOpacityEffect(t,r);break;case 11:flyToLeftOpacityEffect(t,r);break;case 12:flyToBottomOpacityEffect(t,r);break;case 13:flyToRigthOpacityEffect(t,r);break;case 14:flyToTopLeftOpacityEffect(t,r);break;case 15:flyToTopRightOpacityEffect(t,r);break;case 16:flyToBottomRightOpacityEffect(t,r);break;case 17:flyToBottomLeftOpacityEffect(t,r);break;case 18:jQuery(t.obj).hide("puff",{},r,l);break;case 19:jQuery(t.obj).hide("fold",{},r,l);break;case 20:jQuery(t.obj).hide("scale",{},r,l);break;case 21:jQuery(t.obj).hide("slide",{direction:"right"},r,l);break;case 22:jQuery(t.obj).hide("slide",{direction:"left"},r,l);break;case 23:jQuery(t.obj).hide("slide",{direction:"up"},r,l);break;case 24:jQuery(t.obj).hide("slide",{direction:"down"},r,l);break;case 25:jQuery(t.obj).hide("explode",{},r,l)}}}function GetListItem(t,e){if(null!=(t=AnyToObject(t)))return t.GetListItem(e)}function DeleteListItem(t,e){null!=(t=AnyToObject(t))&&t.DeleteListItem(e)}function AddListItem(t,e){return null!=(t=AnyToObject(t))?t.AddListItem(e):-1}function InsertListItem(t,e,n){null!=(t=AnyToObject(t))&&t.InsertListItem(e,n)}function SetListText(t,e){null!=(t=AnyToObject(t))&&t.SetListText(e)}function GetListText(t){if(null!=(t=AnyToObject(t)))return t.GetListText()}function GetListCount(t){if(null!=(t=AnyToObject(t)))return t.GetListCount()}function GetListItemIndex(t,e){if(null!=(t=AnyToObject(t)))return t.GetListItemIndex(e)}var audios=new Object;function GetVolume(){return audio.volume}function SetVolume(t,e){e=AnyToInt(e);var n=pages[getPageFromCallstack(SetVolume.caller)];void 0!==n&&n.HTML5Audio&&n.audioobj?n.audioobj.volume=1/e:(audio.volume=e,""!=audio.currentSound&&soundManager.setVolume("ap"+audio.currentSound,e))}function AudioPause(){""!=audio.currentSound&&soundManager.togglePause(audio.currentSound)}function AudioPlay(t,e,n,i,r){if(""!=e&&null!=e&&"null"!=e)if(r||(r=pages[getPageFromCallstack(AudioPlay.caller)]),e=expandmetavar(e,r.Name()),r.HTML5Audio)r.audioobj?(r.audioobj.pause(),r.audioobj.currentTime=0):(r.audioobj=document.createElement("audio"),r.audioobj.setAttribute("id",r.Name()+"audio-1"),r.audioobj.setAttribute("controls","")),r.audioobj.setAttribute("src",e),r.audioobj.load(),r.audioobj.play();else{if(audio.error)return AudioStop(),void createAudioPlayerMovie(e,r);AudioStop(),audio.currentSound=e,audio.currentObj=t,audio.loop=2==AnyToInt(n),audio.cwp=1==AnyToInt(i);var o=soundManager.createSound({id:"ap"+e,url:e,volume:audio.volume,autoPlay:!0,onfinish:audio.onFinish});audio.sm=o}}function AudioStop(){audio.error&&null!=$("AudioPlayerMovieContainer").firstChild?removeElement($("AudioPlayerMovieContainer").firstChild):""!=audio.currentSound&&(audio.loop=!1,audio.onFinish(),audio.currentSound="")}function VideoPlay(t,e,n){null!=(t=AnyToObject(t))&&t.Subclass().toLowerCase()==cTStdHTML5VideoPlayer.toLowerCase()&&(arguments.length>1&&""!=e&&t.FilenameMP4(e),arguments.length>2&&t.ShowControls(AnyToBool(n)),t.Play())}function VideoStop(t){null!=(t=AnyToObject(t))&&t.Subclass().toLowerCase()==cTStdHTML5VideoPlayer.toLowerCase()&&t.Stop()}function VideoPause(t){null!=(t=AnyToObject(t))&&t.Subclass().toLowerCase()==cTStdHTML5VideoPlayer.toLowerCase()&&t.Pause()}function VideoPlayPause(t){null!=(t=AnyToObject(t))&&t.Subclass().toLowerCase()==cTStdHTML5VideoPlayer.toLowerCase()&&t.FVPPlayPause()}function TimerStart(t){null!=(t=AnyToObject(t,pages[getPageFromCallstack(TimerStart.caller)]))&&t.startTimer()}function TimerStop(t){null!=(t=AnyToObject(t,pages[getPageFromCallstack(TimerStop.caller)]))&&t.stopTimer()}function ShellExecute(t,e){t+="";var n=pages[getPageFromCallstack(ShellExecute.caller)];t.startsWith("www.")&&(t="http://"+t),1==e?window.open(expandmetavar(t,n.Name()),"_blank"):window.location=expandmetavar(t,n.Name())}function ShellExecuteInternal(t){t+="";var e=pages[getPageFromCallstack(ShellExecuteInternal.caller)];t.startsWith("www.")||t.startsWith("http://")||window.open(expandmetavar(t,e.Name()))}function NavigateTo(t){t+="";var e=pages[getPageFromCallstack(NavigateTo.caller)];t.startsWith("www.")&&(t="http://"+t),window.location.replace=expandmetavar(t,e.Name())}function Reload(){location.reload()}function ReadTextFile(t,e,n){if(n||(n=pages[getPageFromCallstack(ReadTextFile.caller)]),""==t)return"";var i="";try{var r=getHttpObject();r.abort();t=expandmetavar(t,n.Name());var o=window.location.href.substring(0,window.location.href.indexOf(".html")+1);o=o.substring(0,o.lastIndexOf("/")+1),t=unescape(o+t),r.open("GET",t,!1),r.send(null),e?i=r.responseText:((i=document.createElement("span")).innerHTML=r.responseText,i=i.innerHTML),404==r.status&&(i="")}catch(t){return i}return 2==i.length&&65533==i.charCodeAt(0)&&(i=""),replace(i,"\r","")}function ReadClientPage(t,e,n){if(n||(n=pages[getPageFromCallstack(ReadTextFile.caller)]),""==t)return"";var i="";try{var r=getHttpObject();r.abort();var o=window.location.href.substring(0,window.location.href.indexOf(".html")+1);if(o=o.substring(0,o.lastIndexOf("/")+1),t=unescape(t),r.open("GET",t,!1),r.send(null),e){var a=(i=r.responseText).indexOf("<?xml");a>-1&&(i=i.substring(a,i.length))}else(i=document.createElement("span")).innerHTML=r.responseText,i=i.innerHTML;404==r.status&&(i="")}catch(t){return i}return 2==i.length&&65533==i.charCodeAt(0)&&(i=""),replace(i,"\r","")}function ReadTextFileAsync(t,e,n,i){if(i||(i=pages[getPageFromCallstack(ReadTextFileAsync.caller)]),""==t)return"";try{var r=getHttpObject();r.onreadystatechange=function(){try{if(4==r.readyState&&200==r.status){var t=e.split(".");2==t.length?pages[t[0]][t[1]](r.responseText,n):pages[t[0]][t[1]][t[2]](r.responseText,n)}}catch(t){dbg_alert(t.message)}},r.open("GET",t,!0),r.send(null)}catch(t){}}function getXAPIMode(){return Variablen.System.XAPIMode()}function setXAPIMode(t){Variablen.System.XAPIMode(t)}function getAICCMode(){return Variablen.System.AICCMode()}function setAICCMode(t){Variablen.System.AICCMode(t)}function preprocessCMIVarName(t){var e=t.toLowerCase(),n=e.split(".");return n.length>=2&&n[0].equalsIgnoreCase("core")&&(e="cmi."+e),e}function finishCommunication(){return 0!=getAICCMode()&&setAICCMode(LMSFinish("")),getAICCMode()}function LMSFinish(t){var e=0;return 0!=getAICCMode()&&"true"==doLMSCommit(t)&&"true"==doLMSFinish(t)&&(e=1),e}function GetCMIValue(t,e){return 0!=getAICCMode()?doLMSGetValue(preprocessCMIVarName(t+"."+e)):""}function SetCMIValue(t,e,n){return 0!=getAICCMode()&&doLMSSetValue(preprocessCMIVarName(t+"."+e),n).equalsIgnoreCase("true")?1:0}function exitAU(t,e){0==arguments.length&&(t=0);var n="";switch(Number(t)){case-1:case 0:n="passed";break;case 1:n="completed";break;case 2:n="failed";break;case 3:n="incomplete";break;case 4:n="browsed";break;case 5:n="not attempted";break;default:n="passed"}return 0!=getAICCMode()?result="true"==doLMSSetValue("cmi.core.lesson_status",n)?1:0:result=0,finishCommunication(),e||CloseProgram(),isExitAU=1,result}function CallUserProc(t,e,n,i){return AnyToObject(e)[t](n,i)}function ListComponentsByAttrVal(t,e,n){for(var i=AnyToObject(t).childes,r=i.length,o="",a="",s=0;s<r;s++)i[s][e]&&i[s][e]()==n&&(""!=o&&(o+=","),o+=i[s].Name()),i[s].childes.length>0&&""!=(a=ListComponentsByAttrVal(i[s],e,n))&&(""!=o&&(o+=","),o+=a);return o}function SetAttrForList(t,e,n,i){for(var r=(i=i.split(",")).length,o=null,a=0;a<r;a++)(o=AnyToObject(i[a])).Parent()==t&&SetAttr(e,n,o)}function BringToFront(t,e){pages[getPageFromCallstack(BringToFront.caller)],(t=AnyToObject(t)).obj;if(0!=e){var n=t.obj;t.orgvaluz=n.style.zIndex,maxZ++,n.style.zIndex=maxZ}else{""==t.orgvaluz&&(t.orgvaluz="auto"),(n=t.obj).style.zIndex=t.orgvaluz}}function getAbsoluteDivs(){for(var t=[],e=document.body.getElementsByTagName("DIV"),n=0,i=0;i<e.length;i++)"absolute"==e.item(i).style.position&&(t[n]=e.item(i),n++);return t}function moveToFront(t,e){e=pages[e];var n=$(t),i=$(e.Name());i!=n?(i.removeChild(n),i.appendChild(n)):(document.getElementsByTagName("body")[0].removeChild(n),document.getElementsByTagName("body")[0].appendChild(n))}function moveToBack(t,e){e=pages[e];var n=$(t),i=$(e.Name());i==n&&(i=document.getElementsByTagName("body")[0]),i.removeChild(n),null!=i.firstChild?i.insertBefore(n,i.firstChild):i.appendChild(n)}function getAbsoluteDivs(){var t=[],e=document.body.getElementsByTagName("DIV"),n=0;for(i=0;i<e.length;i++)"absolute"==e.item(i).style.position&&(t[n]=e.item(i),n++);return t}function bringToFront(t){if(document.getElementById&&document.getElementsByTagName){var e,n=document.getElementById(t),r=getAbsoluteDivs(),o=0;for(i=0;i<r.length;i++){var a=r[i];a!=n&&""!=a.style.zIndex&&(o<(e=parseInt(a.style.zIndex))&&(o=e))}n.style.zIndex=o+1}}function sendToBack(t){if(document.getElementById&&document.getElementsByTagName){var e,n=document.getElementById(t),r=getAbsoluteDivs(),o=999999;if(!(r.length<2)){for(i=0;i<r.length;i++){if((s=r[i])!=n){if(""==s.style.zIndex){o=0;break}o>(e=parseInt(s.style.zIndex))&&(o=e)}}if(!(o>parseInt(n.style.zIndex)||(n.style.zIndex=1,o>1))){var a=0==o?2:1;for(i=0;i<r.length;i++){var s;(s=r[i])!=n&&(s.style.zIndex+=a)}}}}}function Delay(t){}function ReadFromIniFile(t,e,n,i){if(t=expandmetavar(t,(page=pages[getPageFromCallstack(ReadFromIniFile.caller)]).Name()),e=e.toLowerCase(),n=n.toLowerCase(),!INIStorage[t]){var r=ReadTextFile(t,!0);INIStorage[t]=new Object,readInIniFile(r,INIStorage[t])}return INIStorage[t][e]&&INIStorage[t][e][n]?INIStorage[t][e][n]:i}function readInIniFile(t,e){for(var n,i,r,o=null,a=t.split("\n"),s=0;s<a.length;s++)if(""!=(n=a[s])&&!n.startsWith("//"))if(n.startsWith("[")){if(!n.endsWith("]"))continue;o=n.substring(1,n.length-1).toLowerCase()}else{if(null==o)continue;var l;if((l=n.indexOf("="))<0)continue;i=n.substring(0,l).toLowerCase(),r=n.substring(l+1),e[o]||(e[o]=new Object),e[o][i]=r}}function DeleteProtocol(){IdeaProtocoll.setProtocol("")}function FileExists(){return!0}function ChangeAttrOnTimeObj(t,e,n,i,r,o){var a=AnyToObject(o);this.target=t.Name(),this.attrName=e,this.endValue=n,this.valueStep=r,this.id=a.chgAttrOnTime.length;var s=this.id;this.pageName=o,a.chgAttrOnTime[this.id]=this,this.startValue=t[e](),this.startTime=currentTime(),this.endTime=this.startTime+i,this.intver=window.setInterval("doNextTick('"+o+"',"+s+")",this.TICKDURATION)}function doNextTick(t,e){pages[t]&&pages[t].chgAttrOnTime[e]&&pages[t].chgAttrOnTime[e].nextChange()}function Fly(t,e,n,i,r){null!=(t=r?AnyToObject(t,r):AnyToObject(t))&&(jQuery?jQuery(t.obj).animate({left:AnyToInt(e)+"px",top:AnyToInt(n)+"px"},AnyToInt(i),function(){t.obj&&(t.Top(AnyToInt(n)),t.Left(AnyToInt(e)))}):(new ChangeAttrOnTimeObj(t,"Left",AnyToInt(e),AnyToInt(i),1,t.thePageName),new ChangeAttrOnTimeObj(t,"Top",AnyToInt(n),AnyToInt(i),1,t.thePageName)))}function currentTime(){return(new Date).getTime()}function CallOnLinkClick(t,e){(t=AnyToObject(t)).OnLinkClick(1,e)}function AskProtocol(t,e,n,i){return IdeaProtocoll.sqlQuery(t+" WHERE "+e)}function IsInProtocolMode(){return null!=GlobalProtocolSetting1?GlobalProtocolSetting1:(null==(t=GetProjectSettings("Voreinstellung Protokollassistenten","ProtocolSetting1"))&&(t=GetProjectSettings("Voreinstellung Protokollassistenten"," ProtocolSetting1")),GlobalProtocolSetting1="0"!=t);var t}function IsProtocolBitSet(t){var e,n;null==GlobalProtocolSetting2&&(null==(n=GetProjectSettings("Voreinstellung Protokollassistenten","ProtocolSetting2"))&&(n=GetProjectSettings("Voreinstellung Protokollassistenten"," ProtocolSetting2")),GlobalProtocolSetting2=n);return(AnyToInt(GlobalProtocolSetting2)&(e=Math.pow(2,t)))==e}function Protocol(t,e){1==arguments.length&&(e=pages[getPageFromCallstack(Protocol.caller)]);var n=t.split(",");if("5"==(n=n[0].split("="))[1]||"4"==n[1]||"6"==n[1]){var i=new Date;t=replace(t=replace(t=replace(t=replace(t,"%DATE",generateIFormatDate(i)),"%TIME",generateIFormatTime(i)),"%DURATION",AnyToStr(Math.round((i.getTime()-e.StartDate.getTime())/1e3))),"%PAGENAME",e.Name())}t=replace(t=replace(t=replace(t=replace(t=replace(t=replace(t=replace(t=replace(t=replace(t,"RecordTyp=",""),"Recordtyp=",""),"Datum=",""),"Zeit=",""),"Dauer=",""),"Seitenname=",""),"Fehlerwert=",""),"Versuche=",""),"Punkte=",""),IdeaProtocoll.addToProtocol(t)}function SetProtocolData(t){IdeaProtocoll.setProtocol(t)}function GetProtocolData(t){return IdeaProtocoll.getProtocol()}function ProtocolCountExercises(t){var e,n=null;switch(t=AnyToInt(t)){case 0:e="SELECT COUNT (*)",n='Recordtyp="4"';break;case 1:e="SELECT COUNT (*)",n='Recordtyp="4" AND Fehlerwert="0"';break;case 2:e="SELECT COUNT (*)",n='Recordtyp="4" AND Fehlerwert<>"0"'}return IdeaProtocoll.sqlQuery(e+" WHERE "+n)}function ProtocolPageInfo(t,e){var n,i=null;switch(t=AnyToInt(t)){case 0:n="SELECT SUM(Versuche)",i='Recordtyp="4" AND Upper(Seitenname)=Upper('+e+")";break;case 1:n="SELECT Punkte",i='Recordtyp="4" AND Upper(Seitenname)=Upper('+e+")";break;case 2:n="SELECT Fehlerwert",i='Recordtyp="4" AND Upper(Seitenname)=Upper('+e+")";break;case 3:n="SELECT Dauer",i='Recordtyp="4" AND Upper(Seitenname)=Upper('+e+")";break;case 4:n="SELECT COUNT (*)",i="Upper(Seitenname)=Upper("+e+')AND Recordtyp="3"'}return IdeaProtocoll.sqlQuery(n+" WHERE "+i)}function ProtocolPageList(t){var e,n=null;switch(t=AnyToInt(t)){case 0:e="SELECT Seitenname",n='Recordtyp="3"';break;case 1:e="SELECT Seitenname",n='Recordtyp="4"';break;case 2:e="SELECT Seitenname",n='Recordtyp="4" AND Fehlerwert="0"';break;case 3:e="SELECT Seitenname",n='Recordtyp="4" AND Fehlerwert<>"0"'}return IdeaProtocoll.sqlQuery(e+" WHERE "+n)}function ProtocolCourseInfo(t){var e,n=null;switch(t=AnyToInt(t)){case 0:e="SELECT SUM (Dauer)",n='Recordtyp="1"';break;case 1:e="SELECT COUNT (*)",n='Recordtyp="3"';break;case 2:e="SELECT AVG (Dauer)",n='Recordtyp="4"';break;case 3:e="SELECT SUM(Punkte)",n='Recordtyp="4"'}return IdeaProtocoll.sqlQuery(e+" WHERE "+n)}function set_cookie(t,e,n){if(!is_cookie_enabled())return!1;var i=new Date,r=new Date(i.getTime()+864e5*n);return document.cookie=t+"="+e+";expires="+r.toGMTString()+";",!0}function get_cookie(t){var e=!1;return(strCookie=document.cookie)&&(arrCookie=strCookie.match(new RegExp(t+"=([^;]*)","g")))&&(e=RegExp.$1),e}function delete_cookie(t){return!!document.cookie&&(document.cookie=t+"="+get_cookie(t)+";expires=Thu, 01-Jan-1970 00:00:01 GMT;",!0)}function is_cookie_enabled(){return void 0!==navigator.cookieEnabled?navigator.cookieEnabled:(set_cookie("testcookie","testwert",1),!!document.cookie&&(delete_cookie("testcookie"),!0))}function WriteToCookie(t,e,n){if(n){var i=new Date,r=0;-1==n?(i.setTime(i.getTime()+31536e7),r=31536e4):(i.setTime(i.getTime()+24*n*60*60*1e3),r=r=24*n*60*60);var o="; expires="+i.toGMTString()+";max-age="+r}else o="",r=0;document.cookie=t+"="+e+o+"; path=/"}function ReadFromCookie(t){return get_cookie(t)}function DeleteCookie(t){return delete_cookie(t)}function CookieIsAllowed(){return is_cookie_enabled()}function allPageInit(){(allPageIndex={}).result="",(allPageName={}).result=-1;for(var t,e=PageLibrary.getElementsByTagName("TIdeaPage"),n=1,i=1,r=1,o=1,a=0,s=null,l=0;l<e.length;l++)t=AnyToInt(e[l].getAttribute("DeviceType")),"1"!=e[l].getAttribute("IsCFWPage")&&(allPageName[e[l].getAttribute("Name")]=n,allPageIndex[n]=e[l].getAttribute("Name"),n++,a++,0!=t&&1!=(1&t)||(phonePageName[e[l].getAttribute("Name")]=r,phonePageIndex[r]=e[l].getAttribute("Name"),r++),0!=t&&2!=(2&t)||(tabletPageName[e[l].getAttribute("Name")]=o,tabletPageIndex[o]=e[l].getAttribute("Name"),o++),0!=t&&4!=(4&t)||(desktopPageName[e[l].getAttribute("Name")]=i,desktopPageIndex[i]=e[l].getAttribute("Name"),i++));if(tabletPageName.result=o-1,desktopPageName.result=i-1,phonePageName.result=r-1,allPageName.result=a,PageLibrary.childNodes.length>0&&("TProject"==(s=PageLibrary.childNodes[0]).nodeName&&s.childNodes.length>0?s=s.childNodes[0]:PageLibrary.childNodes.length>1&&"TProject"==PageLibrary.childNodes[1].nodeName&&PageLibrary.childNodes[1].childNodes.length>0&&(s=PageLibrary.childNodes[1].childNodes[0]),null!=s&&"tstdorganization"==s.nodeName.toLowerCase())){var d=s.getAttribute("Numbering");null!=d&&""!=d||(d=nmAbsolute),d=initAutoNumbering(s,d,0),s.setAttribute("nrCount",d)}}function initAutoNumbering(t,e,n){var i,r,o,a,s,l=t.childNodes;s=0;for(var d=0;d<l.length;d++)"tstdorganization"==l[d].nodeName.toLowerCase()&&(o=n,r=!1,(i=l[d].getAttribute("Numbering"))!=nmRelative&&i!=nmAbsolute&&i!=nmIgnore||(r=!0),null!=i&&i!=nmAuto||(i=e)==nmRelative&&(r=!0),1==r&&(o=0),a=initAutoNumbering(l[d],i,o),1==r?l[d].setAttribute("nrCount",a):i!=nmIgnore&&(n+=a,s+=a)),"tideapage"==l[d].nodeName.toLowerCase()&&(null==(i=l[d].getAttribute("Numbering"))&&(i=nmAuto),i==nmAuto&&e==nmIgnore&&(i=nmIgnore),i!=nmIgnore&&"1"!=l[d].getAttribute("IsCFWPage")&&(n+=1,s+=1),i==nmIgnore||i==nmAuto&&e==nmIgnore?l[d].setAttribute("nr",nmIgnore):l[d].setAttribute("nr",Max(1,n)));return s}function GetAutoPageNr(t){for(var e,n=PageLibrary.getElementsByTagName("TIdeaPage"),i=0;i<n.length;i++)if(n[i].getAttribute("Name")==t)return null==(e=n[i].getAttribute("nr"))&&(e=1),Max(0,e);return""}function GetAutoPageCount(t){for(var e,n,i=PageLibrary.getElementsByTagName("TIdeaPage"),r=0;r<i.length;r++)if(i[r].getAttribute("Name")==t){for(e=(n=i[r].parentNode).getAttribute("nrCount");(null==e||""==e||0==e)&&null!=n.parentNode&&"tstdorganization"==n.parentNode.nodeName.toLowerCase();)e=(n=n.parentNode).getAttribute("nrCount"),"Seiten"==n.getAttribute("Name")&&null==e&&(e=0);return null==e&&(e=0),e}return""}function GetAbsPageCount(){return allPageName.result>-1?allPageName.result:(allPageInit(),AnyToInt(allPageName.result))}function GetAbsPageIndex(t){arguments.length<1&&(t=pages[getPageFromCallstack(GetAbsPageIndex.caller)].Name());return t.lastIndexOf(".")>-1&&(t=t.substring(t.lastIndexOf(".")+1,t.length)),allPageName[t]}function GetLongPageName(t){t.lastIndexOf(".")>-1&&(t=t.substring(t.lastIndexOf(".")+1,t.length));for(var e="",n=findPageInPageLib(t);null!=n&&(e=n.getAttribute("Name")+(""!=e?".":"")+e,"seiten"!=n.getAttribute("Name").toLowerCase());)n=n.parentNode;return e}function GetChapterNode(t){t.lastIndexOf(".")>-1&&(t=t.substring(t.lastIndexOf(".")+1,t.length));var e=findPageInPageLib(t);return e=e.parentNode}function GetChapterCountOnSameLevel(t){var e=t.parentNode;return null!=e?e.childNodes.length:0}function GetChapterIndex(t){var e=t.parentNode,n=-1;if(null!=e){var r=e.childNodes;for(i=0;i<r.length;i++)if(r[i].getAttribute("Name")==t.getAttribute("Name")){n=i+1;break}}return n}function getParentNode(t){return t.parentNode}function GetPageFromIndex(t){return t>0&&t<=GetAbsPageCount()?allPageIndex[t]:""}function PreviousPageFromTree(t){null!=window.IDEAMAPI&&null!=window.IDEAMAPI.PreviousPageFromTree?window.IDEAMAPI.PreviousPageFromTree():(t||(t=pages[getPageFromCallstack(PreviousPageFromTree.caller)]),PreviousPageFromTreeEx(t))}function IsPreviousPageFromTree(t){null!=window.IDEAMAPI&&null!=window.IDEAMAPI.IsPreviousPageFromTree?window.IDEAMAPI.IsPreviousPageFromTree():(t||(t=pages[getPageFromCallstack(IsPreviousPageFromTree.caller)]),IsPreviousPageFromTreeEx(t))}function IsPreviousPageFromTreeEx(t){if(!t)t=pages[getPageFromCallstack(IsPreviousPageFromTreeEx.caller)];sPage=t.Name();var e=GetAbsPageIndex(sPage);if((e-=1)>0){allPageIndex[e];return!0}return!1}function PreviousPageFromTreeEx(t){if(!t)t=pages[getPageFromCallstack(PreviousPageFromTreeEx.caller)];sPage=t.Name();var e=GetAbsPageIndex(sPage);(e-=1)>0&&JumpEx(allPageIndex[e],t)}function GetRuntimeVersion(){return runtimeversion}function GetRuntimeDate(){return runtimedate}function GetLastErrorValue(){}function GetLastErrorText(){}function GetSystemHeight(){return getDocumentHeight()}function GetSystemWidth(){return getDocumentWidth()}function getRandomNumber(t){return Math.floor(Math.random()*t)}function getRandomChar(){return"0123456789abcdefghijklmnopqurstuvwxyzABCDEFGHIJKLMNOPQURSTUVWXYZ".substr(getRandomNumber(62),1)}function GetUniqueID(){for(var t="",e=0;e<31;e++)t+=getRandomChar();return t=t.toLowerCase()}function showCoverPanel(t){t||(t=gCoverID),$(t)||createTransCoverPanel(t)}function hideCoverPanel(t){t||(t=gCoverID),$(t)&&removeTransCoverPanel(t)}function isCoverPanelVisible(t){return t||(t=gCoverID),AnyToBool(null!=$(t))}function getParams(){var t=window.location.search,e=[];(t=t.replace("?","")).trim().length>0&&(e=t.split("&"));for(var n=0;n<e.length;n++){var i=e[n].split("="),r=i[0];AppParams[r]=decodeURIComponent(i[1])}}function GetAppletParam(t,e){return 0==isVarUndefined(e)&&e,""!=t?AppParams[t]:window.location.hash}function SetLoadPageCallback(t,e){callbackloadPage=t,callbackloadMethod=e}function LoadProjectFile(t){pageHistory=[],PageLibrary=GetXMLDocFromString(t)}function SetVariable(t,e,n,i){var r=findNode(t,i=i?(i=AnyToObject(i)).vartreenode:Variablen.vartreenode,!0);null==r&&(r=createNode(t,i));var o=findNode(e,r,!0);null==o&&(o=createNode(e,r)),null!=o&&o.setAttribute("value",n)}function GetVariable(t,e,n){var i=findNode(t,n=n?(n=AnyToObject(n)).vartreenode:Variablen.vartreenode,!0);if(null==i)return"";var r=findNode(e,i,!0);return null==r?"":r.getAttribute("value")}function SetVariableEx(t,e,n,i){var r=(i=i?AnyToObject(i):Variablen).vartreenode;if(i[t]){s=i[t];for(var o=0;o<r.childNodes.length;o++)if(r.childNodes[o].getAttribute("Name")==t){a=r.childNodes[o];break}}else{var a,s=new Object;i[t]=s,s.varNodeName=t,s.vartreenode=r,(a=r.ownerDocument.createElement("TMetaVariables")).setAttribute("Name",t),r.appendChild(a)}i[t][e]?(i[t][e](n),a.setAttribute(e,n)):(isdDefPropOnObject(e,s)?invokeFunc(s,e,n):evalProjectProp(e,s,!0,n),a.setAttribute(e,n))}function GetVariableEx(t,e,n,i,r){i=i?AnyToObject(i):Variablen;var o,a=[];if((a=AnyToStr(t).split(".")).length<=0||!i[a[0]])return n;if(!i[a[0]].Name)return n;for(o=AnyToObject(i[a[0]]),a.splice(0,1);a.length>0;){if(!o[a[0]]||!o[a[0]].Name)return n;o=AnyToObject(o[a[0]]),a.splice(0,1)}return o[e]?o[e]():n}function getCaptionFromPageLib(t,e,n){isVarUndefined(n)&&(n=""),void 0===e&&(e="TIdeaPage");var i=PageLibrary.getElementsByTagName(e);if(""==t&&i.length>0)return i[0].getAttribute("Caption");for(var r=0;r<i.length;r++)if(i[r].getAttribute("Name").toLowerCase()==t.toLowerCase())return i[r].getAttribute("Caption");return n}function enumNodes(t,e,n,i){var r,o,a,s=[],l=PageLibrary.getElementsByTagName(cTStdOrganization);for(o=0;o<l.length;o++)if(l[o].getAttribute("Name").toLowerCase()==t.toLowerCase()){var d=l[o];for(a=0;a<d.childNodes.length;a++)d.childNodes[a].nodeName!=e||0!=i&&"1"!=d.childNodes[a].getAttribute("ShowInMenu")||s.push(d.childNodes[a].getAttribute("Name")),0==n&&d.childNodes[a].nodeName==cTStdOrganization&&(r=enumNodes(d.childNodes[a].getAttribute("Name"),e,n,i)).length>0&&(s=s.concat(r.split(",")));return s.join(",")}return s.join(",")}function getBreadcrumb4page(t,e,n){var i=jQuery('TIdeaPage[Name="'+t+'"]',jQuery(PageLibrary));if(0==i.length)return"";var r=i.parentsUntil("TStdOrganization[Name='Seiten']"),o=r.length;if(1==n){for(var a="";o>0;)o--,a+=jQuery(r[o]).attr("Caption")+" "+e+" ";a+=jQuery(i).attr("Caption")}if(2==n){var s;for(a=new Array;o>0;)o--,a[(s=a.push(new Object))-1].Caption=jQuery(r[o]).attr("Caption"),a[s-1].Page=jQuery(jQuery(r[o]).find("TIdeaPage").eq(0)).attr("Name");a[(s=a.push(new Object))-1].Caption=jQuery(i).attr("Caption"),a[s-1].Page=jQuery(i).attr("Name")}return a}function getParentChapter(t,e){var n=jQuery('TIdeaPage[Name="'+t+'"]',jQuery(PageLibrary));return 0==n.length&&(n=jQuery('TStdOrganization[Name="'+t+'"]',jQuery(PageLibrary))),0==n.length?"":n.parent()[0].getAttribute(e)}function iHTTP_Post(t,e,n,i){var r=!!n,o="Content-Type:application/x-www-form-urlencoded;charset=UTF-8";if(t){var a=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");if(a)return n&&(a.onreadystatechange=function(){try{if(4==a.readyState&&200==a.status){var t=i.split(".");2==t.length?pages[t[0]][t[1]](a.responseText):pages[t[0]][t[1]][t[2]](a.responseText)}}catch(t){dbg_alert(t.message)}}),a.open("post",t,r),a.setRequestHeader(o.split(":")[0],o.split(":")[1]),a.send(e),n?void 0:a.responseText.ltrim()}}function getValidName(t,e){var n="";if(!e)e=gvnCaption;for(var i=0;i<t.length;i++)isValidName(n+t[i],e)&&(n+=t[i]);return n}function isValidName(t,e){if(!e)e=gvnCaption;if(t.length<=0)return e==gvnCaption;var n;switch(e){case gvnPageName:case gvnCompName:case gvnAttrName:case gvnObjName:case gvnPrjName:n=new RegExp(/[\W]+/);break;case gvnUserName:n=new RegExp(/[^\w-.]+/);break;case gvnMediaNiceName:case gvnCatName:n=new RegExp(/(<|>|,|"|'|{|}|:)+/);break;case gvnMailSubj:case gvnMailBody:n=new RegExp(/(<|>|"|&)+/);break;case gvnPrjTitle:n=new RegExp(/(<|>|')+/);break;case gvnCaption:default:n=new RegExp(/(<|>|"|\$|&)+/)}return null==t.match(n)}function isValidMailAdr(t){return!isVarUndefined(t)&&(0!=t.length&&!(t.indexOf("@")<1||t.indexOf(".")<1))}function stopOnThis(t,e){1==isVarUndefined(t)&&(t=""),1==isVarUndefined(e)&&(e=""),t==e&&WriteToConsole("a = b = "+t),t!=e&&WriteToConsole("a != b, a="+t+", b="+e),isNaN(t)||isNaN(e)||WriteToConsole(t<e?"a < b, a="+t+", b="+e:"a > b, a="+t+", b="+e)}function GetBrowserType(){return IS.ie?"IE":IS.chrome?"CH":IS.opera?"OP":IS.gecko?"FF":IS.safari?"SAF":"ND"}function checkBrowserName(t){return navigator.userAgent.toLowerCase().indexOf(t.toLowerCase())>-1}function getBrowserName(){return checkBrowserName("MSIE")?"MSIE":checkBrowserName("opera")?"opera":checkBrowserName("chrome")?"chrome":checkBrowserName("safari")?"safari":checkBrowserName("firefox")?"firefox":void 0}function msieversion(){var t=window.navigator.userAgent,e=t.indexOf("MSIE ");return e>0?parseInt(t.substring(e+5,t.indexOf(".",e))):0}function GetBrowserVersion(){if(IS.ie)return msieversion()}function AddHook(t,e,n,i){GlobalHook.registerForEvent(t,n,i,e)}function RemoveHook(t,e,n,i){GlobalHook.removeEvent(t,n,i,e)}function GetBrowserLanguage(){return(navigator.language||navigator.systemLanguage||navigator.userLanguage||"en").substr(0,2).toLowerCase()}function ShowTip(t,e){null==globalTipComp&&(globalTipComp=createGlobalTipComponent("xglobtipx")),isVarUndefined(e)&&(e="IdeaTEAM"),globalTipComp.ShowTip(t,e)}function ShowTipEx(t){null==globalTipComp&&(globalTipComp=createGlobalTipComponent("xglobtipx"));for(var e=GlossarXML.getElementsByTagName("word"),n=GlossarXML.getElementsByTagName("desc"),i=e.length,r="",o=0;o<i;o++)if(null!=e[o].childNodes[0].nodeValue){var a=e[o].childNodes[0].nodeValue;if(a==t||a.replace(/\'/g,'"')==t||a.replace(/\"/g,"'")==t){r=_glossardescription(n[o].childNodes);break}}""!=r&&globalTipComp.ShowTip(r,t)}function UpdateGlobalTipComp(){var t=null;if(t=Variablen,null!=globalTipComp){globalTipComp.BGColor(t.GlossarSettings.BGColor()),globalTipComp.BorderColor(t.GlossarSettings.BorderColor()),globalTipComp.BorderWidth(t.GlossarSettings.Borderwidth()),globalTipComp.CloseBtn(t.GlossarSettings.CloseBtn()),globalTipComp.Duration(t.GlossarSettings.Duration()),globalTipComp.Height(t.GlossarSettings.Height()),globalTipComp.FontSize(t.GlossarSettings.FontSize()),globalTipComp.FontWeight(t.GlossarSettings.FontWeight()),globalTipComp.FontColor(t.GlossarSettings.FontColor()),globalTipComp.TitleFontSize(t.GlossarSettings.TitleFontSize()),globalTipComp.TitleFontColor(t.GlossarSettings.TitleFontColor()),globalTipComp.TitleBGColor(t.GlossarSettings.TitleBGColor()),globalTipComp.Sticky(t.GlossarSettings.Sticky());var e=convertFontName(t.GlossarSettings.FontFace());globalTipComp.FontFace(e),e=convertFontName(t.GlossarSettings.TitleFontFace()),globalTipComp.TitleFontFace(e)}}function getGlossarAsArray(){if(null!=GlossarXML){for(var t=[],e=GlossarXML.getElementsByTagName("entry"),n=e.length,i=0;i<n;i++)null!=e[i].getElementsByTagName("word")[0].textContent&&""!=e[i].getElementsByTagName("word")[0].textContent&&null!=e[i].getElementsByTagName("desc")[0].textContent&&""!=e[i].getElementsByTagName("desc")[0].textContent&&(t[i]=[],t[i].w=e[i].getElementsByTagName("word")[0].textContent,t[i].d=e[i].getElementsByTagName("desc")[0].textContent);return t}}function insertGlossar(t){if(null!=GlossarXML)for(var e=GlossarXML.getElementsByTagName("word"),n=e.length,i=0;i<n;i++){if(0==isVarUndefined(e[i].childNodes[0])&&0==isVarUndefined(e[i].childNodes[0].nodeValue))t=_insertGlossarElem(t,e[i].childNodes[0].nodeValue)}return t}function loadGlossar(t){t=expandmetavar(t,pages[getPageFromCallstack(loadGlossar.caller)].Name()),"undefined"==typeof Android&&(t+="?rnd="+Time()),loadXML(t),GlossarXML=GetXMLDoc()}function loadGlossarEx(t){"undefined"==typeof Android&&(t+="?rnd="+Time()),loadXML(t),GlossarXML=GetXMLDoc()}function EvaluateTextErrors(t,e,n,i,r,o){return isVarUndefined(r)&&(r=""),n&&(n=AnyToObject(n)).Items.ClearItems(),i&&(i=AnyToObject(i)).Items.ClearItems(),CompareLists(ParseTextIntoList(t,"",r,o),ParseTextIntoList(e,"",r,o),n,i)}function Float_ADD(t,e){var n=parseFloat(t);return(n+=parseFloat(e)).toString()}function Float_SUB(t,e){var n=parseFloat(t);return(n-=parseFloat(e)).toString()}function Float_MULT(t,e){var n=parseFloat(t);return(n*=parseFloat(e)).toString()}function Float_DIV(t,e){var n=parseFloat(t);return(n/=parseFloat(e)).toString()}function Float_EQUAL(t,e){return parseFloat(t)==parseFloat(e)}function Float_LESS(t,e){return parseFloat(t)<parseFloat(e)}function Float_GREATER(t,e){return parseFloat(t)>parseFloat(e)}function DuplicateVertex(t,e,n,i){page=pages[getPageFromCallstack(DuplicateVertex.caller)],n||(n=page),i||(i=t);var r=findNode(t,page.stringcontentofsite);if(null==r)return"@0";t=i;for(var o=r.nodeName,a=0,s=page.Name()+t,l=t;null!=$(s)||null!=AnyToObject(l,page);)a++,s=page.Name()+t+a,l=t+a;a>0&&(t+=a),(r=r.cloneNode(!0)).setAttribute("Name",t),n==page?page.stringcontentofsite.appendChild(r):n.nodeObject.appendChild(r);var d="";o.toLowerCase()!=ntTStdHTML5VideoPlayer.toLowerCase()&&o.toLowerCase()!=ntTHTML5VideoPlayer.toLowerCase()||(d=r.getAttribute("FilenameWebM")),focuscheck=r.getAttribute("EKBMode");var h=getIdeaObjForNodeType(o,t,n,page.Name(),focuscheck,page.int_mobileView,d);return h.pageName=page.Name(),h.thePageName=page.Name(),h.Parent(n),h.nodeObject=r,page[t]=h,page[h.pageName+t]=h,h.isInit=!0,h.isPageReady=!0,parseNodeToObj(r,h,n,page.Name(),"",1),h}function getNode(t,e){return serializeNode(findNode(t,(e=e?AnyToObject(e):pages[getPageFromCallstack(getNode.caller)]).stringcontentofsite))}function xml2Node(t){var e=null;IS.IE()?((e=new ActiveXObject("Microsoft.XMLDOM")).async="false",e.loadXML(t)):e=(new DOMParser).parseFromString(t,"text/xml");return e}function addNode(t,e,n,i){n=n?AnyToObject(n):pages[getPageFromCallstack(addNode.caller)],i=i?AnyToObject(i,n):n;var r,o,a,s=xml2Node(t),l=[],d=[],h=0,u=s=s.childNodes[0];for(h=u.childNodes.length-1;h>0;)u.childNodes[h].nodeName.toLowerCase()!=ntJavaScript.toLowerCase()&&u.childNodes[h].nodeName.toLowerCase()!=ntFont.toLowerCase()&&(o=u.childNodes[h].outerHTML,r=s.removeChild(s.childNodes[h]),s.setAttribute("Name",e),l.push(r.getAttribute("Name")),d.push(o)),h--;var c,p=!1,m=e,g="",f=0;if(null!=AnyToObject(m,n)){for(g="",h=m.length-1;m.charAt(h)>="0"&&m.charAt(h)<="9";)g=StrConcat(m.charAt(h),g),m=StrCopy(m,1,h),h--;for(""==g&&(g="1"),f=AnyToInt(g);NOT(p);)null==AnyToObject(StrConcat(m,f),n)?p=!0:f+=1;e=m=StrConcat(m,f)}var T=s.nodeName;h=0,s.setAttribute("Name",e),i==n?n.stringcontentofsite.appendChild(s):i.nodeObject.appendChild(s);var y="";for(T.toLowerCase()!=ntTStdHTML5VideoPlayer.toLowerCase()&&T.toLowerCase()!=ntTHTML5VideoPlayer.toLowerCase()||(y=s.getAttribute("FilenameWebM")),c=s.getAttribute("EKBMode"),(a=getIdeaObjForNodeType(T,e,i,n.Name(),c,n.int_mobileView,y)).pageName=n.Name(),a.thePageName=n.Name(),a.Parent(i),a.nodeObject=s,n[e]=a,n[a.pageName+e]=a,a.isInit=!0,a.isPageReady=!0,parseNodeToObj(s,a,i,n.Name(),"",1,n.int_mobileView),h=d.length-1;h>=0;h--)addNode(d[h],l[h],n,a);return T.toLowerCase()==ntTStdsortableList.toLowerCase()&&a.repaint(),a}function DeleteObj(t,e){var n,i,r,o,a;if(a=null,i=(e=1==arguments.length?pages[getPageFromCallstack(DeleteObj.caller)]:AnyToObject(e)).Name(),t.indexOf(i+".")>=0&&null!=(a=AnyToObject(r=t.substr(i.length+1),e))&&"function"!=typeof a.IdeaClass&&(a=null),null==a&&0==t.indexOf(i)&&null!=(a=AnyToObject(r=t.substr(i.length),e))&&"function"!=typeof a.IdeaClass&&(a=null),null==a&&(a=AnyToObject(r=t,e)),null==a||null!=a&&"function"!=typeof a.IdeaClass)return!1;for((o=a.getParentasComp())==e?e.stringcontentofsite.removeChild(a.nodeObject):o.nodeObject.removeChild(a.nodeObject),null!=a.drag&&(a.drag.destroy(),a.drag=null),o==e&&e.removeChild(a),delete e[r],delete e[i+r],removeElement(a.obj),n=o.childes.length-1;n>=0;n--)o.childes[n].Name()==r&&o.childes.splice(n,1);return!0}function SetPageContainer(t,e){if(!arguments.length)return null==callbackContainerPage?"":callbackContainerPage+"."+callbackContainerComp;""!=t?(e||(e=null),callbackContainerPage=t,callbackContainerComp=e):(callbackContainerPage=null,callbackContainerComp=null)}function SetCloseProgramCallback(t,e){if(!arguments.length)return null==CloseProgramCallbackPage?"":CloseProgramCallbackPage+"."+CloseProgramCallbackFuncname;""!=t?(CloseProgramCallbackPage=t,CloseProgramCallbackFuncname=e):(CloseProgramCallbackPage=null,CloseProgramCallbackFuncname=null)}function SetNewState(t,e){StateManager.setState(t,e)}function GoHistoryBack(){history.back()}function removejscssfile(t,e){var n="js"==e?"script":"css"==e?"link":"none",i="js"==e?"src":"css"==e?"href":"none",r=document.getElementsByTagName(n);t=expandmetavar(t);for(var o=r.length;o>=0;o--)r[o]&&null!=r[o].getAttribute(i)&&-1!=r[o].getAttribute(i).indexOf(t)&&r[o].parentNode.removeChild(r[o])}function LoadCSSfile(t){LoadCSSfileEx(t=expandmetavar(t,pages[getPageFromCallstack(LoadCSSfile.caller)].Name()))}function LoadCSSfileEx(t){var e=document.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("type","text/css"),e.setAttribute("href",t),void 0!==e&&(removejscssfile(t,"css"),document.getElementsByTagName("head")[0].appendChild(e))}function hasClass(t,e){var n=t.getAttribute(document.all?"className":"class");return null!=n&&n.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}function addClass(t,e){if(!this.hasClass(t,e)){var n=t.getAttribute(document.all?"className":"class");t.setAttribute(document.all?"className":"class",n+" "+e)}}function removeClass(t,e){if(hasClass(t,e)){var n=new RegExp("(\\s|^)"+e+"(\\s|$)"),i=t.getAttribute(document.all?"className":"class").replace(n," ");t.setAttribute(document.all?"className":"class",i)}}function GetAppURL(){return location.href}function CallUserProcAsync(t,e,n,i,r,o){o+="";var a="if(pages['"+n+"'] && pages['"+n+"']['"+e+"'] && pages['"+n+"']['"+e+"']['"+t+"']){pages['"+n+"']['"+e+"']['"+t+"']('"+(r=(r+="").replace("'","\\'"))+"','"+(o=o.replace("'","\\'"))+"');}";i=AnyToInt(i),window.setTimeout(a,i)}function hex2int(t){return parseInt(t,16)}function int2hex(t){return parseInt(t).toString(16)}function getsqrt(t){return Math.sqrt(t)}function convertColorEx(t){var e=-1;if(!new String(t).match(/[0-9]/))for(var n=0;n<PredefinedStringColors.length;n++)t.toUpperCase()==PredefinedStringColors[n]&&(e=PredefinedIntColors[n]);return-1==e&&(e=t),e}function scrollBottom(t){(t=AnyToObject(t)).obj.scrollTop=t.obj.scrollHeight}function ExternalMailClient(t,e,n){ShellExecute("mailto:"+t+"?subject="+e+"&body="+n,1)}function isYScrollBarVisible(t){var e=!1;return(t=AnyToObject(t)).obj.clientHeight<t.obj.scrollHeight&&(e=!0),e}function GetAuthorMode(){return AuthorMode}function isAuthorMode(t){return t==iamProjectPreview&&(0==isVarUndefined(pages.ProjectPreviewRespo)||0==isVarUndefined(pages.ProjectPreview))||(t==iamPagePreview&&0==isVarUndefined(pages.Preview)||(t==iamRuntime&&1==isVarUndefined(pages.MainPage)||t==iamAnyEditor&&0==isVarUndefined(pages.MainWindow)&&1==isVarUndefined(pages.ProjectPreviewRespo)&&1==isVarUndefined(pages.ProjectPreview)&&1==isVarUndefined(pages.Preview)))}function setProtocollMode(t){GlobalProtocolSetting1=1==t}function checkExitAU(){window.AICCMODEINIT&&0!=getAICCMode()&&1!=isExitAU&&exitAU(Variablen.Global.AICCResult())}function WriteToConsole(t,e){try{"undefined"!=typeof console&&void 0!==console.log&&(void 0!==console[e]?console[e](t):console.log(t))}catch(t){}}function getParentPageAsComponent(t){for(t=(t=AnyToObject(t)).getParentasComp();t;){if("TIdeaPage"==t.IdeaClass())return t;t=t.getParentasComp()}return null}function LoadPage(t,e,n,i,r,o){""!=lasttooltip&&hideToolTip(lasttooltip),!t.startsWith("<?xml")&&t.lastIndexOf(".")>-1&&(t=pageName.substring(t.lastIndexOf(".")+1,t.length));var a=openPage(t,!1,!0,e,n,r,o);return""==i&&(i=a.Name()),window[i]=a,a._intPageNameAlias=i,a}function getXMLnodeChildesByAttr(t,e,n){var i=[];if(t.getAttribute(e)==n){for(var r=0;r<t.childNodes.length;r++)i.push(t.childNodes[r]);return i}for(r=0;r<t.childNodes.length;r++)if((i=getXMLnodeChildesByAttr(t.childNodes[r],e,n)).length>0)return i;return i}function getXMLnodeParenByAttr(t,e,n){var i=[];if(t.getAttribute(e)==n)return i.push(t.parentNode),i;for(var r=0;r<t.childNodes.length;r++)if((i=getXMLnodeParenByAttr(t.childNodes[r],e,n)).length>0)return i;return i}function mydecodeURIComponent(t){try{t=decodeURIComponent(t)}catch(e){t=t}return t}function myencodeURIComponent(t){try{t=encodeURIComponent(t)}catch(e){t=t}return t}function jQueryObject(t,e){return jQuery("#"+t+e)}function newObject(){return new Object}function cnvCommentfile(t){var e=GetXMLDocFromString(t);if("2"!=e.getAttribute("Version")){var n=GetXMLDocFromString("<TIdeaPageComment Version='2' Name=''/>");n.setAttribute("Name",e.getAttribute("name"));var i=n.ownerDocument.createElement("TIdeaComment");i.setAttribute("id","1");var r=e.getAttribute("cmt_editor");if(null==r&&(r=e.getAttribute("cmt_creator")),null!=r){i.setAttribute("editor",r);var o=e.getAttribute("cmt_etimestamp");null==o&&(o=e.getAttribute("cmt_ctimestamp")),i.setAttribute("timestamp",o);var a=n.ownerDocument.createCDATASection(e.getAttribute("cmt_comment"));i.appendChild(a);var s=e.getAttribute("cmt_state");"1"==s?(s=0,i.setAttribute("stateuser","")):(s=1,i.setAttribute("stateuser",r)),i.setAttribute("state",s),n.appendChild(i)}return n.xml?Xml2String=n.xml:Xml2String=serializeNode(n),Xml2String}return t}function _tts2mp3(t,e,n){return jQuery.ajax("relay.php",{success:function(t){""==n?e(t.links.mp3):pages[n][e](t.links.mp3)},data:{v:"German - male",t:t,f:"mp3"},dataType:"json",type:"post"}),""}function _tts(t){_tts2mp3(t,_ttscallback,"")}function _ttscallback(t){var e=jQuery("#tts");if(0==e.length){var n=document.createElement("iframe");n.id="tts",document.body.appendChild(n),e=jQuery("#tts")}jQuery("#tts").prop("src",t)}function getRandomInt(t,e){return Math.floor(Math.random()*(e-t+1))+t}function getScrollbarWidth(){var t=document.createElement("div");t.style.visibility="hidden",t.style.width="100px",t.style.msOverflowStyle="scrollbar",document.body.appendChild(t);var e=t.offsetWidth;t.style.overflow="scroll";var n=document.createElement("div");n.style.width="100%",t.appendChild(n);var i=n.offsetWidth;return t.parentNode.removeChild(t),e-i}function isFlashAvailable(){if(navigator.plugins&&navigator.plugins.length)return void 0!==navigator.plugins["Shockwave Flash"];if(navigator.mimeTypes&&navigator.MimeTypes.length)return void 0!==navigator.mimeTypes["application/x-shockwave-flash"];try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");return!0}catch(t){try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");return!0}catch(t){try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash");return!0}catch(t){return!1}}}return!1}function moveArrEl(t,e,n){for(;e<0;)e+=t.length;for(;n<0;)n+=t.length;if(n>=t.length)for(var i=n-t.length;1+i--;)t.push(void 0);return t.splice(n,0,t.splice(e,1)[0]),t}function fixedEncodeURIComponent(t){return encodeURIComponent(t).replace(/[!'()*]/g,escape)}function measureText(t,e,n){var i=document.createElement("div");document.body.appendChild(i),null!=n&&(i.style=n),i.style.fontSize=e+"px",i.style.position="absolute",i.style.left=-1e3,i.style.top=-1e3,i.innerHTML=t;var r={width:i.clientWidth,height:i.clientHeight};return document.body.removeChild(i),i=null,r}function eventFire(t,e){if(t.fireEvent)t.fireEvent("on"+e);else{var n=document.createEvent("MouseEvents");n.initEvent(e,!0,!1),!t.dispatchEvent(n)&&console.log("automatic click canceled")}}function ideaTimer(t,e,n){t&&(this.idx=Timer_maxidx++,this.obj=t,this.method=e,this.arg0=n,this.timer=0,this.delay_ms=0,this.interval_f=0,Timer_pending[this.idx]=this),ideaTimer.prototype||(this.exec=Timer_exec,this.setTimeout=Timer_setTimeout,this.clearTimeout=Timer_clearTimeout,this.setInterval=Timer_setInterval,this.clearInterval=Timer_clearInterval,this.close=Timer_close)}audio.onFinish=function(){audio.loop?soundManager.play(audio.currentSound):""!=audio.currentSound&&(audio.currentSound="",audio.cwp=!0,audio.sm.destruct(),null!=audio.currentObj&&audio.currentObj.OnSystemEvent&&window.setTimeout(function(){var t=audio.currentObj;audio.currentObj=null,t.OnSystemEvent(1)},100))},INIStorage=new Object,ChangeAttrOnTimeObj.prototype={TICKDURATION:40,target:null,attrName:null,endValue:null,valueStep:null,isEnded:null,id:null,startValue:null,startTime:null,endTime:null,intver:null,nextChange:function(){if(!this.isEnded){var t=this.endValue;currentTime()>this.startTime&&(this.endTime>this.startTime&&(t=(this.endValue-this.startValue)*(currentTime()-this.startTime)/(this.endTime-this.startTime)/this.valueStep*this.valueStep+this.startValue),this.endTime-currentTime()<this.TICKDURATION&&(t=this.endValue,this.isEnded=!0,window.clearInterval(this.intver))),AnyToObject(this.target,this.pageName)[this.attrName](t)}},stop:function(){this.isEnded=!0,window.clearInterval(this.intver)}},String.prototype.ltrim=function(t){return t?this.replace(new RegExp("^["+t+"]+"),""):this.replace(/^\s+/,"")},itrunc=function(t){return t<0?Math.ceil(t):Math.floor(t)},new ideaTimer,ideaTimer.prototype&&(ideaTimer.prototype.exec=Timer_exec,ideaTimer.prototype.setTimeout=Timer_setTimeout,ideaTimer.prototype.clearTimeout=Timer_clearTimeout,ideaTimer.prototype.setInterval=Timer_setInterval,ideaTimer.prototype.clearInterval=Timer_clearInterval,ideaTimer.prototype.close=Timer_close);var Timer_maxidx=0,Timer_pending=[];function Timer_exec(){this.obj[this.method](this.arg0),this.interval_f?window.setInterval||window.setTimeout&&(this.timer=window.setTimeout('Timer_pending["'+this.idx+'"].exec()',this.delay_ms)):this.timer=0}function Timer_setTimeout(t){this.timer&&this.clearTimeout(),this.delay_ms=t,this.delay_ms>0&&(this.interval_f&&window.setInterval?this.timer=window.setInterval("Timer_pending["+this.idx+"].exec()",this.delay_ms):window.setTimeout&&(this.timer=window.setTimeout('Timer_pending["'+this.idx+'"].exec()',this.delay_ms)))}function Timer_clearTimeout(){this.timer&&(this.interval_f&&window.clearInterval?window.clearInterval(this.timer):window.clearTimeout&&window.clearTimeout(this.timer)),this.timer=0,this.interval_f=0}function Timer_setInterval(t){this.timer&&this.clearTimeout(),this.interval_f=1,this.setTimeout(t)}function Timer_clearInterval(){this.clearTimeout()}function Timer_close(){this.timer&&this.clearTimeout(),delete Timer_pending[this.idx]}function parseFont(t,e){null!==t.getAttribute("Name")&&""!==t.getAttribute("Name")&&e.attr_Font.FontName(t.getAttribute("Name")),null!==t.getAttribute("Color")&&""!==t.getAttribute("Color")&&e.attr_Font.FontColor(t.getAttribute("Color")),null!==t.getAttribute("Size")&&""!==t.getAttribute("Size")&&e.attr_Font.FontSize(t.getAttribute("Size"));var n=t.getAttribute("Style");if(null!==n&&""!==n){var i=0;(n=n.substring(1,n.length-1)).indexOf("fsBold")>=0&&(i|=FSBOLD),n.indexOf("fsItalic")>=0&&(i|=FSITALIC),n.indexOf("fsUnderline")>=0&&(i|=FSUNDERLINE),n.indexOf("fsStrikeOut")>=0&&(i|=FSSTRIKEOUT),e.attr_Font.FontStyle(i)}}function convertFontName(t){var e=t;switch(t){case"Arial":e="arial";break;case"MS Dialog":case"System":case"Fixedsys":e="arial";break;case"MS Sans Serif":e="sans-serif";break;case"MS Serif":returnvalue="serif";break;case"Times New Roman":e='Times,"Times New Roman",serif';break;case"Helvetica":case"Tahoma":e="Tahoma,Verdana,Helvetica,Arial,sans-serif";break;case"Verdana":e="Verdana,Arial,sans-serif";break;case"Roman":case"SmallFonts":e="Times,serif";break;case"Courier":case"CourierNew":e="Courier New, Courier, monospace";break;case"LatoWeb":e="latoweb";break;case"NewsCycle":e="newscycle"}return e}function getHttpObject(){if(null!==httpObject&&0===httpObject.readyState)return httpObject;var t=null;if(!t&&window.ActiveXObject)try{t=new ActiveXObject("MSXML2.XMLHTTP")}catch(e){try{t=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){t=!1}}if(!t&&XMLHttpRequest)try{(t=new XMLHttpRequest).overrideMimeType("text/xml")}catch(e){t=!1}return t}function loadXML(t,e){t=projectPath+toLowerCaseFileName(t),(httpObject=getHttpObject()).abort(),httpObject.open("GET",t,!1);try{httpObject.send(null)}catch(t){}}function GetPageXMLDocFromString(t){try{if(IS.IE())return PageXMLDoc.loadXML(t),PageXMLDoc;var e=new DOMParser;return PageXMLDoc=e.parseFromString(t,"text/xml")}catch(t){return PageXMLDoc}}function GetXMLDocFromString(t){try{var e;return window.DOMParser&&!window.ActiveXObject?(e=(new DOMParser).parseFromString(t,"text/xml")).documentElement:((e=new ActiveXObject("Microsoft.XMLDOM")).async="false",e.loadXML(t),e.documentElement)}catch(t){}}function startCourse(t){internalProduct=t,init_EventDelegation(),loadXML(StartXMLName),parseStartXML(),startTimeout>=0&&hideStartScreen()}function GetLastError(){return 200==httpObject.status||0===httpObject.status?0:1}function GetXMLDoc(){var t;return IS.IE()?""!==httpObject.responseText&&0===GetLastError()&&(t=new ActiveXObject("Microsoft.XMLDOM")).loadXML(httpObject.responseText):0===GetLastError()&&(t=httpObject.responseXML),t}var PageXMLDoc=null;function GetPageXMLDoc(){return IS.IE()?""!==httpObject.responseText&&0===GetLastError()&&PageXMLDoc.loadXML(httpObject.responseText):0===GetLastError()&&(PageXMLDoc=httpObject.responseXML),PageXMLDoc}IS.IE()&&(PageXMLDoc=new ActiveXObject("Microsoft.XMLDOM"),PageXMLDoc.async="false");var FileName=null;function parseStartXML(){var t=(projectXML=GetXMLDoc()).documentElement;FileName=t.getAttribute(TA_PROJECTNAME),StartPageName=t.getAttribute(TA_STARTPAGENAME),getParams();var e=GetAppletParam("startpage");void 0!==e&&""!=e&&setExternalStartPage(e),t.getAttribute(TA_TEMPLATENAME),t.getAttribute(TA_DATAPATH),loadXML(FileName),loadPageLibary(),t=null}function createProjectSet(t){var e=t;return function(t){if(!arguments.length)return GetProjectSettings(this.varNodeName,e,this.vartreenode);SetProjectSettings(this.varNodeName,e,t,this.vartreenode)}}function loadVarFile(){var t=GetXMLDoc();variablen.varNodeName="Variablen",Variablen.varNodeName="Variablen",t=t.documentElement,variablen.vartreenode=t,Variablen.vartreenode=t,parseVarNode(t,variablen,null,t),Variablen=variablen,SetProjectSettings("Metavariablen","CourseDir",""),SetProjectSettings("Metavariablen","LocaleCourseDir",""),void 0===window.use_dataInterface&&(window.use_dataInterface=!1),window.use_dataInterface||(AICCMode=doLMSInitialize(),Variablen.System.AICCMode("true"==AICCMode.toString()?1:0),window.AICCMODEINIT=!0),XAPIMode=AnyToBool(null!=getLLAPIHandle()),Variablen.System.XAPIMode("true"==XAPIMode.toString()?1:0),Variablen.System.OfflineMode(document.location.host?0:1),Variablen.System.ScreenHeight(getDocumentHeight()),Variablen.System.ScreenWidth(getDocumentWidth()),mos=GetVariableEx("System","MOS",0,"Variablen")>0,init_System_Vars_Ex(Variablen),IS.dTM.setVariables(Variablen),Variablen.Global.LastComment=createProjectSet("LastComment");(StartDate=new Date).getDate(),StartDate.getMonth(),StartDate.getFullYear(),StartDate.getHours(),StartDate.getMinutes,StartDate.getSeconds();IsInProtocolMode()&&IsProtocolBitSet(0)&&Protocol("Recordtyp=0,Datum="+generateIFormatDate(StartDate)+",Zeit="+generateIFormatTime(StartDate)+",,,,,");GetAbsPageCount(),getParams(),globalTipComp=null,getGlossar();GetVariableEx("Projectsettings","TargetPlatform",0,"Variablen");openPage(StartPageName)}function parseVarNode(t,e,n,i){var r,o=t.attributes,a="",s=t.childNodes.length,l=t.childNodes;setVarAttrSetOnObj(o,e);for(var d=0;d<s;d++)a=l[d].getAttribute("Name"),r=new Object,e[a]=r,r.varNodeName=a,r.vartreenode=i,parseVarNode(l[d],r,e,i);r=null}function setVarAttrSetOnObj(t,e){for(var n=null,i="",r=t.length,o=0;o<r;o++)n=t[o].name,i=replace(i=replace(i=t[o].value,"\\","/"),"&#x0A;",""),isdDefPropOnObject(n,e)?invokeFunc(e,n,i):evalProjectProp(n,e,!0,i)}function evalProjectProp(t,e,n,i){e[t]=createProjectSet(t),invokeFunc(e,t,i)}function loadPageLibary(){var t=[];PageLibrary=GetXMLDoc(),loadXML(FileName=FileName.toLowerCase().endsWith("prj")?FileName.substring(0,FileName.length-3)+VARFILEEXTENSION:FileName.substring(0,FileName.length-8)+NEWVARFILEEXTENSION),loadVarFile();var e=GetVariableEx("Projectsettings","CSSFile","");""!=e&&(t=[],e.trim().length>0&&(t=e.trim().split(",")),1==t.length&&LoadCSSfileEx(e=expandmetavarEx(e,"Variablen"))),""!=(e=GetVariableEx("Projectsettings","TextCSSFile",""))&&(t=[],e.trim().length>0&&(t=e.trim().split(",")),1==t.length&&LoadCSSfileEx(e=expandmetavarEx(e,"Variablen")))}function openPage(t){var e,n;AnyToBool(allowTransCoverPanel)&&createTransCoverPanel();var i="",r="",o="",a="";return 1==arguments[1]&&(e=!0),1==arguments[2]&&(n=!0),arguments[3]&&""!==arguments[3]&&(i=arguments[3]),arguments[4]&&""!==arguments[4]&&(arguments[4]instanceof Object?(r=arguments[4].Name(),pages[arguments[4].Name()]||(r=arguments[4].pageName+"."+r)):r=arguments[4]),arguments[5]&&""!==arguments[5]&&(o=arguments[5]),arguments[6]&&(a=arguments[6]),innerPageOpen(t,e,n,i,r,o,a)}function innerPageRunTime(t,e,n,i){var r=null,o=GetVariableEx("Projectsettings","TargetPlatform",0,"Variablen")>0;if(null!==callbackloadPage&&""!==callbackloadPage){var a,s=0;if(null!=(a=findPageInPageLib(t))){s=AnyToInt(a.getAttribute("ShowInMenu"));var l=n?e:"";t=pages[callbackloadPage][callbackloadMethod](a.getAttribute("Name"),s,l)}}t.startsWith("<?xml")?r=openPageXML(n,i,!0,t,0,"","",e,a.getAttribute("Name"),o):(t.lastIndexOf(".")>-1&&(t=t.substr(t.lastIndexOf(".")+1)),null!==(a=findPageInPageLib(t))&&(loadXML(a.getAttribute("Template")),r=openPageXML(n,i,!1,t,0,"","",e,a.getAttribute("Name"),o)));if(AnyToBool(allowTransCoverPanel)&&removeTransCoverPanel(),null===r){var d=AnyToObject(e);null!==d&&removeCoverPanel(d.Name()+"TransCoverPanel"),alert("Seite nicht vorhanden!")}return r}function innerPageOpen(t){var e,n,i=!1,r="",o="",a=null,s="";if("true"==arguments[1]&&(e=!0),"true"==arguments[2]&&(i=!0),arguments[3]&&(n=arguments[3]),arguments[4]&&(r=arguments[4]),arguments[5]&&(o=arguments[5]),arguments[6]&&(s=arguments[6]),t.startsWith("<?xml"))a=openPageXML(e,i,!0,t,n,r,o,"",null,s);else{if(t.lastIndexOf(".")>-1&&(t=t.substr(t.lastIndexOf(".")+1)),""===t){var l=findPageInPageLib(t);if(null!==l)loadXML(l.getAttribute("Template"))}else loadXML(t+"."+TPLFILEEXTENSION);a=openPageXML(e,i)}return AnyToBool(allowTransCoverPanel)&&removeTransCoverPanel(),a}var pages=new Object;function openPageXML(t,e){var n,i,r=!1,o="",a="",s="",l=null;1==arguments[2]&&(r=!0),arguments[4]&&(n=arguments[4]),arguments[5]?s=arguments[5]:null!==callbackContainerPage&&(s=null!==callbackContainerComp?callbackContainerPage+"."+callbackContainerComp:callbackContainerPage),arguments[6]&&(i=arguments[6]),arguments[7]&&(o=arguments[7]),arguments[8]&&(l=arguments[8]),arguments[9]&&(a=arguments[9]);var d=r?GetPageXMLDocFromString(arguments[3]):GetPageXMLDoc();l&&null!==l&&d.documentElement.setAttribute("Name",l);var h=d.documentElement.getAttribute("Name"),u=0,c="",p=getUniqueID();if(""!==o&&(void 0==pages[o]?(o="",c=""):c=(o=pages[o]).obj),c&&""!==c&&!t){o.obj;closePage(o),renameAll(c,p)}for(var m=h;pages[m]&&null!==pages[m];)m=h,m+=++u;u>0&&(h+=u,d.documentElement.setAttribute("Name",h));var g=null,f=null,T=null;if(null===d)return alert("Die Seite "+h+" konnte nicht geöffnet werden"),null;o&&""!==o&&t&&e&&createCoverPanel(o,p);f=null;if(T=createPage(h,s,a),t&&T.zLayer(maxZ++),t&&e&&T.callerPage(o.Name()),n&&""!==n&&T.PageMode(n),s&&null!==s&&""!==s){var y=s;y.lastIndexOf(".")>-1&&(y=y.substring(y.lastIndexOf(".")+1,y.length),f=s.substring(0,s.indexOf("."))),pages[f]&&pages[f][y].addChild(T)}if(pages[h]=T,T.pageName=h,T.thePageName=h,""!==i&&(T.varfileinternal=i),T.Parent(s),T.nodeObject=d.documentElmement,T.int_mobileView=void 0!==a&&""!==a&&0!=a,a=!1,s&&null!==s&&""!==s){var b="";if(s.lastIndexOf(".")>-1){var S=s.substring(s.lastIndexOf(".")+1,s.length);b=s.substring(0,s.indexOf(".")),s=S}a&&""!==a&&0!=a?("testcontainermobile"==$(b+s).id?jQuery($(b+s)).find(".ui-content")[0].appendChild(T.obj):pages[b][s].appendChild(T.obj),jQuery($(b+s)).closest(".ui-page").length>0&&jQuery($(b+s)).closest(".ui-page").page("destroy").page(),doChangeMobilePage(jQuery($(b+s)).closest(".ui-page"))):$(b+s).appendChild(T.obj)}else document.getElementsByTagName("body")[0].appendChild(T.obj);d.documentElement.setAttribute("Visible","0"),parseNodeToObj(d.documentElement,T,null,h,"",0,T.int_mobileView),n&&""!==n?T.PageMode(n):T.PageMode(0),T.stringcontentofsite=d.documentElement,(f=T)[f.Name()]=f,pageHistory[pageHistory.length-1]!=f.Name()&&pageHistory.push(f.Name()),t&&null===g&&(g=c.obj);var v="";return t&&(f.callerPage(g),v=g),a||startPage(t?"":o,f,f.Name(),v),t||null!==o&&""!==o&&removeElement(c),a&&startPage(t?"":o,f,f.Name(),v),f}function removeAll(t){if(null!==t){if(t.childNodes&&t.childNodes.length>0)for(var e=(i=t.childNodes).length,n=0;n<t.childNodes.length;n++)removeAll(i[n]);var i,r="";if(i=t.attributes)for(e=i.length,n=0;n<e;n++)"function"==typeof t[r=i[n].name]&&(t[r]=null);removeElement(t)}}function initFlashPlayer(){for(var t,e=null,n=0;n<2;n++){e=document.createElement("div"),document.getElementsByTagName("body")[0].appendChild(e),e.setAttribute("id",n+"firstFlash");var i=e.style;i.position="absolute",i.visibility="hidden",i.width=1+px,i.height=1+px,i.top=0+px,i.left=0+px,i.display="none",t={movie:"",wmode:"transparent",id:n+"firstFlashObj",name:n+"firstFlashObj",width:"1",height:"1",majorversion:"7",build:"0",bgcolor:"#FFFFFF",allowfullscreen:"false",swliveconnect:"true",flashvars:""},UFO.create(t,n+"firstFlash"),t=null,e=null}}function removeElement(t){var e=document.getElementById("IELeakGarbageBin");e||((e=document.createElement("DIV")).id="IELeakGarbageBin",e.style.display="none",document.body.appendChild(e)),e.appendChild(t),e.innerHTML=""}function startPage(t,e,n,i){var r=e;arguments.length<=3&&(i=""),e.Name(n),e.OnBeforePageReady&&e.OnBeforePageReady(i),e.onpgready(i),r==e&&(0==e.PageMode()?Show(e,1):e.Visible(1),e.OnShow&&e.OnShow(i),e.onpgshown(i))}function openXPG(){var t=GetPageXMLDoc();null!==t&&mergeToPage(t.documentElement,window.page,null),t=null,startPage()}function loadSystemLib(){loadXML(pathsyslib),systemLibary=GetXMLDoc(),IS.NN()&&systemLibary.normalize(),systemLibary=systemLibary.documentElement}function parseNodeToObj(t,e,n,i,r,o,a){var s,l,d,h,u,c,p,m,g,f,T,y,b,S=t.attributes,v="";null!==n&&n.addChild(e),parseNodeToObj.thePageName=i,use_syslib&&""!=t.getAttribute("Subclass")?setXMLAttrSetOnObjNew(e,t.getAttribute("Subclass"),S):setXMLAttrSetOnObj(S,e);for(var C=getIdeaObjForNodeType,_=parseNodeToObj,E=t.childNodes.length,j=t.childNodes,I=0;I<E;I++)if("Script"!=(c=(u=j[I]).nodeName))if("JavaScript"!=c)if("Font"!=c){if(s=u.getAttribute("Name"),1==o){for(var A=0,P=i+s;null!==$(P);)P=i+s+ ++A;A>0&&(s+=A),u.setAttribute("Name",s)}T=u.getAttribute("Subclass"),y=u.getAttribute("EKBMode"),b=null==(b=u.getAttribute("mobileView"))||""==b||!AnyToBool(b);var N="";T.toLowerCase()!=cTStdHTML5VideoPlayer.toLowerCase()&&T.toLowerCase()!=ntTHTML5VideoPlayer.toLowerCase()||(N=u.getAttribute("FilenameWebM")),"tstdextjstreeview"==T.toLowerCase()&&null!=u.getAttribute("multiSelect")&&(N=u.getAttribute("multiSelect")),(f=C(T,s,e,i,y,b&&a,N)).pageName=i,f.thePageName=i,f.Parent(e),f.nodeObject=u,(m=pages[i])[s]=f,m[i+s]=f,m.allComps[m.allComps.length]=f,"TStdScenario"==c&&m.scenarios.push(f),_(u,f,e,i,r,o,a),1==o&&(f.isInit=!0),u=null,f=null}else parseFont(u,e);else null!==(d=u.getAttribute("ScriptData"))&&""==d&&(d="return;"),null!==d&&""!==d&&(d=d.replace(/&#x0A;/g,"\n"),l=(l=u.getAttribute("Name")).substring(l.indexOf("_")+1),null===(h=u.getAttribute("ScriptParam"))&&(h=""),p=null,null!==(h=replace(h,"//",""))&&""!==h&&(p=h.split(",")),g=d,(d=[]).push("var page=pages[this.pageName];var Page=page;"),"OnInternalInit"!==l&&"_initPosition"!==l&&d.push(l.endsWith("Get")||l.endsWith("Set")?"if(page.PageMode()==2) return;":"if(page.PageMode()!=0) return;"),d.push(g),v=null!==p?new Function(p,d.join("")):new Function(d.join("")),"OnClick"==l&&(l="JScr_"+l),v.thePageName=i,e[l]=v,l.endsWith("Get")&&(e["attr_"+(s=l.replace("Get",""))]=null,e[s]=createSetterGetterTech(s)),l.endsWith("Set")&&(e["attr_"+(s=l.replace("Set",""))]=null,e[s]=createSetterGetterTech(s)),v=null);t=null}function mergeToPage(t,e,n,i){var r,o,a,s=t.attributes,l=null,d="",h=t.childNodes.length,u=(l=null,null),c=null,p="";null!==n&&n.addChild(e),use_syslib?setXMLAttrSetOnObjNew(e,t.getAttribute("Subclass"),s):setXMLAttrSetOnObj(s,e);for(var m=0;m<h;m++)if("Script"!=(u=(l=t.childNodes[m]).nodeName))if("JavaScript"!=u)"Font"!=u?((c=AnyToObject(d=l.getAttribute("Name")))&&mergeToPage(l,c,e,i),l=null):parseFont(l,e);else if(null!==(o=l.getAttribute("ScriptData"))&&""!==o){o=o.replace(/&#x0A;/g,"\n"),r=(r=l.getAttribute("Name")).substring(r.indexOf("_")+1),null===(a=l.getAttribute("ScriptParam"))&&(a="");var g=null;if(null!==(a=replace(a,"//",""))&&""!==a)g=a.split(",");o="var page=pages[this.pageName]; if(page.PageMode()!=0) return;"+o,p=null!==g?new Function(g,o):new Function(o),"OnClick"==r&&(r="JScr_"+r),p.thePageName=i,e[r]=p,r.endsWith("Get")&&(e["attr_"+(d=r.replace("Get",""))]=null,e[d]=createSetterGetterTech(d)),r.endsWith("Set")&&(e["attr_"+(d=r.replace("Set",""))]=null,e[d]=createSetterGetterTech(d)),p=null}}function createSetterGetter(t){var e="attr_"+t;return function(t){if(!arguments.length)return this[e];this[e]=t}}function createSetterGetterTech(t){var e="attr_"+t,n=t+"Set",i=t+"Get";return function(t){if(2!=pages[this.thePageName].PageMode())return arguments.length?void(this[n]?this[n](t):this[e]=t):this[i]?this[i]():this[e]}}function setXMLAttrSetOnObj(t,e){for(var n=null,i="",r=t.length,o=0;o<r;o++)if(n=t[o].name,i=t[o].value.replace(/\\/g,"/").replace(/&lt;/g,"<").replace(/&gt;/g,">"),void 0===e["attr_"+n])e["attr_"+n]=i,e[n]=createSetterGetter(n);else{if("Items"==n){e[n].SetText(i);continue}if("Lines"==n){e[n].SetText(i);continue}e[n](i)}}function setXMLAttrSetOnObjNew(t,e,n){for(var i=getSystemObjectNode(e).cloneNode(!0),r=(i.attributes,0),o=n.length;r<o;r++)i.setAttribute(n[r].name,n[r].value);setXMLAttrSetOnObj(i.attributes,t)}function getSystemObjectNode(t){if(null===systemLibary&&loadSystemLib(),uncoveredSystemObjects[t])return uncoveredSystemObjects[t];for(var e=findNode(t,systemLibary),n=[];null!==e&&(n.push(e),"Library"!=e.nodeName);)e=e.parentNode;for(var i=systemLibary.ownerDocument.createElement(t),r=n.length-1;r>-1;r--)mergeChildParentSysLibary(i,n[r]);return uncoveredSystemObjects[t]=i,i}function mergeChildParentSysLibary(t,e){if(e.childNodes&&e.childNodes.length>0)for(var n,i,r=e.childNodes.length,o=null,a=0;a<r;a++)"SubClass"!=(i=e.childNodes[a]).nodeName&&(null===(o=i.getAttribute("AttrVisible"))||"1"==o?"1280"!=i.getAttribute("AttrData")&&"Font"!=i.getAttribute("Name")&&(n=null===(n=i.getAttribute("DefaultValue"))?"":n,t.setAttribute(i.getAttribute("Name"),n)):"0"==i.getAttribute("AttrVisible")&&t.removeAttribute(i.getAttribute("Name")))}function getIdeaObjForNodeType(t,e,n,i,r,o,a){var s=null;switch(r=AnyToBool(r),t=t.toLowerCase()){case"tstdimage":case"tideaimage":return null!=r&&""!=r&&0!=r?createFocusableImage(e,n,i):createImage(e,n,i);case"tstdpicture":return createPicture(e,n,i);case"tstdflipcard":return createFlipCard(e,n,i);case"tstdtextflipcard":return createTextFlipCard(e,n,i);case"tstdtextoverpic":return createTextOverPic(e,n,i);case"tstdtile":return createTile(e,n,i);case"tstdtilepanel":return createTilePanel(e,n,i);case"tstdzoomimg":return createZoomImg(e,n,i);case"tstdpdflink":return createPDFLink(e,n,i);case"tstdtrriched":case"ttransrichedit":return createTTransRichEdit(e,n,i);case"tstdbackground":case"tibackground":return createBackground(e,n,i);case"tlabel":case"tstdlabel":case"tslabel":case"tskinlabel":return null!=r&&""!=r&&0!=r?createFocusableLabel(e,n,i):createLabel(e,n,i);case"tstdbmpbutton":case"tepbmpbutton":return null!=r&&""!=r&&0!=r?createFocusableBMPButton(e,n,i):createBMPButton(e,n,i);case"tstdpanel":case"tpanel":case"tskinpanel":case"tspanel":case"titransparentpanel":case"tstdtranspanel":return createPanel(e,n,i);case"tsplitcontainer":case"tstdsplitcontainer":return createSplitContainer(e,n,i);case"tframedlabel":case"tstdframedlabel":return createFramedLabel(e,n,i);case"tstdform":return createForm(e,n,i);case"tstdlangcomp":return createLangComp(e,n,i);case"tideahtmlviewer":case"tstdhtmlviewer":return createHTMLViewer(e,n,i);case"tstdbutton":case"tbutton":case"tskinbutton":case"tsbutton":return createButton(e,n,i);case"tstdjbutton":return createjButton(e,n,i);case"tstdbitbtn":case"tbitbtn":case"tsbitbtn":case"tskinbitbtn":return createBitBtn(e,n,i);case"tstdcssbutton":return createTStdCssButton(e,n,i);case"tstdspinbutton":return createTStdSpinButton(e,n,i);case"tstdjqslider":return createTStdjqSlider(e,n,i);case"tstdspeedbutton":case"tspeedbutton":case"tspeedbutton":case"tskinspeedbutton":return createSpeedButton(e,n,i);case"tstdradiobutton":case"tradiobutton":case"tskinradiobutton":case"tsradiobutton":return null!=r&&""!=r&&0!=r?createFocusRadioButton(e,n,i):createRadioButton(e,n,i);case"tstdcheckbox":case"tideacheckbox":case"tskincheckbox":case"tsideacheckbox":case"tcheckbox":return createCheckBox(e,n,i);case"tstdedit":case"tedit":case"tskinedit":case"tsedit":return createEdit(e,n,i);case"tstdpasswordedit":return createPasswordEdit(e,n,i);case"tstdlistbox":case"tidealistbox":case"tskinlistbox":case"tsidealistbox":return createListBox(e,n,i);case"tstdnavigationlist":case"tnavigationlist":return createNaviElementList(e,n,i);case"tstdcombobox":case"tideacombobox":case"tskincombobox":case"tcombobox":return createComboBox(e,n,i);case"tstdideatimer":case"tideatimer":return createTimer(e,n,i);case"tstdflashplayer":case"tideaflash":return createFlashPlayer(e,n,i);case"tstdmemo":case"tmemo":case"tskinmemo":case"tsmemo":return createMemo(e,n,i);case"tstdtreeview":case"tideatreeview":case"tskintreeview":case"tsideatreeview":return createTreeView(e,n,i);case"tstdscenario":case"tscenario":return createScenario(e,n,i);case"tstdpageaction":case"tpageaction":return createPageaction(e,n,i);case"thotspot":case"tstdhotspot":return createHotSpot(e,n,i);case"tiplaudio":case"tstdaudiocomment":return createAudioComment(e,n,i);case"tiplvideo":case"tstdvideocomment":return createVideoComment(e,n,i);case"mobilesidemenuebutton":return createMobileSideMenueButton(e,n,i);case"texttreeview":case"tstdexttreeview":return createExtTreeView(e,n,i);case"tstdslider":return createTStdSlider(e,n,i);case"tideaflashvideoplayer":case"tstdflashvideoplayer":return createVideoFlashPlayer(e,n,i);case"titimeline":case"tstdtimeline":case"tijspraesentation":return createTimeline(e,n,i);case"tideamouse":case"tstdideamouse":return createIdeaMouse(e,n,i);case"tiieviewer":case"tstdieviewer":return createHTMLViewer(e,n,i);case"titextbubble":case"tstdtextbubble":return(s=createFramedLabel(e,n,i)).FrameWidth(1),s.ShowFrame(1),s;case"tstdmobileheaderbutton":return createHeaderButton(e,n,i);case"tstdigroup":case"tstdcontrolgroup":case"tigroup":case"tcontrolgroup":return createTPanel(e,n,i);case"tstdheadercontrolgroup":case"theadercontrolgroup":return createTPanel(e,n,i);case"tlayoutcontainer":return createLayoutContainer(e,n,i);case"tlayoutpane":case"tlayoutleftpanel":case"tlayoutrightpanel":return createLayoutPane(e,n,i);case"tstdpptviewer":case"tipptviewer":return createPPTViewer(e,n,i);case"tipdfviewer":case"tstdpdfviewer":return createPDFViewer(e,n,i);case"tstdcmviewer":return createCMViewer(e,n,i);case"tstdsoapelement":case"tsoapelement":return createSoapElement(e,n,i);case"tstdsoapelement":case"tsoapparameter":return createSoapParameter(e,n,i);case"tstdextsoapelement":case"textsoapelement":return createExtSoapElement(e,n,i);case"tstdxmlelement":case"txmlelement":return createXMLElement(e,n,i);case"tsoapresponse":case"tsoaprespone":return createSoapResponse(e,n,i);case"tmagicframe":return createTMagicFrame(e,n,i);case"tstdlistview":return createPanel(e,n,i);case"tstdgrid":return createTStdGrid(e,n,i);case"tstdmenu":return createTStdMenu(e,n,i);case"tstdcontextmenu":return createTStdContextMenu(e,n,i);case"tstdtoolbar":return createTStdToolBar(e,n,i);case"tstdactionlist":return createActionList(e,n,i);case"tstdprocedurelist":return createProcedureList(e,n,i);case"tstdaccordion":return createTStdAccordion(e,n,i);case"tstdaccordion2":return createTStdAccordion2(e,n,i);case"tstdaccordion3":return createTStdAccordion3(e,n,i);case"tstdextjstreeview":return createExtJSTreeView(e,n,i,a);case"tstdvector":return createVector(e,n,i);case"tstdhtmledit":return createHTMLEdit(e,n,i);case"tstdscripteditor":return createScriptEditor(e,n,i);case"tstdhtml5videoplayer":case"thtml5videoplayer":return createVideoPlayer(e,n,i,a);case"tstdcustomvideoplayer":return createCustomVideoPlayer(e,n,i);case"tstdaudioplayer":case"taudioplayer":return createAudioPlayer(e,n,i);case"tstdattributepanel":return createTStdAttributePanel(e,n,i);case"tstdmobileslider":case"tmobileslider":return createMobileSlide(e,n,i);case"tstdmobileflipbutton":case"tmobileflipbutton":return createMobileFlipButton(e,n,i);case"tmobilepageeditor":return createmobilePageEditor(e,n,i);case"tstdexplorer":return createTStdExplorer(e,n,i);case"tstdmobileheader":case"tmobileheader":return createHeader(e,n,i);case"tstdmobileinternalheader":case"tmobileinternalheader":return createInternalHeader(e,n,i);case"tstdmobilefooter":case"tmobilefooter":return createFooter(e,n,i);case"tstdmobilenavbar":case"tmobilenavbar":return createNavbar(e,n,i);case"tstdmobilenavbarelement":case"tmobilenavbarelement":return createNavbarElement(e,n,i);case"tstdmobileheaderbutton":return createMobileHeaderButton(e,n,i);case"tstdtabbar":case"tideatabbar":return createTStdTabBar(e,n,i);case"tstdmobilescrollview":return createMobileScrollView(e,n,i);case"tstdmobilespacer":return createMobileSpacer(e,n,i);case"tstdclickpresiassi":return createClickPresiAssi(e,n,i);case"tstdaudiotimepresiassi":return createAudioTimePresiAssi(e,n,i);case"tstdelementlist":return createElementList(e,n,i);case"tstdideashape":return createShape(e,n,i);case"tstdtable":return createTStdTable(e,n,i);case"tstdsortablelist":return createSortableList(e,n,i);case"tstdgroup":return createGroup(e,n,i);default:return s=new createVisibleObject(e,n,i)}}function parseCourseXML(){projectXML=httpObject.responseXML}function closePage(t){var e=(t=AnyToObject(t)).Name();if(null!==t&&null!==t.childes){audio.currentObj=null,audio.cwp&&AudioStop(),t.onpgclose();var n=$("toolTipBox");null!==n&&hideToolTip(n.parent)}null!=t&&(pages[e],delete pages[e])}function isComplexNodeName(t){return-1!=t.indexOf(".")}function findSimpleNode(t,e){var n=null,i=e.getAttribute("Name");if(null!=i)var r=i;else r="";var o=t;if(r=r.toLowerCase(),o=o.toLowerCase(),i==t||r==o)return e;for(var a=e.firstChild;null!==a;a=a.nextSibling){if(null!==(n=findSimpleNode(t,a)))return n;n=null}return null}function serializeNode(t){if("undefined"!=typeof XMLSerializer)try{return(new XMLSerializer).serializeToString(t)}catch(t){}if(void 0!==t.xml)return t.xml;if("undefined"!=typeof printNode)return printNode(t);if("undefined"==typeof Packages)return"";try{var e=new java.io.StringWriter;return Packages.org.apache.batik.dom.util.DOMUtilities.writeNode(t,e),e.toString()}catch(t){return""}}function getXMLAttribute(){}function findNode(t,e){var n=null;if(isComplexNodeName(t)){var i=t.split(".");n=e;for(var r=findSimpleNode,o=0;o<i.length&&null!==n;o++)n=r(i[o],n)}else n=findSimpleNode(t,e);return n}function isdDefPropOnObject(t,e){return void 0!==e[t]}function evalAttr(t,e,n,i){return e&&t?isDefPropOnObject(t,e)?e[t]:n?e[t]=i||{}:void 0:null}function evalProp(t,e,n,i){e["attr_"+t]=i,e[t]=createSetterGetter(t),func=null}function invokeFunc(t,e,n){t?t[e](n):Window[e](n)}function getRelX(t){return void 0===t.layerX&&(t.layerX=t.offsetX),t.layerX}function getRelY(t){return void 0===t.layerX&&(t.layerX=t.offsetX),void 0===t.layerY&&(t.layerY=t.offsetY),t.layerY}function nextPage(){openPage(marker.nextSibling.getAttribute("Name"))}function addCssClasses(t,e,n,i,r){var o=t+"_"+n.Name(),a=r?e:e+"_"+n.Name();if(""!==t&&addClass(n.obj,o),addClass(n.obj,a),""!==i)for(var s=i.split(","),l=0;l<s.length;l++)addClass(n.obj,a+"_"+s[l]),""!==t&&addClass(n.obj,o+"_"+s[l])}function isNumber(t){return!isNaN(t)&&""!==t}function isString(t){return"string"==typeof t}function KeyValue(t,e){this.key=t,this.value=e}function HashMap(){this.inheritFrom=Array,this.inheritFrom()}function findPageInPageLib(t,e){void 0===e&&(e="TIdeaPage"),t=t.replace(/Seiten./g,"");var n=PageLibrary.getElementsByTagName(e);if(""===t&&n.length>0)return n[0];for(var i=n.length,r=0;r<i;r++)if(n[r].getAttribute("Name").toLowerCase()==t.toLowerCase())return n[r];return null}function calculateRelMouseCord(t){var e=new Object;return t.offsetX?(e.posx=t.offsetX,e.posy=t.offsetY):(e.posx=t.layerX,e.posy=t.layerY),e}function convertMouseParams(t){var e;return(e=mouseCoords(t)).shiftState=mouseButton(t),e}function checkIfEventInside(t,e){if(!n)var n=window.event;var i=window.event?n.srcElement:n.target;if("DIV"==i.nodeName){for(var r=n.relatedTarget?n.relatedTarget:n.toElement;r!=i&&"BODY"!=r.nodeName;)r=r.parentNode;return r==i||void 0}}function getAbsScreenCoord(t){for(var e=t,n=0,i=0;null!==e&&"BODY"!=e.nodeName;)n+=e.offsetLeft,i+=e.offsetTop,e=e.offsetParent;i+=document.body.scrollTop,n+=document.body.scrollLeft;var r=new Object;return r.x=n,r.y=i,r}function getRelCoordOnParent(t,e,n){var i=n.x,r=n.y,o=($(o),$(t)),a=$(e);if(o==a)return n;if(null==o.offsetParent)return n;for(o.offsetParent;null!==o&&o!=a;)i+=getAbsScreenCoord(o).x-getAbsScreenCoord(o.offsetParent).x,r+=getAbsScreenCoord(o).y-getAbsScreenCoord(o.offsetParent).y,o=o.offsetParent;return n.x=i,n.y=r,n}function mouseButton(t){var e=0;if(t.altKey&&(e+=2),t.ctrlKey&&(e+=4),t.shiftKey&&(e+=1),!t)t=window.event;return t.which?2==t.which||3==t.which?(2==t.which&&(e+=32),3==t.which&&(e+=16)):e+=8:t.button&&(2==t.button||4==t.button?(2==t.button&&(e+=32),4==t.button&&(e+=16)):e+=8),e}function init_System_Vars_Ex(t){SetVariableEx("System","Phone",0,t),SetVariableEx("System","Tablet",0,t),SetVariableEx("System","Desktop",1,t),SetVariableEx("System","Touchdevice",isTouchDevice?1:0,t),SetVariableEx("System","HPIScreen",0,t),SetVariableEx("System","Orientation",jQuery(window).width()>jQuery(window).height()?0:1,t),jQuery(window).bind("orientationchange",function(t){window.setTimeout(external_rotate,500)}),jQuery(window).bind("message",function(t){null!=t.data&&"orientationChanged"==t.data.id&&window.setTimeout(external_rotate,500)}),jQuery(window).bind("resize",function(t){window.setTimeout(checkOrientation,500)})}function checkOrientation(){GetVariableEx("System","Orientation",0,"Variablen")!=(jQuery(window).width()>jQuery(window).height()?0:1)&&external_rotate()}function external_rotate(){var t=jQuery(window).width()>jQuery(window).height()?0:1;SetVariableEx("System","Orientation",t,"Variablen"),jQuery(".IdeaComponent").each(function(e){var n=this.obj,i=this.pageName,r=pages[i][n];r.OnOrientationChange&&null!=r.OnOrientationChange&&r.OnOrientationChange(t)})}function mouseCoords(t){var e=new Object;if(void 0===t.layerX&&(t.layerX=t.offsetX),void 0===t.layerY&&(t.layerY=t.offsetY),e.x=t.layerX,e.y=t.layerY,null!=t.clientX?e.Absx=t.clientX:(e.Absx=t.pageX,t.clientX=t.pageX),null!=t.clientY?e.Absy=t.clientY:(e.Absy=t.pageY,t.clientY=t.pageY),null!=t.touches&&null!=t.touches.item){var n=t.touches.item(0);null!=n&&(null!=n.clientX?(e.Absx=n.clientX,t.clientX=n.clientX,t.pageX=n.clientX):null!=n.pageX&&(e.Absx=n.pageX,t.clientX=n.pageX,t.pageX=n.pageX),null!=n.clientY?(e.Absy=n.clientY,t.clientY=n.clientY,t.pageY=n.clientY):null!=n.pageY&&(e.Absy=n.pageY,t.pageY=n.pageY,t.clientY=n.pageY),void 0===n.layerX?void 0===n.offsetX?(e.x=n.clientX,t.layerX=n.clientX):(e.x=n.offsetX,t.layerX=n.offsetX):e.x=n.layerX,void 0===n.layerY?void 0===n.offsetY?(e.y=n.clientY,t.layerY=n.clientY):(e.y=n.offsetY,t.layerY=n.offsetY):e.y=n.layerY)}return t.idea&&(t.idea.mouseCords=e),e}function convertKeyEventParams(t){var e,n=new Object;return t.keyCode?e=t.keyCode:t.which&&(e=t.which),n.keyValue=e,n.shiftState=0,t.altKey&&(n.shiftState+=2),t.ctrlKey&&(n.shiftState+=4),t.shiftKey&&(n.shiftState+=1),t.idea&&(t.idea.keyParams=n),n}function stopPropagation(t){t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation()}function createNode(t,e){var n=null;return null===(n=findNode(t,e))&&((n=e.ownerDocument.createElement("TMetavariables")).setAttribute("Name",t),e.appendChild(n)),n}function isTouchDevice(){if(null==window.IDEA_ISTOUCH){var t=document.createElement("div");t.setAttribute("ontouchstart","return;"),"function"==typeof t.ontouchstart?window.IDEA_ISTOUCH=!0:window.navigator.pointerEnabled&&window.navigator.maxTouchPoints?window.IDEA_ISTOUCH=!0:window.IDEA_ISTOUCH=!1}return window.IDEA_ISTOUCH}function init_EventDelegation(){var t=addEvent,e=window.navigator.userAgent;msi=e.indexOf("MSIE ")>-1||e.indexOf("Trident/")>-1||e.indexOf("Edge/")>-1,msi,t(document.documentElement,"touchstart",ICompsEvent.onEvent),t(document.documentElement,"touchmove",ICompsEvent.onEvent),t(document.documentElement,"touchend",ICompsEvent.onEvent),t(document.documentElement,"mousedown",ICompsEvent.onEvent),t(document.documentElement,"mouseup",ICompsEvent.onEvent),t(document.documentElement,"mousemove",ICompsEvent.onEvent),t(document.documentElement,"dblclick",ICompsEvent.onEvent),t(document.documentElement,"mouseover",ICompsEvent.onEvent),t(document.documentElement,"mouseout",ICompsEvent.onEvent),t(document.documentElement,"keypress",ICompsEvent.onEvent),t(document.documentElement,"keydown",ICompsEvent.onEvent),t(document.documentElement,"keyup",ICompsEvent.onEvent),IS.IE()?(t(document.documentElement,"focusin",ICompsEvent.onEvent),t(document.documentElement,"focusout",ICompsEvent.onEvent)):(document.documentElement.addEventListener("focus",ICompsEvent.onEvent,!0),document.documentElement.addEventListener("blur",ICompsEvent.onEvent,!0)),t(document.documentElement,"contextmenu",ICompsEvent.onEvent),t(document.documentElement,"change",ICompsEvent.onEvent),t(document.documentElement,"webkitTransitionEnd",ICompsEvent.onEvent),t(document.documentElement,"oTransitionEnd",ICompsEvent.onEvent),t(document.documentElement,"transitionend",ICompsEvent.onEvent)}function deinit_EventDelegation(){var t=removeEvent;t(document.documentElement,"touchstart",ICompsEvent.onEvent),t(document.documentElement,"touchmove",ICompsEvent.onEvent),t(document.documentElement,"touchend",ICompsEvent.onEvent),t(document.documentElement,"dblclick",ICompsEvent.onEvent),t(document.documentElement,"mousedown",ICompsEvent.onEvent),t(document.documentElement,"mouseup",ICompsEvent.onEvent),t(document.documentElement,"mouseover",ICompsEvent.onEvent),t(document.documentElement,"mouseout",ICompsEvent.onEvent),t(document.documentElement,"mousemove",ICompsEvent.onEvent),t(document.documentElement,"keypress",ICompsEvent.onEvent),t(document.documentElement,"keydown",ICompsEvent.onEvent),t(document.documentElement,"keyup",ICompsEvent.onEvent),IS.IE()?(t(document.documentElement,"focusin",ICompsEvent.onEvent),t(document.documentElement,"focusout",ICompsEvent.onEvent)):(document.documentElement.removeEventListener("focus",ICompsEvent.onEvent,!0),document.documentElement.removeEventListener("blur",ICompsEvent.onEvent,!0)),t(document.documentElement,"contextmenu",ICompsEvent.onEvent),t(document.documentElement,"change",ICompsEvent.onEvent),t(document.documentElement,"webkitTransitionEnd",ICompsEvent.onEvent),t(document.documentElement,"oTransitionEnd",ICompsEvent.onEvent),t(document.documentElement,"transitionend",ICompsEvent.onEvent)}function Node(t,e,n,i,r,o,a,s){this.id=t,this.pid=e,this.name=n,this.info=i,this.xmlNode=s,this.icon=r,this.iconOpen=o,this._io=a||!1,this._is=!1,this._ls=!1,this._hc=!1,this._ai=0,this._p,this.childs=0,this.depth=0,this.folder=url_libs+IDEAFOLDERICON,this.folderOpen=url_libs+IDEAFOLDEROPENICON,this.node=url_libs+IDEAPAGEICON}function IdeaTree(t,e){this.config={target:null,folderLinks:!0,useSelection:!0,useLines:!0,useIcons:!0,useButtons:!0,useStatusText:!1,closeSameLevel:!1,inOrder:!1,backgroundColor:"#000066",hlbackgroundColor:"#FFFFFF",lastTabIndex:-1,Class:"IdeaTree",SmallIcons:!1},this.icon={root:url_libs+IDEABASEICON,folder:url_libs+IDEAFOLDERICON,folderOpen:url_libs+IDEAFOLDEROPENICON,node:url_libs+IDEAPAGEICON,empty:url_libs+IDEAEMPTYGIF,line:url_libs+IDEALINEICON,join:url_libs+IDEAJOINICON,joinBottom:url_libs+IDEAJOINBOTTOMICON,plus:url_libs+IDEAPLUSICON,plusBottom:url_libs+IDEAPLUSBOTTOMICON,minus:url_libs+IDEAMINUSICON,minusBottom:url_libs+IDEAMINUSBOTTOMICON,nlPlus:url_libs+IDEANOLINESPLUSICON,nlMinus:url_libs+IDEANOLINESMINUSICON},this.obj=t,this.pageName=e,this.nodes=[],this.aIndent=[],this.root=new Node(-1,-2),this.selectedNode=null,this.selectedFound=!1,this.completed=!1}function dummy(){}function LTrim(t){return t.replace(/\s*((\S+\s*)*)/,"$1")}function RTrim(t){return t.replace(/((\s*\S+)*)\s*/,"$1")}function DeleteAllStyle(t){var e=t.style;for(var n in e)if(/string|number/i.test(typeof e[n]))try{e[n]=""}catch(t){}}function AndClass(t,e,n){this.key=t,this.wert=e,this.gleich=n}function OrClass(t,e){this.wert=e,this.key=t}function ProtocollItems(t){this.recordTyp=t.split(",")[0],this.date=t.split(",")[1],this.time=t.split(",")[2],"0"!=this.recordTyp&&("2"==this.recordTyp?this.pageName=t.split(",")[4]:(this.duration=t.split(",")[3],"1"!=this.recordTyp&&(this.pageName=t.split(",")[4],"4"!=this.recordTyp&&"5"!=this.recordTyp&&"6"!=this.recordTyp||(this.errorValue=t.split(",")[5],this.points=t.split(",")[7],this.trials=t.split(",")[6])))),null!=this.pageName&&(this.pageName=replace(this.pageName,'"',""),this.pageName=this.pageName.toUpperCase())}function CIdeaProtocoll(){}IdeaTree.prototype.add=function(t){this.nodes[this.nodes.length]=t},IdeaTree.prototype.openAll=function(){this.oAll(!0)},IdeaTree.prototype.closeAll=function(){this.oAll(!1)},IdeaTree.prototype.clear=function(t){this.nodes.length=0},IdeaTree.prototype.toString=function(){var t=[];return t.push('<div id="'),t.push(this.obj),t.push("Tree"),t.push('" class="'+this.config.Class+'">\n'),document.getElementById?t.push(this.addNode(this.root)):t.push("Browser not supported."),t.push("</div>"),this.selectedFound||(this.selectedNode=null),this.completed=!0,t.join("")},IdeaTree.prototype.addNode=function(t){for(var e,n=[],i=this.nodes.length,r=this.nodes,o=0;o<i&&(r[o].pid!=t.id||((e=r[o])._p=t,e._ai=o,this.setCS(e),this.config.useSelection&&e.id==this.selectedNode&&!this.selectedFound&&(e._is=!0,this.selectedNode=o,this.selectedFound=!0),n.push(this.createNode(e,o)),!e._ls));o++);return n.join("")},IdeaTree.prototype.createNode=function(t,e){var n=[];return n.push('<div class="dTreeNode" tabIndex="-1" onenter="javascript:pages[\''+this.pageName+"']['"+this.obj),n.push("']._onent();\" onexit=\"javascript:pages['"+this.pageName+"']['"+this.obj+"']._onext();\" onmousedown=\"javascript:pages['"+this.pageName+"']['"+this.obj),n.push("']._msdown(event);\" onmousedown=\"javascript:pages['"+this.pageName+"']['"+this.obj+'\']._msup(event);" onmouseover="javascript:'),n.push("pages['"+this.pageName+"']['"+this.obj+"']._msenter(event);\" onmouseout=\"javascript:pages['"+this.pageName+"']['"+this.obj+"']._msexit;\" onmousemove=\"javascript:pages['"+this.pageName+"']['"+this.obj),n.push("']._msmove(event);\" onkeypress=\"javascript:pages['"+this.pageName+"']['"+this.obj+"']._keypressed(event,"+e+');" onkeyup="javascript:'),n.push("pages['"+this.pageName+"']['"+this.obj+"']._keyreleased(event,"+e+');" onkeydown="javascript:pages[\''+this.pageName+"']['"+this.obj+"']._keytyped(event,"+e+');" ondblclick="javascript:stopPropagation(event);'),n.push("pages['"+this.pageName+"']['"+this.obj+"']._ondblclk();return false;\" onclick=\"javascript:stopPropagation(event);pages['"+this.pageName+"']['"+this.obj+"']._onclk();return false;\">"+this.indent(t,e)),this.config.useIcons&&(t.icon||(t.icon=t._hc?this.icon.folder:this.icon.node),t.iconOpen||(t.iconOpen=t._hc?this.icon.folderOpen:this.icon.node),n.push('<img  tabindex="-1" id="i'+this.obj+e+'" src="'+(t._io?t.iconOpen:t.icon)+'" alt="" />')),t.info?(n.push('<a tabIndex="'+this.config.lastTabIndex+'" id="s'+this.obj+e+'" class="'+(this.config.useSelection&&t._is?"nodeSel":"node")+'"  href="javascript:void(0)" '),t.title&&n.push(' title="'+t.title+'"'),this.config.useSelection&&(t._hc&&this.config.folderLinks||!t._hc)&&n.push(' onclick="javascript: stopPropagation(event);'),n.push((t._hc?"pages['"+this.pageName+"']['"+this.obj+"'].tree.o("+e+");":"dummy();")+"pages['"+this.pageName+"']['"+this.obj+"'].tree.s("+e+",1);return false;"),n.push('"'),n.push(">")):this.config.folderLinks&&t.url||!t._hc||t.pid==this.root.id||n.push('<a tabIndex="'+this.config.lastTabIndex+'" onclick="javascript:pages[\''+this.pageName+"']['"+this.obj+"'].tree.o("+e+');" class="node">'),n.push(t.name),!t.info&&(this.config.folderLinks&&t.info||!t._hc)||n.push("</a>"),n.push("</div>"),t._hc&&(n.push('<div tabindex="-1" id="d'+this.obj+e+'" class="clip" style="display:'+(this.root.id==t.pid||t._io?"block":"none")+';">'),n.push(this.addNode(t)),n.push("</div>")),this.config.lastTabIndex++,this.aIndent.pop(),n.join("")},IdeaTree.prototype.indent=function(t,e){var n=16;this.config.SmallIcons&&(n=8);for(var i=[],r=0;r<this.aIndent.length;r++)i.push('<img src="'+(1==this.aIndent[r]&&this.config.useLines?this.icon.line:this.icon.empty)+'" alt="" width="'+n+'"/>');return t._ls?this.aIndent.push(0):this.aIndent.push(1),t._hc?(i.push('<a tabindex="-1" href="javascript:void(0)" onclick="javascript: stopPropagation(event); pages[\''+this.pageName+"']['"+this.obj+"'].tree.o("+e+"); pages['"+this.pageName+"']['"+this.obj+"'].tree.s("+e+',1);return false;">'),this.config.useButtons?(i.push('<img id="j'+this.obj+e+'" src="'),this.config.useLines?i.push(t._io?t._ls&&this.config.useLines?this.icon.minusBottom:this.icon.minus:t._ls&&this.config.useLines?this.icon.plusBottom:this.icon.plus):i.push(t._io?this.icon.nlMinus:this.icon.nlPlus),i.push('" alt="" /></a>')):i.push("</a>")):this.config.useButtons&&i.push('<img src="'+(this.config.useLines?t._ls?this.icon.joinBottom:this.icon.join:this.icon.empty)+'" width="'+n+'" alt="" />'),i.join("")},IdeaTree.prototype.setCS=function(t){var e;_l=this.nodes.length,_tn=this.nodes;for(var n=0;n<_l;n++)_tn[n].pid==t.id&&(t._hc=!0),_tn[n].pid==t.pid&&(e=_tn[n].id);e==t.id&&(t._ls=!0)},IdeaTree.prototype.getSelected=function(){return this.selectedNode},IdeaTree.prototype.s=function(t,e,n){if(this.config.useSelection&&(t<0&&(t=0),t>this.nodes.length-1&&(t=this.nodes.length-1),!this.nodes[t]._hc||this.config.folderLinks)){var i=null,r=null,o=this.selectedNode==t;if(!o){if((this.selectedNode||0==this.selectedNode)&&(r=document.getElementById("s"+this.obj+this.selectedNode)))try{r.className=this.nodeClass,DeleteAllStyle(r),r.className="node"}catch(t){}i=document.getElementById("s"+this.obj+t);try{i.className=this.nodeClass,i.focus(),i.style.backgroundColor=this.config.hlbackgroundColor,i.style.color=this.config.hlColor}catch(t){}this.selectedNode=t,n&&pages[this.pageName][this.obj]._onchng()}n||!e&&!o||pages[this.pageName][this.obj]._onclk()}},IdeaTree.prototype.o=function(t){var e=this.nodes[t];this.nodeStatus(!e._io,t,e._ls),e._io=!e._io,this.config.closeSameLevel&&this.closeLevel(e)},IdeaTree.prototype.oAll=function(t){for(var e=this.nodes.length,n=this.nodes,i=0;i<e;i++)n[i]._hc&&(this.nodeStatus(t,i,n[i]._ls),n[i]._io=t)},IdeaTree.prototype.openTo=function(t,e,n){if(!n)for(var i=0;i<this.nodes.length;i++)if(this.nodes[i].id==t){t=i;break}var r=this.nodes[t];r._p&&(r._io=!0,r._is=e,this.completed&&r._hc&&this.nodeStatus(!0,r._ai,r._ls),this.completed&&e?this.s(r._ai):e&&(this._sn=r._ai),r.pid!=this.root.id&&this.openTo(r._p._ai,!1,!0))},IdeaTree.prototype.closeLevel=function(t){for(var e=0;e<this.nodes.length;e++)this.nodes[e].pid==t.pid&&this.nodes[e].id!=t.id&&this.nodes[e]._hc&&(this.nodeStatus(!1,e,this.nodes[e]._ls),this.nodes[e]._io=!1,this.closeAllChildren(this.nodes[e]))},IdeaTree.prototype.closeAllChildren=function(t){for(var e=0;e<this.nodes.length;e++)this.nodes[e].pid==t.id&&this.nodes[e]._hc&&(this.nodes[e]._io&&this.nodeStatus(!1,e,this.nodes[e]._ls),this.nodes[e]._io=!1,this.closeAllChildren(this.nodes[e]))},IdeaTree.prototype.nodeStatus=function(t,e,n){var i=document.getElementById("d"+this.obj+e),r=document.getElementById("j"+this.obj+e);this.config.useIcons&&""!=this.nodes[e].iconOpen&&""!=this.nodes[e].icon&&(document.getElementById("i"+this.obj+e).src=t?this.nodes[e].iconOpen:this.nodes[e].icon);null!=r&&(r.src=this.config.useLines?t?n?this.icon.minusBottom:this.icon.minus:n?this.icon.plusBottom:this.icon.plus:t?this.icon.nlMinus:this.icon.nlPlus),i.style.display=t?"block":"none"},IdeaTree.prototype.fillNodes=function(t,e){for(var n=[],i=e.split("\n"),r=0,o=null,a=0,s=i.length;r<s;r++)if(i[r]=replace(i[r],"\r",""),""!=i[r]){if((o=this.readNodeInfo(i[r],r)).id=r,o.pid=t.id,o.depth=a,t.childs++,r+1<i.length){for(a=0;"\t"==i[r+1].charAt(a);)a++;if(a>n.length)n.push(t),t=o;else if(a<n.length)do{t=n.pop()}while(a<n.length)}this.add(o)}},IdeaTree.prototype.readNodeInfo=function(t,e){t=replace(t,"\t","");for(var n=[],i=0,r=0;i<t.length;){var o;if('"'==t.charAt(i))if((o=t.indexOf('"',i+1))>=i)n[r]=t.substring(i+1,o),i=o+2;else{if(!((o=t.indexOf(",",i+1))>=0))return;n[r]=t.substring(i,o),i=o+1}else(o=t.indexOf(",",i))>=0?(n[r]=t.substring(i,o),i=o+1):(n[r]=t.substring(i),i=t.length);r++}return new Node(e,0,replace(n[0],'"',""),n[1]?n[1]:" ")},IdeaTree.prototype.fillNodesfromXML=function(t,e,n,i){for(var r,o,a,s,l=e.childNodes.length,d=0;d<l;d++)null==(a=(o=e.childNodes[d]).attributes.getNamedItem("Caption"))&&(a=o.attributes.getNamedItem("caption")),null==a&&(a=o.attributes.getNamedItem("Name")),null==a&&(a=o.attributes.getNamedItem("name")),s=a.value,a=o.attributes,"",(r=new Node(n,0,s,o.xml?o.xml:serializeNode(o))).xmlNode=o,r.id=n,r.pid=t.id,r.depth=i,t.childs++,this.add(r),n++,o.hasChildNodes()&&(n=this.fillNodesfromXML(r,o,n,i+1));return n},void 0===String.prototype.trim&&(String.prototype.trim=function(t){return LTrim(RTrim(t))}),AndClass.prototype,OrClass.prototype={wert:null,key:null,getKey:function(){return this.key},getWert:function(){return this.wert}},ProtocollItems.prototype={duration:null,pageName:null,errorValue:null,points:null,trials:null,recordTyp:null,date:null,time:null,pageName:null,getRecordTyp:function(){return this.recordTyp},getDate:function(){return this.date},getTime:function(){return this.time},getDuration:function(){return this.duration},getPageName:function(){return this.pageName},getErrorValue:function(){return this.errorValue},getPoints:function(){return this.points},getTrials:function(){return this.trials},getAllItems:function(){var t=null,e=null,n=null,i=null,r=null,o=null;return e=null==this.getDuration()?",":this.getDuration()+",",i=null==this.getPageName()?",":this.getPageName()+",",n=null==this.getErrorValue()?",":this.getErrorValue()+",",r=null==this.getPoints()?",":this.getPoints()+",",o=null!=this.getTrials()?this.getTrials():"",t=this.getRecordTyp()+",",t+=this.getDate()+",",t+=this.getTime()+",","0"==this.getRecordTyp()?t+=i+e+n+r+o:"2"==this.getRecordTyp()?t+=i+e+n+r+o:("1"==this.getRecordTyp()||this.getRecordTyp(),t+=e+i+n+r+o),t},getItemAt:function(t){switch(t){case 0:return this.recordTyp;case 1:return this.date;case 2:return this.time;case 3:return this.duration;case 4:return this.pageName;case 5:return this.errorValue;case 6:return this.trials;case 7:return this.points}return""}},CIdeaProtocoll.prototype={protocollItemList:[],setProtocol:function(t){if(""!=t){for(var e=t.split("\n"),n=0;n<e.length;n++)if(""!=e[n]){var i=new ProtocollItems(e[n]);this.protocollItemList.push(i)}}else this.protocollItemList=[]},getProtocol:function(){for(var t=new StringBuffer,e=this.protocollItemList.length,n=0;n<e;n++){var i=this.protocollItemList[n];t=t.append(i.getRecordTyp()+","+i.getDate()+","+i.getTime()+","),t="0"==i.getRecordTyp()?t.append(",,,,\n"):"2"==i.getRecordTyp()?t.append(","+i.getPageName()+",,,\n"):"1"==i.getRecordTyp()?t.append(i.getDuration()+",,,,\n"):"3"==i.getRecordTyp()?t.append(i.getDuration()+","+i.getPageName()+",,,\n"):t.append(i.getDuration()+","+i.getPageName()+","+i.getErrorValue()+","+i.getPoints()+","+i.getTrials()+"\n")}return t.toString()},addToProtocol:function(t){var e=new ProtocollItems(t);this.protocollItemList.push(e)},sqlQuery:function(t){return(new SQLParser).doMySQLRequest(t)}};var IdeaProtocoll=new CIdeaProtocoll;function SQLParser(){}function setProjectPath(t){projectPath=t}function setExternalStartPage(t){externalStartPage=t}function ToolTip(t,e){ShowTip(t,e)}function ToolTipGlossary(t){ShowTipEx(t)}function ShowToolTip(Comment,fcolor,bgcolor,bordercolor,xpos,ypos,awidth,fadein,ballon){cmd='Tip("'+Comment+"\",BGCOLOR, '"+bgcolor+"', BORDERCOLOR,'"+bordercolor+"', FOLLOWMOUSE, true, FONTCOLOR, '"+fcolor+"', FONTFACE, 'Verdana', FONTSIZE, '10pt',STICKY, true, FIX, ["+xpos+","+ypos+"], WIDTH, "+awidth+", FADEIN, "+fadein+", FADEOUT, "+fadein,cmd+=ballon?", BALLOON, true, BALLOONSTEMWIDTH, 0, BALLOONSTEMHEIGHT, 0)":")",eval(cmd)}function GetChapterNode(t){t.lastIndexOf(".")>-1&&(t=t.substring(t.lastIndexOf(".")+1,t.length));var e=findPageInPageLib(t);return e=e.parentNode}function GetChapterCountOnSameLevel(t){var e=t.parentNode;return null!=e?e.childNodes.length:0}function GetChapterIndex(t){if(null==t)return-1;var e=t.parentNode,n=-1;if(null!=e){if(!e.hasChildNodes)return-1;var r=e.childNodes;for(i=0;i<r.length;i++)if(7!=r[i].nodeType&&r[i].getAttribute("Name")==t.getAttribute("Name")){n=i+1;break}}return n}function GetFirstPageInChapter(t){var e="";if(null!=t){var n=t.childNodes;n.length>0&&(e=0==n[0].childNodes.length?n[0].getAttribute("Name"):GetFirstPageInChapter(n[0]))}return e}function GetLastPageInChapter(t){var e="";if(null!=t){var n=t.childNodes;n.length>0&&(e=0==n[n.length-1].childNodes.length?n[n.length-1].getAttribute("Name"):GetFirstPageInChapter(n[n.length-1]))}return e}function GetPageInChapter(t,e){var n="";if(null!=t){var i=t.childNodes;i.length>=e-1&&(n=i[e-1].getAttribute("Name"))}return n}function GetPageCountOfChapter(t){return null!=t?x=t.childNodes:0}function GetChapterName(t){return t.getAttribute("Name")}function getParentNode(t){return t.parentNode}function SecondsBetween(t,e){var n=new Date(t.substring(0,4),t.substring(4,6),t.substring(6,8),t.substring(8,10),t.substring(10,12),t.substring(12,14)),i=new Date(e.substring(0,4),e.substring(4,6),e.substring(6,8),e.substring(8,10),e.substring(10,12),e.substring(12,14)),r=n.getTime()/1e3,o=i.getTime()/1e3;return Math.floor(o-r)}function getMiliseconds(){return(new Date).getTime()}function getActiveElement(){return obj=document.activeElement,obj=findIdeaObj(obj),null==obj||"@0"==obj?"@0":obj.obj}function timestamp2Date(t){var e=1*t,n=new Date;n.setTime(e);var i=n.getMonth()+1,r=n.getDate()+"."+i+"."+n.getFullYear(),o=n.getHours(),a=n.getMinutes(),s=n.getSeconds();return a<10&&(a="0"+a),s<10&&(s="0"+s),r+", "+(o+":"+a+":"+s)}function ProtocolExersiceList(){var t,e=null;t="SELECT Seitenname",e='Recordtyp="4"';var n=IdeaProtocoll.sqlQuery(t+" WHERE "+e);return t="SELECT Seitenname",e='Recordtyp="6"',n+=","+IdeaProtocoll.sqlQuery(t+" WHERE "+e)}function ProtocolExersiceInfo(t){var e,n=null;e="SELECT RecordTyp",n="Upper(Seitenname)=Upper("+t+")";var i=IdeaProtocoll.sqlQuery(e+" WHERE "+n);return e="SELECT Dauer",n="Upper(Seitenname)=Upper("+t+")",i+=","+IdeaProtocoll.sqlQuery(e+" WHERE "+n),e="SELECT Fehlerwert",n="Upper(Seitenname)=Upper("+t+")",i+=","+IdeaProtocoll.sqlQuery(e+" WHERE "+n),e="SELECT Datum,",n="Upper(Seitenname)=Upper("+t+")",i+=","+IdeaProtocoll.sqlQuery(e+" WHERE "+n),e="SELECT Zeit",n="Upper(Seitenname)=Upper("+t+")",i+=","+IdeaProtocoll.sqlQuery(e+" WHERE "+n)}function shr(t,e){return t>>=e}function shl(t,e){return t<<=e}function _findPosX(t){var e=0;if(t.offsetParent)for(;t.offsetParent;)e+=t.offsetLeft,t=t.offsetParent;else t.x&&(e=t.x);return e}function _findPosY(t){var e=0;if(t.offsetParent)for(;t.offsetParent;)e+=t.offsetTop,t=t.offsetParent;else t.y&&(e=t.y);return e}SQLParser.prototype={maxClauses:"3",fieldTokenId:"#",opTokenId:"&",condTokenId:"$",cmdTokenId:"$",select:"SELECT ",where:" WHERE ",maxFieldCount:8,maxOPCount:6,maxCondCount:2,maxCmdCount:3,selectType:null,selectField:null,selectStatement:null,whereClauseVector:new Vector,selectItems:null,up:["UPPER","=UPPER","=UPPER(","UPPER("],fieldTokens:["RECORDTYP","DATUM","ZEIT","DAUER","SEITENNAME","FEHLERWERT","VERSUCHE","PUNKTE"],opTokens:["=","<>","<","<=",">",">="],condTokens:["AND","OR"],cmdTokens:["SUM","AVG","COUNT"],insertStr:function(t,e,n){var i=e.substring(n,e.length);return i=t+i,e.substring(0,n)+i},delStr:function(t,e,n){return t.substring(0,e)+t.substring(e+n,t.length)},removeQuotes:function(t){return t=replaceIgnoreCase(t=replaceIgnoreCase(t,'"',""),"'","")},removeBracers:function(t){for(var e=0;e<t.length;e++)-1!=t.indexOf("(")&&(t=this.delStr(t,t.indexOf("("),1)),-1!=t.indexOf(")")&&(t=this.delStr(t,t.indexOf(")"),1));return t},removeUpper:function(t){return-1==t.indexOf(this.up[0])&&-1==t.indexOf(this.up[1])&&-1==t.indexOf(this.up[2])&&-1==t.indexOf(this.up[3])||(t=replaceIgnoreCase(t,"UPPER","")),t},tokenize:function(t,e,n,i){for(var r=0,o=0;o<e;o++)do{(r=t.indexOf(i[o]))>=0&&(t=this.insertStr(n+o,t,r),t=""==n?this.delStr(t,r+1,i[o].length):this.delStr(t,r+2,i[o].length))}while(r>=0);return t},anweisungBearbeiten:function(t){var e=0,n=null,i=null,r=0;if(this.whereClauseVector.removeAllElements(),-1==(t=t.toUpperCase()).indexOf(this.where))return"No where clause found!";var o=t.split(this.where);if(this.selectStatement=o[0],-1==o[1].indexOf(" AND ")){o[1]=this.tokenize(o[1],this.maxFieldCount,"",this.fieldTokens),o[1]=this.removeQuotes(o[1]),o[1]=this.removeUpper(o[1]),o[1]=this.removeBracers(o[1]),-1!=o[1].indexOf("=")?(e=o[1].indexOf("="),n=o[1].substring(0,e),i=o[1].substring(e+1,o[1].length),r=0):(e=o[1].indexOf("<>"),n=o[1].substring(0,e),i=o[1].substring(e+2,o[1].length),r=1);var a=new AndClass(n,i,r);this.whereClauseVector.addElement(a)}else for(var s=o[1].split(" AND "),l=0;l<s.length;l++){s[l]=this.tokenize(s[l],this.maxFieldCount,"",this.fieldTokens),s[l]=this.removeQuotes(s[l]),s[l]=this.removeUpper(s[l]),s[l]=this.removeBracers(s[l]),-1!=s[l].indexOf("=")?(e=s[l].indexOf("="),n=s[l].substring(0,e),i=s[l].substring(e+1,s[l].length),r=0):(e=s[l].indexOf("<>"),n=s[l].substring(0,e),i=s[l].substring(e+2,s[l].length),r=1);a=new AndClass(n,i,r);this.whereClauseVector.addElement(a)}if(0!=this.selectStatement.indexOf(this.select))return"Keine gültige Abfrage!";this.selectStatement=this.delStr(this.selectStatement,0,this.select.length),this.selectStatement=this.tokenize(this.selectStatement,this.maxFieldCount,"",this.fieldTokens),this.selectStatement=this.tokenize(this.selectStatement,this.maxCmdCount,this.cmdTokenId,this.cmdTokens),this.selectStatement=this.removeQuotes(this.selectStatement),this.selectStatement=this.removeUpper(this.selectStatement),this.selectStatement=this.removeBracers(this.selectStatement),this.selectStatement=replace(this.selectStatement," ",""),"$"==this.selectStatement.charAt(0)?(this.selectItems=[],this.selectItems[0]=this.getCMD(AnyToInt(this.selectStatement.substring(1,2))),"*"==this.selectStatement.substring(2,this.selectStatement.length)?this.selectItems[1]="*":this.selectItems[1]=this.getTyp(AnyToInt(this.selectStatement.substring(2,this.selectStatement.length)))):(this.selectItems=[],this.selectItems[0]=this.getTyp(AnyToInt(this.selectStatement.substring(0,1))))},doMySQLRequest:function(t){this.anweisungBearbeiten(t);var e=0,n="",i="";if(gefunden=[],1==this.selectItems.length?n=this.selectItems[0]:(i=this.selectItems[0],n=this.selectItems[1]),1==this.whereClauseVector.getSize())for(var r=this.whereClauseVector.getElementAt(0),o=null,a=0;a<IdeaProtocoll.protocollItemList.length;a++)null!=(o=IdeaProtocoll.protocollItemList[a]).getItemAt(AnyToInt(r.key))&&(0==r.gleich&&o.getItemAt(AnyToInt(r.key))==r.wert&&(gefunden.push(this.getValueOf(o,n)),e++),1==r.gleich&&!o.getItemAt(AnyToInt(r.key))==r.wert&&(gefunden.push(this.getValueOf(o,n)),e++));else{if(2!=this.whereClauseVector.getSize())return'Zu viele "And" Operatoren.';var s=this.whereClauseVector.getElementAt(0),l=this.whereClauseVector.getElementAt(1);for(o=null,a=0;a<IdeaProtocoll.protocollItemList.length;a++)null!=(o=IdeaProtocoll.protocollItemList[a]).getItemAt(AnyToInt(s.key))&&null!=o.getItemAt(AnyToInt(l.key))&&(0==s.gleich&&0==l.gleich&&o.getItemAt(AnyToInt(s.key))==s.wert&&o.getItemAt(AnyToInt(l.key))==l.wert&&(gefunden.push(this.getValueOf(o,n)),e++),0==s.gleich&&1==l.gleich&&o.getItemAt(AnyToInt(s.key))==s.wert&&!o.getItemAt(AnyToInt(l.key))==l.wert&&(gefunden.push(this.getValueOf(o,n)),e++),1==s.gleich&&0==l.gleich&&!o.getItemAt(AnyToInt(s.key))==s.wert&&o.getItemAt(AnyToInt(l.key))==l.wert&&(gefunden.push(this.getValueOf(o,n)),e++),1==s.gleich&&1==l.gleich&&!o.getItemAt(AnyToInt(s.key))==s.wert&&!o.getItemAt(AnyToInt(l.key))==l.wert&&(gefunden.push(this.getValueOf(o,n)),e++))}var d="",h=0;for(a=0;a<gefunden.length;a++)d+=gefunden[a]+",",h+=AnyToInt(gefunden[a]);return""!=(d=this.removeQuotes(d))&&null!=d||(d="Nichts gefunden!"),d=d.substring(0,d.lastIndexOf(",")),""==i||("COUNT"==i?d=""+e:"SUM"==i?d=""+h:"AVG"==i&&(d=""+h/e)),d},getValueOf:function(t,e){return"RECORDTYP"==e?e=t.getRecordTyp():"DATUM"==e?e=t.getDate():"ZEIT"==e?e=t.getTime():"DAUER"==e?e=t.getDuration():"SEITENNAME"==e?e=t.getPageName():"FEHLERWERT"==e?e=t.getErrorValue():"VERSUCHE"==e?e=t.getTrials():"PUNKTE"==e?e=t.getPoints():"*"==e&&(e=t.getRecordTyp()),e},getTyp:function(t){switch(t){case 0:return"RECORDTYP";case 1:return"DATUM";case 2:return"ZEIT";case 3:return"DAUER";case 4:return"SEITENNAME";case 5:return"FEHLERWERT";case 6:return"VERSUCHE";case 7:return"PUNKTE"}return""},getCMD:function(t){switch(t){case 0:return"SUM";case 1:return"AVG";case 2:return"COUNT"}return""}};var wi=null;function makeit(t){(new printPartOfPage).printPart(t)}function _lsc(t,e){for(var n,i=t.childNodes.length-1;i>-1;i--)"SUBCLASS"==(n=t.childNodes[i]).nodeName.toUpperCase()&&e.push(n.getAttribute("Name")),n.childNodes.length>0&&_lsc(n,e)}function ListSubclasses(){null==systemLibaryEx&&loadSystemLibEx();var t=findNode("TStdControl",systemLibaryEx),e=[];return t.childNodes.length>0&&_lsc(t,e),e.join(",")}function makeComponent(t){for(var e,n=getSystemObjectAttrDataNode(t),i=!1,r="<"+t+' IdeaClass="'+StrReplace(t,"Std","")+'" Subclass="'+t+'" ',o=0;o<n.length;o++)"FONT"==(e=n[o]).Name.toUpperCase()?i=!0:"1280"!=e.AttrData&&(r+=e.Name+'="'+e.DefValue+'" ');return r+=">",i&&(r+='<Font Name="Verdana" Size="9" Charset="0" Style="[]" Color="0"/>'),r+="</"+t+">"}function doParseCommaText(t){if(null!=t&&t.indexOf(",")>-1){if(t.indexOf('"')<0)return t.replace(/,/g,"\r");for(var e=[],n=t.split(","),i=!1,r=[],o=0,a=0;a<n.length;a++)r.push(n[a]),o=1,n[a].indexOf('"')>-1&&(o=n[a].split('"').length%2),0==o&&(i=!i),i?r.push(","):(e.push(r.join("")),r=[]);t=e.join("\r")}return t}function SortStringIgnoreCase(t,e,n){return"asc"==n?t.toLowerCase()>e.toLowerCase()?1:-1:t.toLowerCase()>e.toLowerCase()?-1:1}function getGlossarList(t,e){for(var n=new StringBuffer,i=GlossarXML.getElementsByTagName("entry"),r=i.length,o=0;o<r;o++){var a=i[o].getAttribute("Typ")||"Glossar",s=i[o].getAttribute("Kategorie"),l="";null!=i[o].childNodes[0].textContent&&(l=i[o].childNodes[0].textContent),""==l&&(l=i[o].getAttribute("Name")),t==a&&(""!=e?s.indexOf(e)>-1&&n.append(""!=n?",":"").append(l):n.append(""!=n?",":"").append(l))}return n.toString()}function getGlossarElement(t){for(var e=GlossarXML.getElementsByTagName("word"),n=GlossarXML.getElementsByTagName("desc"),i=e.length,r="",o=0;o<i;o++){if(void 0!==e[o].childNodes[0]&&null!=e[o].childNodes[0].nodeValue)if(e[o].childNodes[0].nodeValue==t){r=_glossardescription(n[o].childNodes);break}}return r}printPartOfPage=function(){wi&&!wi.closed&&wi.close(),this.printPart=function(t){html=document.getElementById(""+t).innerHTML,(wi=window.open("","printingpage")).document.write('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /></head><body onload="self.print()">'+html+"</body></html>"),wi.document.close()}};var IMenueXML=null;function searchPages(t){t=t.toUpperCase();var e=[],n=[];if(null==IMenueXML){var i=expandmetavarEx("$(SonstigePfad)$ideamenu.xml","Variablen");loadXML(i+="?rnd="+Time()),IMenueXML=GetXMLDoc()}for(var r,o,a,s="",l="",d=0,h=IMenueXML.getElementsByTagName("TStdOrganization"),u=h.length,c=0;c<u;c++)if((s=(s=h[c].getAttribute("Caption")).toUpperCase()).indexOf(t)>-1&&h[c].children){a=(r=h[c].children).length;for(var p=0;p<a;p++)"TIdeaPage"==r[p].nodeName&&(s=r[p].getAttribute("Caption"),o=r[p].getAttribute("Name"),-1==e.indexOf(o)&&(e.push(o),n[d]={},n[d].page=o,n[d].Caption=s,d++))}for(u=(r=IMenueXML.getElementsByTagName("TIdeaPage")).length,c=0;c<u;c++)(s=(l=r[c].getAttribute("Caption")).toUpperCase()).indexOf(t)>-1&&(o=r[c].getAttribute("Name"),-1==e.indexOf(o)&&(e.push(o),n[d]={},n[d].page=o,n[d].Caption=l,d++));return n}function searchGlossar(t){t=t.toUpperCase();for(var e,n,i=new StringBuffer,r=GlossarXML.getElementsByTagName("entry"),o=r.length,a=0;a<o;a++)e=(n=r[a].getAttribute("Name")).toUpperCase(),cat="",null!=r[a].getAttribute("Kategorie")&&(cat=r[a].getAttribute("Kategorie").toUpperCase()),(e.indexOf(t)>-1||cat.indexOf(t)>-1)&&i.append(""!=i?",":"").append(n);return i.toString()}var IDocumentXML=null;function searchDocuments(t,e,n,i){if(e=void 0===e?"Name":e,n=void 0===n?"File":n,i=void 0===i?"documents.xml":i,null==IDocumentXML){var r=expandmetavarEx("$(SonstigePfad)$"+i,"Variablen");loadXML(r+="?rnd="+Time()),IDocumentXML=GetXMLDoc()}var o=[];t=t.toUpperCase();for(var a,s,l,d=IDocumentXML.getElementsByTagName("entry"),h=d.length,u=0,c=0;c<h;c++)a=(s=d[c].getAttribute(e)).toUpperCase(),l=d[c].getAttribute(n),a.indexOf(t)>-1&&(o[u]={},o[u].Caption=s,o[u].Filename=l,u++);return o}function getDocumentList(t,e,n){if(t=void 0===t?"Name":t,e=void 0===e?"File":e,n=void 0===n?"documents.xml":n,null==IDocumentXML){var i=expandmetavarEx("$(SonstigePfad)$"+n,"Variablen");loadXML(i+="?rnd="+Time()),IDocumentXML=GetXMLDoc()}for(var r=[],o=IDocumentXML.getElementsByTagName("entry"),a=o.length,s=0;s<a;s++)r[s]={},r[s].Caption=o[s].getAttribute(t),r[s].Filename=o[s].getAttribute(n);return r}function replaceAllwords(t,e){return t.replace(/(\b)/gm,e)}function pC_add(t,e){PageCache[t]=e}function pC_exists(t){return void 0!==PageCache[t]}function pC_remove(t){return void 0!==PageCache[t]&&(delete PageCache[t],!0)}function pC_get(t){return result="",void 0!==PageCache[t]&&(result=PageCache[t]),result}function removeDuplicates(t){for(var e={},n=[],i=0,r=t.length;i<r;i++)e[t[i]]=0;for(var o in e)n.push(o);return n}function AnyToRGB(t){if(~t.indexOf(","))var e=t.split(",");if(~t.indexOf("#")||3==t.length||6==t.length)e=hexToRgb(t);return e}function hexToRgb(t){t=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(t,e,n,i){return e+e+n+n+i+i});var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{0:parseInt(e[1],16),1:parseInt(e[2],16),2:parseInt(e[3],16)}:null}function msToTime(t){function e(t,e){return("00"+t).slice(-(e=e||2))}var n=t%1e3,i=(t=(t-n)/1e3)%60,r=(t=(t-i)/60)%60;return e((t-r)/60)+":"+e(r)+":"+e(i)+"."+e(n,3)}function getTimeStamp(){var t=new Date;return msToTime((t.getTime()-6e4*t.getTimezoneOffset())%864e5)}function MatchString(t,e){var n,i;if(1==(n=e.split("*")).length)return t==e;for(i=0,Count=0;Count<n.length;Count++){if(0==Count){if(0!=(i=t.indexOf(n[Count],i)))return!1}else if(-1==(i=t.indexOf(n[Count],i)))return!1;i+=n[Count].length}return!0}function generateSimpleEvalutationChart(t,e,n,i){percentageWrongAnswers=100-t,n=AnyToRGB(n),i=AnyToRGB(i);var r={animation:!1},o=document.getElementById("chart-area").getContext("2d");switch(e){case"doughnut":case 1:var a=[{value:t,color:"rgba("+n[0]+","+n[1]+","+n[2]+",1.0)",highlight:"#FF5A5E",label:"Richtig"},{value:percentageWrongAnswers,color:"rgba("+i[0]+","+i[1]+","+i[2]+",1.0)",highlight:"#FF5A5E",label:"Falsch"}];window.myChart=new Chart(o).Doughnut(a,r);break;case"bars":case 2:var s={labels:[""],datasets:[{fillColor:"rgba("+n[0]+","+n[1]+","+n[2]+",1.0)",strokeColor:"rgba("+n[0]+","+n[1]+","+n[2]+",0.8)",highlightFill:"rgba(220,0,0,0.75)",highlightStroke:"rgba(220,220,220,1)",data:[t]},{fillColor:"rgba("+i[0]+","+i[1]+","+i[2]+",1.0)",strokeColor:"rgba("+i[0]+","+i[1]+","+i[2]+",0.8)",highlightFill:"rgba(220,0,0,0.75)",highlightStroke:"rgba(220,220,220,1)",data:[percentageWrongAnswers]}]};window.myChart=new Chart(o).Bar(s,r);break;default:var l=[{value:t,color:"rgba("+n[0]+","+n[1]+","+n[2]+",1.0)",highlight:"#FFFFFF",label:"Richtig"},{value:percentageWrongAnswers,color:"rgba("+i[0]+","+i[1]+","+i[2]+",1.0)",highlight:"#FFFFFF",label:"Falsch"}];window.myChart=new Chart(o).Pie(l,r)}return window.myChart.toBase64Image()}function delChildCmp(t,e,n){var i,r=AnyToObject(t,e),o=r.childes.length-1;for(isVarUndefined(n)&&(n=!0),i=o;i>=0;i--)delChildCmp(r.childes[i].Name(),e,n);0!=n&&0!=(r.__LN&&0!=AnyToInt(r.__LN()))||DeleteObj(t,e)}function setNewParent(t,e,n,i){var r,o;return AnyToObject(e,i),r=AnyToObject(n,i),o=getNode(t,i.Name()),delChildCmp(t,i,!1),AnyToObject(addNode(o,t,i.Name(),r),i.Name())}function enumChildComps(t,e,n,i,r,o){var a,s,l=[];for(isVarUndefined(i)&&(i=lmByName),isVarUndefined(r)&&(r=ltFirst),isVarUndefined(o)&&(o=!0),""==i&&(i=lmByName),a=AnyToObject(t,e),s=0;s<a.childes.length;s++)(""==n||i==lmByName&&a.childes[s].Name().toLowerCase().indexOf(n.toLowerCase())>=0||i==lmBySubClass&&a.childes[s].Subclass().toLowerCase().indexOf(n.toLowerCase())>=0||i==lmByNameExclude&&a.childes[s].Name().toLowerCase().indexOf(n.toLowerCase())<0||i==lmBySubClassExclude&&a.childes[s].Subclass().toLowerCase().indexOf(n.toLowerCase())<0)&&(0!=o&&0!=(a.childes[s].__LN&&0!=AnyToInt(a.childes[s].__LN()))||l.push(a.childes[s].Name())),r==ltAny&&a.childes[s].childes.length>0&&(l=l.concat(enumChildComps(a.childes[s].Name(),e,n,i,r,o)));return l}function simulate(t,e){var n,i=extend(defaultOptions,arguments[2]||{}),r=null;for(var o in eventMatchers)if(eventMatchers[o].test(e)){r=o;break}if(!r)throw new SyntaxError("Only HTMLEvents and MouseEvents interfaces are supported");document.createEvent?(n=document.createEvent(r),"HTMLEvents"==r?n.initEvent(e,i.bubbles,i.cancelable):n.initMouseEvent(e,i.bubbles,i.cancelable,document.defaultView,i.button,i.pointerX,i.pointerY,i.pointerX,i.pointerY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,t),t.dispatchEvent(n)):(i.clientX=i.pointerX,i.clientY=i.pointerY,n=extend(document.createEventObject(),i),t.fireEvent("on"+e,n));return t}function extend(t,e){for(var n in e)t[n]=e[n];return t}Array.prototype.sortAsc=function(t){if(!(t>=this.length))for(var e=0;e<this.length-1;e++)for(var n=e+1;n<this.length;n++)if(this[n][t]<this[e][t]){var i=this[e];this[e]=this[n],this[n]=i}};var eventMatchers={HTMLEvents:/^(?:load|unload|abort|error|select|change|submit|reset|focus|blur|resize|scroll)$/,MouseEvents:/^(?:click|dblclick|mouse(?:down|up|over|move|out))$/},defaultOptions={pointerX:0,pointerY:0,button:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,bubbles:!0,cancelable:!0};function objectsOnCordsMobile(t,e,n){var i,r="",o=new Object;isVarUndefined(n)&&(n=!0);for(var a=e.childes.length-1;a>-1;a--)t.x>e.childes[a].OffsetLeft()&&t.x<e.childes[a].OffsetLeft()+e.childes[a].OffsetWidth()&&t.y>e.childes[a].OffsetTop()&&t.y<e.childes[a].OffsetTop()+e.childes[a].OffsetHeight()&&(i="",r+=e.childes[a].Name()+",",1==n&&e.childes[a].childes.length>0&&(1==e.childes[a]._getCSSPosition()&&(o.x=Math.max(t.x-e.childes[a].OffsetLeft(),0),o.y=Math.max(t.y-e.childes[a].OffsetTop(),0),i=objectsOnCordsMobile(o,e.childes[a],n)),2==e.childes[a]._getCSSPosition()&&(o.x=Math.max(t.x-e.childes[a].OffsetLeft(),0),o.y=Math.max(t.y-e.childes[a].OffsetTop(),0),i=objectsOnCordsMobile(o,e.childes[a],n)),0==e.childes[a]._getCSSPosition()&&(o.x=Math.max(t.x,0),o.y=Math.max(t.y,0),i=objectsOnCordsMobile(o,e.childes[a],n)),""!=i&&(r+=i+",")));return StrCopy(r,1,r.length-1)}var jsfilepath=IDEASCRIPTDIR,jslibs=[];function loadjsfile(t){var e=document.createElement("script");e.setAttribute("type","text/javascript"),e.setAttribute("src",t),void 0!==e&&document.getElementsByTagName("head")[0].appendChild(e)}function startRuntime(){addResizeMonitor();for(var t=0;t<jslibs.length;t++)loadjsfile(jsfilepath+jslibs[t]);startTimeout&&0!=startTimeout?setTimeout(function(){startCourse()},Math.abs(startTimeout)):startCourse()}function hideStartScreen(){$("splashscreen")&&document.getElementsByTagName("body")[0].removeChild($("splashscreen"))}function createMAPIifNotExists(){window.IDEAMAPI||createMAPI()}function createMAPI(){window.IDEAMAPI||(window.IDEAMAPI=new TStdMAPI);var t=window.IDEAMAPI;window.IDEAMAPI.deInit(),window.IDEAMAPI=t,window.IDEAMAPI.Init(),window.MAPI=window.IDEAMAPI}function destroyMAPI(){window.IDEAMAPI&&(null!=window.IDEAMAPI.deInit&&window.IDEAMAPI.deInit(),window.IDEAMAPI=null,window.MAPI=null)}function TStdMAPI(){}TStdMAPI.prototype={attr_m:[],attr_c:[],attr_navi_btns:[],attr_innerPage:null,attr_handler:"",attr_debugmode:!1,attr_pagehistory:[],attr_event_listeners:[],attr_rt_previewmod:0,attr_previewmod:0,attr_priviewpage:null,attr_priviewpageobj:null,attr_priviewcfwobj:null,attr_platform:"",attr_otherNextPage:"",attr_otherPrevPage:"",attr_scorm_on:!1,attr_save_page_status:!0,attr_last_visited_page:"",attr_last_saved_visited_page:"",attr_projectid:"",Init:function(){this.doRegInternModules(),this.writeVar("Global","Starttime",Time()),this.attr_scorm_on=AnyToBool(this.readVar("System","AICCMode")),this.scorm_Init()},deInit:function(){this.attr_m=[],this.attr_c=[],this.attr_navi_btns=[],this.attr_innerPage=null,this.attr_handler="",this.attr_debugmode=!1,this.attr_pagehistory=[],this.attr_event_listeners=[],this.attr_rt_previewmod=0,this.attr_previewmod=0,this.attr_priviewpage=null,this.attr_priviewpageobj=null,this.attr_priviewcfwobj=null,this.attr_platform="",this.attr_otherNextPage="",this.attr_otherPrevPage="",this.attr_scorm_on=!1,this.attr_last_visited_page="",this.attr_last_saved_visited_page="",window.IDEAMAPI=null,window.MAPI=null},doRegInternModules:function(){this.RegisterAPI("intern","IDEAMAPI","RegisterAPI,NavigationHint,AddEventListener,RemoveEventListener,readVar,writeVar,SetPageContainer,LoadFirstPage,newPage,PageCount,PageIndex,getPageState,ReloadPage,SetNextPage,NextPage,SetPreviousPage,PreviousPage,Jump,PreviousPageFromTree,IsNextPage,IsPreviousPage,IsPreviousPageFromTree,regNaviBtn,enableNavigation,disableNavigation,CloseProgram,PagesStatus,getPageAttr,getPageHistory,GetAbsPageCount,GetAbsPageIndex,GetLastVisitedPageName,SetOptionSavePageStatusSession,SetHandler,setNavigationAttr,setPageState,ExecuteFunctionOnComponents,getComponentAttrValue,ExitAU,doLMSCommit")},getComponentAttrValue:function(t,e,n){if((e="page"==e?AnyToObject(t):AnyToObject(e,t))&&e[n]&&"function"==typeof e[n])return e[n]()},ExecuteFunctionOnComponents:function(t,e,n,i,r){i||(i=null),r||(r=null);for(var o=e.split(","),a=0;a<o.length;a++){var s=o[a];(s="page"==s?AnyToObject(t):AnyToObject(s,t))&&s[n]&&"function"==typeof s[n]&&s[n](i,r)}},SetPreviewMod:function(t,e){return arguments.length>0&&(t=AnyToInt(t),this.attr_previewmod=t,this.attr_platform=e,this.attr_rt_previewmod=this.attr_previewmod,0==this.attr_previewmod||1==this.attr_previewmod?this.attr_rt_previewmod=0:2==this.attr_previewmod?this.attr_rt_previewmod=1:4==this.attr_previewmod&&(this.attr_rt_previewmod=0),this.InitPreviewCFW()),this.attr_previewmod},SetPriviewPage:function(t){return arguments.length>0&&(this.attr_priviewpage=t,this.InitPreviewCFW()),null!=this.attr_priviewpageobj?this.attr_priviewpageobj:this.attr_priviewpage},InitPreviewCFW:function(){if(null==this.SetPreviewCFW()||2!=this.SetPreviewMod()&&3!=this.SetPreviewMod()&&4!=this.SetPreviewMod()||null==this.SetPriviewPage())return null;2!=this.attr_previewmod&&3!=this.attr_previewmod&&4!=this.attr_previewmod||(null!=this.attr_priviewcfwobj._cfwInit&&this.attr_priviewcfwobj._cfwInit(!0),this.SetPageContainer(this.attr_priviewcfwobj.Name(),this.attr_priviewcfwobj.Buehne()),this.LoadFirstPage())},SetPreviewCFW:function(t){return arguments.length>0&&(this.attr_priviewcfwobj=AnyToObject(t),this.InitPreviewCFW()),this.attr_priviewcfwobj},StartCFW:function(){if(this.attr_previewmod>0)return 0;for(var t=PageLibrary.getElementsByTagName("TIdeaPage"),e=0,n=t.length,i=0;i<n;i++)"1"==t[i].getAttribute("IsCFWPage")&&(e>0&&CallPage(t[i].getAttribute("Name"),0),e++)},AddEventListener:function(t){this.attr_event_listeners.indexOf(t)<0&&this.attr_event_listeners.push(t)},RemoveEventListener:function(t){for(var e=0;e<this.attr_event_listeners.length;e++)if(this.attr_event_listeners[e]==t)return this.attr_event_listeners[e]="",0;return-5},SetHandler:function(t,e){if(""==t&&""==e)this.attr_handler="";else{if(""==t||""==e)return""!=t?(this.attr_handler=t,0):(this.DebugMessage(t+"."+e+" Page must be defined","-1"),-4);this.attr_handler=t+"."+e}},RegisterAPI:function(t,e,n){for(var i=0;i<this.attr_m.length;i++)if(this.attr_m[i].id==t)return this.DebugMessage(t+", Modul ID is not Uniqe","-1"),-1;var r=n.split(","),o=this.ListFunktions().split(",");for(i=0;i<o.length;i++)for(var a=0;a<r.length;a++)if(""!=o[i]&&o[i]==r[a])return this.DebugMessage(r[a]+" function name is not Uniqe","-2"),-2;var s=[];s.id=t,s.poinnter=e,s.functions=[];for(i=0;i<r.length;i++)""!=r[i]&&s.functions.push(r[i]);return this.attr_m.push(s),this._updateCache(),0},ListModules:function(){for(var t=[],e=0;e<this.attr_m.length;e++)this.attr_m[e]&&null!=this.attr_m[e]&&this.attr_m[e].id&&null!=this.attr_m[e].id&&""!=this.attr_m[e].id&&t.push(this.attr_m[e].id);return t.join(",")},ListFunktions:function(t){var e=[];if(t&&""!=t&&null!=t){for(var n=0;n<this.attr_m.length;n++)if(this.attr_m[n]&&null!=this.attr_m[n]&&this.attr_m[n].id&&null!=this.attr_m[n].id&&""!=this.attr_m[n].id&&this.attr_m[n].id==t){if(this.attr_m[n].functions[i]&&null!=this.attr_m[n].functions[i])for(var i=0;i<this.attr_m[n].functions.length;i++)e.push(this.attr_m[n].functions[i]);break}}else for(n=0;n<this.attr_m.length;n++)if(this.attr_m[n]&&null!=this.attr_m[n]&&this.attr_m[n].functions&&null!=this.attr_m[n].functions)for(i=0;i<this.attr_m[n].functions.length;i++)this.attr_m[n].functions[i]&&null!=this.attr_m[n].functions[i]&&e.push(this.attr_m[n].functions[i]);return e.join(",")},toComponent:function(t){if("IDEAMAPI"==t)return this;var e=null,n=null;if(t.indexOf(".")>=0){var i=t.split(".");e=AnyToObject(i[0]),n=AnyToObject(i[1],e)}else n=AnyToObject(t);return n},API:function(t,e,n,i,r){if(e||(e=""),n||(n=""),i||(i=""),r||(r=""),this.attr_c[t]&&""!=this.attr_c[t]){var o=this.toComponent(this.attr_c[t]);return o[t]&&null!=o[t]&&"function"==typeof o[t]?o[t](e,n,i,r):(this.DebugMessage(t+" Object OR Function not found","-7"),-7)}return this.DebugMessage(t+" API Function not found(not registred)","-6"),-6},DebugMessage:function(t,e){this.attr_debugmode&&WriteToConsole("ERROR: "+e+",     ERROR CODE: "+t)},_updateCache:function(){this.attr_c=[];for(var t=0;t<this.attr_m.length;t++)if(this.attr_m[t]&&null!=this.attr_m[t]&&this.attr_m[t].functions&&null!=this.attr_m[t].functions)for(var e=0;e<this.attr_m[t].functions.length;e++)this.attr_m[t].functions[e]&&null!=this.attr_m[t].functions[e]&&(this.attr_c[this.attr_m[t].functions[e]]=this.attr_m[t].poinnter)},HandlerEvent:function(t,e,n,i,r){e||(e=""),n||(n=""),i||(i=""),r||(r="");for(var o=null,a=0;a<this.attr_event_listeners.length;a++)if(null!=(o=this.toComponent(this.attr_event_listeners[a]))&&null!=o[t]&&"function"==typeof o[t])try{o[t](e,n,i,r)}catch(t){}return""!=this.attr_handler&&null!=(o=this.toComponent(this.attr_handler))&&null!=o[t]&&"function"==typeof o[t]&&o[t](e,n,i,r)},HandlerOverrideFunction:function(t){if(""!=this.attr_handler){var e=this.toComponent(this.attr_handler);if(null!=e&&null!=e[t]&&"function"==typeof e[t])return!0}return!1},page2history:function(t,e){if(e||(e=1),0==this.attr_pagehistory.length){this.attr_pagehistory=[];for(var n=PageCountABS(this.attr_innerPage),i=[],r=0;r<=n;r++)(i=[]).name=GetPageByIndexFromPageLibABS(r),i.status="0",""!=i.name&&this.attr_pagehistory.push(i)}var o=getSharedPSFromPageLib().split(","),a=[],s="";a.push(t);for(r=0;r<o.length;r++)if(o[r].indexOf(t+"=")>=0){s=(s=o[r]).substr(t.length+1),a.push(s);for(var l=0;l<o.length;l++)o[l].indexOf("="+s)>=0&&(t=o[l].substr(0,o[l].indexOf("=")),a.indexOf(t)<0&&a.push(t));r=o.length}for(l=0,r=0;r<this.attr_pagehistory.length;r++)(l=a.indexOf(this.attr_pagehistory[r].name))>=0&&(this.attr_pagehistory[r].status=e,a.splice(l,1),0==a.length&&(r=this.attr_pagehistory.length))},readVar:function(t,e){return this.HandlerEvent("OnReadVar",t,e),this.HandlerOverrideFunction("readVar")?this.HandlerEvent("readVar",t,e):readVariable(t,e)},writeVar:function(t,e,n){return this.HandlerEvent("OnWriteVar",t,e,n),this.HandlerOverrideFunction("writeVar")?this.HandlerEvent("writeVar",t,e,n):(writeVariable(t,e,n),0)},SetPageContainer:function(t,e){return arguments.length>0?(this.HandlerEvent("OnSetPageContainer",t,e),this.HandlerOverrideFunction("SetPageContainer")?this.HandlerEvent("SetPageContainer",t,e):(SetPageContainer(t,e),0)):(this.HandlerEvent("OnSetPageContainer"),this.HandlerOverrideFunction("SetPageContainer")?this.HandlerEvent("SetPageContainer"):SetPageContainer())},LoadFirstPage:function(){if(this.attr_previewmod>0)return null!=this.attr_priviewpageobj&&null!=this.attr_priviewpageobj.Name&&ClosePage(this.attr_priviewpageobj.Name()),""!=this.attr_priviewpage&&null!=this.attr_priviewpage&&(this.attr_priviewpageobj=LoadPage(this.attr_priviewpage,this.attr_rt_previewmod,"","","",this.attr_platform)),0;if(this.HandlerEvent("OnLoadFirstPage"),this.HandlerOverrideFunction("LoadFirstPage"))return this.HandlerEvent("LoadFirstPage");if(pageHistory=[],""==externalStartPage){for(var t=PageLibrary.getElementsByTagName("TIdeaPage"),e=t.length,n=0;n<e;n++)if("1"!=t[n].getAttribute("IsCFWPage"))return JumpEx(t[n].getAttribute("Name"),""),0}else{var i=externalStartPage;externalStartPage="",JumpEx(i,"")}return 0},newPage:function(t,e,n){if(null!=window.hiqPdfConverter&&null!=hiqPdfConverter&&null!=hiqPdfConverter.startConversion&&hiqPdfConverter.startConversion(),this.attr_innerPage=t,this.attr_innerPageIsLast=AnyToBool(e),this.page2history(this.attr_innerPage.Name()),AnyToBool(n)&&(this.attr_last_saved_visited_page=this.attr_innerPage.Name()),this.HandlerEvent("OnNewPage",t),this.scorm_savePageStatus(),this.HandlerOverrideFunction("newPage"))return this.HandlerEvent("newPage",t);!this.attr_innerPageIsLast&&this.IsNextPage()||this.scormDoLastpage()},ReloadPage:function(){if(this.HandlerEvent("OnReloadPage"),this.HandlerOverrideFunction("ReloadPage"))return this.HandlerEvent("ReloadPage");JumpEx(this.attr_innerPage,this.attr_innerPage)},SetNextPage:function(t){this.attr_otherNextPage=t},SetPreviousPage:function(t){this.attr_otherPrevPage=t},NextPage:function(){if(this.HandlerEvent("OnNextPage"),this.HandlerOverrideFunction("NextPage"))return this.HandlerEvent("NextPage");null!=this.attr_innerPage&&this.attr_innerPage._OnBeforeNextPage&&this.attr_innerPage._OnBeforeNextPage(),""==this.attr_otherNextPage||null==this.attr_otherNextPage?NextPageEx(this.attr_innerPage):(JumpEx(this.attr_otherNextPage,this.attr_innerPage),this.attr_otherNextPage="")},PreviousPage:function(){if(this.HandlerEvent("OnPreviousPage"),this.HandlerOverrideFunction("PreviousPage"))return this.HandlerEvent("PreviousPage");null!=this.attr_innerPage&&this.attr_innerPage._OnBeforePreviousPage&&this.attr_innerPage._OnBeforePreviousPage(),""==this.attr_otherPrevPage||null==this.attr_otherPrevPage?PreviousPageEx(this.attr_innerPage):(JumpEx(this.attr_otherPrevPage,this.attr_innerPage),this.attr_otherPrevPage="")},Jump:function(t,e){if(""!=t||""!=e){if(this.HandlerEvent("OnJump",t),this.HandlerOverrideFunction("Jump"))return this.HandlerEvent("Jump",t);JumpEx(t,this.attr_innerPage)}else JumpEx(t,e)},PreviousPageFromTree:function(){if(this.HandlerEvent("OnPreviousPageFromTree"),this.HandlerOverrideFunction("PreviousPageFromTree"))return this.HandlerEvent("PreviousPageFromTree");PreviousPageFromTreeEx(this.attr_innerPage)},IsNextPage:function(){return this.HandlerEvent("OnIsNextPage"),this.HandlerOverrideFunction("IsNextPage")?this.HandlerEvent("IsNextPage"):IsNextPage(this.attr_innerPage)},IsPreviousPage:function(){return this.HandlerEvent("OnIsPreviousPage"),this.HandlerOverrideFunction("IsPreviousPage")?this.HandlerEvent("IsPreviousPage"):IsPreviousPage(this.attr_innerPage)},IsPreviousPageFromTree:function(){return this.HandlerEvent("OnIsPreviousPageFromTree"),this.HandlerOverrideFunction("IsPreviousPageFromTree")?this.HandlerEvent("IsPreviousPageFromTree"):IsPreviousPageFromTreeEx(this.attr_innerPage)},regNaviBtn:function(t,e){if(this.HandlerEvent("OnRegNaviBtn",t,e),this.HandlerOverrideFunction("regNaviBtn"))return this.HandlerEvent("regNaviBtn",t,e);this.attr_navi_btns.all||(this.attr_navi_btns.all=[]),this.attr_navi_btns[t]||(this.attr_navi_btns[t]=[]),this.attr_navi_btns.all.indexOf(e)<0&&this.attr_navi_btns.all.push(e),"all"!=t&&this.attr_navi_btns[t].indexOf(t)<0&&this.attr_navi_btns[t].push(e)},setNavigationAttr:function(t,e,n){if(!this.attr_navi_btns[t])return this.DebugMessage(t+" Navigation controls group not registred","-3"),-3;for(var i=0;i<this.attr_navi_btns[t].length;i++){var r=this.toComponent(this.attr_navi_btns[t][i]);""!=e&&null!=r[e]&&r[e](n)}},NavigationHint:function(t,e){if(!this.attr_navi_btns[t])return this.DebugMessage(t+" Navigation controls group not registred","-3"),-3;for(var n=0;n<this.attr_navi_btns[t].length;n++){var i=this.toComponent(this.attr_navi_btns[t][n]);if(""!=e&&null!=i[e]){var r=i[e]();i.Hint(r)}}},endisNavigation:function(t,e){if(!this.attr_navi_btns[t])return this.DebugMessage(t+" Navigation controls group not registred","-3"),-3;for(var n=0;n<this.attr_navi_btns[t].length;n++){var i=this.toComponent(this.attr_navi_btns[t][n]);null!=i&&i.Enabled(e)}},disableNavigation:function(t){if(this.HandlerEvent("OnDisableNavigation",t),this.HandlerOverrideFunction("disableNavigation"))return this.HandlerEvent("disableNavigation",t);this.endisNavigation(t,!1)},enableNavigation:function(t){if(this.HandlerEvent("OnEnableNavigation",t),this.HandlerOverrideFunction("enableNavigation"))return this.HandlerEvent("enableNavigation",t);this.endisNavigation(t,!0)},PageIndex:function(){return this.HandlerEvent("OnPageIndex"),this.HandlerOverrideFunction("PageIndex")?this.HandlerEvent("PageIndex"):PageIndex(this.attr_innerPage)},getPageAttr:function(t){var e="";return null==this.attr_innerPage?"":(this.attr_innerPage[t]&&(e=this.attr_innerPage[t]()),e)},PageCount:function(){return this.HandlerEvent("OnPageCount"),this.HandlerOverrideFunction("PageCount")?this.HandlerEvent("PageCount"):PageCount(this.attr_innerPage)},GetAbsPageIndex:function(){if(this.HandlerEvent("OnGetAbsPageIndex"),this.HandlerOverrideFunction("GetAbsPageIndex"))return this.HandlerEvent("GetAbsPageIndex");for(var t=0;t<this.attr_pagehistory.length;t++)if(this.attr_pagehistory[t].name==this.attr_innerPage.Name())return t+1;return 0},GetAbsPageCount:function(){return this.HandlerEvent("OnGetAbsPageCount"),this.HandlerOverrideFunction("GetAbsPageCount")?this.HandlerEvent("GetAbsPageCount"):this.attr_pagehistory.length},getPageState:function(t){if(this.HandlerEvent("OnGetPageState",t),this.HandlerOverrideFunction("getPageState"))return this.HandlerEvent("getPageState",t);for(var e=0;e<this.attr_pagehistory.length;e++)if(this.attr_pagehistory[e].name==t)return this.attr_pagehistory[e].status;return 0},setPageState:function(t,e){this.page2history(t,e)},getPageHistory:function(){for(var t="",e=0;e<this.attr_pagehistory.length;e++)t=t+this.attr_pagehistory[e].status+",";return t+";"+this.attr_last_saved_visited_page},PagesStatus:function(t){if(t||(t=""),this.HandlerEvent("OnPagesStatus",t),this.HandlerOverrideFunction("PagesStatus"))return this.HandlerEvent("PagesStatus",t);if(""==t){for(var e="",n=0;n<this.attr_pagehistory.length;n++)e=e+this.attr_pagehistory[n].status+",";return e+";"+this.attr_last_saved_visited_page}t.indexOf(";")>-1&&(this.attr_last_visited_page=t.substr(t.indexOf(";")+1),t=t.substr(0,t.indexOf(";"))),","==t.charAt(t.length-1)&&(t=t.substr(0,t.length-1));var i=t.split(",");for(n=0;n<i.length;n++)"1"==i[n]&&this.page2history(GetPageByIndexFromPageLibABS(n))},CloseProgram:function(){var t;for(t in pages)pages[t].OnBeforeCloseProgram&&pages[t].OnBeforeCloseProgram();for(t in pages)pages[t].OnCloseProgram&&pages[t].OnCloseProgram();if(this.HandlerEvent("OnCloseProgram"),this.HandlerOverrideFunction("CloseProgram"))return this.HandlerEvent("CloseProgram");this.scorm_do_end(),CloseProgram(!0),destroyMAPI()},doLMSCommit:function(){this.scorm_do_commit()},ExitAU:function(){this.scorm_do_end()},GetLastVisitedPageName:function(){return this.attr_last_visited_page},scorm_savePageStatus:function(){this.writeSuspendData(this.PagesStatus())},scorm_Init:function(){window.IDEACUID&&""!=window.IDEACUID&&"##CUID##"!=window.IDEACUID?this.attr_projectid=window.IDEACUID:(this.attr_projectid=GetVariableEx("Projectsettings","UniqueID","","Variablen"),""!=this.attr_projectid&&void 0!=this.attr_projectid||(this.attr_projectid=document.location.pathname.substr(0,document.location.pathname.lastIndexOf("/")),this.attr_projectid=this.attr_projectid.substr(this.attr_projectid.lastIndexOf("/")),this.attr_projectid=this.attr_projectid.substr(1),this.attr_projectid=document.location.hostname+"_"+this.attr_projectid,this.attr_projectid=this.attr_projectid.toLowerCase()));var t=this.readSuspendData();if(""!=t&&this.PagesStatus(t),this.attr_scorm_on){var e=AnyToStr(GetCMIValue("Core","lesson_status"));"passed"==(e=e.toLowerCase())?this.writeVar("Global","AICCResult","0"):"completed"==e?this.writeVar("Global","AICCResult","1"):"failed"==e?this.writeVar("Global","AICCResult","2"):this.writeVar("Global","AICCResult","3")}},scormDoLastpage:function(){if(this.HandlerEvent("OnScormDoLastpage"),this.HandlerOverrideFunction("scormDoLastpage"))return this.HandlerEvent("scormDoLastpage");var t=null;if(this.scorm_savePageStatus(),this.attr_scorm_on){var e=this.readVar("Global","AICCResult");if("0"!=e)if("2"!=e)t=this.writeVar("Global","AICCResult","1");else t=null}return t},scorm_do_end:function(){this.attr_scorm_on&&(this.scorm_do_commit(),exitAU(this.readVar("Global","AICCResult"),!0),this.attr_scorm_on=!1)},SetOptionSavePageStatusSession:function(t){this.attr_save_page_status=AnyToBool(t)},scorm_do_commit:function(){var t,e,n,i,r,o,a,s,l;this.attr_scorm_on?(this.scorm_savePageStatus(),s=AnyToStr(this.readVar("Global","Starttime")),t=AnyToInt(StrCopy(l=AnyToStr(Time()),1,Sub(StrPos(":",l),1))),l=AnyToStr(StrCopy(l,Add(StrPos(":",l),1),StrLen(l))),i=AnyToInt(StrCopy(s,1,Sub(StrPos(":",s),1))),s=AnyToStr(StrCopy(s,Add(StrPos(":",s),1),StrLen(s))),e=AnyToInt(StrCopy(l,1,Sub(StrPos(":",l),1))),n=AnyToInt(StrCopy(l,Add(StrPos(":",l),1),StrLen(l))),r=AnyToInt(StrCopy(s,1,Sub(StrPos(":",s),1))),o=AnyToInt(StrCopy(s,Add(StrPos(":",s),1),StrLen(s))),o=AnyToInt(Sub(a=AnyToInt(Sub(a=AnyToInt(Add(MULT(Add(MULT(Sub(t,i),60),Sub(e,r)),60),Sub(n,o))),MULT(i=AnyToInt(DIV(a,3600)),3600))),MULT(r=AnyToInt(DIV(a,60)),60))),l=AnyToStr(StrConcat(l=AnyToStr(StrConcat(l=AnyToBool(LT(i,10))?AnyToStr("0"):AnyToStr(""),i)),":")),AnyToBool(LT(r,10))&&(l=AnyToStr(StrConcat(l,"0"))),l=AnyToStr(StrConcat(l=AnyToStr(StrConcat(l,r)),":")),AnyToBool(LT(o,10))&&(l=AnyToStr(StrConcat(l,"0"))),SetCMIValue("Core","session_Time",l=AnyToStr(StrConcat(l,o)))):this.scorm_savePageStatus()},writeSuspendData:function(t){this.attr_save_page_status&&(this.attr_scorm_on?SetCMIValue("cmi","suspend_data",t):this.writeToCookieProjektData("suspend_data",t))},readSuspendData:function(){if(this.attr_save_page_status){return this.attr_scorm_on?AnyToStr(GetCMIValue("cmi","suspend_data")):AnyToStr(this.readFromCookieProjektData("suspend_data"))}},writeToCookieProjektData:function(t,e){if("1"==GetVariableEx("Projectsettings","AllowPagePreviewCookie","0","Variablen")&&1==this.attr_previewmod&&AUTORENSYSTEMMODE||"1"==GetVariableEx("Projectsettings","AllowProjectPreviewCookie","0","Variablen")&&0==this.attr_previewmod&&AUTORENSYSTEMMODE||"1"==GetVariableEx("Projectsettings","AllowRuntimeCookie","0","Variablen")&&!AUTORENSYSTEMMODE){e=encodeURIComponent(e);var n=this.attr_projectid+t,i=new Date;i.setTime(i.getTime()+31536e6);var r="; expires="+i.toGMTString();document.cookie=n+"="+e+r+"; path=/"}},readFromCookieProjektData:function(t){var e="";if("1"==GetVariableEx("Projectsettings","AllowPagePreviewCookie","0","Variablen")&&1==this.attr_previewmod&&AUTORENSYSTEMMODE||"1"==GetVariableEx("Projectsettings","AllowProjectPreviewCookie","0","Variablen")&&0==this.attr_previewmod&&AUTORENSYSTEMMODE||"1"==GetVariableEx("Projectsettings","AllowRuntimeCookie","0","Variablen")&&!AUTORENSYSTEMMODE)for(var n=this.attr_projectid+t+"=",i=document.cookie.split(";"),r=0;r<i.length;r++){for(var o=i[r];" "==o.charAt(0);)o=o.substring(1,o.length);if(0==o.indexOf(n)){e=o.substring(n.length,o.length);break}}return""!=e&&(e=decodeURIComponent(e)),e}};var dmMove=0,dmCopy=1;function ExtNode(t,e,n,i,r,o,a,s){this.id=t,this.pid=e,this.name=n,this.rel=r,this.info=i,this.icon=o,this.iconOpen=a,this._io=s||!1,this._is=!1,this._ls=!1,this._hc=!1,this._ai=0,this._p,this.childs=0,this.depth=0,this.type=""}function _moveDrag(t,e){i=!1;var n=e.data.origin.intideaobj;if(0==isVarUndefined(n)&&n.OnMoveDrag)var i=AnyToBool(n.OnMoveDrag(t,e));return 1==i?e.helper.find(".jstree-icon").removeClass("jstree-er").addClass("jstree-ok"):e.helper.find(".jstree-icon").removeClass("jstree-ok").addClass("jstree-er"),i}function _stopDrag(t,e){var n=e.data.origin.intideaobj;return!(0!=isVarUndefined(n)||!n.OnStopDrag)&&n.OnStopDrag(t,e)}function _startDrag(t,e){var n=e.data.origin.intideaobj;if(isVarUndefined(n))return!1;if(n.OnStartDrag){n.OnStartDrag(t,e);return!0}return!1}_treeonchapteropentoggle=function(t){var e=jQuery.jstree.reference(t);if(void 0!==e.get_buffer().node[0]){var n=e.get_buffer().node[0],i=e.intideaobj.CheckOpenState(n.id,e);e.intideaobj.OnCancelClipBrd(i)}},_treeonbeforemove=function(t,e,n,i,r){var o="";return r.intideaobj!=i.intideaobj?(o=r.intideaobj,t=r.intideaobj.getAbsIndexOfNode(t)):t=i.intideaobj.getAbsIndexOfNode(t),e=i.intideaobj.getAbsIndexOfNode(e),!!i.intideaobj.OnBeforeMove&&1==AnyToInt(i.intideaobj.OnBeforeMove(t,e,n,0,o))},_treeonmoved=function(t,e){var n=e.instance;setTimeout(function(){n.open_node(jQuery("#"+e.parent))},10);var i=jQuery("#"+e.node.id);i=n.intideaobj.getAbsIndexOfNode(i),n.intideaobj.moveindex=-1,n.intideaobj.movenode="";var r=dmMove;void 0!==e.original&&(r=dmCopy);var o="",a=1;0==e.position&&void 0===jQuery("#"+e.parent).children()[2]&&(a=0,o=jQuery("#"+e.parent)),0==e.position&&void 0!==jQuery("#"+e.parent).children()[2]&&(a=2,1==jQuery("#"+e.parent).children()[2].children.length?(a=0,o=jQuery(jQuery("#"+e.parent))):o=jQuery("#"+e.parent).children()[2].children[1]),e.position>0&&(o=jQuery("#"+e.parent).children()[2].children[e.position-1]),o=n.intideaobj.getAbsIndexOfNode(jQuery(o));var s="";e.old_instance.intideaobj!=n.intideaobj&&(s=e.old_instance.intideaobj),n.intideaobj.OnMoved&&n.intideaobj.OnMoved(i,o,a,r,s)},_treeonbeforedelete=function(t,e){return t=e.intideaobj.getAbsIndexOfNode(t),!!e.intideaobj.OnBeforeDelete&&AnyToInt(1==e.intideaobj.OnBeforeDelete(t))},_treeonbeforerename=function(t,e){return t=e.intideaobj.getAbsIndexOfNode(t),!!e.intideaobj.OnBeforeRename&&1==AnyToInt(e.intideaobj.OnBeforeRename(t))},_treeonafterrename=function(t,e,n){return t=e.intideaobj.getAbsIndexOfNode(t),!!e.intideaobj.OnAfterRename&&1==AnyToInt(e.intideaobj.OnAfterRename(t,n))},_treeondelete=function(t,e){var n=e.instance,i=n.intideaobj.getAbsIndexOfNode(jQuery("#"+e.node.id));n.intideaobj.OnDeleted&&n.intideaobj.OnDeleted(i)},_treeonrename=function(t,e){var n=e.instance,i=n.intideaobj.getAbsIndexOfNode(jQuery("#"+e.node.id)),r=e.text;n.intideaobj.OnRename&&n.intideaobj.OnRename(i,r)},_treeonselect=function(t,e){var n=e.instance,i=n.intideaobj.getAbsIndexOfNode(jQuery("#"+e.node.id));return n.intideaobj.OnClick&&n.intideaobj.OnClick(i),n.intideaobj.OnSelect&&n.intideaobj.OnSelect(i),!0},_treeonopennode=function(t,e){var n=jQuery.jstree.reference(this);if(n.intideaobj){var i=n.intideaobj.getAbsIndexOfNode(jQuery("#"+e.node.id));return n.intideaobj.OnExpand&&n.intideaobj.OnExpand(i),_treeonchapteropentoggle("#"+e.node.id),!0}},_treeonclosenode=function(t,e){var n=jQuery.jstree.reference(this);if(n.intideaobj){var i=n.intideaobj.getAbsIndexOfNode(jQuery("#"+e.node.id));return n.intideaobj.OnCollapse&&n.intideaobj.OnCollapse(i),_treeonchapteropentoggle("#"+e.node.id),!0}},_treeonredraw=function(t,e){var n=e.instance;return n.intideaobj.OnRedraw&&n.intideaobj.OnRedraw(),!0},_treeoncopy=function(t,e,n,i){t=(i=data.instance).intideaobj.getAbsIndexOfNode(t),e=i.intideaobj.getAbsIndexOfNode(e),i.intideaobj.OnCopied&&i.intideaobj.OnCopied(t,e,n)},_treeonready=function(){var t=jQuery.jstree.reference(this),e=jQuery.extend(!0,{},t.settings);t.settings=e,0==t.intideaobj.JSTDragable()&&(t.settings.dnd.is_draggable=!1)};var idea_treeconfig={core:{animation:50,check_callback:function(t,n,i,r,o){var a=!0,s=jQuery("#"+n.id);if("move_node"===t||"copy_node"==t){-1!=this.intideaobj.moveindex&&void 0!==this.intideaobj.moveindex||(this.intideaobj.moveindex=this.intideaobj.getAbsIndexOfNode(s),this.intideaobj.movenode=s);var l=1,d="";return(0!=r||!(isVarUndefined(i.li_attr)||"0"!=i.li_attr.rel&&"1"!=i.li_attr.rel))&&(0==r&&void 0===jQuery("#"+i.id).children()[2]&&(l=0,d=jQuery("#"+i.id)),0==r&&void 0!==jQuery("#"+i.id).children()[2]&&(l=2,d=jQuery("#"+i.id).children()[2].children[0]),r>0&&(d=jQuery("#"+i.id).children()[2].children[r-1]),(a=_treeonbeforemove(this.intideaobj.movenode,d,l,this,jQuery.jstree.reference(n.id)))&&checkinternal_move(this.intideaobj))}if("rename_node"==t)a=_treeonafterrename(n,this,r);else{if("delete_node"!=t)return!!a||(e.stopImmediatePropagation(),!1);a=_treeonbeforedelete(n,this)}},themes:{name:"default",url:!1},multiple:!1},search:{case_sensitive:!1},plugins:["dnd","types","search"],dnd:{copy:!0},types:{types:{TIdeaPage:{valid_children:["none"],max_children:0,max_depth:0},TStdOrganization:{valid_children:[cTIdeaPage,cTStdOrganization]}}}};function checkinternal_move(t){return 1!=parseInt(t.JSTReadOnly())}function onbeforehandler(t,e){var n=e.instance,i=e.func;if(null!=i.match(/rename_node|rename|prepare_move|delete_node/g)){var r=n.get_node(t.currentTarget,!0),o=n.get_node(e.node,!0),a=e.position,s=!0;return"rename"==i&&(s=_treeonbeforerename(r,n)),"prepare_move"==i&&(s=_treeonbeforemove(r,o,a,n,jQuery.jstree.reference(r))),"rename_node"==i&&(s=_treeonafterrename(r,n,e.text)),"delete_node"!=i||n.intideaobj.internal_clear||(s=_treeonbeforedelete(r,n)),s?void 0:(t.stopImmediatePropagation(),!1)}}function ExtJSTreeView(t){arguments.length<=0||(TStdVisibleComponent.call(this,t),this.obj.style.overflow="auto",this.inttreename="#"+this.obj.id+"int",this.root=new ExtNode(-1,-2),this.obj.style.MozBoxSizing="content-box",this.obj.style.boxSizing="content-box",this.obj.style.msBoxSizing="content-box",this.internal_clear=!1)}ExtJSTreeView.prototype=new TStdVisibleComponent,ExtJSTreeView.prototype.constructor=ExtJSTreeView,ExtJSTreeView.prototype.attr_AutoFullExpand=0,ExtJSTreeView.prototype.attr_AutoExpand=1,ExtJSTreeView.prototype.attr_Borderstyle=1,ExtJSTreeView.prototype.attr_Filename="",ExtJSTreeView.prototype.attr_XMLFilename="",ExtJSTreeView.prototype.attr_XMLFileName="",ExtJSTreeView.prototype.attr_GlyphNormal="",ExtJSTreeView.prototype.attr_GlyphExpanded="",ExtJSTreeView.prototype.attr_GlyphCollapsed="",ExtJSTreeView.prototype.attr_ShowLines=0,ExtJSTreeView.prototype.attr_Index=0,ExtJSTreeView.prototype.attr_IconHorAlignment=0,ExtJSTreeView.prototype.attr_AutoLineBreak=0,ExtJSTreeView.prototype.attr_Picture="",ExtJSTreeView.prototype.attr_NumGlyphs=0,ExtJSTreeView.prototype.attr_PageCount=0,ExtJSTreeView.prototype.attr_ImgByCSS=0,ExtJSTreeView.prototype.attr_JSTDragable=1,ExtJSTreeView.prototype.attr_JSTExtDragable=0,ExtJSTreeView.prototype.attr_JSTReadOnly=0,ExtJSTreeView.prototype.attr_JSTCaptionAsName=1,ExtJSTreeView.prototype.root=null,ExtJSTreeView.prototype.isPageReady=!1,ExtJSTreeView.prototype.tree=null,ExtJSTreeView.prototype.isTreeInit=!1,ExtJSTreeView.prototype.internal_clear=!1,ExtJSTreeView.prototype.internal_xml=null,ExtJSTreeView.prototype.rootElement="",ExtJSTreeView.prototype.endElement="</TProject>",ExtJSTreeView.prototype.posConst=["inside","after","before","first","last"];var tpInside=0,tpAfter=1,tpBefore=2,tpFirst=3,tpLast=4;function createExtJSTreeView(t,e,n,i){idea_treeconfig.core.multiple=AnyToBool(i);var r=document.createElement("div");e.obj.appendChild(r);var o=document.createElement("div");r.setAttribute("id",n+t),r.appendChild(o),o.setAttribute("id",n+t+"int"),o.style.MozBoxSizing="content-box",o.style.overflow="auto";var a=document.createElement("ul");return o.appendChild(a),r.pageName=n,r.obj=t,new ExtJSTreeView(r)}function ieQuirksSlideUp(t,e,n){var i=t.height(),r=t.css("height");t.animate({height:"1px"},e,function(){t.hide(),t.height(i),t.css("height",r),t.css("display","none")})}ExtJSTreeView.prototype.JSTDragable=function(t){if(!arguments.length)return this.attr_JSTDragable;this.attr_JSTDragable=AnyToInt(t)},ExtJSTreeView.prototype.JSTExtDragable=function(t){if(!arguments.length)return this.attr_JSTExtDragable;1==AnyToBool(t)&&0==AnyToBool(this.attr_JSTExtDragable)&&(jQuery(document).on("dnd_move.vakata",_moveDrag),jQuery(document).on("dnd_stop.vakata",_stopDrag),jQuery(document).on("dnd_start.vakata",_startDrag),this.tree.settings.dnd.is_draggable=!0),0==AnyToBool(t)&&1==AnyToBool(this.attr_JSTExtDragable)&&(jQuery(document).off("dnd_move.vakata",_moveDrag),jQuery(document).off("dnd_stop.vakata",_stopDrag),jQuery(document).off("dnd_stop.vakata",_startDrag),this.tree.settings.dnd.is_draggable=!1),this.attr_JSTExtDragable=AnyToInt(t)},ExtJSTreeView.prototype.JSTReadOnly=function(t){if(!arguments.length)return this.attr_JSTReadOnly;this.attr_JSTReadOnly=AnyToInt(t)},ExtJSTreeView.prototype.JSTCaptionAsName=function(t){if(!arguments.length)return this.attr_JSTCaptionAsName;this.attr_JSTCaptionAsName=AnyToInt(t)},ExtJSTreeView.prototype.IconHorAlignment=function(t){if(!arguments.length)return this.attr_IconHorAlignment;this.attr_IconHorAlignment=AnyToInt(t)},ExtJSTreeView.prototype.AutoLineBreak=function(t){if(!arguments.length)return this.attr_AutoLineBreak;this.attr_AutoLineBreak=AnyToInt(t)},ExtJSTreeView.prototype.AutoFullExpand=function(t){if(!arguments.length)return this.attr_AutoFullExpand;t=Number(t),this.attr_AutoFullExpand=t},ExtJSTreeView.prototype.AutoExpand=function(t){if(!arguments.length)return this.attr_AutoFullExpand;t=Number(t),this.attr_AutoExpand=t},ExtJSTreeView.prototype.Borderstyle=function(t){if(!arguments.length)return this.attr_Borderstyle;t=AnyToInt(t);this.attr_Borderstyle=t,this.obj.style.borderStyle=1==t?"groove":"none"},ExtJSTreeView.prototype.Filename=function(t){if(!arguments.length)return this.attr_Filename;this.attr_Filename=t},ExtJSTreeView.prototype.loadFromString=function(t){arguments.length&&this.isTreeInit&&(this.content=t,this.clear(),this.fillNodes(this.tree.root,this.content))},ExtJSTreeView.prototype.XMLFileName=function(t){if(!arguments.length)return this.XMLFilename();this.XMLFilename(t)},ExtJSTreeView.prototype.XMLFilename=function(t){if(!arguments.length)return this.attr_XMLFilename;if(t.length>0&&""!=t&&(this.attr_XMLFilename=t,this.isTreeInit)){this.content=ReadTextFile(t,!0,pages[this.pageName]),this.content.startsWith("<?xml")&&(this.content=this.content.substring(this.content.lastIndexOf("?>")+2,this.content.length));var e=GetXMLDocFromString(this.content),n=e.cloneNode(!1);this.rootElement=(n.xml?n.xml:serializeNode(n)).replace(/\/>/g,">"),jQuery(this.inttreename).unbind("move_node.jstree",_treeonmoved),jQuery(this.inttreename).unbind("copy_node.jstree",_treeonmoved),jQuery(this.inttreename).unbind("rename_node.jstree",_treeonrename),jQuery(this.inttreename).unbind("delete_node.jstree",_treeondelete),jQuery(this.inttreename).unbind("select_node.jstree",_treeonselect),jQuery(this.inttreename).unbind("before.jstree",onbeforehandler),jQuery(this.inttreename).unbind("redraw.jstree",_treeonredraw),jQuery(this.inttreename).unbind("open_node.jstree",_treeonopennode),jQuery(this.inttreename).unbind("close_node.jstree",_treeonclosenode),jQuery(this.inttreename).unbind("ready.jstree",_treeonready),this.tree.intideaobj=null,this.tree.destroy(!1),this.attr_PageCount=0,jQuery(this.inttreename).empty(),this.internal_xml=e;var i=$(this.obj.id+"int").appendChild(document.createElement("ul"));this.fillNodesfromXML(-1,e,0,0,i),jQuery(this.inttreename).jstree(idea_treeconfig),this.tree=jQuery.jstree.reference(this.inttreename),this.tree.open_all(),this.tree.intideaobj=this,jQuery(this.inttreename).bind("move_node.jstree",_treeonmoved),jQuery(this.inttreename).bind("copy_node.jstree",_treeonmoved),jQuery(this.inttreename).bind("rename_node.jstree",_treeonrename),jQuery(this.inttreename).bind("delete_node.jstree",_treeondelete),jQuery(this.inttreename).bind("select_node.jstree",_treeonselect),jQuery(this.inttreename).bind("open_node.jstree",_treeonopennode),jQuery(this.inttreename).bind("close_node.jstree",_treeonclosenode),jQuery(this.inttreename).bind("before.jstree",onbeforehandler),jQuery(this.inttreename).bind("redraw.jstree",_treeonredraw),jQuery(this.inttreename).bind("ready.jstree",_treeonready),this.isTreeInit=!0}},ExtJSTreeView.prototype.GlyphNormal=function(t){if(!arguments.length)return this.attr_GlyphNormal;this.attr_GlyphNormal=t,this.isTreeInit&&(t=expandmetavar(t,this.pageName),this.tree.icon.node=t)},ExtJSTreeView.prototype.GlyphExpanded=function(t){if(!arguments.length)return this.attr_GlyphExpanded;this.attr_Expanded=t,this.isTreeInit&&(t=expandmetavar(t,this.pageName),this.tree.icon.folderOpen=t)},ExtJSTreeView.prototype.GlyphCollapsed=function(t){if(!arguments.length)return this.attr_GlyphCollapsed;this.attr_Expanded=t,this.isTreeInit&&(t=expandmetavar(t,this.pageName),this.tree.icon.folder=t)},ExtJSTreeView.prototype.ShowLines=function(t){if(!arguments.length)return this.attr_ShowLines;t=Number(t),this.attr_ShowLines=t},ExtJSTreeView.prototype.int_onMouseDown=function(t,e){var n=convertMouseParams(t);extractEventTarget(t)!=this.obj&&(n=getRelCoordOnParent(extractEventTarget(t),this.obj,n)),this.OnItemDown&&this.OnItemDown(this.getAbsIndexOfNode(e))},ExtJSTreeView.prototype.TreeViewSetAttribute=function(t,e,n){var i=this.selectXMLNodes("//*");null!==i&&i[t].setAttribute(e,n)},ExtJSTreeView.prototype.TreeViewGetAttribute=function(t,e){var n=this.selectXMLNodes("//*");return null!==n?n[t].getAttribute(e):""},ExtJSTreeView.prototype.TreeViewFullExpand=function(t){this.tree.open_all()},ExtJSTreeView.prototype.TreeViewFullCollapse=function(t){this.tree.close_all()},ExtJSTreeView.prototype.TreeViewItemCount=function(){return AnyToInt(jQuery(this.inttreename).find("li").size())},ExtJSTreeView.prototype.LoadTreeView=function(t){this.Filename(t)},ExtJSTreeView.prototype.LoadXMLTreeView=function(t){this.XMLFilename(t)},ExtJSTreeView.prototype.SetXMLTreeView=function(t){this.internal_xml=null,this.content=t,this.content.startsWith("<?xml")&&(this.content=this.content.substring(this.content.lastIndexOf("?>")+2,this.content.length));var e=GetXMLDocFromString(this.content),n=e.cloneNode(!1);this.rootElement=(n.xml?n.xml:serializeNode(n)).replace(/\/>/g,">"),jQuery(this.inttreename).unbind("move_node.jstree",_treeonmoved),jQuery(this.inttreename).unbind("copy_node.jstree",_treeonmoved),jQuery(this.inttreename).unbind("rename_node.jstree",_treeonrename),jQuery(this.inttreename).unbind("delete_node.jstree",_treeondelete),jQuery(this.inttreename).unbind("select_node.jstree",_treeonselect),jQuery(this.inttreename).unbind("open_node.jstree",_treeonopennode),jQuery(this.inttreename).unbind("close_node.jstree",_treeonclosenode),jQuery(this.inttreename).unbind("before.jstree",onbeforehandler),jQuery(this.inttreename).unbind("redraw.jstree",_treeonredraw),jQuery(this.inttreename).unbind("ready.jstree",_treeonready),this.tree.intideaobj=null,this.tree.destroy(),jQuery(this.inttreename).empty(),this.attr_PageCount=0,this.internal_xml=e;var i=$(this.obj.id+"int").appendChild(document.createElement("ul"));this.fillNodesfromXML(-1,e,0,0,i),jQuery(this.inttreename).jstree(idea_treeconfig),this.tree=jQuery.jstree.reference(this.inttreename),this.tree.open_all(),this.tree.intideaobj=this,jQuery(this.inttreename).bind("move_node.jstree",_treeonmoved),jQuery(this.inttreename).bind("copy_node.jstree",_treeonmoved),jQuery(this.inttreename).bind("rename_node.jstree",_treeonrename),jQuery(this.inttreename).bind("delete_node.jstree",_treeondelete),jQuery(this.inttreename).bind("select_node.jstree",_treeonselect),jQuery(this.inttreename).bind("before.jstree",onbeforehandler),jQuery(this.inttreename).bind("redraw.jstree",_treeonredraw),jQuery(this.inttreename).bind("open_node.jstree",_treeonopennode),jQuery(this.inttreename).bind("close_node.jstree",_treeonclosenode),jQuery(this.inttreename).bind("ready.jstree",_treeonready),this.isTreeInit=!0},ExtJSTreeView.prototype.CheckOpenState=function(t,e){var n=e.get_parent(t);return e.is_open(n)?"#"==n||e.intideaobj.CheckOpenState(n,e):"#"==n},ExtJSTreeView.prototype.GetTreeViewInfo=function(t){t=Number(t);var e=jQuery(this.inttreename).find("li");if(t<e.size()){var n=this.tree.get_node(e[t],!0);return n?(e=n.attr("nodeinfo")).replace(/regexwa/g,"/>"):""}},ExtJSTreeView.prototype.SetTreeViewInfo=function(t,e){t=Number(t);var n=jQuery(this.inttreename).find("li");if(t<n.size()){var i=this.tree.get_node(n[t],!0);if(!i)return;i.attr("nodeinfo",e.replace(/\/>/g,"regexwa")),this.tree._model.data[n[t].id].li_attr.nodeinfo=e.replace(/\/>/g,"regexwa")}},ExtJSTreeView.prototype.SetTreeViewText=function(t,e){t=Number(t);var n=jQuery(this.inttreename).find("li");t<n.size()&&this.tree.rename_node(n[t],e)},ExtJSTreeView.prototype.GetTreeViewText=function(t,e){t=Number(t);var n=jQuery(this.inttreename).find("li");if(t<n.size())return this.tree.get_text(n[t],e)},ExtJSTreeView.prototype.Index=function(t){if(!arguments.length)return this.isTreeInit?this.getAbsIndexOfNode(jQuery("#"+this.tree.get_selected()[0])):this.attr_Index;if(t=AnyToInt(t),this.attr_Index=t,this.isTreeInit){var e=jQuery(this.inttreename).find("li");t>-1&&t<e.size()&&(this.tree.deselect_all(),this.tree.select_node(e[t],!0))}},ExtJSTreeView.prototype.Picture=function(t){if(!arguments.length)return this.attr_Picture;this.attr_Picture=t,""!=t&&(t=expandmetavar(null==(t=0==this.attr_NumGlyphs?t:this.attr_Picture0)?t=this.attr_Picture:t,this.pageName))},ExtJSTreeView.prototype.NumGlyphs=function(t){if(!arguments.length)return this.attr_NumGlyphs;t=AnyToInt(t),this.attr_NumGlyphs=t,this.Picture(this.Picture())},ExtJSTreeView.prototype.ImgByCSS=function(t){if(!arguments.length)return this.attr_ImgByCSS;this.attr_ImgByCSS=t},ExtJSTreeView.prototype.PageCount=function(t){if(!arguments.length)return this.attr_PageCount;this.attr_PageCount=t},ExtJSTreeView.prototype.TreeViewChildCount=function(t){var e=0;t=AnyToInt(t);var n=jQuery(this.inttreename).find("li");return t<n.size()&&(e=jQuery(n[t]).find("li").size()),e},ExtJSTreeView.prototype.TreeViewGetChildAbsoluteIndex=function(t,e){t=AnyToInt(t);var n=e=AnyToInt(e),i=jQuery(this.inttreename).find("li");return t<i.size()&&e<=jQuery(i[t]).children().size()&&(n=t+e),n},ExtJSTreeView.prototype.TreeViewGetNodeLevel=function(t){var e=0,n=jQuery(this.inttreename).find("li");if(t<n.size()){for(var i=this.tree.get_node(n[t],!0),r=0;0!=(i=this.tree.get_parent(i));)r++;e=r}return e},ExtJSTreeView.prototype.TreeViewHasNodeChildren=function(t){var e=0;t=AnyToInt(t);var n=jQuery(this.inttreename).find("li");return t<n.size()&&(e=jQuery(n[t]).find("li").size()),0==e?0:1},ExtJSTreeView.prototype.TreeViewIsNodeExpanded=function(t){var e=0,n=jQuery(this.inttreename).find("li");return t<n.size()&&(e=jQuery(n[t]).is(".jstree-open")?1:0),e},ExtJSTreeView.prototype.TreeViewSetImageIndex=function(t,e){t=AnyToInt(t),e=AnyToInt(e);var n=jQuery(this.inttreename).find("li");if(1==AnyToBool(this.attr_ImgByCSS))n[t].setAttribute("rel",e);else if(t<n.size()&&""!=this.attr_Picture&&t<n.size()&&e<this.attr_NumGlyphs){var i=expandmetavar(this["attr_Picture"+e],this.pageName),r={};r=void 0!==jQuery(n[t]).find("a:first").find("i:first")[0]?jQuery(n[t]).find("a:first").find("i:first")[0].style:jQuery(n[t]).find("span:first").find("i:first")[0].style;var o=n[t].getAttribute("rel","");if(""!=o){var a=n[t].getAttribute("nodeInfo");a=StrReplace(a,"rel="+scDQ+o+scDQ,"rel="+scDQ+AnyToStr(e)+scDQ),n[t].setAttribute("nodeInfo",a)}n[t].setAttribute("rel","custom"),r.backgroundImage="url("+i+")",r.backgroundPosition="50%",this.tree._model.data[n[t].id].icon=i}},ExtJSTreeView.prototype.TreeViewSetImageFile=function(t,e){t=AnyToInt(t);var n=jQuery(this.inttreename).find("li");if(t<n.size()){var i=expandmetavar(e,this.pageName),r={};r=void 0!==jQuery(n[t]).find("a:first").find("i:first")[0]?jQuery(n[t]).find("a:first").find("i:first")[0].style:jQuery(n[t]).find("span:first").find("i:first")[0].style,n[t].setAttribute("rel","custom"),r.backgroundImage="url("+i+")",r.backgroundPosition="50%",this.tree._model.data[n[t].id].icon=i}},ExtJSTreeView.prototype.getParentIndex=function(t){var e=jQuery(this.inttreename).find("li"),n=-1;if(t<e.size()){var i=this.tree.get_node(e[t],!0),r=this.tree.get_parent(i);"#"!=r&&(n=this.getAbsIndexOfNode(jQuery("#"+r)))}return n},ExtJSTreeView.prototype.onpgready=function(){jQuery(this.inttreename).jstree(idea_treeconfig),jQuery(this.inttreename).bind("move_node.jstree",_treeonmoved),jQuery(this.inttreename).bind("copy_node.jstree",_treeonmoved),jQuery(this.inttreename).bind("rename_node.jstree",_treeonrename),jQuery(this.inttreename).bind("delete_node.jstree",_treeondelete),jQuery(this.inttreename).bind("select_node.jstree",_treeonselect),jQuery(this.inttreename).bind("redraw.jstree",_treeonredraw),jQuery(this.inttreename).bind("before.jstree",onbeforehandler),jQuery(this.inttreename).bind("open_node.jstree",_treeonopennode),jQuery(this.inttreename).bind("close_node.jstree",_treeonclosenode),jQuery(this.inttreename).bind("ready.jstree",_treeonready),this.tree=jQuery.jstree.reference(this.inttreename),this.tree.intideaobj=this,this.isTreeInit=!0,this.Filename(this.Filename()),this.XMLFilename(this.XMLFilename()),this.Index(this.attr_Index),TStdVisibleComponent.prototype.onpgready.call(this)},ExtJSTreeView.prototype.Visible=function(t){if(!arguments.length)return this.attr_Visible;TStdVisibleComponent.prototype.Visible.call(this,t)},ExtJSTreeView.prototype.getAbsIndexOfNode=function(t){return null==t?-1:jQuery(this.inttreename).find("li").index(t[0])},ExtJSTreeView.prototype.fillNodes=function(t,e){for(var n=[],i=e.split("\n"),r=0,o=null,a=0,s=i.length;r<s;r++)if(i[r]=replace(i[r],"\r",""),""!=i[r]&&((o=this.readNodeInfo(i[r],r)).id=r,o.pid=t.id,o.depth=a,t.childs++,this.addNodeInternal(o,t.id),r+1<i.length)){for(a=0;"\t"==i[r+1].charAt(a);)a++;if(a>n.length)n.push(t),t=o;else if(a<n.length)do{t=n.pop()}while(a<n.length)}},ExtJSTreeView.prototype.readNodeInfo=function(t,e){t=replace(t,"\t","");for(var n=[],i=0,r=0;i<t.length;){var o;if('"'==t.charAt(i))if((o=t.indexOf('"',i+1))>=i)n[r]=t.substring(i+1,o),i=o+2;else{if(!((o=t.indexOf(",",i+1))>=0))return;n[r]=t.substring(i,o),i=o+1}else(o=t.indexOf(",",i))>=0?(n[r]=t.substring(i,o),i=o+1):(n[r]=t.substring(i),i=t.length);r++}return new ExtNode(e,0,replace(n[0],'"',""),n[1]?n[1]:" ")},ExtJSTreeView.prototype.fillNodesfromXML=function(t,e,n,i,r){for(var o,a,s,l,d,h,u,c=null,p=e.childNodes.length,m=0;m<p;m++)a=e.childNodes[m],s=null,"1"==this.attr_JSTCaptionAsName&&null==(s=a.attributes.getNamedItem("Caption"))&&(s=a.attributes.getNamedItem("caption")),null==s&&(s=a.attributes.getNamedItem("Name")),null==s&&(s=a.attributes.getNamedItem("name")),d=s.value,1==AnyToBool(this.attr_ImgByCSS)&&(l="0",null!=(s=a.attributes.getNamedItem("rel"))&&"undefined"!=s&&(l=s.value)),s=a.attributes,"",(o=new ExtNode(n,0,d,(h=a.cloneNode(!1)).xml?h.xml:serializeNode(h),l)).id=n,o.pid=-1==t?-1:t.id,o.depth=i,a.nodeName==cTIdeaPage?(o.type=cTIdeaPage,this.attr_PageCount++):a.nodeName==cTStdOrganization&&(o.type=cTStdOrganization),u=this.addHTMLNodeInternal(o,r),n++,a.hasChildNodes()&&(c=document.createElement("ul"),u.appendChild(c),n=this.fillNodesfromXML(o,a,n,i+1,c));return n},ExtJSTreeView.prototype.addHTMLNodeInternal=function(t,e){var n;null===t.info&&null!==t.type&&(t.info="<"+t.type+"/>"),t.info=t.info.replace(/\/>/g,"regexwa");var i=document.createElement("li");if(n=null,1==AnyToBool(this.attr_ImgByCSS)&&(n=t.rel),null==n||"undefined"==n){var r=document.createAttribute("rel");t.type==cTStdOrganization?r.value="1":r.value="2",i.attributes.setNamedItem(r)}else i.setAttribute("rel",t.rel);i.setAttribute("nodeinfo",t.info);var o=document.createElement("a"),a=document.createTextNode(t.name);return o.appendChild(a),i.appendChild(o),o.href="#",e.appendChild(i),i},ExtJSTreeView.prototype.TEJSTaddNode=function(t,e,n,i,r){var o=new ExtNode(1,n,t,e);return o.type=void 0!==r&&""!=r?r:null,this.addNodeInternal(o,n,i,!0)},ExtJSTreeView.prototype.addNodeInternal=function(t,e,n,i){i&&(null!==t.info&&""!==t.info||null===t.type||(t.info="<"+t.type+"/>")),t.info=t.info.replace(/\/>/g,"regexwa"),n=void 0===n||""===n?null:this.posConst[AnyToInt(n)];var r=-1,o=new Object;if(o.li_attr=new Object,o.li_attr.nodeinfo=t.info,t.type==cTStdOrganization)o.li_attr.rel="0";else{var a=t.info.indexOf('rel="');if(a>=0){var s=t.info.indexOf(t.info[a+4],a+5);o.li_attr.rel=s>=0?t.info.substr(a+5,s-(a+5)):"2"}else o.li_attr.rel="2"}if(o.text=t.name,""===e){e=this.Index();var l=jQuery(this.inttreename).find("li");return n=null===n?"after":n,r=this.tree.create_node(jQuery(l[e]),o,n),this.getAbsIndexOfNode(jQuery("#"+r))}if(e=AnyToInt(e),n=null===n?"last":n,-1==e)r=this.tree.create_node(-1,o,n);else{l=jQuery(this.inttreename).find("li");r=this.tree.create_node(jQuery(l[e]),o,n)}return this.tree.open_node(jQuery(l[e])),this.getAbsIndexOfNode(jQuery("#"+r))},ExtJSTreeView.prototype.TEJSTclear=function(t,e){this.clear()},ExtJSTreeView.prototype.clear=function(t,e){jQuery(this.inttreename).unbind("move_node.jstree",_treeonmoved),jQuery(this.inttreename).unbind("copy_node.jstree",_treeonmoved),jQuery(this.inttreename).unbind("rename_node.jstree",_treeonrename),jQuery(this.inttreename).unbind("delete_node.jstree",_treeondelete),jQuery(this.inttreename).unbind("select_node.jstree",_treeonselect),jQuery(this.inttreename).unbind("before.jstree",onbeforehandler),jQuery(this.inttreename).unbind("redraw.jstree",_treeonredraw),jQuery(this.inttreename).unbind("open_node.jstree",_treeonopennode),jQuery(this.inttreename).unbind("close_node.jstree",_treeonclosenode),jQuery(this.inttreename).unbind("ready.jstree",_treeonready),this.tree.intideaobj=null,this.tree.destroy(),jQuery(this.inttreename).empty(),jQuery(this.inttreename).jstree(idea_treeconfig),this.tree=jQuery.jstree.reference(this.inttreename),this.tree.intideaobj=this,jQuery(this.inttreename).bind("move_node.jstree",_treeonmoved),jQuery(this.inttreename).bind("copy_node.jstree",_treeonmoved),jQuery(this.inttreename).bind("rename_node.jstree",_treeonrename),jQuery(this.inttreename).bind("delete_node.jstree",_treeondelete),jQuery(this.inttreename).bind("select_node.jstree",_treeonselect),jQuery(this.inttreename).bind("before.jstree",onbeforehandler),jQuery(this.inttreename).bind("redraw.jstree",_treeonredraw),jQuery(this.inttreename).bind("open_node.jstree",_treeonopennode),jQuery(this.inttreename).bind("close_node.jstree",_treeonclosenode),jQuery(this.inttreename).bind("ready.jstree",_treeonready),this.isTreeInit=!0},ExtJSTreeView.prototype.TEJSTcutNode=function(t){if(t&&""!=t){t=AnyToInt(t);var e=jQuery(this.inttreename).find("li");t<e.size()&&this.tree.cut(e[t])}else this.tree.cut()},ExtJSTreeView.prototype.TEJSTcopyNode=function(t){if(t&&""!=t){t=AnyToInt(t);var e=jQuery(this.inttreename).find("li");t<e.size()&&this.tree.copy(e[t])}else this.tree.copy()},ExtJSTreeView.prototype.TEJSTpasteNode=function(t,e){var n=this.tree.get_buffer(),i=n.node[0];if(void 0!==t&&""!==t){t=AnyToInt(t);var r=jQuery(this.inttreename).find("li"),o=r[t];t<r.size()&&(this.tree.open_node(o),4==e?e="last":(o=this.tree.get_node(jQuery("#"+r[t].id).parent().parent().attr("id")),e=AnyToInt(e=jQuery("#"+r[t].id).parent().children().index(jQuery("#"+r[t].id)))+1),this.tree.paste(o,e),this.tree.open_node(o))}else this.tree.paste();if("copy_node"==n.mode){this.tree.get_selected()[0];return this.getAbsIndexOfNode(jQuery("#"+this.tree.get_selected()[0]))}return this.getAbsIndexOfNode(jQuery("#"+i.id))},ExtJSTreeView.prototype.TEJSTmoveNode=function(t,e,n){if(t&&""!=t){t=AnyToInt(t),e=AnyToInt(e);var i=jQuery(this.inttreename).find("li");t<i.size()&&this.tree.move_node(i[t],i[e],this.posConst[n])}},ExtJSTreeView.prototype.TEJSTremoveNode=function(t){if(!arguments.length||isNaN(t)||""===t||AnyToInt(t)<0)return!1;t=AnyToInt(t);var e=jQuery(this.inttreename).find("li");return t<e.size()&&(this.tree.delete_node(jQuery("#"+e[t].id)),!0)},ExtJSTreeView.prototype.TEJSTcallNodeTextEditor=function(t){if(t&&""!=t){t=AnyToInt(t);var e=jQuery(this.inttreename).find("li");t<e.size()&&this.tree.edit(e[t])}else this.tree.edit()},ExtJSTreeView.prototype.TEJSTsearchNode=function(t){this.tree.search(t)},ExtJSTreeView.prototype.TEJSTclearSearchNode=function(t){this.tree.clear_search()},ExtJSTreeView.prototype.TEJSTtoggleopclose=function(t){if(t&&""!=t){t=AnyToInt(t);var e=jQuery(this.inttreename).find("li");t<e.size()&&this.tree.toggle_node(e[t])}else this.tree.toggle_node()},ExtJSTreeView.prototype.Width=function(t){if(!arguments.length)return TStdVisibleComponent.prototype.Width.call(this);TStdVisibleComponent.prototype.Width.call(this,t),this.obj.firstChild.style.Width=t+px},ExtJSTreeView.prototype.getHoverNode=function(){var t=jQuery(this.inttreename).find(".jstree-hovered").parent();return this.getAbsIndexOfNode(t)},ExtJSTreeView.prototype.Height=function(t){if(!arguments.length)return TStdVisibleComponent.prototype.Height.call(this);TStdVisibleComponent.prototype.Height.call(this,t),this.obj.firstChild.style.Height=t+px},ExtJSTreeView.prototype.selectXMLNodes=function(t,e){var n=null,i=[];if(null===e)return n;if(window.ActiveXObject){n=e.ownerDocument.selectNodes(t);for(var r=1;r<n.length;r++)i[r-1]=n.item(r)}else if(document.implementation&&document.implementation.createDocument){t=StrReplace(t,"//",""),n=e.ownerDocument.querySelectorAll(t);for(r=1;r<n.length;r++)i[r-1]=n[r]}return i.length>0?n=i:n.snapshotLength>0&&(i[0]=n.snapshotItem(0),n=i),n},ExtJSTreeView.prototype.get_XML=function(t,e){var n="",i=this,r="";return t&&-1!==t||(t=jQuery(this.inttreename).find("> ul > li")),t.each(function(){li=jQuery(this);var t=li.find("> ul > li");n+=t.length?li.attr("nodeinfo").replace(/regexwa/g,">"):li.attr("nodeinfo").replace(/regexwa/g,"/>"),li.attr("rel"),li=t,r=li.length?i.get_XML(li,!0):"",n+=r,n+=t.length?"</TStdOrganization>":""}),n},ExtJSTreeView.prototype.TEJSTSetXMLAttribute=function(t,e,n){var i=this.GetTreeViewInfo(t);if(isVarUndefined(i))return!1;var r=new RegExp(e+'="([^\\"]*)"',"i");return i=void 0!==r.exec(i)&&null!=r.exec(i)?i.replace(r,e+'="'+n+'"'):StrInsert(e+'="'+n+'" ',i,i.indexOf(" ")+2),this.SetTreeViewInfo(t,i),"Caption"==e&&"1"==this.attr_JSTCaptionAsName&&this.SetTreeViewText(t,n),!0},ExtJSTreeView.prototype.TEJSTGetXMLAttribute=function(t,e,n){var i=this.GetTreeViewInfo(t);if(isVarUndefined(i))return n;var r=new RegExp(e+'="([^\\"]*)|'+e+"='([^\\']*)'","i").exec(i);return null===r?n:void 0!==r[1]?r[1]:r[2]},ExtJSTreeView.prototype.TEJSTRemoveXMLAttribute=function(t,e){var n=this.GetTreeViewInfo(t),i=new RegExp(e+'="([^\\"]*)"',"i");n=n.replace(i,""),this.SetTreeViewInfo(t,n)},ExtJSTreeView.prototype.TEJSTSaveXMLFile=function(){return"<PageTree >"==this.rootElement||"<PageTree>"==this.rootElement?this.rootElement+this.get_XML(-1)+"</"+this.rootElement.substr(1):this.rootElement+this.get_XML(-1)+this.endElement},ExtJSTreeView.prototype.TEJSTSearchNodeWithAttr=function(t,e){e=AnyToStr(e);for(var n=this.selectXMLNodes("//*",GetXMLDocFromString(this.TEJSTSaveXMLFile())),i=n.length,r=0;r<i;r++)if(n[r].getAttribute(t)===e)return r;return-1},ExtJSTreeView.prototype.deInit=function(){jQuery(this.inttreename).unbind("move_node.jstree",_treeonmoved),jQuery(this.inttreename).unbind("copy_node.jstree",_treeonmoved),jQuery(this.inttreename).unbind("rename_node.jstree",_treeonrename),jQuery(this.inttreename).unbind("delete_node.jstree",_treeondelete),jQuery(this.inttreename).unbind("select_node.jstree",_treeonselect),jQuery(this.inttreename).unbind("before.jstree",onbeforehandler),jQuery(this.inttreename).unbind("redraw.jstree",_treeonredraw),jQuery(this.inttreename).unbind("open_node.jstree",_treeonopennode),jQuery(this.inttreename).unbind("close_node.jstree",_treeonclosenode),jQuery(this.inttreename).unbind("ready.jstree",_treeonready),this.tree.intideaobj=null,this.tree.destroy(),jQuery(this.inttreename).empty(),TStdVisibleComponent.prototype.deInit.call(this)},ExtJSTreeView.prototype.removeEdit=function(){jQuery($("treeeditbox")).blur()},_fninternalpet={load_node:function(t,e,n){var i=this;this.load_node_xml(t,function(){i.__callback({obj:t}),e.call(this)},n)},_is_loaded:function(t){var e=this._get_settings().xml_data;return-1==(t=this._get_node(t))||!t||!e.ajax||t.is(".jstree-open, .jstree-leaf")||t.children("ul").children("li").size()>0},load_node_xml:function(t,e,n){var i=this.get_settings().xml_data,r=function(){},o=function(){};if((t=this._get_node(t))&&-1!==t){if(t.data("jstree-is-loading"))return;t.data("jstree-is-loading",!0)}switch(!0){case!i.data&&!i.ajax:throw"Neither data nor ajax settings supplied.";case!!i.data&&!i.ajax||!!i.data&&!!i.ajax&&(!t||-1===t):t&&-1!=t||this.parse_xml(i.data,$.proxy(function(n){n?(n=n.replace(/ ?xmlns="[^"]*"/gi,"")).length>10&&(n=$(n),this.get_container().children("ul").empty().append(n.children()),i.clean_node&&this.clean_node(t),e&&e.call(this)):i.correct_state&&(this.get_container().children("ul").empty(),e&&e.call(this))},this));break;case!i.data&&!!i.ajax||!!i.data&&!!i.ajax&&t&&-1!==t:r=function(e,r,o){var a=this.get_settings().xml_data.ajax.error;a&&a.call(this,e,r,o),-1!==t&&t.length?(t.children(".jstree-loading").removeClass("jstree-loading"),t.data("jstree-is-loading",!1),"success"===r&&i.correct_state&&t.removeClass("jstree-open jstree-closed").addClass("jstree-leaf")):"success"===r&&i.correct_state&&this.get_container().children("ul").empty(),n&&n.call(this)},o=function(n,o,a){n=a.responseText;var s=this.get_settings().xml_data.ajax.success;if(s&&(n=s.call(this,n,o,a)||n),""==n)return r.call(this,a,o,"");this.parse_xml(n,$.proxy(function(n){n&&((n=n.replace(/ ?xmlns="[^"]*"/gi,"")).length>10?(n=$(n),-1!==t&&t?(t.children(".jstree-loading").removeClass("jstree-loading"),t.append(n),t.data("jstree-is-loading",!1)):this.get_container().children("ul").empty().append(n.children()),i.clean_node&&this.clean_node(t),e&&e.call(this)):t&&-1!==t?(t.children(".jstree-loading").removeClass("jstree-loading"),t.data("jstree-is-loading",!1),i.correct_state&&(t.removeClass("jstree-open jstree-closed").addClass("jstree-leaf"),e&&e.call(this))):i.correct_state&&(this.get_container().children("ul").empty(),e&&e.call(this)))},this))},i.ajax.context=this,i.ajax.error=r,i.ajax.success=o,i.ajax.dataType||(i.ajax.dataType="xml"),$.isFunction(i.ajax.url)&&(i.ajax.url=i.ajax.url.call(this,t)),$.isFunction(i.ajax.data)&&(i.ajax.data=i.ajax.data.call(this,t)),$.ajax(i.ajax)}},parse_xml:function(t,e){var n=this._get_settings().xml_data;$.vakata.xslt(t,xsl[n.xsl],e)},get_xml:function(t,e,n,i,r){var o,a,s,l,d="",h=this._get_settings(),u=this;return t||(t="flat"),r||(r=0),(e=this._get_node(e))&&-1!==e||(e=this.get_container().find("> ul > li")),n=$.isArray(n)?n:["id","class"],!r&&this.data.types&&-1===$.inArray(h.types.type_attr,n)&&n.push(h.types.type_attr),i=$.isArray(i)?i:[],r||(d+="<root>"),e.each(function(){d+="<item",s=$(this),$.each(n,function(t,e){d+=" "+e+'="'+(s.attr(e)||"").replace(/jstree[^ ]*|$/gi,"").replace(/^\s+$/gi,"")+'"'}),s.hasClass("jstree-open")&&(d+=' state="open"'),s.hasClass("jstree-closed")&&(d+=' state="closed"'),"flat"===t&&(d+=' parent_id="'+r+'"'),d+=">",d+="<content>",s.children("a").each(function(){o=$(this),l=!1,d+="<name",-1!==$.inArray("languages",h.plugins)&&$.each(h.languages,function(t,e){if(o.hasClass(e))return d+=' lang="'+e+'"',l=e,!1}),i.length&&$.each(i,function(t,e){d+=" "+e+'="'+(o.attr(e)||"").replace(/jstree[^ ]*|$/gi,"")+'"'}),o.children("ins").get(0).className.replace(/jstree[^ ]*|$/gi,"").replace(/^\s+$/gi,"").length&&(d+=' icon="'+o.children("ins").get(0).className.replace(/jstree[^ ]*|$/gi,"").replace(/^\s+$/gi,"")+'"'),o.children("ins").get(0).style.backgroundImage.length&&(d+=' icon="'+o.children("ins").get(0).style.backgroundImage.replace("url(","").replace(")","")+'"'),d+=">",d+="<![CDATA["+u.get_text(o,l)+"]]>",d+="</name>"}),d+="</content>",a=s[0].id,s=s.find("> ul > li"),a=s.length?u.get_xml(t,s,n,i,a):"","nest"==t&&(d+=a),d+="</item>","flat"==t&&(d+=a)}),r||(d+="</root>"),d}},Element.prototype.scrollIntoViewIfNeeded||(Element.prototype.scrollIntoViewIfNeeded=function(t){t=0===arguments.length||!!t;var e=this.parentNode,n=window.getComputedStyle(e,null),i=parseInt(n.getPropertyValue("border-top-width")),r=parseInt(n.getPropertyValue("border-left-width")),o=this.offsetTop-e.offsetTop<e.scrollTop,a=this.offsetTop-e.offsetTop+this.clientHeight-i>e.scrollTop+e.clientHeight,s=this.offsetLeft-e.offsetLeft<e.scrollLeft,l=this.offsetLeft-e.offsetLeft+this.clientWidth-r>e.scrollLeft+e.clientWidth,d=o&&!a;(o||a)&&t&&(e.scrollTop=this.offsetTop-e.offsetTop-e.clientHeight/2-i+this.clientHeight/2),(s||l)&&t&&(e.scrollLeft=this.offsetLeft-e.offsetLeft-e.clientWidth/2-r+this.clientWidth/2),(o||a||s||l)&&!t&&this.scrollIntoView(d)});